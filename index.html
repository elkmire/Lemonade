<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="no-referrer">
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=()">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="LC5">
    <link rel="icon" href="icon.svg">
    <link rel="apple-touch-icon" href="icon.svg">
    <link rel="manifest" href="manifest.json">
    <title>LC5</title>
    <style>
/* CSS with dark/light mode support */
:root {
    --bg-color: #ffffff;
    --text-color: #000000;
    --title-gradient: linear-gradient(90deg, #000000, #000000);
    --card-bg: #ffffff;
    --accent-color: #000000;
    --border-color: #dddddd;
    --input-bg: #ffffff;
    --button-bg: #000000;
    --button-text: #ffffff;
    --button-hover: #333333;
    --success-color: #00cc66;
    --error-color: #cc3300;
    --warning-color: #f0ad4e;
    --cyber-line: rgba(0, 0, 0, 0.15); /* Kept for light mode, dark mode will override */
    --cyber-glow: rgba(0, 0, 0, 0.4); /* Kept for light mode, dark mode will override */
    --security-high: #00cc66;
    --security-medium: #f0ad4e;
    --security-low: #cc3300;
    --output-bg: #f8f8f8;
    --output-text: #222222;
}

/* Dark mode class */
body.dark-mode {
    --bg-color: #000000; /* Pitch black background */
    --text-color: #E0E0E0; /* Light grey/off-white for general text */
    --title-gradient: linear-gradient(90deg, #39FF14, #FF00FF, #00FFFF); /* Green, Pink, Blue */
    --card-bg: #0A0A0A; /* Very dark grey, almost black, solid */
    --accent-color: #39FF14; /* Terminal Green */
    --border-color: #2A2A2A; /* Darker grey for subtle borders */
    --input-bg: #101010; /* Dark grey for inputs */
    --button-bg: #00FFFF; /* Cyber Blue for buttons */
    --button-text: #000000; /* Black for text on blue buttons */
    --button-hover: #FF00FF; /* Hot Pink for button hover */
    --success-color: #39FF14; /* Terminal Green for success */
    --error-color: #FF3131; /* Neon Red for error */
    --warning-color: #FFFF00; /* Neon Yellow for warning */
    --cyber-line: rgba(57, 255, 20, 0.3); /* Terminal Green, slightly transparent line */
    --cyber-glow: rgba(57, 255, 20, 0.1); /* Terminal Green, very subtle glow or none */
    --security-high: #39FF14;
    --security-medium: #FFFF00;
    --security-low: #FF3131;
    --output-bg: #050505; /* Even darker for output boxes */
    --output-text: #B2F2BB; /* Light terminal green for output text */
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    transition: background-color 0.3s, color 0.3s;
    line-height: 1.6;
    position: relative;
    overflow-x: hidden;
}

body::before {
    display: none; /* Removed psychedelic background for performance */
}

/* Solid Black Background for Dark Mode */
body.dark-mode::before {
    content: "";
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    background-color: #000000; /* Pitch black */
    opacity: 1;
}

/* Static scanlines overlay (kept as it's not resource-intensive) */
body.dark-mode::after {
    content: "";
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1; /* Ensure it's behind content */
    background: repeating-linear-gradient(
        0deg,
        rgba(57, 255, 20, 0.05), /* Very subtle green scanlines */
        rgba(57, 255, 20, 0.05) 1px,
        transparent 1px,
        transparent 3px /* Increased spacing for subtlety */
    );
    pointer-events: none;
}

/* Enhanced App Title - No animation */
body.dark-mode .app-title {
    background: var(--title-gradient);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    text-shadow: none; /* Removed text-shadow */
    /* animation: title-shift 5s ease infinite; REMOVED */
}

/* Enhanced Cards - No animation or heavy shadows */
body.dark-mode .card {
    border: 1px solid var(--accent-color); /* Terminal green border */
    box-shadow: none; /* Removed box-shadow */
    backdrop-filter: none; /* Removed backdrop-filter */
    /* animation: border-pulse 4s infinite; REMOVED */
}

/* Enhanced Buttons - No animation or heavy shadows */
body.dark-mode button {
    border: 1px solid transparent;
    box-shadow: none; /* Removed box-shadow */
    text-shadow: none; /* Removed text-shadow */
    transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease; /* Simplified transition */
    position: relative;
    overflow: hidden;
}

body.dark-mode button:hover {
    background-color: var(--button-hover); /* Uses --button-hover (Hot Pink) */
    color: var(--button-text); /* Ensure text remains readable, or set a specific hover text color */
    box-shadow: none; /* Ensure no shadow on hover */
    transform: translateY(-1px); /* Slight lift effect */
}

/* Removed Psychedelic button effects */
body.dark-mode button::before {
    display: none; /* Removed animated gradient */
}

/* Enhanced Input Fields - No animation or heavy shadows */
body.dark-mode input,
body.dark-mode textarea,
body.dark-mode select {
    border: 1px solid var(--border-color);
    box-shadow: none; /* Removed inset shadow */
    backdrop-filter: none; /* Removed backdrop-filter */
    transition: border-color 0.2s ease; /* Simplified transition */
}

body.dark-mode input:focus,
body.dark-mode textarea:focus,
body.dark-mode select:focus {
    border-color: var(--accent-color); /* Terminal green border on focus */
    box-shadow: none; /* Removed focus shadow and animation */
    /* animation: focus-pulse 2s infinite; REMOVED */
}

/* Enhanced Security Badges - No animation */
body.dark-mode .security-badge {
    /* animation: security-pulse 2s infinite; REMOVED */
    text-shadow: none; /* Removed text-shadow */
}

/* Enhanced Key Items - Simplified */
body.dark-mode .key-item {
    border: 1px solid var(--border-color);
    background-color: var(--card-bg); /* Consistent with card background */
    box-shadow: none; /* Removed box-shadow */
    transition: border-color 0.2s ease; /* Simplified transition */
}

body.dark-mode .key-item:hover {
    transform: none; /* Removed transform */
    border-color: var(--accent-color); /* Green border on hover */
    box-shadow: none;
}

/* Tab Button Enhancement - Simplified */
body.dark-mode .tab-btn.active {
    background-color: var(--accent-color); /* Terminal green background */
    color: var(--button-text); /* Black text for contrast */
    border-bottom-color: var(--accent-color);
    box-shadow: none;
    /* animation: tab-shift 3s infinite; REMOVED */
}
body.dark-mode .tab-btn:hover:not(.active) {
    color: var(--accent-color);
    border-bottom-color: var(--accent-color);
}


/* Switch slider enhancement - Simplified */
body.dark-mode .slider {
    background-color: #333; /* Dark grey for off state */
    box-shadow: none;
}

body.dark-mode input:checked + .slider {
    background-color: var(--accent-color); /* Terminal green for on state */
}

body.dark-mode .slider:before {
    box-shadow: none;
    background-color: #111; /* Darker circle */
}
body.dark-mode input:checked + .slider:before {
    background-color: #000; /* Black circle when active */
}


/* Status enhancement - No animation */
body.dark-mode .status.success,
body.dark-mode .status.warning,
body.dark-mode .status.error {
    /* animation: status-pulse 2s infinite; REMOVED */
    border-width: 1px;
    border-style: solid;
}
body.dark-mode .status.success { background-color: rgba(57, 255, 20, 0.1); border-color: var(--success-color); color: var(--success-color); }
body.dark-mode .status.warning { background-color: rgba(255, 255, 0, 0.1); border-color: var(--warning-color); color: var(--warning-color); }
body.dark-mode .status.error { background-color: rgba(255, 49, 49, 0.1); border-color: var(--error-color); color: var(--error-color); }


/* Loading animation enhancement - Simplified */
body.dark-mode .spinner {
    border: 3px solid rgba(224, 224, 224, 0.2); /* Lighter, subtle border */
    border-top-color: var(--accent-color); /* Terminal Green */
    /* animation: spin 1s ease-in-out infinite, color-shift 3s linear infinite; REMOVED color-shift */
    animation: spin 1s linear infinite; /* Kept spin animation */
}

/* Ensure base styles for .app-title are present if needed */
.app-title {
    font-size: 1.8rem;
    margin: 0;
    background: var(--title-gradient); /* Ensure this is applied for light mode too */
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    /* text-shadow: 0 0 15px var(--cyber-glow); /* Potentially remove for light mode too if desired */
}

/* Updated Dark Mode styles for elements previously animated or heavily styled */
body.dark-mode .app-header::after {
    background: linear-gradient(90deg, transparent, var(--accent-color), transparent); /* Green accent line */
}

body.dark-mode .card::before { /* Top border highlight for card */
    background: var(--accent-color); /* Solid Green */
    height: 2px;
}

body.dark-mode .tab-btn:hover::after {
    background-color: var(--accent-color); /* Green underline on hover */
}

body.dark-mode input:focus, 
body.dark-mode textarea:focus, 
body.dark-mode select:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px var(--cyber-glow); /* Using the new subtle glow */
}

body.dark-mode .btn-secondary {
    border: 1px solid var(--accent-color); /* Green border */
    color: var(--accent-color); /* Green text */
    background-color: transparent;
}

body.dark-mode .btn-secondary:hover {
    background-color: rgba(57, 255, 20, 0.1); /* Slight green tint on hover */
    color: #39FF14; /* Brighter green text on hover */
}

/* Security Badges in Dark Mode - Static, no pulse */
body.dark-mode .security-badge {
    /* animation: securityPulse 2s infinite; REMOVED */
    transition: none;
}
body.dark-mode .security-badge.high { background-color: rgba(57, 255, 20, 0.1); color: var(--security-high); border: 1px solid var(--security-high); box-shadow: none; }
body.dark-mode .security-badge.medium { background-color: rgba(255, 255, 0, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); box-shadow: none; }
body.dark-mode .security-badge.low { background-color: rgba(255, 49, 49, 0.1); color: var(--security-low); border: 1px solid var(--security-low); box-shadow: none; }

/* Key Pair Badges in Dark Mode - Static */
body.dark-mode .key-pair-badge.full { background-color: rgba(57, 255, 20, 0.1); color: var(--security-high); border: 1px solid var(--security-high); box-shadow: none; }
body.dark-mode .key-pair-badge.private { background-color: rgba(255, 49, 49, 0.1); color: var(--security-low); border: 1px solid var(--security-low); box-shadow: none; }
body.dark-mode .key-pair-badge.public { background-color: rgba(255, 255, 0, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); box-shadow: none; }

body.dark-mode .private-key-btn {
    border: 1px solid var(--error-color) !important;
    color: var(--error-color) !important;
}
body.dark-mode .private-key-btn:hover {
    background-color: rgba(255, 49, 49, 0.2) !important;
    color: #FF3131 !important; /* Brighter red on hover */
}

/* Modal Content in Dark Mode */
body.dark-mode .modal-content {
    border: 1px solid var(--accent-color); /* Green border */
    box-shadow: none; /* Removed glow */
    background-color: var(--card-bg); /* Consistent with card backgrounds */
}

/* Primary button in dark mode (often used in modals) */
body.dark-mode .btn-primary {
    background-color: var(--accent-color); /* Green */
    color: #000000; /* Black text for contrast */
}
body.dark-mode .btn-primary:hover {
    background-color: #4CFF3A; /* Lighter green for hover */
}

/* Zero Keys button dark mode override */
body.dark-mode .btn-zero {
    background-color: var(--error-color); /* Neon Red */
    color: #FFFFFF; /* White text for contrast */
    border: 1px solid #FF0000; /* Brighter Red border */
}
body.dark-mode .btn-zero:hover {
    background-color: #FF5555; /* Lighter Neon Red */
}

/* Ensure general body styles and other non-dark-mode specific styles remain below */

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    transition: background-color 0.3s, color 0.3s;
    line-height: 1.6;
    position: relative;
    overflow-x: hidden;
}

/* Base container - Responsive container sizing */
.container {
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
    transition: max-width 0.3s ease-in-out;
}

.app-header {
    text-align: center;
    margin-bottom: 20px;
    position: relative;
}

/* .app-title is already defined above with dark mode considerations */

.app-subtitle {
    font-size: 0.9rem;
    margin: 0;
    padding-top: 2px;
    font-style: italic;
    color: var(--text-color);
    opacity: 0.8;
}

.app-header::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 80%;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
}

.card {
    background-color: var(--card-bg);
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    padding: 20px;
    margin-bottom: 20px;
    border: 1px solid var(--border-color);
    position: relative;
    overflow: hidden;
}

.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, #33aaff, #0066cc); /* Default for light mode */
}
/* Dark mode card::before is handled by body.dark-mode .card::before */


.tabs {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
    border-bottom: 1px solid var(--border-color);
    overflow-x: auto; /* Allow scrolling on small screens */
}

.tab-btn {
    background: none;
    border: none;
    padding: 10px 20px;
    font-size: 1rem;
    cursor: pointer;
    color: var(--text-color);
    border-bottom: 2px solid transparent;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
    white-space: nowrap; /* Prevent text wrapping */
}

.tab-btn.active {
    border-bottom: 2px solid var(--accent-color);
    color: var(--accent-color);
}
/* body.dark-mode .tab-btn.active is already defined */

.tab-btn::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background-color: var(--accent-color);
    transition: width 0.3s;
}

.tab-btn:hover::after {
    width: 100%;
}
/* body.dark-mode .tab-btn:hover::after is already defined */

.tab-content {
    display: none !important;
}

.tab-content.active {
    display: block !important;
    /* animation: fadeIn 0.3s ease-in-out; REMOVED animation for performance */
}

/* @keyframes fadeIn { REMOVED
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
} */

.form-group {
    margin-bottom: 15px;
}

label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
}

input, textarea, select {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background-color: var(--input-bg);
    color: var(--text-color);
    font-size: 1rem;
    box-sizing: border-box;
    transition: border-color 0.3s, box-shadow 0.3s;
}

input:focus, textarea:focus, select:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px var(--cyber-glow); /* Default glow, dark mode overrides this */
}
/* body.dark-mode input:focus etc. is already defined */


/* Enhanced output textareas */
#encryptedOutput,
#decryptedOutput {
    min-height: 120px;
    background-color: var(--output-bg);
    color: var(--output-text);
    border-width: 1px;
    border-style: solid;
    border-color: var(--border-color);
    font-family: 'Consolas', 'Courier New', monospace;
    width: 100%;
    resize: vertical;
    padding: 15px;
    overflow-y: auto;
}

/* Make sure parent containers don't restrict width */
.form-group:has(#encryptedOutput),
.form-group:has(#decryptedOutput) {
    width: 100%;
}

/* Non :has() fallback for better browser compatibility */
#encrypt .form-group:nth-of-type(3),
#decrypt .form-group:nth-of-type(3) {
    width: 100%;
}

textarea {
    min-height: 100px;
    resize: vertical;
}

button {
    background-color: var(--button-bg);
    color: var(--button-text);
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.1s;
    position: relative;
    overflow: hidden;
}

button:hover {
    background-color: var(--button-hover);
}
/* body.dark-mode button:hover is already defined */


button:active {
    transform: scale(0.98);
}

/* Removed ripple effect for performance */
button::after {
    display: none;
}
/* @keyframes ripple { REMOVED ... } */

.btn-group {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}

.btn-secondary {
    background-color: transparent;
    border: 1px solid var(--accent-color);
    color: var(--accent-color);
}
/* body.dark-mode .btn-secondary is already defined */

.btn-secondary:hover {
    background-color: rgba(0,0,0, 0.05); /* Subtle hover for light mode */
}
/* body.dark-mode .btn-secondary:hover is already defined */

.status {
    padding: 10px;
    border-radius: 8px;
    margin-top: 15px;
    display: none; /* Hidden by default */
}

.status.success {
    background-color: rgba(0, 204, 102, 0.1);
    color: var(--success-color);
    border: 1px solid var(--success-color);
    display: block;
}

.status.warning {
    background-color: rgba(240, 173, 78, 0.1);
    color: var(--warning-color);
    border: 1px solid var(--warning-color);
    display: block;
}

.status.error {
    background-color: rgba(204, 51, 0, 0.1);
    color: var(--error-color);
    border: 1px solid var(--error-color);
    display: block;
}
/* body.dark-mode .status styles are already defined */

.keys-container {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.keys-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px;
    width: 100%;
}

.key-form {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.key-item {
    background-color: var(--input-bg); /* Light mode uses input background */
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 15px;
    display: flex;
    flex-direction: column;
    height: 100%;
}
/* body.dark-mode .key-item is already defined */


.key-item-content {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.key-item h3 {
    margin-top: 0;
    margin-bottom: 10px;
}

.key-header {
    text-align: center;
    margin-bottom: 15px;
}

.key-actions {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
    margin-top: auto;
    padding-top: 15px;
    border-top: 1px solid var(--border-color);
}

.key-actions button {
    flex: 1 1 auto;
    min-width: 80px;
    padding: 8px 12px;
    font-size: 0.9rem;
}

.key-meta {
    font-size: 0.9rem;
    color: #888; /* Consistent for both modes, or use var(--text-color) with opacity */
    margin-bottom: 5px;
}

.key-management-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 20px;
}

.key-management-buttons button {
    flex: 1 1 auto;
    min-width: 100px;
}

.btn-zero {
    background-color: #cc3300;
    color: white;
    margin-top: 20px;
    width: 100%;
    font-weight: bold;
    border: 1px solid #aa2200;
}
.btn-zero:hover {
    background-color: #ff3300;
}
/* body.dark-mode .btn-zero is already defined */


.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent black */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    display: none; /* Hidden by default */
}

.spinner {
    width: 50px;
    height: 50px;
    border: 5px solid rgba(255, 255, 255, 0.3); /* Default for light mode, or when overlay is on light bg */
    border-radius: 50%;
    border-top-color: var(--accent-color); /* Uses current accent color */
    animation: spin 1s linear infinite; /* Simplified animation */
}
/* body.dark-mode .spinner is already defined */

@keyframes spin {
    to { transform: rotate(360deg); }
}
/* @keyframes color-shift { REMOVED ... } */


.password-strength {
    height: 5px;
    border-radius: 5px;
    margin-top: 5px;
    transition: all 0.3s;
}
.password-strength.weak { background-color: var(--security-low); width: 30%; }
.password-strength.medium { background-color: var(--security-medium); width: 60%; }
.password-strength.strong { background-color: var(--security-high); width: 100%; }

.password-feedback {
    font-size: 0.8rem;
    margin-top: 5px;
    color: var(--text-color); /* Ensure it's readable in dark mode */
    opacity: 0.9;
}

.security-badge {
    display: inline-flex;
    align-items: center;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    margin-left: 8px;
    font-weight: bold;
}
.security-badge.high { background-color: rgba(0, 204, 102, 0.1); color: var(--security-high); border: 1px solid var(--security-high); }
.security-badge.medium { background-color: rgba(240, 173, 78, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); }
.security-badge.low { background-color: rgba(204, 51, 0, 0.1); color: var(--security-low); border: 1px solid var(--security-low); }
/* body.dark-mode .security-badge (static) is already defined */

/* @keyframes securityPulse { REMOVED ... } */


.key-pair-badge {
    display: inline-flex;
    align-items: center;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: bold;
    margin-top: 5px;
}
.key-pair-badge.full { background-color: rgba(0, 204, 102, 0.1); color: var(--security-high); border: 1px solid var(--security-high); }
.key-pair-badge.private { background-color: rgba(204, 51, 0, 0.1); color: var(--security-low); border: 1px solid var(--security-low); }
.key-pair-badge.public { background-color: rgba(240, 173, 78, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); }
/* body.dark-mode .key-pair-badge (static) is already defined */


.private-key-btn { /* Base style for light mode */
    border: 1px solid var(--error-color) !important;
    color: var(--error-color) !important;
}
.private-key-btn:hover {
    background-color: rgba(204, 51, 0, 0.1) !important;
}
/* body.dark-mode .private-key-btn is already defined */


.config-toggle {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}
.config-toggle label {
    display: inline;
    margin-bottom: 0;
}

.switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 24px;
}
.switch input { opacity: 0; width: 0; height: 0; }

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc; /* Light mode off */
    transition: .4s;
    border-radius: 24px;
}
.slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: white; /* Light mode handle */
    transition: .4s;
    border-radius: 50%;
}
input:checked + .slider { background-color: var(--accent-color); } /* Uses current accent */
input:focus + .slider { box-shadow: 0 0 1px var(--accent-color); }
input:checked + .slider:before { transform: translateX(26px); }
/* body.dark-mode .slider styles are already defined */


.security-info {
    font-size: 0.9rem;
    padding: 10px;
    border-left: 3px solid var(--accent-color);
    background-color: rgba(0,0,0, 0.03); /* Very light grey for light mode */
    margin-bottom: 15px;
}
body.dark-mode .security-info {
    background-color: rgba(57, 255, 20, 0.05); /* Subtle green background */
    border-left-color: var(--accent-color); /* Green left border */
    color: var(--text-color);
}

.key-expiry {
    font-size: 0.8rem;
    color: var(--warning-color); /* Uses warning color */
    margin-top: 5px;
    font-style: italic;
}

#inactivityModal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 1001;
    justify-content: center;
    align-items: center;
}
.modal-content { /* Base styles for modal, dark mode overrides parts of this */
    background-color: var(--card-bg);
    padding: 20px;
    border-radius: 12px;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3); /* Light mode shadow */
    width: 90%; /* Added for responsiveness */
    position: relative; /* Added for positioning context if needed */
}
/* body.dark-mode .modal-content is already defined */

.timer {
    font-size: 2rem;
    margin: 20px 0;
    color: var(--warning-color);
}

#settings { display: none; } /* Base, active state is .tab-content.active */

.settings-section { margin-bottom: 20px; }
.settings-section h3 {
    margin-top: 0;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 5px;
}

.file-info {
    margin-top: 10px;
    font-size: 0.9rem;
    background-color: var(--input-bg);
    padding: 8px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.file-info-name { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.file-icon { margin-right: 8px; font-size: 1.2rem; }
.remove-file { cursor: pointer; color: var(--error-color); padding: 2px 6px; border-radius: 4px; margin-left: 8px; }
.remove-file:hover { background-color: rgba(204, 51, 0, 0.1); } /* Light mode hover */
body.dark-mode .remove-file:hover { background-color: rgba(255, 49, 49, 0.2); }


/* Password Modal Styles */
.modal { /* General modal styling, used by passwordModal too */
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 1001;
    justify-content: center;
    align-items: center;
}

.btn-primary { /* Base btn-primary, dark mode overrides */
    background-color: var(--accent-color);
    color: var(--button-text);
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.1s;
}
.btn-primary:hover {
    background-color: var(--button-hover);
}
/* body.dark-mode .btn-primary is already defined */


/* Mobile Optimization */
@media (max-width: 600px) {
    .container { padding: 15px; }
    .card { padding: 15px; }
    .app-title { font-size: 1.5rem; }
    .btn-group { flex-direction: column; }
    /* button { width: 100%; } This was too broad, specific buttons might need this */
    .btn-group button { width: 100%; } /* Apply to buttons within btn-group */
    .key-actions button { width: 100%; margin-bottom: 5px; }


    .tab-btn { padding: 10px 10px; font-size: 0.9rem; }
    .key-actions { flex-direction: column; }
}

@media (max-width: 767px) {
    .keys-container { flex-direction: column; }
    .key-form, .keys-list-container { width: 100%; }
}

/* Medium screens (tablets and small desktops) */
@media (min-width: 768px) {
    .container { max-width: 750px; }
    .app-title { font-size: 2rem; }
    .card { padding: 25px; }
    #encryptedOutput, #decryptedOutput { min-height: 150px; font-size: 1.05rem; }
    .keys-container { flex-direction: row; align-items: flex-start; }
    .key-form { width: 40%; position: sticky; top: 20px; }
    .keys-list-container { width: 60%; }
    .key-item h3 { font-size: 1.1rem; margin-top: 0; margin-bottom: 10px; word-break: break-word; }
}

/* Large screens (desktops and large tablets in landscape) */
@media (min-width: 1024px) {
    .container { max-width: 900px; }
    #encryptedOutput, #decryptedOutput { min-height: 180px; font-size: 1.1rem; padding: 18px; }
    #keys .card { display: flex; flex-wrap: wrap; gap: 20px; }
    #keys .card > h2, #keys .card > .security-info { width: 100%; }
    #keys .card > .form-group, #keys .card > button#generateKeyBtn { width: calc(40% - 10px); }
    #keys .card > div:has(#keysList) { width: calc(60% - 10px); margin-top: 0; }
    #keys .card > div:nth-last-child(3) { /* Fallback */ width: calc(60% - 10px); margin-top: 0; }
    #keys .card > .btn-group, #keys .card > div:has(#zeroKeysBtn) { width: 100%; }
    #encrypt .card, #decrypt .card { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    #encrypt .card > .form-group:first-child,
    #decrypt .card > .form-group:first-child,
    #encrypt .card > .form-group:has(#encryptedOutput),
    #decrypt .card > .form-group:has(#decryptedOutput),
    #encrypt .card > .form-group:nth-child(3), /* Fallback */
    #decrypt .card > .form-group:nth-child(3) /* Fallback */
    { grid-column: 1 / span 2; }
    #encrypt .card > button, #decrypt .card > button { grid-column: 1 / span 2; }
    #encrypt .card > .btn-group, #decrypt .card > .btn-group { grid-column: 1 / span 2; }
    #encrypt .card > #encryptStatus, #decrypt .card > #decryptStatus { grid-column: 1 / span 2; }
}

@media (min-width: 1200px) {
    .container { max-width: 1140px; }
    .keys-grid { grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); }
}

/* Extra large screens */
@media (min-width: 1440px) {
    .container { max-width: 1200px; }
    #encryptedOutput, #decryptedOutput { min-height: 220px; font-size: 1.15rem; padding: 20px; }
    #settings .card { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
    #settings .card > h2 { grid-column: 1 / span 2; }
    #settings .card > .btn-group { grid-column: 1 / span 2; justify-content: center; }
    #settings .card > #settingsStatus { grid-column: 1 / span 2; }
    #keysList { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }

    @media (min-width: 1800px) {
        #encrypt .card, #decrypt .card { grid-template-columns: 1fr 1fr 1fr; }
        #encrypt .card > .form-group:first-child,
        #decrypt .card > .form-group:first-child,
        #encrypt .card > .form-group:has(#encryptedOutput),
        #decrypt .card > .form-group:has(#decryptedOutput),
        #encrypt .card > .form-group:nth-child(3), /* Fallback */
        #decrypt .card > .form-group:nth-child(3), /* Fallback */
        #encrypt .card > button, #decrypt .card > button,
        #encrypt .card > .btn-group, #decrypt .card > .btn-group,
        #encrypt .card > #encryptStatus, #decrypt .card > #decryptStatus
        { grid-column: 1 / span 3; }
    }
}

/* Ensure button groups stack properly on mobile but stay horizontal on larger screens */
/* This is already handled well by the (max-width: 600px) rule for .btn-group */
@media (min-width: 601px) {
    .btn-group { flex-direction: row; }
    .btn-group button { flex: 1; }
}


/* Print styles */
@media print {
    body { background-color: white; color: black; }
    body.dark-mode { /* Override dark mode for print */
        --bg-color: #ffffff;
        --text-color: #000000;
        --card-bg: #ffffff;
        --border-color: #dddddd;
        --input-bg: #ffffff;
        --output-bg: #f8f8f8;
        --output-text: #222222;
    }
    body.dark-mode .app-title { /* Ensure title is visible when printing from dark mode */
        background: none;
        color: #000000;
        text-shadow: none;
    }
    body.dark-mode .tab-btn.active {
        color: #000000; /* Black text for active tab in print */
        background: none;
    }
    body.dark-mode .security-info {
        background-color: #f0f0f0;
        border-left-color: #ccc;
        color: #000;
    }


    .card { box-shadow: none; border: 1px solid #ddd; }
    .btn-group, button, .tabs, .app-subtitle, .key-actions, .key-management-buttons, .config-toggle, #installContainer, .remove-file { display: none !important; }
    .container { max-width: 100%; padding: 0; }
    #encryptedOutput, #decryptedOutput { border: 1px solid #ddd; background-color: white; color: black; min-height: auto; }
    .key-item { page-break-inside: avoid; }
    .keys-grid { grid-template-columns: 1fr !important; } /* Single column for printing keys */
}
    </style>
</head>
<body>
    <div class="container">
        <div class="app-header">
            <h1 class="app-title">LC5</h1>
            <div class="app-subtitle">by elkmire</div>
            <p>Secure MSG.FILE option</p>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" data-tab="encrypt">Encrypt</button>
            <button class="tab-btn" data-tab="decrypt">Decrypt</button>
            <button class="tab-btn" data-tab="keys">Key Management</button>
            <button class="tab-btn" data-tab="settings">Settings</button>
        </div>
        
        <div class="tab-content active" id="encrypt">
            <div class="card">
                <div class="form-group">
                    <label for="encryptMessage">To Encrypt</label>
                    <textarea id="encryptMessage" placeholder="Free-type here or load file for encryption..."></textarea>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <button id="encryptBrowseBtn" class="btn-secondary">Browse Files</button>
                        <button id="clearEncryptMessageBtn" class="btn-secondary">Clear</button>
                        <input type="file" id="encryptFileInput" style="display: none;">
                    </div>
                    <div id="encryptFileInfo" style="display: none;" class="file-info">
                        <span><span class="file-icon">📄</span> <span id="encryptFileName" class="file-info-name"></span></span>
                        <span class="remove-file" id="removeEncryptFile">×</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="encryptionKey">Encryption Key</label>
                    <select id="encryptionKey">
                        <option value="">Select a key...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="encryptObfKey">OBF Key</label>
                    <input type="text" id="encryptObfKey" placeholder="Optional*">
                </div>
                
                <div class="form-group" id="encryptionPasswordGroup" style="display: none;">
                    <label for="encryptionPassword">Key Password</label>
                    <input type="password" id="encryptionPassword" placeholder="Enter key password">
                </div>
                
                <button id="encryptBtn">Encrypt Data</button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="encryptedOutput">Encrypted Data</label>
                    <textarea id="encryptedOutput" readonly></textarea>
                </div>
                
                <div class="btn-group">
                    <button id="downloadEncryptedBtn" class="btn-secondary">Download Encrypted File</button>
                    <button id="copyEncryptedBtn" class="btn-secondary">Copy to Clipboard</button>
                    <button id="clearEncryptBtn" class="btn-secondary">Clear All</button>
                </div>
                
                <div id="encryptStatus" class="status"></div>
            </div>
        </div>
        
        <div class="tab-content" id="decrypt">
            <div class="card">
                <div class="form-group">
                    <label for="encryptedMessage">To Decrypt</label>
                    <textarea id="encryptedMessage" placeholder="Paste the encrypted data here or load encrypted data..."></textarea>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <button id="decryptBrowseBtn" class="btn-secondary">Browse Files</button>
                        <button id="clearEncryptedMessageBtn" class="btn-secondary">Clear</button>
                        <input type="file" id="decryptFileInput" style="display: none;">
                    </div>
                    <div id="decryptFileInfo" style="display: none;" class="file-info">
                        <span><span class="file-icon">📄</span> <span id="decryptFileName" class="file-info-name"></span></span>
                        <span class="remove-file" id="removeDecryptFile">×</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="decryptionKey">Decryption Key</label>
                    <select id="decryptionKey">
                        <option value="">Select a key...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="decryptObfKey">OBF Key</label>
                    <input type="text" id="decryptObfKey" placeholder="**if custom, enter BEFORE FILE* upload**">
                </div>
                
                <div class="form-group" id="decryptionPasswordGroup" style="display: none;">
                    <label for="decryptionPassword">Key Password</label>
                    <input type="password" id="decryptionPassword" placeholder="Enter key password">
                </div>
                
                <button id="decryptBtn">Decrypt Data</button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="decryptedOutput">Decrypted Data</label>
                    <textarea id="decryptedOutput" readonly></textarea>
                </div>
                
                <div class="btn-group">
                    <button id="downloadDecryptedBtn" class="btn-secondary">Download Decrypted File</button>
                    <button id="copyDecryptedBtn" class="btn-secondary">Copy to Clipboard</button>
                    <button id="clearDecryptBtn" class="btn-secondary">Clear All</button>
                </div>
                
                <div id="decryptStatus" class="status"></div>
            </div>
        </div>
        
        <div class="tab-content" id="keys">
            <div class="card">
                <h2>Key Management</h2>
                
                <div class="security-info">
                    <strong>Security Note:</strong> All keys are stored locally in your browser's protected storage and never sent to any server.
                </div>
                
                <div class="keys-container">
                    <div class="key-form">
                        <div class="form-group">
                            <label for="keyName">Key Name</label>
                            <input type="text" id="keyName" placeholder="e.g., enter crypto name">
                        </div>
                        
                        <div class="form-group">
                            <label for="keyType">Key Type</label>
                            <select id="keyType">
                                <option value="aes">AES-GCM (Symmetric) - 256 bits</option>
                                <option value="rsa">RSA-OAEP (Asymmetric) - 2048 bits</option>
                                <option value="rsa-4096">RSA-OAEP (Asymmetric) - 4096 bits</option>
                                <option value="ecc">ECC (Asymmetric) - P-256</option>
                                <option value="ecc-p384">ECC (Asymmetric) - P-384</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="keyExpiry">Key Expiration (Optional)</label>
                            <select id="keyExpiry">
                                <option value="">Never (Not Recommended)</option>
                                <option value="30">30 Days</option>
                                <option value="90">90 Days</option>
                                <option value="180">180 Days</option>
                                <option value="365">1 Year</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="keyPasswordGroup">
                            <label for="keyPassword">Key Password (Recommended)</label>
                            <input type="password" id="keyPassword" placeholder="Enter optional password">
                            <div id="passwordStrength" class="password-strength"></div>
                            <div id="passwordFeedback" class="password-feedback"></div>
                        </div>
                        
                        <div class="form-group" id="confirmKeyPasswordGroup">
                            <label for="confirmKeyPassword">Confirm Password</label>
                            <input type="password" id="confirmKeyPassword" placeholder="Confirm your password">
                        </div>
                        
                        <button id="generateKeyBtn">Generate New Key</button>
                        
                        <div class="key-management-buttons">
                            <button id="importKeyBtn" class="btn-secondary">Import Key</button>
                            <button id="exportAllKeysBtn" class="btn-secondary">Export State</button>
                            <button id="importStateBtn" class="btn-secondary">Import State</button>
                        </div>
        
                        <div style="text-align: center; margin-top: 20px;">
                            <button id="zeroKeysBtn" class="btn-zero">ZERO ALL KEYS</button>
                        </div>
                        
                        <div id="keyStatus" class="status"></div>
                    </div>
                    
                    <div class="keys-list-container">
                        <h3>Your Keys</h3>
                        <div id="keysList" class="keys-grid">
                            <!-- Keys will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="settings">
            <div class="card">
                <h2>Security Settings</h2>
<p> (Must SAVE for changes to take effect) <p>
                
                <div class="settings-section">
                    <h3>Storage Options</h3>
                    
                    <div class="config-toggle">
                        <label for="useIndexedDB">Use IndexedDB for key storage (more secure)</label>
                        <label class="switch">
                            <input type="checkbox" id="useIndexedDB" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="config-toggle">
                        <label for="sessionOnly">Session-only mode (keys aren't saved when browser closes)</label>
                        <label class="switch">
                            <input type="checkbox" id="sessionOnly">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>Security Parameters</h3>
                    
                    <div class="config-toggle">
                        <label for="enforcePwdProtection">Enforce password protection for keys</label>
                        <label class="switch">
                            <input type="checkbox" id="enforcePwdProtection">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="config-toggle">
                        <label for="enforceKeyExpiry">Enforce key expiration</label>
                        <label class="switch">
                            <input type="checkbox" id="enforceKeyExpiry">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label for="pbkdf2Iterations">PBKDF2 Iterations (higher = more secure but slower)</label>
                        <select id="pbkdf2Iterations">
                            <option value="100000">100,000 (Default)</option>
                            <option value="200000">200,000</option>
                            <option value="300000">300,000</option>
                            <option value="500000">500,000</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Appearance</h3>
                    
                    <div class="config-toggle">
                        <label for="darkMode">Dark Mode</label>
                        <label class="switch">
                            <input type="checkbox" id="darkMode">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Install App</h3>
                    <p>Installs PWA (must be Chromium-based browser or Safari for IOS)</p>
                    <div id="installContainer">
                        <button id="installBtn" class="btn-secondary">Install Lemonade App</button>
                        <p class="install-note" style="margin-top: 8px; font-size: 0.85rem; color: #888;">
                            (Button will be enabled when installation is available)
                        </p>
                    </div>
                    <div id="installStatus" class="status"></div>
                </div>

                <div class="btn-group">
                    <button id="saveSettingsBtn">Save Settings</button>
                    <button id="resetSettingsBtn" class="btn-secondary">Reset to Defaults</button>
                </div>
                
                <div id="settingsStatus" class="status"></div>
            </div>
        </div>
    </div>
    
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>
    
    <script>
function _0x36cb(_0x10bf9e,_0x5a7b32){const _0x5c1dab=_0x5c1d();return _0x36cb=function(_0x36cb8e,_0xc75c70){_0x36cb8e=_0x36cb8e-0x1e9;let _0x285678=_0x5c1dab[_0x36cb8e];return _0x285678;},_0x36cb(_0x10bf9e,_0x5a7b32);}const _0x1df063=_0x36cb;(function(_0x30b9de,_0x4eb14c){const _0x53a6c8=_0x36cb,_0x74eadf=_0x30b9de();while(!![]){try{const _0x4a546a=-parseInt(_0x53a6c8(0x35b))/0x1+-parseInt(_0x53a6c8(0x28a))/0x2+parseInt(_0x53a6c8(0x38c))/0x3*(-parseInt(_0x53a6c8(0x381))/0x4)+parseInt(_0x53a6c8(0x23f))/0x5*(-parseInt(_0x53a6c8(0x2fc))/0x6)+parseInt(_0x53a6c8(0x3c5))/0x7+parseInt(_0x53a6c8(0x2e1))/0x8*(-parseInt(_0x53a6c8(0x275))/0x9)+-parseInt(_0x53a6c8(0x2a3))/0xa*(-parseInt(_0x53a6c8(0x2ea))/0xb);if(_0x4a546a===_0x4eb14c)break;else _0x74eadf['push'](_0x74eadf['shift']());}catch(_0x3b10c3){_0x74eadf['push'](_0x74eadf['shift']());}}}(_0x5c1d,0x92c27));const PBKDF2_CONFIG={'ITERATIONS':0x186a0,'HASH':_0x1df063(0x33a)},AES_CONFIG={'KEY_LENGTH':0x100,'MODE':_0x1df063(0x2ce),'IV_LENGTH':0xc,'TAG_LENGTH':0x80},RSA_CONFIG={'KEY_SIZE':0x800,'KEY_SIZE_4096':0x1000,'ALGORITHM':_0x1df063(0x3c1),'HASH':'SHA-256'},ECC_CONFIG={'CURVE':_0x1df063(0x2a1),'CURVE_P384':_0x1df063(0x2c6),'ALGORITHM':_0x1df063(0x228),'KEY_DERIVATION':'HKDF','KDF_HASH':_0x1df063(0x33a),'ENC_ALGORITHM':'AES-GCM'},DB_NAME=_0x1df063(0x242),DB_VERSION=0x1,KEYS_STORE=_0x1df063(0x25b),SETTINGS_STORE='settings',DEFAULT_SETTINGS={'useIndexedDB':!![],'sessionOnly':![],'enforcePwdProtection':![],'enforceKeyExpiry':![],'pbkdf2Iterations':0x186a0};let db=null,keys=[],appSettings={...DEFAULT_SETTINGS};const tabBtns=document['querySelectorAll'](_0x1df063(0x399)),tabContents=document['querySelectorAll'](_0x1df063(0x3b7)),encryptionKeySelect=document[_0x1df063(0x38b)](_0x1df063(0x231)),decryptionKeySelect=document[_0x1df063(0x38b)](_0x1df063(0x22c)),keysList=document[_0x1df063(0x38b)]('keysList'),loadingOverlay=document[_0x1df063(0x38b)](_0x1df063(0x2f9)),inactivityModal=document[_0x1df063(0x38b)]('inactivityModal'),timeoutTimer=document[_0x1df063(0x38b)]('timeoutTimer'),safeMemory={'sensitiveData':new WeakMap(),'store':function(_0x4ba6fb){const _0x1ea5c5=_0x1df063,_0x1bf7c9={'id':crypto[_0x1ea5c5(0x22d)]()};return this[_0x1ea5c5(0x35f)][_0x1ea5c5(0x379)](_0x1bf7c9,_0x4ba6fb),_0x1bf7c9;},'retrieve':function(_0x383a07,_0x2992ca=![]){const _0x347bae=_0x1df063;if(!this['sensitiveData'][_0x347bae(0x354)](_0x383a07))return null;const _0x5c3fd1=this[_0x347bae(0x35f)][_0x347bae(0x367)](_0x383a07);return _0x2992ca&&this['sensitiveData']['delete'](_0x383a07),_0x5c3fd1;},'delete':function(_0x44f7b6){const _0x19c484=_0x1df063;if(this['sensitiveData'][_0x19c484(0x354)](_0x44f7b6))return this[_0x19c484(0x35f)][_0x19c484(0x227)](_0x44f7b6),!![];return![];},'clearAll':function(){const _0x421c58=_0x1df063;this[_0x421c58(0x35f)]=new WeakMap();if(typeof window['gc']===_0x421c58(0x316))try{window['gc']();}catch(_0x3d3f02){console['log'](_0x421c58(0x2df));}}},validator={'sanitizeHTML':function(_0x4bb3ca){const _0x125abd=_0x1df063,_0x262e29=document['createElement']('div');return _0x262e29[_0x125abd(0x2a2)]=_0x4bb3ca,_0x262e29[_0x125abd(0x2b5)];},'validateInput':function(_0x4b2c0a,_0x190299=![]){const _0x2dc7ae=_0x1df063;if(_0x4b2c0a===null||_0x4b2c0a===undefined)return'';const _0x118ad4=String(_0x4b2c0a);return _0x190299?_0x118ad4:this[_0x2dc7ae(0x31c)](_0x118ad4);},'isValidKeyName':function(_0x58aed1){const _0x3a9225=_0x1df063;return/^[A-Za-z0-9 ._-]{1,50}$/[_0x3a9225(0x358)](_0x58aed1);},'isValidEncryptedMessage':function(_0x479281){const _0x4d84de=_0x1df063;return/^--LM--\s*[A-Za-z0-9+/=]+\s*--EM--$/s[_0x4d84de(0x358)](_0x479281);},'measurePasswordStrength':function(_0x4972f9){const _0x36bfba=_0x1df063;let _0x1481e4=0x0;if(!_0x4972f9)return{'score':0x0,'feedback':_0x36bfba(0x3ad)};const _0x720d85=_0x4972f9['length'];_0x1481e4+=Math[_0x36bfba(0x378)](0x5,Math[_0x36bfba(0x317)](_0x720d85/0x4));if(/[a-z]/[_0x36bfba(0x358)](_0x4972f9))_0x1481e4+=0x1;if(/[A-Z]/[_0x36bfba(0x358)](_0x4972f9))_0x1481e4+=0x1;if(/[0-9]/[_0x36bfba(0x358)](_0x4972f9))_0x1481e4+=0x1;if(/[^A-Za-z0-9]/[_0x36bfba(0x358)](_0x4972f9))_0x1481e4+=0x2;if(/^[a-zA-Z]+$/['test'](_0x4972f9))_0x1481e4-=0x1;if(/^[0-9]+$/[_0x36bfba(0x358)](_0x4972f9))_0x1481e4-=0x1;if(/(.)\1{2,}/[_0x36bfba(0x358)](_0x4972f9))_0x1481e4-=0x1;let _0x3bd922,_0x3249db;if(_0x1481e4<0x4)_0x3bd922='weak',_0x3249db='Weak\x20-\x20Use\x20a\x20longer\x20password\x20with\x20numbers\x20and\x20special\x20characters';else _0x1481e4<0x8?(_0x3bd922=_0x36bfba(0x240),_0x3249db=_0x36bfba(0x29a)):(_0x3bd922=_0x36bfba(0x387),_0x3249db=_0x36bfba(0x34f));return{'score':_0x1481e4,'strengthCategory':_0x3bd922,'feedback':_0x3249db};}},escapeRegex=_0x4b6c1b=>{const _0x2147bf=_0x1df063;if(typeof _0x4b6c1b!==_0x2147bf(0x3aa))return'';return _0x4b6c1b[_0x2147bf(0x2d8)](/[.*+?^${}()|[\]\\]/g,_0x2147bf(0x20e));};document[_0x1df063(0x346)](_0x1df063(0x2f8),async()=>{const _0xdfadc6=_0x1df063;document[_0xdfadc6(0x2d2)](_0xdfadc6(0x399))[_0xdfadc6(0x2a5)](_0x491028=>{const _0x30f90f=_0xdfadc6;_0x491028[_0x30f90f(0x346)](_0x30f90f(0x2c0),_0x53b1f1=>{const _0x3baed3=_0x30f90f;_0x53b1f1[_0x3baed3(0x293)]();const _0x181207=_0x491028[_0x3baed3(0x3cc)](_0x3baed3(0x3a6));console['log'](_0x3baed3(0x2a4),_0x181207),switchTab(_0x181207);});}),document[_0xdfadc6(0x38b)]('darkMode')[_0xdfadc6(0x346)](_0xdfadc6(0x22e),toggleDarkMode);const _0x3a55d2=localStorage[_0xdfadc6(0x34d)](_0xdfadc6(0x304));_0x3a55d2==='true'&&(document['getElementById'](_0xdfadc6(0x350))['checked']=!![],document[_0xdfadc6(0x3a1)]['classList'][_0xdfadc6(0x260)](_0xdfadc6(0x24a))),document[_0xdfadc6(0x38b)](_0xdfadc6(0x2fd))[_0xdfadc6(0x346)]('click',()=>{clearEncryptFile();}),document[_0xdfadc6(0x38b)](_0xdfadc6(0x26d))[_0xdfadc6(0x346)](_0xdfadc6(0x2c0),()=>{clearDecryptFile();}),await initDatabase(),await loadSettings(),initSettingsUI(),await loadKeys(),document['getElementById'](_0xdfadc6(0x2a7))[_0xdfadc6(0x346)]('input',updatePasswordStrength),document[_0xdfadc6(0x38b)](_0xdfadc6(0x24d))[_0xdfadc6(0x346)](_0xdfadc6(0x2c0),encryptMessage),document[_0xdfadc6(0x38b)](_0xdfadc6(0x299))[_0xdfadc6(0x346)]('click',decryptMessage),document['getElementById'](_0xdfadc6(0x27a))['addEventListener'](_0xdfadc6(0x2c0),generateKey),document[_0xdfadc6(0x38b)](_0xdfadc6(0x2d5))[_0xdfadc6(0x346)](_0xdfadc6(0x2c0),()=>copyToClipboard(_0xdfadc6(0x219),'encryptStatus')),document[_0xdfadc6(0x38b)](_0xdfadc6(0x2f5))[_0xdfadc6(0x346)](_0xdfadc6(0x2c0),()=>copyToClipboard(_0xdfadc6(0x262),_0xdfadc6(0x20b))),document[_0xdfadc6(0x38b)](_0xdfadc6(0x202))[_0xdfadc6(0x346)]('click',()=>{const _0x390086=_0xdfadc6;document[_0x390086(0x38b)]('encryptMessage')[_0x390086(0x24c)]='',document['getElementById'](_0x390086(0x219))[_0x390086(0x24c)]='',document['getElementById']('encryptStatus')[_0x390086(0x3bd)]=_0x390086(0x2e8),document['getElementById'](_0x390086(0x225))[_0x390086(0x2a2)]='',clearEncryptFile();}),document[_0xdfadc6(0x38b)](_0xdfadc6(0x25d))[_0xdfadc6(0x346)](_0xdfadc6(0x2c0),()=>{const _0xf01ad9=_0xdfadc6;document[_0xf01ad9(0x38b)](_0xf01ad9(0x2d1))[_0xf01ad9(0x24c)]='',document[_0xf01ad9(0x38b)](_0xf01ad9(0x262))[_0xf01ad9(0x24c)]='',document[_0xf01ad9(0x38b)](_0xf01ad9(0x20b))['className']=_0xf01ad9(0x2e8),document['getElementById']('decryptStatus')['textContent']='',clearDecryptFile(),window[_0xf01ad9(0x211)]=null;}),document[_0xdfadc6(0x38b)](_0xdfadc6(0x388))['addEventListener'](_0xdfadc6(0x2c0),importKey),document[_0xdfadc6(0x38b)](_0xdfadc6(0x307))[_0xdfadc6(0x346)]('click',exportAllKeys),document[_0xdfadc6(0x38b)](_0xdfadc6(0x2e6))[_0xdfadc6(0x346)](_0xdfadc6(0x2c0),importState),document[_0xdfadc6(0x38b)](_0xdfadc6(0x272))[_0xdfadc6(0x346)](_0xdfadc6(0x2c0),saveSettings),document[_0xdfadc6(0x38b)](_0xdfadc6(0x27b))[_0xdfadc6(0x346)](_0xdfadc6(0x2c0),resetSettings),document[_0xdfadc6(0x38b)]('zeroKeysBtn')[_0xdfadc6(0x346)](_0xdfadc6(0x2c0),zeroAllKeys),encryptionKeySelect[_0xdfadc6(0x346)](_0xdfadc6(0x22e),handleEncryptionKeyChange),decryptionKeySelect[_0xdfadc6(0x346)](_0xdfadc6(0x22e),handleDecryptionKeyChange);});async function initDatabase(){const _0x2b1f86=_0x1df063;if(!window[_0x2b1f86(0x29f)]){showStatus(_0x2b1f86(0x374),'Your\x20browser\x20doesn\x27t\x20support\x20secure\x20storage.\x20Using\x20less\x20secure\x20localStorage\x20instead.','warning'),appSettings['useIndexedDB']=![];return;}return new Promise((_0x331575,_0xac4ca8)=>{const _0x4b57ce=_0x2b1f86,_0x2f812a=indexedDB['open'](DB_NAME,DB_VERSION);_0x2f812a[_0x4b57ce(0x21a)]=function(_0x3e9c18){const _0x2d79d8=_0x4b57ce,_0x4f33ca=_0x3e9c18[_0x2d79d8(0x22f)][_0x2d79d8(0x2b9)];!_0x4f33ca['objectStoreNames'][_0x2d79d8(0x257)](KEYS_STORE)&&_0x4f33ca[_0x2d79d8(0x351)](KEYS_STORE,{'keyPath':'id'}),!_0x4f33ca[_0x2d79d8(0x2da)]['contains'](SETTINGS_STORE)&&_0x4f33ca[_0x2d79d8(0x351)](SETTINGS_STORE,{'keyPath':'id'});},_0x2f812a['onsuccess']=function(_0x6450a3){const _0xb522ac=_0x4b57ce;db=_0x6450a3[_0xb522ac(0x22f)][_0xb522ac(0x2b9)],console[_0xb522ac(0x201)]('Database\x20initialized\x20successfully'),_0x331575();},_0x2f812a[_0x4b57ce(0x37a)]=function(_0x381af8){const _0x28ee86=_0x4b57ce;console['error'](_0x28ee86(0x1fb),_0x381af8['target'][_0x28ee86(0x3b8)]),showStatus(_0x28ee86(0x374),_0x28ee86(0x24e),_0x28ee86(0x319)),appSettings[_0x28ee86(0x30c)]=![],_0x331575();};});}function switchTab(_0x4aa271){const _0x2d0b56=_0x1df063;console[_0x2d0b56(0x201)](_0x2d0b56(0x2f4),_0x4aa271),tabBtns[_0x2d0b56(0x2a5)](_0xe5ebc1=>{const _0x1f000d=_0x2d0b56;_0xe5ebc1[_0x1f000d(0x3cc)](_0x1f000d(0x3a6))===_0x4aa271?_0xe5ebc1[_0x1f000d(0x2cc)][_0x1f000d(0x260)](_0x1f000d(0x33b)):_0xe5ebc1[_0x1f000d(0x2cc)][_0x1f000d(0x332)](_0x1f000d(0x33b));}),document[_0x2d0b56(0x38b)](_0x2d0b56(0x3cb))[_0x2d0b56(0x24c)]='',document[_0x2d0b56(0x38b)](_0x2d0b56(0x219))[_0x2d0b56(0x24c)]='',document[_0x2d0b56(0x38b)](_0x2d0b56(0x225))[_0x2d0b56(0x3bd)]=_0x2d0b56(0x2e8),document['getElementById'](_0x2d0b56(0x225))['textContent']='',document[_0x2d0b56(0x38b)](_0x2d0b56(0x231))[_0x2d0b56(0x24c)]='',document[_0x2d0b56(0x38b)](_0x2d0b56(0x2ec))[_0x2d0b56(0x24c)]='',document[_0x2d0b56(0x38b)](_0x2d0b56(0x1fe))[_0x2d0b56(0x246)]['display']=_0x2d0b56(0x303),clearEncryptFile(),document[_0x2d0b56(0x38b)]('encryptedMessage')[_0x2d0b56(0x24c)]='',document[_0x2d0b56(0x38b)](_0x2d0b56(0x262))['value']='',document[_0x2d0b56(0x38b)]('decryptStatus')[_0x2d0b56(0x3bd)]='status',document[_0x2d0b56(0x38b)]('decryptStatus')['textContent']='',document[_0x2d0b56(0x38b)](_0x2d0b56(0x22c))[_0x2d0b56(0x24c)]='',document[_0x2d0b56(0x38b)](_0x2d0b56(0x2eb))['value']='',document[_0x2d0b56(0x38b)](_0x2d0b56(0x2e4))[_0x2d0b56(0x246)]['display']=_0x2d0b56(0x303),clearDecryptFile(),window['decryptedBinaryData']=null,document['getElementById'](_0x2d0b56(0x2bf))[_0x2d0b56(0x2cc)][_0x2d0b56(0x332)](_0x2d0b56(0x33b)),document['getElementById'](_0x2d0b56(0x331))[_0x2d0b56(0x2cc)][_0x2d0b56(0x332)](_0x2d0b56(0x33b)),document[_0x2d0b56(0x38b)]('keys')[_0x2d0b56(0x2cc)][_0x2d0b56(0x332)]('active'),document[_0x2d0b56(0x38b)](_0x2d0b56(0x26e))[_0x2d0b56(0x2cc)]['remove']('active'),document[_0x2d0b56(0x38b)](_0x4aa271)[_0x2d0b56(0x2cc)][_0x2d0b56(0x260)](_0x2d0b56(0x33b));}function setLoading(_0x5a039b){const _0x5bb49b=_0x1df063;loadingOverlay[_0x5bb49b(0x246)][_0x5bb49b(0x386)]=_0x5a039b?_0x5bb49b(0x310):_0x5bb49b(0x303);}async function loadSettings(){const _0x22c635=_0x1df063;if(appSettings['useIndexedDB']&&db)try{const _0x2c1bba=await getFromDatabase(SETTINGS_STORE,_0x22c635(0x323));_0x2c1bba&&(appSettings={...DEFAULT_SETTINGS,..._0x2c1bba});}catch(_0x115f84){console[_0x22c635(0x3b8)](_0x22c635(0x3b2),_0x115f84);try{const _0x3147bb=localStorage['getItem'](_0x22c635(0x207));_0x3147bb&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x22c635(0x295)](_0x3147bb)});}catch(_0x2a571b){console[_0x22c635(0x3b8)](_0x22c635(0x2a9),_0x2a571b);}}else try{const _0x3e6a9e=localStorage[_0x22c635(0x34d)]('LemonadeSettings');_0x3e6a9e&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x22c635(0x295)](_0x3e6a9e)});}catch(_0x2b47b7){console[_0x22c635(0x3b8)](_0x22c635(0x2a9),_0x2b47b7);}return PBKDF2_CONFIG[_0x22c635(0x249)]=appSettings[_0x22c635(0x28d)],appSettings;}function initSettingsUI(){const _0x59545d=_0x1df063;document[_0x59545d(0x38b)]('useIndexedDB')[_0x59545d(0x385)]=appSettings[_0x59545d(0x30c)],document[_0x59545d(0x38b)](_0x59545d(0x2d7))[_0x59545d(0x385)]=appSettings[_0x59545d(0x2d7)],document[_0x59545d(0x38b)](_0x59545d(0x3a4))['checked']=appSettings[_0x59545d(0x3a4)],document[_0x59545d(0x38b)](_0x59545d(0x334))[_0x59545d(0x385)]=appSettings['enforceKeyExpiry'],document[_0x59545d(0x38b)](_0x59545d(0x28d))['value']=appSettings[_0x59545d(0x28d)];}async function saveSettings(){const _0x28bb90=_0x1df063;try{appSettings['useIndexedDB']=document[_0x28bb90(0x38b)](_0x28bb90(0x30c))[_0x28bb90(0x385)],appSettings[_0x28bb90(0x2d7)]=document[_0x28bb90(0x38b)]('sessionOnly')[_0x28bb90(0x385)],appSettings['enforcePwdProtection']=document['getElementById'](_0x28bb90(0x3a4))[_0x28bb90(0x385)],appSettings['enforceKeyExpiry']=document['getElementById'](_0x28bb90(0x334))[_0x28bb90(0x385)],appSettings['pbkdf2Iterations']=parseInt(document[_0x28bb90(0x38b)]('pbkdf2Iterations')[_0x28bb90(0x24c)]),PBKDF2_CONFIG[_0x28bb90(0x249)]=appSettings['pbkdf2Iterations'],appSettings[_0x28bb90(0x30c)]&&db?await saveToDatabase(SETTINGS_STORE,{'id':_0x28bb90(0x323),...appSettings}):localStorage['setItem'](_0x28bb90(0x207),JSON[_0x28bb90(0x2ab)](appSettings)),showStatus('settingsStatus',_0x28bb90(0x371),'success');}catch(_0x39490f){console[_0x28bb90(0x3b8)](_0x28bb90(0x2a0),_0x39490f),showStatus(_0x28bb90(0x31d),_0x28bb90(0x2f0)+_0x39490f[_0x28bb90(0x24b)],_0x28bb90(0x3b8));}}function resetSettings(){const _0x3ccd7e=_0x1df063,_0xc55935=confirm(_0x3ccd7e(0x1ea));if(!_0xc55935)return;appSettings={...DEFAULT_SETTINGS},initSettingsUI(),saveSettings();}function updatePasswordStrength(){const _0x34c6fb=_0x1df063,_0x580e8c=document['getElementById'](_0x34c6fb(0x2a7))[_0x34c6fb(0x24c)],_0xdfbb70=validator[_0x34c6fb(0x34c)](_0x580e8c),_0x2c3faa=document[_0x34c6fb(0x38b)]('passwordStrength'),_0x15b6ee=document['getElementById'](_0x34c6fb(0x2fe));_0x2c3faa[_0x34c6fb(0x3bd)]=_0x34c6fb(0x35a),_0x580e8c?(_0x2c3faa[_0x34c6fb(0x2cc)][_0x34c6fb(0x260)](_0xdfbb70[_0x34c6fb(0x361)]),_0x15b6ee['textContent']=_0xdfbb70['feedback']):_0x15b6ee[_0x34c6fb(0x2a2)]='';}async function loadKeys(){const _0xe527e5=_0x1df063;try{keys=[];if(appSettings[_0xe527e5(0x30c)]&&db){const _0x1a96f1=await getAllFromDatabase(KEYS_STORE);_0x1a96f1&&_0x1a96f1[_0xe527e5(0x392)]>0x0&&(keys=_0x1a96f1);}else{const _0x22b7d5=localStorage[_0xe527e5(0x34d)]('LemonadeKeys');_0x22b7d5&&(keys=JSON['parse'](_0x22b7d5));}checkExpiredKeys(),updateKeysList(),updateKeySelects();}catch(_0x29d3e1){console[_0xe527e5(0x3b8)](_0xe527e5(0x3c8),_0x29d3e1),showStatus(_0xe527e5(0x374),_0xe527e5(0x2f3)+_0x29d3e1[_0xe527e5(0x24b)],_0xe527e5(0x3b8));}}async function saveKeys(){const _0xc19546=_0x1df063;try{if(appSettings[_0xc19546(0x2d7)])console[_0xc19546(0x201)]('Session-only\x20mode:\x20Keys\x20not\x20saved\x20persistently');else{if(appSettings[_0xc19546(0x30c)]&&db){await clearDatabase(KEYS_STORE);for(const _0x5d1e7b of keys){await saveToDatabase(KEYS_STORE,_0x5d1e7b);}}else localStorage['setItem'](_0xc19546(0x362),JSON['stringify'](keys));}updateKeysList(),updateKeySelects();}catch(_0x1e22fd){console[_0xc19546(0x3b8)](_0xc19546(0x268),_0x1e22fd),showStatus(_0xc19546(0x374),_0xc19546(0x35c)+_0x1e22fd['message'],_0xc19546(0x3b8));}}function checkExpiredKeys(){const _0x40ff03=_0x1df063,_0x440fae=new Date(),_0x10775a=[];keys['forEach'](_0x98a09a=>{const _0x48f8ae=_0x36cb;if(_0x98a09a[_0x48f8ae(0x2c3)]){const _0x40555d=new Date(_0x98a09a['expiry']);_0x40555d<_0x440fae&&_0x10775a[_0x48f8ae(0x208)](_0x98a09a['id']);}}),_0x10775a[_0x40ff03(0x392)]>0x0&&(keys=keys[_0x40ff03(0x39b)](_0x4b70d3=>!_0x10775a['includes'](_0x4b70d3['id'])),saveKeys(),showStatus(_0x40ff03(0x374),_0x10775a['length']+_0x40ff03(0x205),'warning'));}async function generateKey(){const _0x3a2f1b=_0x1df063;try{setLoading(!![]);const _0x5df208=document[_0x3a2f1b(0x38b)]('keyName')[_0x3a2f1b(0x24c)][_0x3a2f1b(0x3c7)](),_0x1b49c4=document['getElementById'](_0x3a2f1b(0x279))[_0x3a2f1b(0x24c)],_0x415a37=document['getElementById'](_0x3a2f1b(0x2a7))[_0x3a2f1b(0x24c)],_0x56444b=document['getElementById']('confirmKeyPassword')[_0x3a2f1b(0x24c)],_0x551068=document[_0x3a2f1b(0x38b)](_0x3a2f1b(0x291))[_0x3a2f1b(0x24c)];if(!_0x5df208){showStatus(_0x3a2f1b(0x374),'Please\x20enter\x20a\x20key\x20name',_0x3a2f1b(0x3b8));return;}if(!validator[_0x3a2f1b(0x368)](_0x5df208)){showStatus(_0x3a2f1b(0x374),_0x3a2f1b(0x2b0),_0x3a2f1b(0x3b8));return;}if(appSettings['enforcePwdProtection']&&!_0x415a37){showStatus('keyStatus',_0x3a2f1b(0x2cb),_0x3a2f1b(0x3b8));return;}if(_0x415a37){const _0x1b390f=validator[_0x3a2f1b(0x34c)](_0x415a37);if(_0x1b390f[_0x3a2f1b(0x3c3)]<0x4){showStatus(_0x3a2f1b(0x374),_0x3a2f1b(0x234)+_0x1b390f['feedback'],_0x3a2f1b(0x3b8));return;}if(_0x415a37!==_0x56444b){showStatus(_0x3a2f1b(0x374),_0x3a2f1b(0x302),_0x3a2f1b(0x3b8));return;}}if(appSettings[_0x3a2f1b(0x334)]&&!_0x551068){showStatus('keyStatus',_0x3a2f1b(0x3b3),'error');return;}const _0x271ae0={'id':crypto[_0x3a2f1b(0x22d)](),'name':_0x5df208,'type':_0x1b49c4,'created':new Date()['toISOString']()};if(_0x551068){const _0x353ce6=parseInt(_0x551068),_0xe90634=new Date();_0xe90634[_0x3a2f1b(0x23d)](_0xe90634['getDate']()+_0x353ce6),_0x271ae0[_0x3a2f1b(0x2c3)]=_0xe90634[_0x3a2f1b(0x2bd)]();}const _0x13209a=_0x1b49c4===_0x3a2f1b(0x2d6)||_0x1b49c4==='rsa-4096'||_0x1b49c4==='ecc'||_0x1b49c4===_0x3a2f1b(0x251);_0x13209a&&(_0x271ae0[_0x3a2f1b(0x28f)]=!![],_0x271ae0[_0x3a2f1b(0x375)]=!![],_0x271ae0['pairedKeyId']=_0x271ae0['id']);if(_0x1b49c4===_0x3a2f1b(0x3be))await generateAESKey(_0x271ae0,_0x415a37);else{if(_0x1b49c4===_0x3a2f1b(0x2d6))await generateRSAKey(_0x271ae0,_0x415a37,RSA_CONFIG[_0x3a2f1b(0x2c7)]);else{if(_0x1b49c4===_0x3a2f1b(0x38a))await generateRSAKey(_0x271ae0,_0x415a37,RSA_CONFIG[_0x3a2f1b(0x36a)]);else{if(_0x1b49c4===_0x3a2f1b(0x3a3))await generateECCKey(_0x271ae0,_0x415a37,ECC_CONFIG[_0x3a2f1b(0x2b8)]);else _0x1b49c4===_0x3a2f1b(0x251)&&await generateECCKey(_0x271ae0,_0x415a37,ECC_CONFIG['CURVE_P384']);}}}keys['push'](_0x271ae0),await saveKeys(),document[_0x3a2f1b(0x38b)](_0x3a2f1b(0x24f))[_0x3a2f1b(0x24c)]='',document[_0x3a2f1b(0x38b)](_0x3a2f1b(0x2a7))['value']='',document['getElementById']('confirmKeyPassword')[_0x3a2f1b(0x24c)]='',document['getElementById'](_0x3a2f1b(0x254))[_0x3a2f1b(0x3bd)]=_0x3a2f1b(0x35a),document['getElementById']('passwordFeedback')[_0x3a2f1b(0x2a2)]='';const _0x1b3a32=getKeyTypeDisplay(_0x271ae0);showStatus(_0x3a2f1b(0x374),_0x1b3a32+_0x3a2f1b(0x216)+_0x5df208+'\x22\x20generated\x20successfully',_0x3a2f1b(0x28b));}catch(_0x3439ee){console[_0x3a2f1b(0x3b8)](_0x3a2f1b(0x3a8),_0x3439ee),showStatus(_0x3a2f1b(0x374),_0x3a2f1b(0x2b7)+_0x3439ee[_0x3a2f1b(0x24b)],_0x3a2f1b(0x3b8));}finally{setLoading(![]);}}function getPairedKeyIds(_0x223701){const _0x4d138c=_0x1df063;if(_0x223701[_0x4d138c(0x2f7)])return _0x223701[_0x4d138c(0x2f7)];if(_0x223701[_0x4d138c(0x375)]&&_0x223701[_0x4d138c(0x28f)])return _0x223701['id'];if((_0x223701['type']===_0x4d138c(0x2d6)||_0x223701[_0x4d138c(0x30d)]==='rsa-4096'||_0x223701[_0x4d138c(0x30d)]===_0x4d138c(0x3a3)||_0x223701['type']===_0x4d138c(0x251))&&(_0x223701['hasPublic']||_0x223701['hasPrivate'])){const _0x54d77a=keys[_0x4d138c(0x39b)](_0x57313b=>_0x57313b['id']!==_0x223701['id']&&_0x57313b[_0x4d138c(0x30d)]===_0x223701[_0x4d138c(0x30d)]&&(_0x223701['hasPublic']&&_0x57313b['hasPrivate']||_0x223701[_0x4d138c(0x375)]&&_0x57313b[_0x4d138c(0x28f)])&&(_0x57313b[_0x4d138c(0x39c)]&&_0x223701[_0x4d138c(0x39c)]&&_0x57313b[_0x4d138c(0x39c)]===_0x223701[_0x4d138c(0x39c)]));if(_0x54d77a[_0x4d138c(0x392)]>0x0)return _0x54d77a[0x0]['id'];}return null;}function zeroAllKeys(){const _0x33e995=_0x1df063;if(keys['length']===0x0){showStatus('keyStatus',_0x33e995(0x3af),_0x33e995(0x319));return;}const _0x261abf=confirm(_0x33e995(0x373));if(_0x261abf){const _0x1b5133=keys[_0x33e995(0x392)];keys=[],appSettings['useIndexedDB']&&db?clearDatabase(KEYS_STORE)[_0x33e995(0x245)](()=>{const _0xbd572c=_0x33e995;console['log'](_0xbd572c(0x3c6));})[_0x33e995(0x250)](_0x2c9568=>{const _0x3892ed=_0x33e995;console[_0x3892ed(0x3b8)](_0x3892ed(0x1ec),_0x2c9568);}):localStorage[_0x33e995(0x286)](_0x33e995(0x362)),updateKeysList(),updateKeySelects(),showStatus(_0x33e995(0x374),'All\x20keys\x20('+_0x1b5133+_0x33e995(0x247),_0x33e995(0x28b));}else showStatus(_0x33e995(0x374),_0x33e995(0x370),_0x33e995(0x35e));}async function generateAESKey(_0x551464,_0xc9d3a5){const _0x3a0a39=_0x1df063,_0x215636=await window['crypto'][_0x3a0a39(0x3b9)]['generateKey']({'name':AES_CONFIG[_0x3a0a39(0x2ca)],'length':AES_CONFIG[_0x3a0a39(0x39d)]},!![],[_0x3a0a39(0x2bf),'decrypt']),_0x7f45b6=await window['crypto'][_0x3a0a39(0x3b9)][_0x3a0a39(0x28c)]('raw',_0x215636);_0x551464[_0x3a0a39(0x26a)]=arrayBufferToBase64(_0x7f45b6),_0x551464['algorithm']=AES_CONFIG[_0x3a0a39(0x2ca)],_0x551464['length']=AES_CONFIG['KEY_LENGTH'],_0xc9d3a5&&await encryptKeyWithPassword(_0x551464,_0xc9d3a5);}async function generateRSAKey(_0x5229bb,_0x4055b2,_0x24def4){const _0x5a80a9=_0x1df063,_0x508a9a=await window[_0x5a80a9(0x2b6)][_0x5a80a9(0x3b9)][_0x5a80a9(0x263)]({'name':RSA_CONFIG[_0x5a80a9(0x3c0)],'modulusLength':_0x24def4,'publicExponent':new Uint8Array([0x1,0x0,0x1]),'hash':RSA_CONFIG[_0x5a80a9(0x27e)]},!![],[_0x5a80a9(0x2bf),_0x5a80a9(0x331)]),_0x49e6e0=await window[_0x5a80a9(0x2b6)][_0x5a80a9(0x3b9)]['exportKey'](_0x5a80a9(0x36d),_0x508a9a['publicKey']),_0x244bab=await window[_0x5a80a9(0x2b6)]['subtle'][_0x5a80a9(0x28c)]('pkcs8',_0x508a9a['privateKey']);_0x5229bb['publicKey']=arrayBufferToBase64(_0x49e6e0),_0x5229bb[_0x5a80a9(0x237)]=arrayBufferToBase64(_0x244bab),_0x5229bb[_0x5a80a9(0x39f)]=RSA_CONFIG[_0x5a80a9(0x3c0)],_0x5229bb[_0x5a80a9(0x392)]=_0x24def4;const _0x24a443=await computeKeyHash(_0x49e6e0);_0x5229bb[_0x5a80a9(0x39c)]=_0x24a443,_0x4055b2&&await encryptKeyWithPassword(_0x5229bb,_0x4055b2);}async function generateECCKey(_0x545a70,_0x1a7e61,_0x22598f){const _0xe1ade8=_0x1df063,_0x19acd3=await window[_0xe1ade8(0x2b6)][_0xe1ade8(0x3b9)]['generateKey']({'name':_0xe1ade8(0x228),'namedCurve':_0x22598f},!![],[_0xe1ade8(0x1ff),_0xe1ade8(0x36e)]),_0x32bd61=await window[_0xe1ade8(0x2b6)]['subtle'][_0xe1ade8(0x28c)]('spki',_0x19acd3['publicKey']),_0x37bb7d=await window[_0xe1ade8(0x2b6)][_0xe1ade8(0x3b9)][_0xe1ade8(0x28c)](_0xe1ade8(0x25a),_0x19acd3[_0xe1ade8(0x237)]);_0x545a70[_0xe1ade8(0x327)]=arrayBufferToBase64(_0x32bd61),_0x545a70[_0xe1ade8(0x237)]=arrayBufferToBase64(_0x37bb7d),_0x545a70['algorithm']=_0xe1ade8(0x228),_0x545a70[_0xe1ade8(0x2ae)]=_0x22598f;const _0x2bef44=await computeKeyHash(_0x32bd61);_0x545a70[_0xe1ade8(0x39c)]=_0x2bef44,_0x1a7e61&&await encryptKeyWithPassword(_0x545a70,_0x1a7e61);}async function computeKeyHash(_0x20cfd3){const _0x473e8a=_0x1df063,_0x49f696=await crypto[_0x473e8a(0x3b9)][_0x473e8a(0x30a)]('SHA-256',_0x20cfd3);return arrayBufferToBase64(_0x49f696);}async function encryptKeyWithPassword(_0x4b8e3d,_0x5d3e74){const _0x59eb5a=_0x1df063,_0x96d9be=window[_0x59eb5a(0x2b6)][_0x59eb5a(0x269)](new Uint8Array(0x10));_0x4b8e3d[_0x59eb5a(0x3ce)]=arrayBufferToBase64(_0x96d9be);const _0x4a9c63=await deriveKeyFromPassword(_0x5d3e74,_0x96d9be),_0x1dd29c=window['crypto'][_0x59eb5a(0x269)](new Uint8Array(AES_CONFIG[_0x59eb5a(0x33e)]));_0x4b8e3d['iv']=arrayBufferToBase64(_0x1dd29c);if(_0x4b8e3d[_0x59eb5a(0x30d)]===_0x59eb5a(0x3be)){const _0x5385b2=await encryptWithDerivedKey(_0x4a9c63,base64ToArrayBuffer(_0x4b8e3d[_0x59eb5a(0x26a)]),_0x1dd29c);_0x4b8e3d[_0x59eb5a(0x26a)]=arrayBufferToBase64(_0x5385b2),_0x4b8e3d[_0x59eb5a(0x30f)]=!![];}else{const _0x35cc44=await encryptWithDerivedKey(_0x4a9c63,base64ToArrayBuffer(_0x4b8e3d[_0x59eb5a(0x237)]),_0x1dd29c);_0x4b8e3d[_0x59eb5a(0x237)]=arrayBufferToBase64(_0x35cc44),_0x4b8e3d[_0x59eb5a(0x30f)]=!![];}}async function decryptKeyWithPassword(_0x422029,_0x40f6b2){const _0x197e45=_0x1df063;try{if(!_0x422029||!_0x40f6b2)throw new Error(_0x197e45(0x398));if(!_0x422029[_0x197e45(0x3ce)]||!_0x422029['iv'])throw new Error(_0x197e45(0x1fa));const _0x494dc8=base64ToArrayBuffer(_0x422029[_0x197e45(0x3ce)]),_0x35cae=await deriveKeyFromPassword(_0x40f6b2,_0x494dc8),_0x32092a=base64ToArrayBuffer(_0x422029['iv']),_0xa4bc1e={..._0x422029};if(_0x422029['type']===_0x197e45(0x3be)){if(!_0x422029[_0x197e45(0x26a)])throw new Error(_0x197e45(0x324));const _0x2256a6=await decryptWithDerivedKey(_0x35cae,base64ToArrayBuffer(_0x422029['key']),_0x32092a);_0xa4bc1e['key']=arrayBufferToBase64(_0x2256a6),_0xa4bc1e[_0x197e45(0x3bb)]=await importAESKey(_0x2256a6);}else{if(_0x422029[_0x197e45(0x30d)]==='rsa'||_0x422029[_0x197e45(0x30d)]==='rsa-4096'){if(!_0x422029[_0x197e45(0x237)])throw new Error(_0x197e45(0x294));const _0x1a91e9=await decryptWithDerivedKey(_0x35cae,base64ToArrayBuffer(_0x422029[_0x197e45(0x237)]),_0x32092a);_0xa4bc1e['privateKey']=arrayBufferToBase64(_0x1a91e9),_0xa4bc1e[_0x197e45(0x3a5)]=await importRSAPrivateKey(_0x1a91e9,_0x422029[_0x197e45(0x392)]||RSA_CONFIG['KEY_SIZE']),_0x422029[_0x197e45(0x327)]&&(_0xa4bc1e[_0x197e45(0x1e9)]=await importRSAPublicKey(base64ToArrayBuffer(_0x422029[_0x197e45(0x327)]),_0x422029['length']||RSA_CONFIG['KEY_SIZE']));}else{if(_0x422029[_0x197e45(0x30d)]===_0x197e45(0x3a3)||_0x422029[_0x197e45(0x30d)]===_0x197e45(0x251)){if(!_0x422029[_0x197e45(0x237)])throw new Error(_0x197e45(0x294));const _0x423acf=await decryptWithDerivedKey(_0x35cae,base64ToArrayBuffer(_0x422029['privateKey']),_0x32092a);_0xa4bc1e['privateKey']=arrayBufferToBase64(_0x423acf),_0xa4bc1e['_privateKey']=await importECCPrivateKey(_0x423acf,_0x422029[_0x197e45(0x2ae)]||ECC_CONFIG['CURVE']),_0x422029[_0x197e45(0x327)]&&(_0xa4bc1e['_publicKey']=await importECCPublicKey(base64ToArrayBuffer(_0x422029[_0x197e45(0x327)]),_0x422029['curve']||ECC_CONFIG['CURVE']));}else throw new Error(_0x197e45(0x26f)+_0x422029['type']);}}return safeMemory[_0x197e45(0x355)](_0xa4bc1e);}catch(_0x2f8ce2){console[_0x197e45(0x3b8)]('Decryption\x20error:',_0x2f8ce2);throw new Error(_0x197e45(0x1f1));}}function updateKeysList(){const _0x16fb3a=_0x1df063;keysList[_0x16fb3a(0x2b5)]='';if(keys[_0x16fb3a(0x392)]===0x0){keysList['innerHTML']=_0x16fb3a(0x200);return;}keys[_0x16fb3a(0x2a5)](_0x27a9b4=>{const _0x35baac=_0x16fb3a,_0x10f1ac=document[_0x35baac(0x35d)](_0x35baac(0x34e));_0x10f1ac[_0x35baac(0x3bd)]='key-item';const _0x196263=getKeyTypeDisplay(_0x27a9b4),_0x5481c1=_0x27a9b4['protected']?'\x20🔒':'';let _0x776b50='';if(_0x27a9b4[_0x35baac(0x30d)]===_0x35baac(0x3be))_0x776b50='';else{if(_0x27a9b4[_0x35baac(0x375)]&&_0x27a9b4[_0x35baac(0x28f)])_0x776b50=_0x35baac(0x3b0);else{if(_0x27a9b4[_0x35baac(0x375)])_0x776b50='<span\x20class=\x22key-pair-badge\x20private\x22>PRIVATE\x20KEY</span>';else _0x27a9b4[_0x35baac(0x28f)]&&(_0x776b50=_0x35baac(0x29b));}}let _0x306e26='',_0x3669d9=determineKeySecurityLevel(_0x27a9b4);_0x306e26=_0x35baac(0x1f4)+_0x3669d9+'\x22>'+_0x3669d9[_0x35baac(0x37f)]()+'</span>';let _0x21e6de='';if(_0x27a9b4[_0x35baac(0x2c3)]){const _0x233b07=new Date(_0x27a9b4[_0x35baac(0x2c3)]),_0x200012=Math[_0x35baac(0x2e2)]((_0x233b07-new Date())/(0x3e8*0x3c*0x3c*0x18));_0x21e6de='<div\x20class=\x22key-expiry\x22>Expires\x20in\x20'+_0x200012+_0x35baac(0x32a)+_0x233b07[_0x35baac(0x344)]()+')</div>';}let _0x569d3d='';if(_0x27a9b4[_0x35baac(0x30d)]==='aes')_0x569d3d+=_0x35baac(0x20a)+_0x27a9b4['id']+_0x35baac(0x1ed);else _0x27a9b4[_0x35baac(0x28f)]&&(_0x569d3d+=_0x35baac(0x20a)+_0x27a9b4['id']+'\x27)\x22>Export\x20Public</button>');_0x27a9b4[_0x35baac(0x30d)]!==_0x35baac(0x3be)&&_0x27a9b4['hasPrivate']&&(_0x569d3d+=_0x35baac(0x292)+_0x27a9b4['id']+'\x27)\x22>Private\x20Key</button>'),_0x569d3d+=_0x35baac(0x2c5)+_0x27a9b4['id']+_0x35baac(0x296),_0x10f1ac[_0x35baac(0x2b5)]=_0x35baac(0x3a7)+validator[_0x35baac(0x31c)](_0x27a9b4[_0x35baac(0x383)])+'\x20('+_0x196263+_0x5481c1+')\x20'+_0x306e26+_0x35baac(0x203)+_0x776b50+_0x35baac(0x360)+new Date(_0x27a9b4[_0x35baac(0x2bb)])[_0x35baac(0x2e5)]()+_0x35baac(0x314)+(_0x27a9b4[_0x35baac(0x39f)]||'')+'\x20'+(_0x27a9b4[_0x35baac(0x392)]?_0x27a9b4['length']+'\x20bits':_0x27a9b4['curve']||'')+_0x35baac(0x365)+_0x21e6de+_0x35baac(0x256)+_0x569d3d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',keysList['appendChild'](_0x10f1ac);});}function getKeyTypeDisplay(_0x494343){const _0x3b90f1=_0x1df063;if(_0x494343[_0x3b90f1(0x30d)]===_0x3b90f1(0x3be))return _0x3b90f1(0x377);else{if(_0x494343[_0x3b90f1(0x30d)]===_0x3b90f1(0x2d6))return _0x3b90f1(0x2dc);else{if(_0x494343['type']===_0x3b90f1(0x38a))return'RSA-4096';else{if(_0x494343[_0x3b90f1(0x30d)]===_0x3b90f1(0x3a3))return'ECC-P256';else{if(_0x494343[_0x3b90f1(0x30d)]===_0x3b90f1(0x251))return'ECC-P384';}}}}return _0x494343[_0x3b90f1(0x30d)]['toUpperCase']();}function updateKeySelects(){const _0x55db64=_0x1df063;encryptionKeySelect[_0x55db64(0x2b5)]='<option\x20value=\x22\x22>Select\x20a\x20key...</option>',decryptionKeySelect[_0x55db64(0x2b5)]=_0x55db64(0x326),keys[_0x55db64(0x2a5)](_0x1c2a6e=>{const _0x59b717=_0x55db64;if(_0x1c2a6e[_0x59b717(0x30d)]===_0x59b717(0x3be)||_0x1c2a6e[_0x59b717(0x28f)]){const _0x464548=document[_0x59b717(0x35d)](_0x59b717(0x2b2));_0x464548[_0x59b717(0x24c)]=_0x1c2a6e['id'];const _0x123f98=getKeyTypeDisplay(_0x1c2a6e),_0x24dce6=_0x1c2a6e[_0x59b717(0x30f)]?_0x59b717(0x349):'';let _0x449cd1='';_0x1c2a6e['type']!==_0x59b717(0x3be)&&(_0x449cd1=_0x1c2a6e[_0x59b717(0x375)]&&_0x1c2a6e[_0x59b717(0x28f)]?_0x59b717(0x2c1):_0x59b717(0x278)),_0x464548[_0x59b717(0x283)]=_0x1c2a6e[_0x59b717(0x383)]+'\x20('+_0x123f98+_0x449cd1+_0x24dce6+')',encryptionKeySelect['appendChild'](_0x464548);}}),keys['forEach'](_0x10acaa=>{const _0x356c16=_0x55db64;if(_0x10acaa['type']===_0x356c16(0x3be)||_0x10acaa['hasPrivate']){const _0x52cf7c=document['createElement']('option');_0x52cf7c[_0x356c16(0x24c)]=_0x10acaa['id'];const _0x2ca9d0=getKeyTypeDisplay(_0x10acaa),_0x4415d6=_0x10acaa[_0x356c16(0x30f)]?_0x356c16(0x349):'';let _0x39609c='';_0x10acaa[_0x356c16(0x30d)]!=='aes'&&(_0x39609c=_0x10acaa[_0x356c16(0x375)]&&_0x10acaa[_0x356c16(0x28f)]?_0x356c16(0x2c1):'\x20[Private]'),_0x52cf7c['text']=_0x10acaa['name']+'\x20('+_0x2ca9d0+_0x39609c+_0x4415d6+')',decryptionKeySelect['appendChild'](_0x52cf7c);}});}function handleEncryptionKeyChange(){const _0x551797=_0x1df063,_0x45e516=encryptionKeySelect[_0x551797(0x24c)];if(!_0x45e516){document[_0x551797(0x38b)](_0x551797(0x1fe))[_0x551797(0x246)][_0x551797(0x386)]='none';return;}const _0x2e0e78=keys[_0x551797(0x330)](_0x4276e1=>_0x4276e1['id']===_0x45e516);if(!_0x2e0e78)return;document[_0x551797(0x38b)]('encryptionPasswordGroup')[_0x551797(0x246)]['display']=_0x2e0e78[_0x551797(0x30f)]?_0x551797(0x224):_0x551797(0x303);}function handleDecryptionKeyChange(){const _0x5977ac=_0x1df063,_0x169aef=decryptionKeySelect['value'];if(!_0x169aef){document[_0x5977ac(0x38b)](_0x5977ac(0x2e4))[_0x5977ac(0x246)][_0x5977ac(0x386)]=_0x5977ac(0x303);return;}const _0x1d2c44=keys[_0x5977ac(0x330)](_0x2f12df=>_0x2f12df['id']===_0x169aef);if(!_0x1d2c44)return;document[_0x5977ac(0x38b)](_0x5977ac(0x2e4))[_0x5977ac(0x246)][_0x5977ac(0x386)]=_0x1d2c44[_0x5977ac(0x30f)]?_0x5977ac(0x224):'none';}async function encryptMessage(){const _0xa9d4bd=_0x1df063;try{let _0x19d992,_0x4a5af8='';if(encryptFileData)_0x19d992=encryptFileData,_0x4a5af8=generateRandomFileName(0x6)+'.lmn';else{const _0x13708e=document[_0xa9d4bd(0x38b)]('encryptMessage')[_0xa9d4bd(0x24c)];if(!_0x13708e){showStatus(_0xa9d4bd(0x225),_0xa9d4bd(0x34a),_0xa9d4bd(0x3b8));return;}_0x19d992=new TextEncoder()[_0xa9d4bd(0x3c2)](_0x13708e);}const _0x5c844c=document[_0xa9d4bd(0x38b)](_0xa9d4bd(0x231))[_0xa9d4bd(0x24c)],_0x3018a0=document['getElementById']('encryptionPassword')[_0xa9d4bd(0x24c)],_0x54bc06=document[_0xa9d4bd(0x38b)](_0xa9d4bd(0x2a8))['value'];if(!_0x5c844c){showStatus(_0xa9d4bd(0x225),_0xa9d4bd(0x2d3),_0xa9d4bd(0x3b8));return;}setLoading(!![]);const _0x17a963=keys[_0xa9d4bd(0x330)](_0x219d2f=>_0x219d2f['id']===_0x5c844c);if(!_0x17a963){showStatus('encryptStatus',_0xa9d4bd(0x2af),_0xa9d4bd(0x3b8)),setLoading(![]);return;}let _0x24c2be=null,_0x5e8ef6=_0x17a963;if(_0x17a963[_0xa9d4bd(0x30f)]){if(!_0x3018a0){showStatus(_0xa9d4bd(0x225),'Password\x20required\x20for\x20this\x20key',_0xa9d4bd(0x3b8)),setLoading(![]);return;}try{_0x24c2be=await decryptKeyWithPassword(_0x17a963,_0x3018a0),_0x5e8ef6=safeMemory['retrieve'](_0x24c2be);if(!_0x5e8ef6)throw new Error(_0xa9d4bd(0x318));}catch(_0x356e9f){showStatus(_0xa9d4bd(0x225),'Failed\x20to\x20decrypt\x20key:\x20'+_0x356e9f[_0xa9d4bd(0x24b)],_0xa9d4bd(0x3b8)),setLoading(![]);return;}}let _0x4aeb3c=await encryptData(_0x19d992,_0x5e8ef6);_0x24c2be&&safeMemory[_0xa9d4bd(0x227)](_0x24c2be);encryptFileData&&(_0x4aeb3c['fileName']=encryptFileName,_0x4aeb3c[_0xa9d4bd(0x1f5)]=encryptFileData[_0xa9d4bd(0x271)],_0x4aeb3c[_0xa9d4bd(0x3b4)]=!![]);const _0x889c39=createEncryptedMessageString(_0x4aeb3c,_0x54bc06);document[_0xa9d4bd(0x38b)]('encryptedOutput')['value']=_0x889c39,document[_0xa9d4bd(0x38b)](_0xa9d4bd(0x1fc))[_0xa9d4bd(0x2d4)](_0xa9d4bd(0x3a9),_0x4a5af8),showStatus(_0xa9d4bd(0x225),_0xa9d4bd(0x357),'success');}catch(_0x512431){console['error'](_0xa9d4bd(0x1f8),_0x512431),showStatus('encryptStatus','Encryption\x20error:\x20'+_0x512431['message'],'error');}finally{document[_0xa9d4bd(0x38b)](_0xa9d4bd(0x2ec))['value']='',setLoading(![]);}}async function encryptWithAES(_0x18b337,_0x1999d3){const _0x47ff68=_0x1df063;try{const _0x4b6e7e=window[_0x47ff68(0x2b6)][_0x47ff68(0x269)](new Uint8Array(AES_CONFIG[_0x47ff68(0x33e)]));let _0x3c773b;if(_0x1999d3[_0x47ff68(0x3bb)])_0x3c773b=_0x1999d3[_0x47ff68(0x3bb)];else{const _0x30ae23=base64ToArrayBuffer(_0x1999d3[_0x47ff68(0x26a)]);_0x3c773b=await window[_0x47ff68(0x2b6)][_0x47ff68(0x3b9)][_0x47ff68(0x212)](_0x47ff68(0x321),_0x30ae23,{'name':AES_CONFIG[_0x47ff68(0x2ca)],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x47ff68(0x2bf)]);}const _0x477084=await window[_0x47ff68(0x2b6)][_0x47ff68(0x3b9)]['encrypt']({'name':AES_CONFIG['MODE'],'iv':_0x4b6e7e,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x3c773b,_0x18b337),_0x1a6701={'k':_0x1999d3['id'],'t':new Date()[_0x47ff68(0x2bd)](),'a':AES_CONFIG[_0x47ff68(0x2ca)]};encryptFileData&&encryptFileName&&(_0x1a6701['f']={'n':encryptFileName,'s':encryptFileData[_0x47ff68(0x271)]});const _0x258633=new TextEncoder()[_0x47ff68(0x3c2)](JSON[_0x47ff68(0x2ab)](_0x1a6701)),_0x1fbc99=window['crypto']['getRandomValues'](new Uint8Array(AES_CONFIG[_0x47ff68(0x33e)])),_0x53be15=await window['crypto'][_0x47ff68(0x3b9)][_0x47ff68(0x263)]({'name':AES_CONFIG[_0x47ff68(0x2ca)],'length':AES_CONFIG[_0x47ff68(0x39d)]},!![],[_0x47ff68(0x2bf)]),_0x40acea=await window[_0x47ff68(0x2b6)][_0x47ff68(0x3b9)]['encrypt']({'name':AES_CONFIG[_0x47ff68(0x2ca)],'iv':_0x1fbc99,'tagLength':AES_CONFIG[_0x47ff68(0x2e0)]},_0x53be15,_0x258633),_0x1a6059=await window[_0x47ff68(0x2b6)][_0x47ff68(0x3b9)][_0x47ff68(0x28c)](_0x47ff68(0x321),_0x53be15),_0x41144e=0x3,_0x3ae68f=0x1+_0x1fbc99[_0x47ff68(0x271)]+0x4+_0x1a6059[_0x47ff68(0x271)]+0x4+_0x40acea[_0x47ff68(0x271)]+_0x4b6e7e[_0x47ff68(0x271)]+0x4+_0x477084[_0x47ff68(0x271)],_0x401fac=new Uint8Array(_0x3ae68f);let _0x279d09=0x0;_0x401fac[_0x279d09++]=_0x41144e,_0x401fac[_0x47ff68(0x379)](_0x1fbc99,_0x279d09),_0x279d09+=_0x1fbc99[_0x47ff68(0x271)];const _0x33244d=_0x1a6059[_0x47ff68(0x271)];_0x401fac[_0x279d09++]=_0x33244d>>0x18&0xff,_0x401fac[_0x279d09++]=_0x33244d>>0x10&0xff,_0x401fac[_0x279d09++]=_0x33244d>>0x8&0xff,_0x401fac[_0x279d09++]=_0x33244d&0xff,_0x401fac[_0x47ff68(0x379)](new Uint8Array(_0x1a6059),_0x279d09),_0x279d09+=_0x1a6059['byteLength'];const _0x80111f=_0x40acea[_0x47ff68(0x271)];_0x401fac[_0x279d09++]=_0x80111f>>0x18&0xff,_0x401fac[_0x279d09++]=_0x80111f>>0x10&0xff,_0x401fac[_0x279d09++]=_0x80111f>>0x8&0xff,_0x401fac[_0x279d09++]=_0x80111f&0xff,_0x401fac[_0x47ff68(0x379)](new Uint8Array(_0x40acea),_0x279d09),_0x279d09+=_0x40acea[_0x47ff68(0x271)],_0x401fac['set'](_0x4b6e7e,_0x279d09),_0x279d09+=_0x4b6e7e[_0x47ff68(0x271)];const _0x51f503=_0x477084['byteLength'];return _0x401fac[_0x279d09++]=_0x51f503>>0x18&0xff,_0x401fac[_0x279d09++]=_0x51f503>>0x10&0xff,_0x401fac[_0x279d09++]=_0x51f503>>0x8&0xff,_0x401fac[_0x279d09++]=_0x51f503&0xff,_0x401fac[_0x47ff68(0x379)](new Uint8Array(_0x477084),_0x279d09),{'version':0x3,'data':arrayBufferToBase64(_0x401fac['buffer'])};}catch(_0x445364){console[_0x47ff68(0x3b8)](_0x47ff68(0x26c),_0x445364);throw new Error('Encryption\x20failed:\x20'+_0x445364[_0x47ff68(0x24b)]);}}async function deriveMetadataKey(_0x198c23,_0x39cc6c){const _0x3b5a28=_0x1df063,_0x1a79d0=await window['crypto']['subtle'][_0x3b5a28(0x28c)](_0x3b5a28(0x321),_0x198c23),_0x3b6733=new Uint8Array(_0x1a79d0[_0x3b5a28(0x271)]+_0x39cc6c[_0x3b5a28(0x271)]);_0x3b6733[_0x3b5a28(0x379)](new Uint8Array(_0x1a79d0),0x0),_0x3b6733[_0x3b5a28(0x379)](_0x39cc6c,_0x1a79d0[_0x3b5a28(0x271)]);const _0x409a5d=await window[_0x3b5a28(0x2b6)][_0x3b5a28(0x3b9)][_0x3b5a28(0x212)](_0x3b5a28(0x321),_0x3b6733,{'name':_0x3b5a28(0x3a2)},![],[_0x3b5a28(0x1ff)]);return window[_0x3b5a28(0x2b6)][_0x3b5a28(0x3b9)][_0x3b5a28(0x1ff)]({'name':_0x3b5a28(0x3a2),'hash':'SHA-256','salt':_0x39cc6c,'info':new Uint8Array([0x1,0x2,0x3,0x4])},_0x409a5d,{'name':AES_CONFIG[_0x3b5a28(0x2ca)],'length':AES_CONFIG[_0x3b5a28(0x39d)]},![],[_0x3b5a28(0x2bf),'decrypt']);}async function encryptWithRSA(_0x40efa2,_0xae3a7){const _0x37b083=_0x1df063,_0x292476=await window[_0x37b083(0x2b6)][_0x37b083(0x3b9)][_0x37b083(0x263)]({'name':AES_CONFIG['MODE'],'length':AES_CONFIG['KEY_LENGTH']},!![],['encrypt',_0x37b083(0x331)]),_0x140b6f=window[_0x37b083(0x2b6)][_0x37b083(0x269)](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0x60f7df=await window['crypto'][_0x37b083(0x3b9)]['encrypt']({'name':AES_CONFIG[_0x37b083(0x2ca)],'iv':_0x140b6f,'tagLength':AES_CONFIG[_0x37b083(0x2e0)]},_0x292476,_0x40efa2),_0x49a99e=await window[_0x37b083(0x2b6)][_0x37b083(0x3b9)][_0x37b083(0x28c)](_0x37b083(0x321),_0x292476);let _0x3a2dff;if(_0xae3a7[_0x37b083(0x1e9)])_0x3a2dff=_0xae3a7['_publicKey'];else{const _0x423e51=base64ToArrayBuffer(_0xae3a7[_0x37b083(0x327)]);_0x3a2dff=await importRSAPublicKey(_0x423e51,_0xae3a7[_0x37b083(0x392)]||RSA_CONFIG['KEY_SIZE']);}const _0x35dbe=await window['crypto'][_0x37b083(0x3b9)][_0x37b083(0x2bf)]({'name':RSA_CONFIG[_0x37b083(0x3c0)]},_0x3a2dff,_0x49a99e),_0x3476d2={'a':RSA_CONFIG[_0x37b083(0x3c0)]+'+'+AES_CONFIG['MODE'],'k':_0xae3a7['id'],'t':new Date()['toISOString'](),'s':_0xae3a7[_0x37b083(0x392)]||RSA_CONFIG[_0x37b083(0x2c7)]};encryptFileData&&encryptFileName&&(_0x3476d2['f']={'n':encryptFileName,'s':encryptFileData[_0x37b083(0x271)]});const _0x270b6e=new TextEncoder()['encode'](JSON[_0x37b083(0x2ab)](_0x3476d2)),_0x27a2eb=await window[_0x37b083(0x2b6)]['subtle'][_0x37b083(0x263)]({'name':AES_CONFIG[_0x37b083(0x2ca)],'length':AES_CONFIG[_0x37b083(0x39d)]},!![],[_0x37b083(0x2bf),'decrypt']),_0xb06544=window[_0x37b083(0x2b6)]['getRandomValues'](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0x4d6372=await window[_0x37b083(0x2b6)][_0x37b083(0x3b9)]['encrypt']({'name':AES_CONFIG[_0x37b083(0x2ca)],'iv':_0xb06544,'tagLength':AES_CONFIG[_0x37b083(0x2e0)]},_0x27a2eb,_0x270b6e),_0x4b28a2=await window[_0x37b083(0x2b6)][_0x37b083(0x3b9)][_0x37b083(0x28c)](_0x37b083(0x321),_0x27a2eb),_0x1bbc59=Math[_0x37b083(0x317)](Math[_0x37b083(0x3cf)]()*0x40)+0x1,_0x325539=window[_0x37b083(0x2b6)][_0x37b083(0x269)](new Uint8Array(_0x1bbc59)),_0x2e4d85=new Uint8Array(0x1+_0xb06544[_0x37b083(0x271)]+0x4+_0x4b28a2['byteLength']+0x4+_0x4d6372[_0x37b083(0x271)]+0x4+_0x35dbe[_0x37b083(0x271)]+_0x140b6f[_0x37b083(0x271)]+0x4+_0x60f7df[_0x37b083(0x271)]+0x1+_0x325539[_0x37b083(0x271)]);let _0x387bc9=0x0;_0x2e4d85[_0x387bc9++]=_0xb06544['byteLength'],_0x2e4d85['set'](_0xb06544,_0x387bc9),_0x387bc9+=_0xb06544['byteLength'];const _0x5036cd=_0x4b28a2['byteLength'];_0x2e4d85[_0x387bc9++]=_0x5036cd>>0x18&0xff,_0x2e4d85[_0x387bc9++]=_0x5036cd>>0x10&0xff,_0x2e4d85[_0x387bc9++]=_0x5036cd>>0x8&0xff,_0x2e4d85[_0x387bc9++]=_0x5036cd&0xff,_0x2e4d85[_0x37b083(0x379)](new Uint8Array(_0x4b28a2),_0x387bc9),_0x387bc9+=_0x4b28a2[_0x37b083(0x271)];const _0x4968d4=_0x4d6372[_0x37b083(0x271)];_0x2e4d85[_0x387bc9++]=_0x4968d4>>0x18&0xff,_0x2e4d85[_0x387bc9++]=_0x4968d4>>0x10&0xff,_0x2e4d85[_0x387bc9++]=_0x4968d4>>0x8&0xff,_0x2e4d85[_0x387bc9++]=_0x4968d4&0xff,_0x2e4d85[_0x37b083(0x379)](new Uint8Array(_0x4d6372),_0x387bc9),_0x387bc9+=_0x4d6372[_0x37b083(0x271)];const _0x3cfadd=_0x35dbe[_0x37b083(0x271)];_0x2e4d85[_0x387bc9++]=_0x3cfadd>>0x18&0xff,_0x2e4d85[_0x387bc9++]=_0x3cfadd>>0x10&0xff,_0x2e4d85[_0x387bc9++]=_0x3cfadd>>0x8&0xff,_0x2e4d85[_0x387bc9++]=_0x3cfadd&0xff,_0x2e4d85[_0x37b083(0x379)](new Uint8Array(_0x35dbe),_0x387bc9),_0x387bc9+=_0x35dbe['byteLength'],_0x2e4d85['set'](_0x140b6f,_0x387bc9),_0x387bc9+=_0x140b6f[_0x37b083(0x271)];const _0xd2e465=_0x60f7df[_0x37b083(0x271)];return _0x2e4d85[_0x387bc9++]=_0xd2e465>>0x18&0xff,_0x2e4d85[_0x387bc9++]=_0xd2e465>>0x10&0xff,_0x2e4d85[_0x387bc9++]=_0xd2e465>>0x8&0xff,_0x2e4d85[_0x387bc9++]=_0xd2e465&0xff,_0x2e4d85[_0x37b083(0x379)](new Uint8Array(_0x60f7df),_0x387bc9),_0x387bc9+=_0x60f7df[_0x37b083(0x271)],_0x2e4d85[_0x387bc9++]=_0x325539[_0x37b083(0x271)],_0x2e4d85[_0x37b083(0x379)](_0x325539,_0x387bc9),{'version':0x2,'data':arrayBufferToBase64(_0x2e4d85[_0x37b083(0x2c2)])};}async function encryptWithECC(_0x1cd105,_0x2fa7b8){const _0x30c0f6=_0x1df063,_0x9965a7=await window[_0x30c0f6(0x2b6)][_0x30c0f6(0x3b9)][_0x30c0f6(0x263)]({'name':_0x30c0f6(0x228),'namedCurve':_0x2fa7b8[_0x30c0f6(0x2ae)]||ECC_CONFIG['CURVE']},!![],[_0x30c0f6(0x1ff),_0x30c0f6(0x36e)]),_0x136f44=await window[_0x30c0f6(0x2b6)][_0x30c0f6(0x3b9)][_0x30c0f6(0x28c)](_0x30c0f6(0x36d),_0x9965a7['publicKey']);let _0x25cf96;if(_0x2fa7b8[_0x30c0f6(0x1e9)])_0x25cf96=_0x2fa7b8[_0x30c0f6(0x1e9)];else{const _0x365af5=base64ToArrayBuffer(_0x2fa7b8[_0x30c0f6(0x327)]);_0x25cf96=await importECCPublicKey(_0x365af5,_0x2fa7b8[_0x30c0f6(0x2ae)]||ECC_CONFIG[_0x30c0f6(0x2b8)]);}const _0x324aa8=window['crypto']['getRandomValues'](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0x2fabed=await window[_0x30c0f6(0x2b6)][_0x30c0f6(0x3b9)][_0x30c0f6(0x36e)]({'name':_0x30c0f6(0x228),'public':_0x25cf96},_0x9965a7[_0x30c0f6(0x237)],0x100),_0x4a2623=await window[_0x30c0f6(0x2b6)][_0x30c0f6(0x3b9)][_0x30c0f6(0x212)](_0x30c0f6(0x321),_0x2fabed,{'name':AES_CONFIG[_0x30c0f6(0x2ca)],'length':AES_CONFIG[_0x30c0f6(0x39d)]},![],[_0x30c0f6(0x2bf)]),_0x2a93b9=await window[_0x30c0f6(0x2b6)][_0x30c0f6(0x3b9)][_0x30c0f6(0x2bf)]({'name':AES_CONFIG[_0x30c0f6(0x2ca)],'iv':_0x324aa8,'tagLength':AES_CONFIG[_0x30c0f6(0x2e0)]},_0x4a2623,_0x1cd105),_0x44e86d={'a':_0x30c0f6(0x2d9)+AES_CONFIG[_0x30c0f6(0x2ca)],'k':_0x2fa7b8['id'],'t':new Date()[_0x30c0f6(0x2bd)](),'c':_0x2fa7b8[_0x30c0f6(0x2ae)]||ECC_CONFIG['CURVE']};encryptFileData&&encryptFileName&&(_0x44e86d['f']={'n':encryptFileName,'s':encryptFileData[_0x30c0f6(0x271)]});const _0x5b7157=new TextEncoder()['encode'](JSON[_0x30c0f6(0x2ab)](_0x44e86d)),_0x460422=await window[_0x30c0f6(0x2b6)][_0x30c0f6(0x3b9)]['generateKey']({'name':AES_CONFIG[_0x30c0f6(0x2ca)],'length':AES_CONFIG['KEY_LENGTH']},!![],[_0x30c0f6(0x2bf),_0x30c0f6(0x331)]),_0x77e776=window[_0x30c0f6(0x2b6)][_0x30c0f6(0x269)](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0x6b3343=await window[_0x30c0f6(0x2b6)][_0x30c0f6(0x3b9)][_0x30c0f6(0x2bf)]({'name':AES_CONFIG[_0x30c0f6(0x2ca)],'iv':_0x77e776,'tagLength':AES_CONFIG[_0x30c0f6(0x2e0)]},_0x460422,_0x5b7157),_0x3f91bf=await window[_0x30c0f6(0x2b6)][_0x30c0f6(0x3b9)][_0x30c0f6(0x28c)](_0x30c0f6(0x321),_0x460422),_0xc36912=Math['floor'](Math[_0x30c0f6(0x3cf)]()*0x40)+0x1,_0x5055e0=window[_0x30c0f6(0x2b6)]['getRandomValues'](new Uint8Array(_0xc36912)),_0x2c163d=new Uint8Array(0x1+_0x77e776['byteLength']+0x4+_0x3f91bf[_0x30c0f6(0x271)]+0x4+_0x6b3343['byteLength']+0x4+_0x136f44['byteLength']+_0x324aa8[_0x30c0f6(0x271)]+0x4+_0x2a93b9[_0x30c0f6(0x271)]+0x1+_0x5055e0['byteLength']);let _0x5dbe62=0x0;_0x2c163d[_0x5dbe62++]=_0x77e776['byteLength'],_0x2c163d[_0x30c0f6(0x379)](_0x77e776,_0x5dbe62),_0x5dbe62+=_0x77e776[_0x30c0f6(0x271)];const _0x8cb139=_0x3f91bf[_0x30c0f6(0x271)];_0x2c163d[_0x5dbe62++]=_0x8cb139>>0x18&0xff,_0x2c163d[_0x5dbe62++]=_0x8cb139>>0x10&0xff,_0x2c163d[_0x5dbe62++]=_0x8cb139>>0x8&0xff,_0x2c163d[_0x5dbe62++]=_0x8cb139&0xff,_0x2c163d[_0x30c0f6(0x379)](new Uint8Array(_0x3f91bf),_0x5dbe62),_0x5dbe62+=_0x3f91bf[_0x30c0f6(0x271)];const _0x500215=_0x6b3343[_0x30c0f6(0x271)];_0x2c163d[_0x5dbe62++]=_0x500215>>0x18&0xff,_0x2c163d[_0x5dbe62++]=_0x500215>>0x10&0xff,_0x2c163d[_0x5dbe62++]=_0x500215>>0x8&0xff,_0x2c163d[_0x5dbe62++]=_0x500215&0xff,_0x2c163d['set'](new Uint8Array(_0x6b3343),_0x5dbe62),_0x5dbe62+=_0x6b3343[_0x30c0f6(0x271)];const _0x27560c=_0x136f44[_0x30c0f6(0x271)];_0x2c163d[_0x5dbe62++]=_0x27560c>>0x18&0xff,_0x2c163d[_0x5dbe62++]=_0x27560c>>0x10&0xff,_0x2c163d[_0x5dbe62++]=_0x27560c>>0x8&0xff,_0x2c163d[_0x5dbe62++]=_0x27560c&0xff,_0x2c163d[_0x30c0f6(0x379)](new Uint8Array(_0x136f44),_0x5dbe62),_0x5dbe62+=_0x136f44[_0x30c0f6(0x271)],_0x2c163d['set'](_0x324aa8,_0x5dbe62),_0x5dbe62+=_0x324aa8['byteLength'];const _0x1372e6=_0x2a93b9[_0x30c0f6(0x271)];return _0x2c163d[_0x5dbe62++]=_0x1372e6>>0x18&0xff,_0x2c163d[_0x5dbe62++]=_0x1372e6>>0x10&0xff,_0x2c163d[_0x5dbe62++]=_0x1372e6>>0x8&0xff,_0x2c163d[_0x5dbe62++]=_0x1372e6&0xff,_0x2c163d[_0x30c0f6(0x379)](new Uint8Array(_0x2a93b9),_0x5dbe62),_0x5dbe62+=_0x2a93b9[_0x30c0f6(0x271)],_0x2c163d[_0x5dbe62++]=_0x5055e0['byteLength'],_0x2c163d[_0x30c0f6(0x379)](_0x5055e0,_0x5dbe62),{'version':0x2,'data':arrayBufferToBase64(_0x2c163d[_0x30c0f6(0x2c2)])};}async function decryptMessage(){const _0x36dfe7=_0x1df063;try{let _0x249328;const _0x3669b1=document[_0x36dfe7(0x38b)](_0x36dfe7(0x2d1))[_0x36dfe7(0x24c)],_0x2a0ebb=document[_0x36dfe7(0x38b)](_0x36dfe7(0x2e7))[_0x36dfe7(0x24c)];if(!_0x3669b1){showStatus('decryptStatus','Please\x20enter\x20an\x20encrypted\x20message\x20or\x20add\x20an\x20encrypted\x20file','error');return;}if(!isValidEncryptedMessage(_0x3669b1,_0x2a0ebb)){showStatus('decryptStatus',_0x36dfe7(0x364),_0x36dfe7(0x3b8));return;}try{_0x249328=parseEncryptedMessage(_0x3669b1,_0x2a0ebb);}catch(_0x173588){showStatus(_0x36dfe7(0x20b),'Invalid\x20encrypted\x20message\x20data:\x20'+_0x173588[_0x36dfe7(0x24b)],_0x36dfe7(0x3b8));return;}const _0x5960c4=document[_0x36dfe7(0x38b)](_0x36dfe7(0x22c))[_0x36dfe7(0x24c)],_0x24c323=document['getElementById'](_0x36dfe7(0x2eb))[_0x36dfe7(0x24c)];if(!_0x5960c4){showStatus(_0x36dfe7(0x20b),_0x36dfe7(0x276),_0x36dfe7(0x3b8));return;}setLoading(!![]);const _0x1a32ca=keys[_0x36dfe7(0x330)](_0x545bc6=>_0x545bc6['id']===_0x5960c4);if(!_0x1a32ca){showStatus(_0x36dfe7(0x20b),_0x36dfe7(0x2af),_0x36dfe7(0x3b8)),setLoading(![]);return;}let _0x561d57=null,_0x2952de=_0x1a32ca;if(_0x1a32ca[_0x36dfe7(0x30f)]){if(!_0x24c323){showStatus('decryptStatus',_0x36dfe7(0x359),_0x36dfe7(0x3b8)),setLoading(![]);return;}try{_0x561d57=await decryptKeyWithPassword(_0x1a32ca,_0x24c323),_0x2952de=safeMemory['retrieve'](_0x561d57);if(!_0x2952de)throw new Error(_0x36dfe7(0x318));}catch(_0x52476d){showStatus(_0x36dfe7(0x20b),_0x36dfe7(0x21d)+_0x52476d[_0x36dfe7(0x24b)],_0x36dfe7(0x3b8)),setLoading(![]);return;}}let _0x209b54=await decryptData(_0x249328,_0x2952de),_0x5d067b,_0xe48d30;_0x209b54[_0x36dfe7(0x2ee)]?(_0x5d067b=_0x209b54['data'],_0xe48d30=_0x209b54['metadata']):(_0x5d067b=_0x209b54,_0xe48d30=null);_0x561d57&&safeMemory[_0x36dfe7(0x227)](_0x561d57);let _0x211dec=![],_0x479775=null,_0x331b5d=null;if(!_0x249328[_0x36dfe7(0x311)]&&_0x249328['isFile']&&_0x249328['fileName'])_0x211dec=!![],_0x479775=_0x249328[_0x36dfe7(0x339)],_0x331b5d=_0x249328[_0x36dfe7(0x1f5)]||_0x5d067b['byteLength'];else _0xe48d30&&_0xe48d30['f']&&(_0x211dec=!![],_0x479775=_0xe48d30['f']['n'],_0x331b5d=_0xe48d30['f']['s']||_0x5d067b[_0x36dfe7(0x271)]);if(_0x211dec)document[_0x36dfe7(0x38b)](_0x36dfe7(0x262))['value']=_0x36dfe7(0x33f)+_0x479775+'\x20('+formatFileSize(_0x331b5d)+')',document['getElementById'](_0x36dfe7(0x33c))['setAttribute'](_0x36dfe7(0x3a9),_0x479775),document[_0x36dfe7(0x38b)](_0x36dfe7(0x33c))['setAttribute'](_0x36dfe7(0x220),_0x36dfe7(0x36c)),window[_0x36dfe7(0x211)]=_0x5d067b;else{const _0x5994b0=new TextDecoder()[_0x36dfe7(0x288)](_0x5d067b);document['getElementById'](_0x36dfe7(0x262))['value']=_0x5994b0,document[_0x36dfe7(0x38b)]('downloadDecryptedBtn')['setAttribute'](_0x36dfe7(0x3a9),_0x36dfe7(0x25e)),document[_0x36dfe7(0x38b)](_0x36dfe7(0x33c))[_0x36dfe7(0x2d4)]('data-binary',_0x36dfe7(0x3b5)),window[_0x36dfe7(0x211)]=null;}showStatus('decryptStatus',_0x36dfe7(0x342),_0x36dfe7(0x28b));}catch(_0x3be4e7){console[_0x36dfe7(0x3b8)]('Decryption\x20error:',_0x3be4e7),showStatus(_0x36dfe7(0x20b),_0x36dfe7(0x38f)+_0x3be4e7[_0x36dfe7(0x24b)],'error');}finally{document[_0x36dfe7(0x38b)](_0x36dfe7(0x2eb))[_0x36dfe7(0x24c)]='',setLoading(![]);}}async function decryptWithAES(_0x58b59e,_0x6c63f){const _0x9a536e=_0x1df063;try{const _0x4aff01=base64ToArrayBuffer(_0x58b59e[_0x9a536e(0x2ee)]),_0x2e2383=new Uint8Array(_0x4aff01);let _0x2607e5=0x0;const _0xdc4597=_0x2e2383[_0x2607e5++];if(_0xdc4597!==0x3)throw new Error('Unsupported\x20data\x20format\x20version');const _0x563091=_0x2e2383[_0x9a536e(0x31f)](_0x2607e5,_0x2607e5+AES_CONFIG[_0x9a536e(0x33e)]);_0x2607e5+=AES_CONFIG[_0x9a536e(0x33e)];const _0x286cc2=_0x2e2383[_0x2607e5]<<0x18|_0x2e2383[_0x2607e5+0x1]<<0x10|_0x2e2383[_0x2607e5+0x2]<<0x8|_0x2e2383[_0x2607e5+0x3];_0x2607e5+=0x4;const _0x3f7125=_0x2e2383[_0x9a536e(0x31f)](_0x2607e5,_0x2607e5+_0x286cc2);_0x2607e5+=_0x286cc2;const _0x981373=_0x2e2383[_0x2607e5]<<0x18|_0x2e2383[_0x2607e5+0x1]<<0x10|_0x2e2383[_0x2607e5+0x2]<<0x8|_0x2e2383[_0x2607e5+0x3];_0x2607e5+=0x4;const _0x16201d=_0x2e2383['slice'](_0x2607e5,_0x2607e5+_0x981373);_0x2607e5+=_0x981373;const _0x15a8ff=_0x2e2383[_0x9a536e(0x31f)](_0x2607e5,_0x2607e5+AES_CONFIG['IV_LENGTH']);_0x2607e5+=AES_CONFIG[_0x9a536e(0x33e)];const _0x39d033=_0x2e2383[_0x2607e5]<<0x18|_0x2e2383[_0x2607e5+0x1]<<0x10|_0x2e2383[_0x2607e5+0x2]<<0x8|_0x2e2383[_0x2607e5+0x3];_0x2607e5+=0x4;const _0x2e36c7=_0x2e2383['slice'](_0x2607e5,_0x2607e5+_0x39d033),_0x23d944=await window[_0x9a536e(0x2b6)][_0x9a536e(0x3b9)]['importKey']('raw',_0x3f7125,{'name':AES_CONFIG[_0x9a536e(0x2ca)],'length':AES_CONFIG[_0x9a536e(0x39d)]},![],[_0x9a536e(0x331)]),_0x16493a=await window[_0x9a536e(0x2b6)][_0x9a536e(0x3b9)][_0x9a536e(0x331)]({'name':AES_CONFIG[_0x9a536e(0x2ca)],'iv':_0x563091,'tagLength':AES_CONFIG[_0x9a536e(0x2e0)]},_0x23d944,_0x16201d),_0xec4acc=new TextDecoder()[_0x9a536e(0x288)](_0x16493a),_0x52ea7a=JSON[_0x9a536e(0x295)](_0xec4acc);if(_0x52ea7a['k']!==_0x6c63f['id'])throw new Error(_0x9a536e(0x20f));let _0x518472;if(_0x6c63f[_0x9a536e(0x3bb)])_0x518472=_0x6c63f['_cryptoKey'];else{const _0x524c16=base64ToArrayBuffer(_0x6c63f[_0x9a536e(0x26a)]);_0x518472=await window['crypto']['subtle'][_0x9a536e(0x212)](_0x9a536e(0x321),_0x524c16,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x9a536e(0x331)]);}return{'data':await window[_0x9a536e(0x2b6)][_0x9a536e(0x3b9)]['decrypt']({'name':AES_CONFIG[_0x9a536e(0x2ca)],'iv':_0x15a8ff,'tagLength':AES_CONFIG[_0x9a536e(0x2e0)]},_0x518472,_0x2e36c7),'metadata':_0x52ea7a};}catch(_0x1d6329){console[_0x9a536e(0x3b8)](_0x9a536e(0x3b1),_0x1d6329);if(_0x1d6329 instanceof DOMException)throw new Error('Decryption\x20failed:\x20'+_0x1d6329[_0x9a536e(0x383)]+_0x9a536e(0x397)+(_0x1d6329['message']||'Unknown\x20WebCrypto\x20error'));else throw new Error(_0x9a536e(0x1f2)+_0x1d6329[_0x9a536e(0x24b)]);}}function isValidEncryptedMessage(_0x3b2dd7,_0xdbd15c=''){const _0x3c27fe=_0x1df063,_0x181054=typeof _0xdbd15c===_0x3c27fe(0x3aa)&&_0xdbd15c[_0x3c27fe(0x3c7)]()!==''?_0xdbd15c[_0x3c27fe(0x3c7)]():null;let _0x2eae3c,_0xa9d8c7;_0x181054?(_0x2eae3c=_0x181054,_0xa9d8c7=reverseString(_0x181054)):(_0x2eae3c='@!',_0xa9d8c7='!@');const _0x4962fb=escapeRegex(_0x2eae3c),_0x2e6dda=escapeRegex(_0xa9d8c7),_0x519a12='^.*?'+_0x4962fb+_0x3c27fe(0x2f6)+_0x2e6dda+_0x3c27fe(0x243),_0x4a3c37=new RegExp(_0x519a12);return _0x4a3c37['test'](_0x3b2dd7);}function createEncryptedMessageString(_0x450b6a,_0x538ac3=''){const _0xe4595f=_0x1df063,_0x216bbb=typeof _0x538ac3==='string'&&_0x538ac3[_0xe4595f(0x3c7)]()!==''?_0x538ac3[_0xe4595f(0x3c7)]():null;let _0x2a345b,_0x1d47f;_0x216bbb?(_0x2a345b=_0x216bbb,_0x1d47f=reverseString(_0x216bbb)):(_0x2a345b='@!',_0x1d47f='!@');const _0xb98a31=generateRandomString(0x2+Math[_0xe4595f(0x317)](Math[_0xe4595f(0x3cf)]()*0x9)),_0x3b5c07=generateRandomString(0x2+Math[_0xe4595f(0x317)](Math['random']()*0x9)),_0x4db9c8=typeof _0x450b6a['data']===_0xe4595f(0x3aa)?_0x450b6a[_0xe4595f(0x2ee)]['replace'](/[\r\n\s]*(.*?)[\r\n\s]*$/s,'$1'):_0x450b6a['data'];return _0xb98a31+_0x2a345b+_0x4db9c8+_0x1d47f+_0x3b5c07;}function parseEncryptedMessage(_0xb582cc,_0x34a880=''){const _0x5accc8=_0x1df063,_0x31b9a9=typeof _0x34a880==='string'&&_0x34a880[_0x5accc8(0x3c7)]()!==''?_0x34a880[_0x5accc8(0x3c7)]():null;let _0x1b5a60,_0x4364e9;_0x31b9a9?(_0x1b5a60=_0x31b9a9,_0x4364e9=reverseString(_0x31b9a9)):(_0x1b5a60='@!',_0x4364e9='!@');const _0x5d5d9f=escapeRegex(_0x1b5a60),_0x23fe46=escapeRegex(_0x4364e9),_0x58ccdd=_0x5accc8(0x31b)+_0x5d5d9f+'([\x5cs\x5cS]+?)'+_0x23fe46+_0x5accc8(0x243),_0x12bedc=new RegExp(_0x58ccdd),_0x45b114=_0xb582cc[_0x5accc8(0x252)](_0x12bedc);if(!_0x45b114||!_0x45b114[0x1])throw new Error(_0x5accc8(0x238));const _0x389193=_0x45b114[0x1]['trim']();return{'version':0x2,'data':_0x389193};}function updateEncryptionOutput(_0x37e99b){return createEncryptedMessageString(_0x37e99b);}function generateRandomString(_0x3e714b=0x5){const _0x1d6918=_0x1df063,_0x1545f6=_0x1d6918(0x389);let _0x562f39='';for(let _0x113004=0x0;_0x113004<_0x3e714b;_0x113004++){_0x562f39+=_0x1545f6[_0x1d6918(0x38e)](Math['floor'](Math[_0x1d6918(0x3cf)]()*_0x1545f6[_0x1d6918(0x392)]));}return _0x562f39;}function determineKeySecurityLevel(_0x5cf5db){const _0xda97d5=_0x1df063;let _0x356e5a='low';if(_0x5cf5db[_0xda97d5(0x30d)]===_0xda97d5(0x3be)||_0x5cf5db[_0xda97d5(0x30d)]===_0xda97d5(0x38a)||_0x5cf5db[_0xda97d5(0x30d)]===_0xda97d5(0x251))_0x356e5a='medium';else(_0x5cf5db[_0xda97d5(0x30d)]===_0xda97d5(0x2d6)||_0x5cf5db[_0xda97d5(0x30d)]===_0xda97d5(0x3a3))&&(_0x356e5a='low');let _0x4cacf2=0x0;_0x5cf5db[_0xda97d5(0x30f)]&&(_0x4cacf2+=0x2);_0x5cf5db[_0xda97d5(0x30d)]!==_0xda97d5(0x3be)&&(_0x5cf5db[_0xda97d5(0x28f)]&&_0x5cf5db['hasPrivate']&&(_0x4cacf2+=0x1));_0x5cf5db[_0xda97d5(0x2c3)]&&(_0x4cacf2+=0x1);let _0x50e1e9;if(_0x356e5a===_0xda97d5(0x240)){if(_0x4cacf2>=0x3)_0x50e1e9=_0xda97d5(0x22a);else _0x4cacf2>=0x1?_0x50e1e9=_0xda97d5(0x240):_0x50e1e9='low';}else{if(_0x4cacf2>=0x4)_0x50e1e9=_0xda97d5(0x22a);else _0x4cacf2>=0x2?_0x50e1e9=_0xda97d5(0x240):_0x50e1e9=_0xda97d5(0x2e3);}return _0x50e1e9;}async function decryptWithRSA(_0x48f249,_0x2fbe94){const _0x4ba356=_0x1df063;if(!_0x48f249[_0x4ba356(0x311)]||_0x48f249[_0x4ba356(0x311)]===0x1){const _0x4bc13f=base64ToArrayBuffer(_0x48f249[_0x4ba356(0x2ee)]),_0x3a9393=base64ToArrayBuffer(_0x48f249[_0x4ba356(0x259)]),_0x356997=base64ToArrayBuffer(_0x48f249['iv']);let _0x3bef0f;if(_0x2fbe94[_0x4ba356(0x3a5)])_0x3bef0f=_0x2fbe94[_0x4ba356(0x3a5)];else{const _0x523ce3=base64ToArrayBuffer(_0x2fbe94['privateKey']);_0x3bef0f=await importRSAPrivateKey(_0x523ce3,_0x48f249[_0x4ba356(0x23c)]||_0x2fbe94[_0x4ba356(0x392)]||RSA_CONFIG['KEY_SIZE']);}const _0x303395=await window['crypto']['subtle']['decrypt']({'name':RSA_CONFIG[_0x4ba356(0x3c0)]},_0x3bef0f,_0x3a9393),_0x45f6ba=await importAESKey(_0x303395);return await window[_0x4ba356(0x2b6)]['subtle'][_0x4ba356(0x331)]({'name':AES_CONFIG[_0x4ba356(0x2ca)],'iv':_0x356997,'tagLength':AES_CONFIG[_0x4ba356(0x2e0)]},_0x45f6ba,_0x4bc13f);}else{const _0x4e3d67=base64ToArrayBuffer(_0x48f249[_0x4ba356(0x2ee)]),_0x30511e=new Uint8Array(_0x4e3d67);let _0x36fdb0=0x0;const _0xac374b=_0x30511e[_0x36fdb0++],_0x23d567=_0x30511e[_0x4ba356(0x31f)](_0x36fdb0,_0x36fdb0+_0xac374b);_0x36fdb0+=_0xac374b;const _0x461c0c=_0x30511e[_0x36fdb0]<<0x18|_0x30511e[_0x36fdb0+0x1]<<0x10|_0x30511e[_0x36fdb0+0x2]<<0x8|_0x30511e[_0x36fdb0+0x3];_0x36fdb0+=0x4;const _0x54b38a=_0x30511e['slice'](_0x36fdb0,_0x36fdb0+_0x461c0c);_0x36fdb0+=_0x461c0c;const _0x4de64d=_0x30511e[_0x36fdb0]<<0x18|_0x30511e[_0x36fdb0+0x1]<<0x10|_0x30511e[_0x36fdb0+0x2]<<0x8|_0x30511e[_0x36fdb0+0x3];_0x36fdb0+=0x4;const _0x7b8dc1=_0x30511e['slice'](_0x36fdb0,_0x36fdb0+_0x4de64d);_0x36fdb0+=_0x4de64d;const _0x410a2f=_0x30511e[_0x36fdb0]<<0x18|_0x30511e[_0x36fdb0+0x1]<<0x10|_0x30511e[_0x36fdb0+0x2]<<0x8|_0x30511e[_0x36fdb0+0x3];_0x36fdb0+=0x4;const _0x2c3725=_0x30511e[_0x4ba356(0x31f)](_0x36fdb0,_0x36fdb0+_0x410a2f);_0x36fdb0+=_0x410a2f;const _0x4599cf=_0x30511e['slice'](_0x36fdb0,_0x36fdb0+AES_CONFIG[_0x4ba356(0x33e)]);_0x36fdb0+=AES_CONFIG[_0x4ba356(0x33e)];const _0x350a93=_0x30511e[_0x36fdb0]<<0x18|_0x30511e[_0x36fdb0+0x1]<<0x10|_0x30511e[_0x36fdb0+0x2]<<0x8|_0x30511e[_0x36fdb0+0x3];_0x36fdb0+=0x4;const _0x2e8125=_0x30511e[_0x4ba356(0x31f)](_0x36fdb0,_0x36fdb0+_0x350a93);let _0x2dd7c2;if(_0x2fbe94[_0x4ba356(0x3a5)])_0x2dd7c2=_0x2fbe94[_0x4ba356(0x3a5)];else{const _0x1d3f5c=base64ToArrayBuffer(_0x2fbe94[_0x4ba356(0x237)]);_0x2dd7c2=await importRSAPrivateKey(_0x1d3f5c,_0x2fbe94[_0x4ba356(0x392)]||RSA_CONFIG[_0x4ba356(0x2c7)]);}const _0x449324=await window[_0x4ba356(0x2b6)][_0x4ba356(0x3b9)][_0x4ba356(0x331)]({'name':RSA_CONFIG[_0x4ba356(0x3c0)]},_0x2dd7c2,_0x2c3725),_0x8ed8d3=await window['crypto'][_0x4ba356(0x3b9)][_0x4ba356(0x212)](_0x4ba356(0x321),_0x54b38a,{'name':AES_CONFIG[_0x4ba356(0x2ca)],'length':_0x461c0c*0x8},![],[_0x4ba356(0x331)]),_0x4fecbc=await window[_0x4ba356(0x2b6)][_0x4ba356(0x3b9)][_0x4ba356(0x331)]({'name':AES_CONFIG[_0x4ba356(0x2ca)],'iv':_0x23d567,'tagLength':AES_CONFIG[_0x4ba356(0x2e0)]},_0x8ed8d3,_0x7b8dc1),_0x4beb2e=new TextDecoder()[_0x4ba356(0x288)](_0x4fecbc),_0x27d7c1=JSON[_0x4ba356(0x295)](_0x4beb2e);if(_0x27d7c1['k']!==_0x2fbe94['id'])throw new Error('Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message');const _0x50a210=await importAESKey(_0x449324);return{'data':await window['crypto'][_0x4ba356(0x3b9)][_0x4ba356(0x331)]({'name':AES_CONFIG['MODE'],'iv':_0x4599cf,'tagLength':AES_CONFIG[_0x4ba356(0x2e0)]},_0x50a210,_0x2e8125),'metadata':_0x27d7c1};}}async function decryptWithECC(_0x305b75,_0x32b84e){const _0x40c14c=_0x1df063;if(!_0x305b75['version']||_0x305b75['version']===0x1){const _0x8f97e7=base64ToArrayBuffer(_0x305b75[_0x40c14c(0x2ee)]),_0x78ef63=base64ToArrayBuffer(_0x305b75[_0x40c14c(0x305)]),_0x2906f3=base64ToArrayBuffer(_0x305b75['iv']),_0x55cd1e=await importECCPublicKey(_0x78ef63,_0x305b75[_0x40c14c(0x2ae)]||ECC_CONFIG['CURVE']);let _0x4dae25;if(_0x32b84e[_0x40c14c(0x3a5)])_0x4dae25=_0x32b84e[_0x40c14c(0x3a5)];else{const _0x304e90=base64ToArrayBuffer(_0x32b84e[_0x40c14c(0x237)]);_0x4dae25=await importECCPrivateKey(_0x304e90,_0x305b75[_0x40c14c(0x2ae)]||ECC_CONFIG[_0x40c14c(0x2b8)]);}const _0x280f34=await window['crypto'][_0x40c14c(0x3b9)][_0x40c14c(0x1ff)]({'name':'ECDH','public':_0x55cd1e},_0x4dae25,{'name':AES_CONFIG[_0x40c14c(0x2ca)],'length':AES_CONFIG[_0x40c14c(0x39d)]},![],['decrypt']);return await window['crypto'][_0x40c14c(0x3b9)][_0x40c14c(0x331)]({'name':AES_CONFIG[_0x40c14c(0x2ca)],'iv':_0x2906f3,'tagLength':AES_CONFIG[_0x40c14c(0x2e0)]},_0x280f34,_0x8f97e7);}else{const _0x22cb08=base64ToArrayBuffer(_0x305b75[_0x40c14c(0x2ee)]),_0x1ac56e=new Uint8Array(_0x22cb08);let _0x159f78=0x0;const _0x1fadce=_0x1ac56e[_0x159f78++],_0x239fad=_0x1ac56e[_0x40c14c(0x31f)](_0x159f78,_0x159f78+_0x1fadce);_0x159f78+=_0x1fadce;const _0x150900=_0x1ac56e[_0x159f78]<<0x18|_0x1ac56e[_0x159f78+0x1]<<0x10|_0x1ac56e[_0x159f78+0x2]<<0x8|_0x1ac56e[_0x159f78+0x3];_0x159f78+=0x4;const _0x422304=_0x1ac56e[_0x40c14c(0x31f)](_0x159f78,_0x159f78+_0x150900);_0x159f78+=_0x150900;const _0x46d07c=_0x1ac56e[_0x159f78]<<0x18|_0x1ac56e[_0x159f78+0x1]<<0x10|_0x1ac56e[_0x159f78+0x2]<<0x8|_0x1ac56e[_0x159f78+0x3];_0x159f78+=0x4;const _0x54cfab=_0x1ac56e[_0x40c14c(0x31f)](_0x159f78,_0x159f78+_0x46d07c);_0x159f78+=_0x46d07c;const _0x1ea928=_0x1ac56e[_0x159f78]<<0x18|_0x1ac56e[_0x159f78+0x1]<<0x10|_0x1ac56e[_0x159f78+0x2]<<0x8|_0x1ac56e[_0x159f78+0x3];_0x159f78+=0x4;const _0x236b2f=_0x1ac56e[_0x40c14c(0x31f)](_0x159f78,_0x159f78+_0x1ea928);_0x159f78+=_0x1ea928;const _0x180a9b=_0x1ac56e[_0x40c14c(0x31f)](_0x159f78,_0x159f78+AES_CONFIG['IV_LENGTH']);_0x159f78+=AES_CONFIG[_0x40c14c(0x33e)];const _0x58badf=_0x1ac56e[_0x159f78]<<0x18|_0x1ac56e[_0x159f78+0x1]<<0x10|_0x1ac56e[_0x159f78+0x2]<<0x8|_0x1ac56e[_0x159f78+0x3];_0x159f78+=0x4;const _0x98e9b6=_0x1ac56e['slice'](_0x159f78,_0x159f78+_0x58badf),_0x10a384=await importECCPublicKey(_0x236b2f,_0x32b84e[_0x40c14c(0x2ae)]||ECC_CONFIG[_0x40c14c(0x2b8)]);let _0x27eeef;if(_0x32b84e[_0x40c14c(0x3a5)])_0x27eeef=_0x32b84e[_0x40c14c(0x3a5)];else{const _0x17590d=base64ToArrayBuffer(_0x32b84e[_0x40c14c(0x237)]);_0x27eeef=await importECCPrivateKey(_0x17590d,_0x32b84e['curve']||ECC_CONFIG[_0x40c14c(0x2b8)]);}const _0x30f037=await window[_0x40c14c(0x2b6)][_0x40c14c(0x3b9)][_0x40c14c(0x36e)]({'name':_0x40c14c(0x228),'public':_0x10a384},_0x27eeef,0x100),_0x584c1b=await window[_0x40c14c(0x2b6)][_0x40c14c(0x3b9)][_0x40c14c(0x212)](_0x40c14c(0x321),_0x30f037,{'name':AES_CONFIG[_0x40c14c(0x2ca)],'length':AES_CONFIG[_0x40c14c(0x39d)]},![],[_0x40c14c(0x331)]),_0x1941f6=await window[_0x40c14c(0x2b6)][_0x40c14c(0x3b9)][_0x40c14c(0x212)](_0x40c14c(0x321),_0x422304,{'name':AES_CONFIG[_0x40c14c(0x2ca)],'length':_0x150900*0x8},![],['decrypt']),_0x523854=await window[_0x40c14c(0x2b6)][_0x40c14c(0x3b9)][_0x40c14c(0x331)]({'name':AES_CONFIG['MODE'],'iv':_0x239fad,'tagLength':AES_CONFIG[_0x40c14c(0x2e0)]},_0x1941f6,_0x54cfab),_0x45bf09=new TextDecoder()[_0x40c14c(0x288)](_0x523854),_0x2be028=JSON[_0x40c14c(0x295)](_0x45bf09);if(_0x2be028['k']!==_0x32b84e['id'])throw new Error(_0x40c14c(0x20f));return{'data':await window[_0x40c14c(0x2b6)][_0x40c14c(0x3b9)]['decrypt']({'name':AES_CONFIG[_0x40c14c(0x2ca)],'iv':_0x180a9b,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x584c1b,_0x98e9b6),'metadata':_0x2be028};}}function reverseString(_0x4d9d90){const _0x504025=_0x1df063;if(typeof _0x4d9d90!=='string')return'';return _0x4d9d90[_0x504025(0x290)]('')[_0x504025(0x21c)]()['join']('');}function downloadEncryptedFile(){const _0x58268a=_0x1df063,_0x5c9f0e=document[_0x58268a(0x38b)]('encryptedOutput')[_0x58268a(0x24c)];if(!_0x5c9f0e){showStatus(_0x58268a(0x225),_0x58268a(0x209),_0x58268a(0x3b8));return;}const _0x50857e=document[_0x58268a(0x38b)](_0x58268a(0x1fc))[_0x58268a(0x3cc)](_0x58268a(0x3a9))||generateRandomFileName(0x6)+_0x58268a(0x37b),_0x30462f=new Blob([_0x5c9f0e],{'type':_0x58268a(0x2fa)});downloadBlob(_0x30462f,_0x50857e),showStatus(_0x58268a(0x225),_0x58268a(0x300)+_0x50857e+_0x58268a(0x244),'success');}function downloadDecryptedFile(){const _0x56d896=_0x1df063;if(window['decryptedBinaryData']){const _0x21bc54=document['getElementById'](_0x56d896(0x33c))[_0x56d896(0x3cc)](_0x56d896(0x3a9))||_0x56d896(0x258),_0x323607=new Blob([window[_0x56d896(0x211)]],{'type':_0x56d896(0x2fa)});downloadBlob(_0x323607,_0x21bc54);}else{const _0x303e23=document[_0x56d896(0x38b)](_0x56d896(0x262))[_0x56d896(0x24c)];if(!_0x303e23){showStatus('decryptStatus','No\x20decrypted\x20data\x20to\x20download','error');return;}const _0x2c3683=document[_0x56d896(0x38b)](_0x56d896(0x33c))[_0x56d896(0x3cc)](_0x56d896(0x3a9))||_0x56d896(0x25e),_0x256717=new Blob([_0x303e23],{'type':_0x56d896(0x2fa)});downloadBlob(_0x256717,_0x2c3683);}showStatus('decryptStatus',_0x56d896(0x3ca),'success');}function downloadBlob(_0x5d3279,_0x2e9e26){const _0x4c7805=_0x1df063,_0x1677f4=URL[_0x4c7805(0x282)](_0x5d3279),_0xe682ac=document['createElement']('a');_0xe682ac[_0x4c7805(0x3ab)]=_0x1677f4,_0xe682ac[_0x4c7805(0x391)]=_0x2e9e26,document[_0x4c7805(0x3a1)]['appendChild'](_0xe682ac),_0xe682ac[_0x4c7805(0x2c0)](),document[_0x4c7805(0x3a1)][_0x4c7805(0x28e)](_0xe682ac),URL[_0x4c7805(0x2c9)](_0x1677f4);}function importKey(){const _0x469706=_0x1df063,_0x38b582=createKeyFileInput();_0x38b582[_0x469706(0x2c0)]();}async function exportKey(_0x3573d6,_0x3266a4=![]){const _0x25d8bb=_0x1df063;try{const _0x518714=keys[_0x25d8bb(0x330)](_0x2b1d4d=>_0x2b1d4d['id']===_0x3573d6);if(!_0x518714){alert(_0x25d8bb(0x2af));return;}const _0x5983e8=_0x518714[_0x25d8bb(0x30d)]===_0x25d8bb(0x2d6)||_0x518714['type']===_0x25d8bb(0x38a)||_0x518714[_0x25d8bb(0x30d)]===_0x25d8bb(0x3a3)||_0x518714[_0x25d8bb(0x30d)]===_0x25d8bb(0x251);let _0x2b7e2f=_0x518714,_0x53d106=_0x25d8bb(0x270);if(_0x5983e8&&_0x3266a4){let _0x10135d='';try{_0x10135d=await showPasswordModal(_0x25d8bb(0x1ef),_0x25d8bb(0x1f7),!![]);}catch(_0xa0690b){return;}if(!_0x10135d){if(!confirm(_0x25d8bb(0x239)))return;}_0x2b7e2f={'id':_0x518714['id'],'name':_0x518714[_0x25d8bb(0x383)],'type':_0x518714[_0x25d8bb(0x30d)],'created':_0x518714[_0x25d8bb(0x2bb)],'expiry':_0x518714[_0x25d8bb(0x2c3)],'privateKey':_0x518714[_0x25d8bb(0x237)],'protected':_0x518714[_0x25d8bb(0x30f)],'salt':_0x518714[_0x25d8bb(0x3ce)],'iv':_0x518714['iv'],'algorithm':_0x518714[_0x25d8bb(0x39f)],'hasPrivate':!![],'hasPublic':![],'pairedKeyId':_0x518714['id'],'publicKeyHash':_0x518714[_0x25d8bb(0x39c)]};if(_0x518714[_0x25d8bb(0x30d)]==='rsa'||_0x518714[_0x25d8bb(0x30d)]===_0x25d8bb(0x38a))_0x2b7e2f[_0x25d8bb(0x392)]=_0x518714[_0x25d8bb(0x392)];else(_0x518714['type']===_0x25d8bb(0x3a3)||_0x518714[_0x25d8bb(0x30d)]===_0x25d8bb(0x251))&&(_0x2b7e2f[_0x25d8bb(0x2ae)]=_0x518714[_0x25d8bb(0x2ae)]);if(_0x10135d){if(_0x518714[_0x25d8bb(0x30f)])try{const _0x589842=await showPasswordModal(_0x25d8bb(0x337),_0x25d8bb(0x353),![]),_0x1c4fd1=await decryptKeyWithPassword(_0x518714,_0x589842),_0x1e7259=safeMemory['retrieve'](_0x1c4fd1,!![]);_0x2b7e2f[_0x25d8bb(0x237)]=_0x1e7259['privateKey'],_0x2b7e2f['protected']=![];}catch(_0x506721){showStatus(_0x25d8bb(0x374),_0x25d8bb(0x341)+_0x506721[_0x25d8bb(0x24b)],_0x25d8bb(0x3b8));return;}await encryptKeyWithPassword(_0x2b7e2f,_0x10135d);}_0x53d106='.lem';}else{if(_0x5983e8&&!_0x3266a4){_0x2b7e2f={'id':_0x518714['id'],'name':_0x518714['name'],'type':_0x518714[_0x25d8bb(0x30d)],'created':_0x518714[_0x25d8bb(0x2bb)],'expiry':_0x518714[_0x25d8bb(0x2c3)],'publicKey':_0x518714[_0x25d8bb(0x327)],'algorithm':_0x518714[_0x25d8bb(0x39f)],'hasPublic':!![],'hasPrivate':![],'pairedKeyId':_0x518714['id'],'publicKeyHash':_0x518714['publicKeyHash']};if(_0x518714[_0x25d8bb(0x30d)]===_0x25d8bb(0x2d6)||_0x518714[_0x25d8bb(0x30d)]===_0x25d8bb(0x38a))_0x2b7e2f[_0x25d8bb(0x392)]=_0x518714[_0x25d8bb(0x392)];else(_0x518714['type']==='ecc'||_0x518714[_0x25d8bb(0x30d)]===_0x25d8bb(0x251))&&(_0x2b7e2f[_0x25d8bb(0x2ae)]=_0x518714[_0x25d8bb(0x2ae)]);}}const _0x465b87=JSON['stringify'](_0x2b7e2f),_0x314c5b=btoa(_0x465b87),_0x420e22=new Blob([_0x314c5b],{'type':_0x25d8bb(0x2fa)}),_0x1328cf=URL[_0x25d8bb(0x282)](_0x420e22),_0x5c3fb0=document['createElement']('a');_0x5c3fb0[_0x25d8bb(0x3ab)]=_0x1328cf,_0x5c3fb0[_0x25d8bb(0x391)]=''+_0x518714[_0x25d8bb(0x383)][_0x25d8bb(0x2d8)](/[^a-z0-9]/gi,'_')+_0x53d106,document[_0x25d8bb(0x3a1)][_0x25d8bb(0x285)](_0x5c3fb0),_0x5c3fb0['click'](),document[_0x25d8bb(0x3a1)][_0x25d8bb(0x28e)](_0x5c3fb0),URL['revokeObjectURL'](_0x1328cf);const _0x31f760=_0x3266a4?'private\x20key':_0x5983e8?_0x25d8bb(0x27c):'key';showStatus(_0x25d8bb(0x374),_0x25d8bb(0x309)+_0x518714['name']+'\x22\x20'+_0x31f760+_0x25d8bb(0x248)+_0x53d106+_0x25d8bb(0x31a),'success');}catch(_0xb4c6fd){console['error'](_0x25d8bb(0x340),_0xb4c6fd),showStatus(_0x25d8bb(0x374),'Export\x20error:\x20'+_0xb4c6fd[_0x25d8bb(0x24b)],_0x25d8bb(0x3b8));}}async function exportPrivateKey(_0x42265f){const _0x4e2a38=_0x1df063,_0x21f044=keys['find'](_0x18f1d3=>_0x18f1d3['id']===_0x42265f);if(!_0x21f044){alert(_0x4e2a38(0x2af));return;}if(!_0x21f044[_0x4e2a38(0x375)]){showStatus(_0x4e2a38(0x374),_0x4e2a38(0x301),'error');return;}const _0x426138=confirm(_0x4e2a38(0x363)+_0x4e2a38(0x376)+_0x4e2a38(0x352));_0x426138&&await exportKey(_0x42265f,!![]);}function createKeyFileInput(){const _0x4e5cd6=_0x1df063;let _0x257976=document[_0x4e5cd6(0x38b)](_0x4e5cd6(0x3bf));return!_0x257976&&(_0x257976=document[_0x4e5cd6(0x35d)](_0x4e5cd6(0x3b6)),_0x257976[_0x4e5cd6(0x30d)]='file',_0x257976['id']=_0x4e5cd6(0x3bf),_0x257976['accept']=_0x4e5cd6(0x308),_0x257976['style'][_0x4e5cd6(0x386)]=_0x4e5cd6(0x303),document[_0x4e5cd6(0x3a1)][_0x4e5cd6(0x285)](_0x257976),_0x257976[_0x4e5cd6(0x346)](_0x4e5cd6(0x22e),handleKeyFileSelect)),_0x257976;}async function handleKeyFileSelect(_0x36e380){const _0x141de5=_0x1df063;try{const _0x1eb944=_0x36e380[_0x141de5(0x22f)][_0x141de5(0x3cd)];if(!_0x1eb944||_0x1eb944[_0x141de5(0x392)]===0x0)return;setLoading(!![]);const _0x65a02e=_0x1eb944[0x0],_0x2da51a=_0x65a02e[_0x141de5(0x383)][_0x141de5(0x2a6)]()[_0x141de5(0x21f)]('.lem'),_0x3bd26c=_0x65a02e['name'][_0x141de5(0x2a6)]()[_0x141de5(0x21f)](_0x141de5(0x270)),_0x38dd82=new FileReader();_0x38dd82[_0x141de5(0x384)]=async function(_0x5c1046){const _0x4b2d7e=_0x141de5;try{const _0x1b1f89=_0x5c1046['target'][_0x4b2d7e(0x2b9)];let _0x4ac641;try{const _0x55bf88=atob(_0x1b1f89);_0x4ac641=JSON['parse'](_0x55bf88);}catch(_0x1197b7){throw new Error(_0x4b2d7e(0x347));}if(!_0x4ac641['id']||!_0x4ac641[_0x4b2d7e(0x383)]||!_0x4ac641['type']||!_0x4ac641[_0x4b2d7e(0x2bb)])throw new Error(_0x4b2d7e(0x236));if(!validator['isValidKeyName'](_0x4ac641[_0x4b2d7e(0x383)]))throw new Error('Invalid\x20key\x20name\x20format');if(_0x4ac641[_0x4b2d7e(0x30d)]===_0x4b2d7e(0x3be))_0x4ac641['hasPublic']=!![],_0x4ac641[_0x4b2d7e(0x375)]=!![];else{_0x4ac641[_0x4b2d7e(0x28f)]=!!_0x4ac641[_0x4b2d7e(0x327)],_0x4ac641['hasPrivate']=!!_0x4ac641[_0x4b2d7e(0x237)];if(_0x2da51a&&!_0x4ac641[_0x4b2d7e(0x375)])throw new Error(_0x4b2d7e(0x366));if(_0x3bd26c&&!_0x4ac641[_0x4b2d7e(0x28f)])throw new Error(_0x4b2d7e(0x287));}if(_0x4ac641['hasPrivate']&&_0x4ac641[_0x4b2d7e(0x30f)]){let _0x5f0409='';try{_0x5f0409=await showPasswordModal('Protected\x20Private\x20Key','This\x20private\x20key\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import\x20it:',![]);}catch(_0x293117){throw new Error(_0x4b2d7e(0x253));}if(!_0x5f0409)throw new Error('Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20private\x20key');_0x4ac641[_0x4b2d7e(0x3c4)]=_0x5f0409;}const _0xa6074f=keys[_0x4b2d7e(0x2b3)](_0x1b7e01=>_0x1b7e01['id']===_0x4ac641['id']);let _0x532389=![],_0xff8931=-0x1;if(_0xa6074f>=0x0){const _0x4e82b8=keys[_0xa6074f];if(_0x4ac641[_0x4b2d7e(0x375)]&&!_0x4e82b8[_0x4b2d7e(0x375)]&&_0x4e82b8[_0x4b2d7e(0x28f)])_0x532389=!![],_0xff8931=_0xa6074f;else _0x4ac641[_0x4b2d7e(0x28f)]&&!_0x4e82b8[_0x4b2d7e(0x28f)]&&_0x4e82b8[_0x4b2d7e(0x375)]&&(_0x532389=!![],_0xff8931=_0xa6074f);}else _0x4ac641[_0x4b2d7e(0x39c)]&&(_0xff8931=keys[_0x4b2d7e(0x2b3)](_0x42f650=>_0x42f650['publicKeyHash']===_0x4ac641[_0x4b2d7e(0x39c)]&&_0x42f650[_0x4b2d7e(0x30d)]===_0x4ac641[_0x4b2d7e(0x30d)]&&(_0x42f650[_0x4b2d7e(0x375)]&&!_0x42f650[_0x4b2d7e(0x28f)]&&_0x4ac641['hasPublic']||_0x42f650[_0x4b2d7e(0x28f)]&&!_0x42f650['hasPrivate']&&_0x4ac641[_0x4b2d7e(0x375)])),_0xff8931>=0x0&&(_0x532389=!![]));if(_0x532389&&_0xff8931>=0x0){const _0x19f766=confirm('This\x20appears\x20to\x20be\x20the\x20'+(_0x4ac641['hasPrivate']?'private':_0x4b2d7e(0x1eb))+_0x4b2d7e(0x37e)+_0x4b2d7e(0x328));if(_0x19f766){const _0x246b6f=keys[_0xff8931];_0x4ac641['hasPrivate']&&!_0x246b6f[_0x4b2d7e(0x375)]&&(_0x246b6f[_0x4b2d7e(0x237)]=_0x4ac641['privateKey'],_0x246b6f['hasPrivate']=!![],_0x4ac641[_0x4b2d7e(0x30f)]&&(_0x246b6f[_0x4b2d7e(0x30f)]=!![],_0x246b6f[_0x4b2d7e(0x3ce)]=_0x4ac641[_0x4b2d7e(0x3ce)],_0x246b6f['iv']=_0x4ac641['iv'])),_0x4ac641[_0x4b2d7e(0x28f)]&&!_0x246b6f[_0x4b2d7e(0x28f)]&&(_0x246b6f[_0x4b2d7e(0x327)]=_0x4ac641[_0x4b2d7e(0x327)],_0x246b6f[_0x4b2d7e(0x28f)]=!![],_0x4ac641[_0x4b2d7e(0x39c)]&&(_0x246b6f['publicKeyHash']=_0x4ac641['publicKeyHash'])),_0x246b6f[_0x4b2d7e(0x2f7)]=_0x246b6f['id'],await saveKeys(),showStatus(_0x4b2d7e(0x374),_0x4b2d7e(0x309)+_0x246b6f['name']+_0x4b2d7e(0x241)+(_0x4ac641['hasPrivate']?_0x4b2d7e(0x274):_0x4b2d7e(0x1eb))+_0x4b2d7e(0x390)+determineKeySecurityLevel(_0x246b6f)[_0x4b2d7e(0x37f)](),'success');}else _0x4ac641['id']=crypto[_0x4b2d7e(0x22d)](),keys[_0x4b2d7e(0x208)](_0x4ac641),await saveKeys(),showStatus('keyStatus',_0x4b2d7e(0x309)+_0x4ac641[_0x4b2d7e(0x383)]+_0x4b2d7e(0x348),_0x4b2d7e(0x28b));}else{if(_0xa6074f>=0x0){const _0x2fc058=confirm(_0x4b2d7e(0x1f6)+_0x4ac641[_0x4b2d7e(0x383)]+_0x4b2d7e(0x232));_0x2fc058?keys[_0xa6074f]=_0x4ac641:(_0x4ac641['id']=crypto[_0x4b2d7e(0x22d)](),keys[_0x4b2d7e(0x208)](_0x4ac641)),await saveKeys(),showStatus(_0x4b2d7e(0x374),_0x4b2d7e(0x309)+_0x4ac641[_0x4b2d7e(0x383)]+_0x4b2d7e(0x393),'success');}else{keys[_0x4b2d7e(0x208)](_0x4ac641),await saveKeys();if(_0x4ac641['type']===_0x4b2d7e(0x3be))showStatus(_0x4b2d7e(0x374),_0x4b2d7e(0x2f1)+_0x4ac641[_0x4b2d7e(0x383)]+_0x4b2d7e(0x393),_0x4b2d7e(0x28b));else{if(_0x4ac641[_0x4b2d7e(0x375)]&&_0x4ac641[_0x4b2d7e(0x28f)])showStatus(_0x4b2d7e(0x374),_0x4b2d7e(0x213)+_0x4ac641[_0x4b2d7e(0x383)]+_0x4b2d7e(0x393),_0x4b2d7e(0x28b));else _0x4ac641['hasPrivate']?showStatus(_0x4b2d7e(0x374),_0x4b2d7e(0x29d)+_0x4ac641[_0x4b2d7e(0x383)]+'\x22\x20imported\x20successfully',_0x4b2d7e(0x28b)):showStatus(_0x4b2d7e(0x374),_0x4b2d7e(0x280)+_0x4ac641[_0x4b2d7e(0x383)]+_0x4b2d7e(0x393),_0x4b2d7e(0x28b));}}}}catch(_0x3c544d){console[_0x4b2d7e(0x3b8)](_0x4b2d7e(0x345),_0x3c544d),showStatus(_0x4b2d7e(0x374),_0x4b2d7e(0x217)+_0x3c544d[_0x4b2d7e(0x24b)],_0x4b2d7e(0x3b8));}finally{setLoading(![]),document['getElementById']('keyFileInput')[_0x4b2d7e(0x24c)]='';}},_0x38dd82[_0x141de5(0x37a)]=function(){const _0x5717a9=_0x141de5;setLoading(![]),showStatus('keyStatus','Error\x20reading\x20the\x20key\x20file','error'),document[_0x5717a9(0x38b)](_0x5717a9(0x3bf))['value']='';},_0x38dd82['readAsText'](_0x65a02e);}catch(_0x5f1273){console[_0x141de5(0x3b8)]('Import\x20error:',_0x5f1273),showStatus('keyStatus',_0x141de5(0x217)+_0x5f1273[_0x141de5(0x24b)],_0x141de5(0x3b8)),setLoading(![]),document[_0x141de5(0x38b)](_0x141de5(0x3bf))['value']='';}}async function exportAllKeys(){const _0x3edd19=_0x1df063;try{if(keys[_0x3edd19(0x392)]===0x0){showStatus(_0x3edd19(0x374),_0x3edd19(0x20c),_0x3edd19(0x319));return;}let _0x39034b='';try{_0x39034b=await showPasswordModal(_0x3edd19(0x32f),_0x3edd19(0x298),!![]);}catch(_0x38854e){return;}let _0x53d2a1;if(_0x39034b){const _0x499d53=JSON[_0x3edd19(0x2ab)](keys),_0x1bdb1e=new TextEncoder()[_0x3edd19(0x3c2)](_0x499d53),_0x3443b5=window[_0x3edd19(0x2b6)][_0x3edd19(0x269)](new Uint8Array(0x10)),_0x367705=await deriveKeyFromPassword(_0x39034b,_0x3443b5),_0x519fba=window[_0x3edd19(0x2b6)][_0x3edd19(0x269)](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0x331eb0=await encryptWithDerivedKey(_0x367705,_0x1bdb1e,_0x519fba);_0x53d2a1=JSON['stringify']({'format':_0x3edd19(0x2cd),'salt':arrayBufferToBase64(_0x3443b5),'iv':arrayBufferToBase64(_0x519fba),'data':arrayBufferToBase64(_0x331eb0)});}else{const _0x45af2a=confirm('WARNING:\x20Exporting\x20keys\x20without\x20a\x20password\x20is\x20not\x20secure.\x20Anyone\x20with\x20access\x20to\x20this\x20file\x20will\x20be\x20able\x20to\x20use\x20your\x20keys.\x20Continue\x20anyway?');if(!_0x45af2a)return;_0x53d2a1=JSON[_0x3edd19(0x2ab)](keys);}const _0x3e6f40=new Blob([_0x53d2a1],{'type':'application/octet-stream'}),_0x20327b=URL[_0x3edd19(0x282)](_0x3e6f40),_0x173693=document[_0x3edd19(0x35d)]('a');_0x173693[_0x3edd19(0x3ab)]=_0x20327b,_0x173693['download']=_0x3edd19(0x222),document[_0x3edd19(0x3a1)][_0x3edd19(0x285)](_0x173693),_0x173693['click'](),document['body'][_0x3edd19(0x28e)](_0x173693),URL[_0x3edd19(0x2c9)](_0x20327b),showStatus(_0x3edd19(0x374),_0x3edd19(0x32c),_0x3edd19(0x28b));}catch(_0xa02169){console[_0x3edd19(0x3b8)]('Export\x20error:',_0xa02169),showStatus(_0x3edd19(0x374),_0x3edd19(0x22b)+_0xa02169['message'],_0x3edd19(0x3b8));}}function createStateFileInput(){const _0x486585=_0x1df063;let _0x52aa18=document[_0x486585(0x38b)](_0x486585(0x235));return!_0x52aa18&&(_0x52aa18=document['createElement']('input'),_0x52aa18[_0x486585(0x30d)]=_0x486585(0x3c9),_0x52aa18['id']=_0x486585(0x235),_0x52aa18[_0x486585(0x2ba)]=_0x486585(0x306),_0x52aa18[_0x486585(0x246)][_0x486585(0x386)]='none',document[_0x486585(0x3a1)]['appendChild'](_0x52aa18),_0x52aa18[_0x486585(0x346)](_0x486585(0x22e),handleStateFileSelect)),_0x52aa18;}async function handleStateFileSelect(_0x6fc96b){const _0x232c23=_0x1df063;try{const _0x3efb8a=_0x6fc96b[_0x232c23(0x22f)][_0x232c23(0x3cd)];if(!_0x3efb8a||_0x3efb8a[_0x232c23(0x392)]===0x0)return;setLoading(!![]);const _0x19df2e=_0x3efb8a[0x0],_0x1167fe=new FileReader();_0x1167fe[_0x232c23(0x384)]=async function(_0x131ad6){const _0xb40f75=_0x232c23;try{const _0x5b53a8=_0x131ad6['target']['result'];let _0x44076d;try{_0x44076d=JSON[_0xb40f75(0x295)](_0x5b53a8);}catch(_0x42b9b5){throw new Error(_0xb40f75(0x32d));}if(_0x44076d[_0xb40f75(0x21e)]===_0xb40f75(0x2cd)){let _0x59e015='';try{_0x59e015=await showPasswordModal(_0xb40f75(0x223),_0xb40f75(0x233),![]);}catch(_0xd48395){throw new Error(_0xb40f75(0x23b));}if(!_0x59e015)throw new Error(_0xb40f75(0x23b));const _0x1c5b16=base64ToArrayBuffer(_0x44076d[_0xb40f75(0x3ce)]),_0x1233d5=base64ToArrayBuffer(_0x44076d['iv']),_0x41b1aa=base64ToArrayBuffer(_0x44076d['data']),_0x11d7ab=await deriveKeyFromPassword(_0x59e015,_0x1c5b16),_0x5740e1=await decryptWithDerivedKey(_0x11d7ab,_0x41b1aa,_0x1233d5),_0x391e1a=new TextDecoder()['decode'](_0x5740e1);_0x44076d=JSON[_0xb40f75(0x295)](_0x391e1a);}if(!Array[_0xb40f75(0x2c8)](_0x44076d))throw new Error(_0xb40f75(0x30e));const _0x37c755=confirm('This\x20will\x20import\x20'+_0x44076d[_0xb40f75(0x392)]+_0xb40f75(0x312));if(!_0x37c755)return;keys=_0x44076d,await saveKeys(),showStatus(_0xb40f75(0x374),'Application\x20state\x20with\x20'+_0x44076d[_0xb40f75(0x392)]+_0xb40f75(0x38d),_0xb40f75(0x28b));}catch(_0x244dea){console[_0xb40f75(0x3b8)](_0xb40f75(0x206),_0x244dea),showStatus('keyStatus','State\x20import\x20error:\x20'+_0x244dea[_0xb40f75(0x24b)],_0xb40f75(0x3b8));}finally{setLoading(![]),document[_0xb40f75(0x38b)](_0xb40f75(0x235))['value']='';}},_0x1167fe[_0x232c23(0x37a)]=function(){const _0x5b978d=_0x232c23;setLoading(![]),showStatus(_0x5b978d(0x374),_0x5b978d(0x37c),_0x5b978d(0x3b8)),document[_0x5b978d(0x38b)]('stateFileInput')[_0x5b978d(0x24c)]='';},_0x1167fe[_0x232c23(0x3ae)](_0x19df2e);}catch(_0xfb9677){console[_0x232c23(0x3b8)](_0x232c23(0x206),_0xfb9677),showStatus(_0x232c23(0x374),_0x232c23(0x277)+_0xfb9677[_0x232c23(0x24b)],_0x232c23(0x3b8)),setLoading(![]),document['getElementById'](_0x232c23(0x235))[_0x232c23(0x24c)]='';}}function importState(){const _0x1e802e=createStateFileInput();_0x1e802e['click']();}async function secureClipboardCopy(_0x3fcdbe){const _0x19d6eb=_0x1df063;try{return await navigator[_0x19d6eb(0x2d0)]['writeText'](_0x3fcdbe),!![];}catch(_0x362e94){return console[_0x19d6eb(0x201)](_0x19d6eb(0x39e),_0x362e94),![];}}function deleteKey(_0xa1382f){const _0x33b325=_0x1df063,_0x880ded=keys['find'](_0x3e39b3=>_0x3e39b3['id']===_0xa1382f);if(!_0x880ded){alert(_0x33b325(0x2af));return;}const _0x295c96=window[_0x33b325(0x382)](_0x33b325(0x369)+_0x880ded[_0x33b325(0x383)]+_0x33b325(0x320));_0x295c96&&(keys=keys[_0x33b325(0x39b)](_0x5d4055=>_0x5d4055['id']!==_0xa1382f),saveKeys(),showStatus(_0x33b325(0x374),_0x33b325(0x309)+_0x880ded['name']+'\x22\x20deleted\x20successfully',_0x33b325(0x28b)));}function showStatus(_0x5a70f3,_0x1d7f62,_0x36f9d3){const _0x1b6470=_0x1df063,_0x1b8325=document[_0x1b6470(0x38b)](_0x5a70f3);_0x1b8325['textContent']=validator[_0x1b6470(0x31c)](_0x1d7f62),_0x1b8325[_0x1b6470(0x3bd)]=_0x1b6470(0x210)+_0x36f9d3,setTimeout(()=>{const _0xc529d6=_0x1b6470;_0x1b8325[_0xc529d6(0x2a2)]===validator['sanitizeHTML'](_0x1d7f62)&&(_0x1b8325['className']=_0xc529d6(0x2e8));},0x2710);}let passwordModalCallback=null,passwordModalResolve=null,passwordModalReject=null;function showPasswordModal(_0xbf1c72,_0x121dd8,_0x45c6e4=![]){return new Promise((_0x169fc3,_0x4bddad)=>{const _0x531aed=_0x36cb,_0x4f596f=document[_0x531aed(0x38b)](_0x531aed(0x2aa)),_0x8d0d9=document[_0x531aed(0x38b)](_0x531aed(0x2ed)),_0x46be2c=document[_0x531aed(0x38b)](_0x531aed(0x2db)),_0x55820e=document[_0x531aed(0x38b)](_0x531aed(0x356)),_0xe3ec1c=document[_0x531aed(0x38b)](_0x531aed(0x204)),_0x256978=document[_0x531aed(0x38b)](_0x531aed(0x2f2));_0x8d0d9[_0x531aed(0x2a2)]=_0xbf1c72,_0x46be2c[_0x531aed(0x2a2)]=_0x121dd8,_0x55820e['value']='',_0xe3ec1c[_0x531aed(0x3bd)]=_0x531aed(0x35a),_0x256978[_0x531aed(0x2a2)]='',_0xe3ec1c[_0x531aed(0x246)][_0x531aed(0x386)]=_0x45c6e4?_0x531aed(0x224):'none',_0x256978[_0x531aed(0x246)][_0x531aed(0x386)]=_0x45c6e4?'block':_0x531aed(0x303),passwordModalResolve=_0x169fc3,passwordModalReject=_0x4bddad,_0x4f596f[_0x531aed(0x246)][_0x531aed(0x386)]=_0x531aed(0x310),setTimeout(()=>{const _0x47a04e=_0x531aed;_0x55820e[_0x47a04e(0x2ef)]();},0x64);});}function confirmPasswordModal(){const _0xa48c0c=_0x1df063,_0x5b8c06=document[_0xa48c0c(0x38b)](_0xa48c0c(0x356)),_0xdc896e=_0x5b8c06[_0xa48c0c(0x24c)],_0x2c4cbc=document[_0xa48c0c(0x38b)](_0xa48c0c(0x204)),_0x165a67=document[_0xa48c0c(0x38b)](_0xa48c0c(0x2f2));_0x2c4cbc[_0xa48c0c(0x3bd)]=_0xa48c0c(0x35a),_0x165a67[_0xa48c0c(0x2a2)]='',document[_0xa48c0c(0x38b)](_0xa48c0c(0x2aa))['style'][_0xa48c0c(0x386)]=_0xa48c0c(0x303),passwordModalResolve&&(passwordModalResolve(_0xdc896e),passwordModalResolve=null,passwordModalReject=null);}function cancelPasswordModal(){const _0x64335c=_0x1df063,_0x1916db=document[_0x64335c(0x38b)](_0x64335c(0x356)),_0x4bdb06=document['getElementById'](_0x64335c(0x204)),_0x45faaa=document['getElementById'](_0x64335c(0x2f2));_0x1916db[_0x64335c(0x24c)]='',_0x4bdb06[_0x64335c(0x3bd)]=_0x64335c(0x35a),_0x45faaa[_0x64335c(0x2a2)]='',document[_0x64335c(0x38b)](_0x64335c(0x2aa))[_0x64335c(0x246)][_0x64335c(0x386)]=_0x64335c(0x303),passwordModalReject&&(passwordModalReject(new Error(_0x64335c(0x25f))),passwordModalResolve=null,passwordModalReject=null);}function updateModalPasswordStrength(){const _0x2aea3f=_0x1df063,_0x50535e=document[_0x2aea3f(0x38b)](_0x2aea3f(0x356))[_0x2aea3f(0x24c)],_0x57391e=validator['measurePasswordStrength'](_0x50535e),_0x12b1c=document[_0x2aea3f(0x38b)](_0x2aea3f(0x204)),_0x54dbad=document[_0x2aea3f(0x38b)](_0x2aea3f(0x2f2));_0x12b1c[_0x2aea3f(0x3bd)]='password-strength',_0x50535e?(_0x12b1c['classList'][_0x2aea3f(0x260)](_0x57391e[_0x2aea3f(0x361)]),_0x54dbad[_0x2aea3f(0x2a2)]=_0x57391e[_0x2aea3f(0x37d)]):_0x54dbad[_0x2aea3f(0x2a2)]='';}async function copyToClipboard(_0x5379c4,_0x49d313){const _0x399de1=_0x1df063,_0x367f0c=document['getElementById'](_0x5379c4)[_0x399de1(0x24c)];if(!_0x367f0c){showStatus(_0x49d313,_0x399de1(0x226),'error');return;}const _0x1a37d5=await secureClipboardCopy(_0x367f0c);if(_0x1a37d5)showStatus(_0x49d313,_0x399de1(0x273),_0x399de1(0x28b)),appSettings[_0x399de1(0x30b)]&&scheduleClipboardClear();else{showStatus(_0x49d313,_0x399de1(0x2ac),'warning');const _0x28ac22=document[_0x399de1(0x38b)](_0x5379c4);_0x28ac22['focus'](),_0x28ac22[_0x399de1(0x31e)]();}}function toggleDarkMode(){const _0x427069=_0x1df063,_0x522441=document[_0x427069(0x38b)](_0x427069(0x350))[_0x427069(0x385)];_0x522441?document[_0x427069(0x3a1)][_0x427069(0x2cc)][_0x427069(0x260)](_0x427069(0x24a)):document[_0x427069(0x3a1)]['classList'][_0x427069(0x332)](_0x427069(0x24a)),localStorage[_0x427069(0x266)](_0x427069(0x304),_0x522441);}function arrayBufferToBase64(_0x15d9c7){const _0x5cbd87=_0x1df063,_0x29e21a=new Uint8Array(_0x15d9c7);let _0x45c995='';for(let _0x50150a=0x0;_0x50150a<_0x29e21a[_0x5cbd87(0x271)];_0x50150a++){_0x45c995+=String[_0x5cbd87(0x322)](_0x29e21a[_0x50150a]);}return btoa(_0x45c995);}function base64ToArrayBuffer(_0xbb49d3){const _0x1340fe=_0x1df063;try{const _0x517e7e=atob(_0xbb49d3),_0x1d6ef1=new Uint8Array(_0x517e7e[_0x1340fe(0x392)]);for(let _0x4c410d=0x0;_0x4c410d<_0x517e7e[_0x1340fe(0x392)];_0x4c410d++){_0x1d6ef1[_0x4c410d]=_0x517e7e['charCodeAt'](_0x4c410d);}return _0x1d6ef1['buffer'];}catch(_0x38e264){console[_0x1340fe(0x3b8)](_0x1340fe(0x2ff),_0x38e264);throw new Error(_0x1340fe(0x3ac)+_0x38e264['message']);}}async function encryptData(_0x1f77c2,_0x3df380){const _0x3bc04c=_0x1df063;if(_0x3df380[_0x3bc04c(0x30d)]==='aes')return await encryptWithAES(_0x1f77c2,_0x3df380);else{if(_0x3df380[_0x3bc04c(0x30d)]===_0x3bc04c(0x2d6)||_0x3df380['type']==='rsa-4096')return await encryptWithRSA(_0x1f77c2,_0x3df380);else{if(_0x3df380['type']===_0x3bc04c(0x3a3)||_0x3df380[_0x3bc04c(0x30d)]==='ecc-p384')return await encryptWithECC(_0x1f77c2,_0x3df380);else throw new Error(_0x3bc04c(0x267));}}}async function decryptData(_0x4fa27c,_0x36ec5a){const _0x3f37e7=_0x1df063;if(_0x4fa27c[_0x3f37e7(0x311)]===0x2){if(_0x36ec5a['type']===_0x3f37e7(0x3be))return await decryptWithAES(_0x4fa27c,_0x36ec5a);else{if(_0x36ec5a[_0x3f37e7(0x30d)]===_0x3f37e7(0x2d6)||_0x36ec5a[_0x3f37e7(0x30d)]==='rsa-4096')return await decryptWithRSA(_0x4fa27c,_0x36ec5a);else{if(_0x36ec5a[_0x3f37e7(0x30d)]==='ecc'||_0x36ec5a[_0x3f37e7(0x30d)]==='ecc-p384')return await decryptWithECC(_0x4fa27c,_0x36ec5a);}}}if(_0x4fa27c['algorithm']===AES_CONFIG[_0x3f37e7(0x2ca)])return await decryptWithAES(_0x4fa27c,_0x36ec5a);else{if(_0x4fa27c[_0x3f37e7(0x39f)]===RSA_CONFIG[_0x3f37e7(0x3c0)]+'+'+AES_CONFIG['MODE']||_0x4fa27c[_0x3f37e7(0x39f)]===_0x3f37e7(0x329))return await decryptWithRSA(_0x4fa27c,_0x36ec5a);else{if(_0x4fa27c[_0x3f37e7(0x39f)]==='ECDH+'+AES_CONFIG[_0x3f37e7(0x2ca)]||_0x4fa27c[_0x3f37e7(0x39f)]===_0x3f37e7(0x20d))return await decryptWithECC(_0x4fa27c,_0x36ec5a);else throw new Error('Unsupported\x20encryption\x20algorithm:\x20'+_0x4fa27c[_0x3f37e7(0x39f)]);}}}async function deriveKeyFromPassword(_0x1630a5,_0x4401d8){const _0x2fe962=_0x1df063,_0x12d65a=new TextEncoder()['encode'](_0x1630a5),_0x2f294b=await window['crypto'][_0x2fe962(0x3b9)][_0x2fe962(0x212)](_0x2fe962(0x321),_0x12d65a,{'name':_0x2fe962(0x26b)},![],[_0x2fe962(0x1ff)]);return window['crypto'][_0x2fe962(0x3b9)]['deriveKey']({'name':'PBKDF2','salt':_0x4401d8,'iterations':PBKDF2_CONFIG[_0x2fe962(0x249)],'hash':PBKDF2_CONFIG['HASH']},_0x2f294b,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG[_0x2fe962(0x39d)]},!![],['encrypt',_0x2fe962(0x331)]);}async function encryptWithDerivedKey(_0xa52060,_0x4788c2,_0x209d93){const _0x470f03=_0x1df063;return window[_0x470f03(0x2b6)]['subtle'][_0x470f03(0x2bf)]({'name':AES_CONFIG[_0x470f03(0x2ca)],'iv':_0x209d93,'tagLength':AES_CONFIG[_0x470f03(0x2e0)]},_0xa52060,_0x4788c2);}async function decryptWithDerivedKey(_0x1fafb4,_0x1855ca,_0x189767){const _0x25ee33=_0x1df063;return window[_0x25ee33(0x2b6)][_0x25ee33(0x3b9)][_0x25ee33(0x331)]({'name':AES_CONFIG[_0x25ee33(0x2ca)],'iv':_0x189767,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x1fafb4,_0x1855ca);}async function importAESKey(_0x13dffa){const _0x4463cf=_0x1df063;return window['crypto'][_0x4463cf(0x3b9)]['importKey'](_0x4463cf(0x321),_0x13dffa,{'name':AES_CONFIG[_0x4463cf(0x2ca)],'length':AES_CONFIG[_0x4463cf(0x39d)]},![],[_0x4463cf(0x2bf),_0x4463cf(0x331)]);}async function importRSAPublicKey(_0x200f08,_0x88300b){const _0x58be60=_0x1df063;return window[_0x58be60(0x2b6)][_0x58be60(0x3b9)][_0x58be60(0x212)](_0x58be60(0x36d),_0x200f08,{'name':RSA_CONFIG[_0x58be60(0x3c0)],'hash':RSA_CONFIG['HASH']},![],[_0x58be60(0x2bf)]);}async function importRSAPrivateKey(_0x3b9208,_0x393bcf){const _0x7b9e76=_0x1df063;return window[_0x7b9e76(0x2b6)][_0x7b9e76(0x3b9)]['importKey']('pkcs8',_0x3b9208,{'name':RSA_CONFIG['ALGORITHM'],'hash':RSA_CONFIG[_0x7b9e76(0x27e)]},![],[_0x7b9e76(0x331)]);}async function importECCPublicKey(_0x2e673e,_0xb25ca0){const _0x3def13=_0x1df063;return window['crypto'][_0x3def13(0x3b9)]['importKey']('spki',_0x2e673e,{'name':_0x3def13(0x228),'namedCurve':_0xb25ca0},![],[]);}async function importECCPrivateKey(_0x4c4758,_0x2dc9f7){const _0x5b9f9d=_0x1df063;return window[_0x5b9f9d(0x2b6)][_0x5b9f9d(0x3b9)]['importKey']('pkcs8',_0x4c4758,{'name':_0x5b9f9d(0x228),'namedCurve':_0x2dc9f7},![],[_0x5b9f9d(0x1ff),_0x5b9f9d(0x36e)]);}async function saveToDatabase(_0xef0932,_0x4efffb){return new Promise((_0x22839a,_0x2be8d9)=>{const _0x31774d=_0x36cb;if(!db){_0x2be8d9(new Error(_0x31774d(0x27d)));return;}const _0x11ed59=db[_0x31774d(0x395)](_0xef0932,'readwrite'),_0x308c3f=_0x11ed59['objectStore'](_0xef0932),_0x4d9782=_0x308c3f['put'](_0x4efffb);_0x4d9782[_0x31774d(0x265)]=()=>_0x22839a(),_0x4d9782['onerror']=()=>_0x2be8d9(_0x4d9782[_0x31774d(0x3b8)]);});}async function getFromDatabase(_0x3ad2ef,_0x2f4ea0){return new Promise((_0x1d042b,_0x44f21b)=>{const _0x1bf709=_0x36cb;if(!db){_0x44f21b(new Error(_0x1bf709(0x27d)));return;}const _0xfd6b9=db[_0x1bf709(0x395)](_0x3ad2ef,_0x1bf709(0x313)),_0x3cda5e=_0xfd6b9[_0x1bf709(0x21b)](_0x3ad2ef),_0x35aa59=_0x3cda5e[_0x1bf709(0x367)](_0x2f4ea0);_0x35aa59[_0x1bf709(0x265)]=()=>_0x1d042b(_0x35aa59[_0x1bf709(0x2b9)]),_0x35aa59[_0x1bf709(0x37a)]=()=>_0x44f21b(_0x35aa59['error']);});}async function getAllFromDatabase(_0x17cba7){return new Promise((_0x25cc7b,_0x1d98d8)=>{const _0xf39b13=_0x36cb;if(!db){_0x1d98d8(new Error(_0xf39b13(0x27d)));return;}const _0x392457=db[_0xf39b13(0x395)](_0x17cba7,_0xf39b13(0x313)),_0x5e18b5=_0x392457[_0xf39b13(0x21b)](_0x17cba7),_0x23a79c=_0x5e18b5[_0xf39b13(0x336)]();_0x23a79c[_0xf39b13(0x265)]=()=>_0x25cc7b(_0x23a79c[_0xf39b13(0x2b9)]),_0x23a79c[_0xf39b13(0x37a)]=()=>_0x1d98d8(_0x23a79c[_0xf39b13(0x3b8)]);});}async function clearDatabase(_0x220e22){return new Promise((_0x541338,_0x2cd0a2)=>{const _0x1c83df=_0x36cb;if(!db){_0x2cd0a2(new Error(_0x1c83df(0x27d)));return;}const _0xfe1975=db[_0x1c83df(0x395)](_0x220e22,_0x1c83df(0x333)),_0x2e391e=_0xfe1975[_0x1c83df(0x21b)](_0x220e22),_0x2b15b6=_0x2e391e[_0x1c83df(0x1f9)]();_0x2b15b6[_0x1c83df(0x265)]=()=>_0x541338(),_0x2b15b6[_0x1c83df(0x37a)]=()=>_0x2cd0a2(_0x2b15b6[_0x1c83df(0x3b8)]);});}window[_0x1df063(0x28c)]=exportKey,window[_0x1df063(0x32e)]=exportPrivateKey,window[_0x1df063(0x3a0)]=deleteKey;let deferredPrompt;const installBtn=document[_0x1df063(0x38b)]('installBtn'),installContainer=document['getElementById']('installContainer'),installStatus=document['getElementById'](_0x1df063(0x335));function _0x5c1d(){const _0x45278f=['high','Export\x20error:\x20','decryptionKey','randomUUID','change','target','accepted','encryptionKey','\x22\x20already\x20exists.\x20Overwrite?','This\x20state\x20file\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import:','Please\x20use\x20a\x20stronger\x20password:\x20','stateFileInput','Missing\x20required\x20key\x20properties','privateKey','Invalid\x20encrypted\x20message\x20format\x20or\x20OBF\x20Key\x20mismatch.\x20Ensure\x20the\x20OBF\x20key\x20is\x20correct\x20(closer\x20is\x20reverse\x20of\x20opener)\x20and\x20the\x20message\x20structure\x20is\x20intact.','Warning:\x20Exporting\x20a\x20private\x20key\x20without\x20password\x20protection\x20is\x20a\x20security\x20risk.\x20Continue\x20anyway?','userChoice','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20state\x20file','keySize','setDate','passwordModalConfirm','245ikWtLS','medium','\x22\x20updated\x20with\x20','LemonadeSecureDB','.*$','\x22\x20downloaded\x20successfully','then','style',')\x20have\x20been\x20permanently\x20deleted','\x20exported\x20as\x20','ITERATIONS','dark-mode','message','value','encryptBtn','Database\x20initialization\x20failed.\x20Using\x20less\x20secure\x20localStorage\x20instead.','keyName','catch','ecc-p384','match','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20private\x20key','passwordStrength','keydown','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','contains','decrypted_file','encryptedKey','pkcs8','keys','size','clearDecryptBtn','decrypted.txt','Password\x20entry\x20cancelled','add','matches','decryptedOutput','generateKey','readAsArrayBuffer','onsuccess','setItem','Unsupported\x20key\x20type','Error\x20saving\x20keys:','getRandomValues','key','PBKDF2','AES\x20encryption\x20error:','clearEncryptedMessageBtn','settings','Unsupported\x20key\x20type:\x20','.lim','byteLength','saveSettingsBtn','Copied\x20to\x20clipboard','private','3789KExnHI','Please\x20select\x20a\x20decryption\x20key','State\x20import\x20error:\x20','\x20[Public]','keyType','generateKeyBtn','resetSettingsBtn','public\x20key','Database\x20not\x20initialized','HASH','User\x20response\x20to\x20install\x20prompt:\x20','Public\x20key\x20\x22','(display-mode:\x20standalone)','createObjectURL','text','Installation\x20is\x20now\x20available!','appendChild','removeItem','This\x20.lim\x20file\x20does\x20not\x20contain\x20a\x20public\x20key','decode','Bytes','100650gWujyx','success','exportKey','pbkdf2Iterations','removeChild','hasPublic','split','keyExpiry','<button\x20class=\x22btn-secondary\x20private-key-btn\x22\x20onclick=\x22exportPrivateKey(\x27','preventDefault','Missing\x20encrypted\x20private\x20key\x20data','parse','\x27)\x22>Delete</button>','encryptBrowseBtn','Please\x20enter\x20a\x20password\x20to\x20protect\x20your\x20key\x20backup.\x20This\x20is\x20highly\x20recommended\x20for\x20security.','decryptBtn','Medium\x20-\x20Add\x20more\x20variety\x20or\x20length\x20for\x20better\x20security','<span\x20class=\x22key-pair-badge\x20public\x22>PUBLIC\x20KEY</span>','hostname','Private\x20key\x20\x22','scope','indexedDB','Error\x20saving\x20settings:','P-256','textContent','134150emXVUm','Tab\x20button\x20clicked:','forEach','toLowerCase','keyPassword','encryptObfKey','Error\x20loading\x20settings\x20from\x20localStorage:','passwordModal','stringify','Unable\x20to\x20copy\x20automatically.\x20Please\x20select\x20the\x20text\x20and\x20press\x20Ctrl+C\x20(or\x20⌘+C)\x20to\x20copy\x20manually.','prompt','curve','Key\x20not\x20found','Key\x20name\x20can\x20only\x20contain\x20letters,\x20numbers,\x20spaces,\x20and\x20basic\x20punctuation\x20(._-)','Unable\x20to\x20read\x20the\x20file.','option','findIndex','register','innerHTML','crypto','Error\x20generating\x20key:\x20','CURVE','result','accept','created','serviceWorker','toISOString','beforeinstallprompt','encrypt','click','\x20[Full\x20Pair]','buffer','expiry','appinstalled','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22deleteKey(\x27','P-384','KEY_SIZE','isArray','revokeObjectURL','MODE','Password\x20protection\x20is\x20required\x20by\x20your\x20security\x20settings','classList','LemonadeProtectedBackup','AES-GCM','Your\x20browser\x20does\x20not\x20support\x20PWA\x20installation\x20features.','clipboard','encryptedMessage','querySelectorAll','Please\x20select\x20an\x20encryption\x20key','setAttribute','copyEncryptedBtn','rsa','sessionOnly','replace','ECDH+','objectStoreNames','passwordModalMessage','RSA-2048','decryptFileInput','pow','Manual\x20garbage\x20collection\x20not\x20available','TAG_LENGTH','13256BhZBEX','ceil','low','decryptionPasswordGroup','toLocaleString','importStateBtn','decryptObfKey','status','querySelector','2299ihCtkJ','decryptionPassword','encryptionPassword','passwordModalTitle','data','focus','Error\x20saving\x20settings:\x20','Symmetric\x20key\x20\x22','passwordModalFeedback','Error\x20loading\x20keys:\x20','Switching\x20to\x20tab:','copyDecryptedBtn','[\x5cs\x5cS]+?','pairedKeyId','DOMContentLoaded','loadingOverlay','application/octet-stream','encryptFileInput','46692EOeUKB','clearEncryptMessageBtn','passwordFeedback','Base64\x20decoding\x20error:','File\x20\x22','This\x20key\x20does\x20not\x20have\x20a\x20private\x20key\x20component\x20to\x20export','Passwords\x20do\x20not\x20match','none','LemonadeDarkMode','ephemeralPublicKey','.state,application/octet-stream','exportAllKeysBtn','.lim,.lem','Key\x20\x22','digest','clearClipboard','useIndexedDB','type','Invalid\x20state\x20data\x20format','protected','flex','version','\x20keys\x20into\x20your\x20application.\x20Continue?','readonly','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Algorithm:\x20','matchMedia','function','floor','Failed\x20to\x20retrieve\x20decrypted\x20key\x20from\x20memory.','warning','\x20file','^.*?','sanitizeHTML','settingsStatus','select','slice','\x22?\x20This\x20action\x20cannot\x20be\x20undone.','raw','fromCharCode','app-settings','Missing\x20encrypted\x20key\x20data','removeDecryptFile','<option\x20value=\x22\x22>Select\x20a\x20key...</option>','publicKey','Would\x20you\x20like\x20to\x20merge\x20them\x20into\x20a\x20complete\x20key\x20pair?','RSA-OAEP+AES-GCM','\x20days\x20(','keypress','Application\x20state\x20exported\x20successfully','Invalid\x20state\x20file\x20format','exportPrivateKey','Secure\x20Your\x20Key\x20Backup','find','decrypt','remove','readwrite','enforceKeyExpiry','installStatus','getAll','Enter\x20Current\x20Password','passwordModalCancel','fileName','SHA-256','active','downloadDecryptedBtn','App\x20is\x20already\x20running\x20in\x20standalone\x20mode\x20(installed)','IV_LENGTH','File:\x20','Export\x20error:','Export\x20cancelled:\x20','Message\x20decrypted\x20successfully','Lemonade\x20is\x20running\x20as\x20an\x20installed\x20app','toLocaleDateString','Import\x20error:','addEventListener','Invalid\x20key\x20file\x20format','\x22\x20imported\x20as\x20separate\x20key','\x20🔒','Please\x20enter\x20a\x20message\x20or\x20add\x20a\x20file\x20to\x20encrypt','Escape','measurePasswordStrength','getItem','div','Strong\x20-\x20Good\x20password!','darkMode','createObjectStore','Do\x20you\x20want\x20to\x20continue?','Enter\x20the\x20current\x20key\x20password\x20to\x20continue:','has','store','passwordModalInput','Message\x20encrypted\x20successfully','test','Password\x20required\x20for\x20this\x20key','password-strength','558452dhLDNJ','Error\x20saving\x20keys:\x20','createElement','info','sensitiveData','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Created:\x20','strengthCategory','LemonadeKeys','WARNING:\x20Exporting\x20a\x20private\x20key\x20is\x20a\x20security\x20risk.\x20','Invalid\x20encrypted\x20message\x20format\x20or\x20OBF\x20Key\x20mismatch','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','This\x20.lem\x20file\x20does\x20not\x20contain\x20a\x20private\x20key','get','isValidKeyName','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20key\x20\x22','KEY_SIZE_4096','https:','true','spki','deriveBits','0\x20Bytes','Key\x20deletion\x20canceled','Settings\x20saved\x20successfully','protocol','WARNING:\x20This\x20will\x20permanently\x20delete\x20ALL\x20your\x20encryption\x20keys.\x20This\x20action\x20CANNOT\x20be\x20undone.\x0a\x0aAre\x20you\x20absolutely\x20sure\x20you\x20want\x20to\x20continue?','keyStatus','hasPrivate','Only\x20export\x20private\x20keys\x20if\x20you\x20absolutely\x20need\x20to\x20use\x20them\x20on\x20another\x20device.\x20','AES','min','set','onerror','.lmn','Error\x20reading\x20the\x20state\x20file','feedback','\x20key\x20part\x20of\x20an\x20existing\x20key.\x20','toUpperCase','encryptFileInfo','4OHgiKC','confirm','name','onload','checked','display','strong','importKeyBtn','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','rsa-4096','getElementById','2873178gliPtd','\x20keys\x20imported\x20successfully','charAt','Decryption\x20error:\x20','\x20key\x20part.\x20Security\x20level:\x20','download','length','\x22\x20imported\x20successfully','.install-note','transaction','decryptFileName','\x20-\x20','Key\x20data\x20and\x20password\x20are\x20required','.tab-btn','decryptFileInfo','filter','publicKeyHash','KEY_LENGTH','Modern\x20clipboard\x20API\x20failed:','algorithm','deleteKey','body','HKDF','ecc','enforcePwdProtection','_privateKey','data-tab','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-item-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','Error\x20generating\x20key:','data-filename','string','href','Invalid\x20base64\x20data:\x20','Password\x20is\x20required','readAsText','No\x20keys\x20to\x20delete','<span\x20class=\x22key-pair-badge\x20full\x22>FULL\x20KEY\x20PAIR</span>','AES\x20Decryption\x20error:','Error\x20loading\x20settings\x20from\x20database:','Key\x20expiration\x20is\x20required\x20by\x20your\x20security\x20settings','isFile','false','input','.tab-content','error','subtle','Installation\x20not\x20available\x20in\x20this\x20browser\x20or\x20app\x20is\x20already\x20installed','_cryptoKey','Encrypted\x20file\x20loaded\x20successfully.','className','aes','keyFileInput','ALGORITHM','RSA-OAEP','encode','score','_importPassword','3099670UMHNtc','All\x20keys\x20cleared\x20from\x20database','trim','Error\x20loading\x20keys:','file','File\x20downloaded\x20successfully','encryptMessage','getAttribute','files','salt','random','_publicKey','Are\x20you\x20sure\x20you\x20want\x20to\x20reset\x20all\x20settings\x20to\x20defaults?','public','Error\x20clearing\x20keys\x20from\x20database:','\x27)\x22>Export</button>','removeEncryptFile','Secure\x20Your\x20Private\x20Key','location','Incorrect\x20password\x20or\x20corrupted\x20private\x20key','Decryption\x20failed:\x20','localhost','<span\x20class=\x22security-badge\x20','fileSize','A\x20key\x20with\x20name\x20\x22','Please\x20enter\x20a\x20password\x20to\x20protect\x20this\x20private\x20key:','Encryption\x20error:','clear','Key\x20is\x20missing\x20salt\x20or\x20IV\x20data','Database\x20error:','downloadEncryptedBtn','disabled','encryptionPasswordGroup','deriveKey','<p>No\x20keys\x20available.\x20Generate\x20or\x20import\x20a\x20key\x20to\x20get\x20started.</p>','log','clearEncryptBtn','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','passwordModalStrength','\x20expired\x20key(s)\x20removed\x20for\x20security','State\x20import\x20error:','LemonadeSettings','push','No\x20encrypted\x20data\x20to\x20download','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22exportKey(\x27','decryptStatus','No\x20keys\x20available\x20to\x20export','ECDH+AES-GCM','\x5c$&','Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message','status\x20','decryptedBinaryData','importKey','Complete\x20asymmetric\x20key\x20pair\x20\x22','Enter','This\x20file\x20is\x20not\x20in\x20Lemonade\x20encrypted\x20format.\x20Try\x20again.','\x20key\x20\x22','Import\x20error:\x20','load','encryptedOutput','onupgradeneeded','objectStore','reverse','Failed\x20to\x20decrypt\x20key:\x20','format','endsWith','data-binary','Installation\x20was\x20canceled','Lemonade-state.state','Protected\x20State\x20File','block','encryptStatus','Nothing\x20to\x20copy','delete','ECDH','Service\x20Workers\x20not\x20supported\x20or\x20not\x20in\x20secure\x20context'];_0x5c1d=function(){return _0x45278f;};return _0x5c1d();}installBtn&&(installBtn['disabled']=!![]);window[_0x1df063(0x346)](_0x1df063(0x2be),_0x1deedf=>{const _0x48ece8=_0x1df063;_0x1deedf[_0x48ece8(0x293)](),deferredPrompt=_0x1deedf;if(installBtn){installBtn[_0x48ece8(0x1fd)]=![];const _0x44259=installContainer[_0x48ece8(0x2e9)](_0x48ece8(0x394));_0x44259&&(_0x44259[_0x48ece8(0x246)]['display']=_0x48ece8(0x303)),showStatus('installStatus',_0x48ece8(0x284),'success');}});installBtn&&installBtn['addEventListener'](_0x1df063(0x2c0),async()=>{const _0x49ab7d=_0x1df063;if(!deferredPrompt){showStatus(_0x49ab7d(0x335),_0x49ab7d(0x3ba),_0x49ab7d(0x319));return;}deferredPrompt[_0x49ab7d(0x2ad)]();const {outcome:_0x2a1f76}=await deferredPrompt[_0x49ab7d(0x23a)];console[_0x49ab7d(0x201)](_0x49ab7d(0x27f)+_0x2a1f76),_0x2a1f76===_0x49ab7d(0x230)?showStatus(_0x49ab7d(0x335),'Lemonade\x20has\x20been\x20installed\x20successfully!','success'):showStatus('installStatus',_0x49ab7d(0x221),_0x49ab7d(0x319)),deferredPrompt=null,installBtn[_0x49ab7d(0x1fd)]=!![];});window['addEventListener'](_0x1df063(0x2c4),()=>{const _0x369488=_0x1df063;console[_0x369488(0x201)]('Lemonade\x20was\x20installed'),deferredPrompt=null,installBtn&&(installBtn[_0x369488(0x1fd)]=!![]),showStatus(_0x369488(0x335),'Lemonade\x20has\x20been\x20installed\x20successfully!',_0x369488(0x28b));});_0x1df063(0x2bc)in navigator&&(window['location'][_0x1df063(0x372)]===_0x1df063(0x36b)||window[_0x1df063(0x1f0)][_0x1df063(0x29c)]===_0x1df063(0x1f3)||window[_0x1df063(0x1f0)][_0x1df063(0x29c)]==='127.0.0.1')?window['addEventListener'](_0x1df063(0x218),function(){const _0x12317b=_0x1df063;navigator['serviceWorker'][_0x12317b(0x2b4)]('sw.js')[_0x12317b(0x245)](function(_0x109616){const _0x3c6622=_0x12317b;console['log']('Service\x20Worker\x20registered\x20with\x20scope:',_0x109616[_0x3c6622(0x29e)]);})[_0x12317b(0x250)](function(_0x3aff39){const _0x2477ae=_0x12317b;console[_0x2477ae(0x3b8)]('Service\x20Worker\x20registration\x20failed:',_0x3aff39),showStatus(_0x2477ae(0x335),'Service\x20Worker\x20registration\x20failed.\x20PWA\x20features\x20unavailable.',_0x2477ae(0x319));});}):(console[_0x1df063(0x201)](_0x1df063(0x229)),installStatus&&(window[_0x1df063(0x1f0)][_0x1df063(0x372)]==='file:'?showStatus('installStatus','PWA\x20installation\x20requires\x20HTTPS.\x20You\x20are\x20viewing\x20this\x20file\x20locally.',_0x1df063(0x319)):showStatus(_0x1df063(0x335),_0x1df063(0x2cf),_0x1df063(0x319))));window[_0x1df063(0x315)](_0x1df063(0x281))[_0x1df063(0x261)]&&(console[_0x1df063(0x201)](_0x1df063(0x33d)),installStatus&&showStatus(_0x1df063(0x335),_0x1df063(0x343),'success'));let encryptFileData=null,encryptFileName='',decryptFileData=null,decryptFileName='';document[_0x1df063(0x346)](_0x1df063(0x2f8),function(){const _0x5a4851=_0x1df063,_0x2a11e5=document[_0x5a4851(0x38b)]('encryptFileInput'),_0x461e57=document[_0x5a4851(0x38b)](_0x5a4851(0x297)),_0x3643bc=document[_0x5a4851(0x38b)](_0x5a4851(0x380)),_0x2c37b3=document[_0x5a4851(0x38b)]('encryptFileName'),_0x1816aa=document[_0x5a4851(0x38b)](_0x5a4851(0x1ee)),_0x19d3a8=document[_0x5a4851(0x38b)]('decryptFileInput'),_0x568933=document['getElementById']('decryptBrowseBtn'),_0x594241=document[_0x5a4851(0x38b)](_0x5a4851(0x39a)),_0x105be5=document['getElementById']('decryptFileName'),_0x52bebd=document['getElementById'](_0x5a4851(0x325)),_0x3b96c2=document[_0x5a4851(0x38b)]('downloadEncryptedBtn'),_0x3acb7e=document[_0x5a4851(0x38b)](_0x5a4851(0x33c));_0x461e57[_0x5a4851(0x346)](_0x5a4851(0x2c0),()=>{const _0x5d5b76=_0x5a4851;_0x2a11e5[_0x5d5b76(0x2c0)]();}),_0x2a11e5[_0x5a4851(0x346)](_0x5a4851(0x22e),_0x37e5dc=>{const _0x2c1885=_0x5a4851;handleEncryptFileSelect(_0x37e5dc[_0x2c1885(0x22f)][_0x2c1885(0x3cd)]);}),_0x1816aa['addEventListener'](_0x5a4851(0x2c0),()=>{clearEncryptFile();}),_0x568933['addEventListener'](_0x5a4851(0x2c0),()=>{const _0x269b7b=_0x5a4851;_0x19d3a8[_0x269b7b(0x2c0)]();}),_0x19d3a8[_0x5a4851(0x346)](_0x5a4851(0x22e),_0x151c24=>{const _0x1c0ad4=_0x5a4851;handleDecryptFileSelect(_0x151c24['target'][_0x1c0ad4(0x3cd)]);}),_0x52bebd[_0x5a4851(0x346)]('click',()=>{clearDecryptFile();}),createKeyFileInput(),_0x3b96c2[_0x5a4851(0x346)](_0x5a4851(0x2c0),downloadEncryptedFile),_0x3acb7e['addEventListener']('click',downloadDecryptedFile),document[_0x5a4851(0x38b)](_0x5a4851(0x24d))[_0x5a4851(0x346)](_0x5a4851(0x2c0),function(){const _0xc922c0=_0x5a4851;window[_0xc922c0(0x211)]=null;}),document['getElementById'](_0x5a4851(0x23e))[_0x5a4851(0x346)](_0x5a4851(0x2c0),confirmPasswordModal),document[_0x5a4851(0x38b)](_0x5a4851(0x338))[_0x5a4851(0x346)](_0x5a4851(0x2c0),cancelPasswordModal),document[_0x5a4851(0x38b)](_0x5a4851(0x356))[_0x5a4851(0x346)](_0x5a4851(0x3b6),updateModalPasswordStrength),document['getElementById'](_0x5a4851(0x356))[_0x5a4851(0x346)](_0x5a4851(0x32b),function(_0x324507){const _0x4ec555=_0x5a4851;_0x324507[_0x4ec555(0x26a)]===_0x4ec555(0x214)&&confirmPasswordModal();}),document[_0x5a4851(0x346)](_0x5a4851(0x255),function(_0x332b13){const _0x63ba9e=_0x5a4851;_0x332b13[_0x63ba9e(0x26a)]===_0x63ba9e(0x34b)&&document[_0x63ba9e(0x38b)]('passwordModal')['style'][_0x63ba9e(0x386)]===_0x63ba9e(0x310)&&cancelPasswordModal();});});function handleEncryptFileSelect(_0xbd9166){const _0x1e4d97=_0x1df063;if(_0xbd9166[_0x1e4d97(0x392)]===0x0)return;const _0x3e49e8=_0xbd9166[0x0];encryptFileName=_0x3e49e8[_0x1e4d97(0x383)];const _0x12f242=new FileReader();_0x12f242[_0x1e4d97(0x384)]=function(_0x1fb596){const _0x299f88=_0x1e4d97;encryptFileData=_0x1fb596[_0x299f88(0x22f)]['result'],document[_0x299f88(0x38b)](_0x299f88(0x3cb))[_0x299f88(0x24c)]=_0x299f88(0x33f)+encryptFileName+'\x20('+formatFileSize(_0x3e49e8[_0x299f88(0x25c)])+')',document[_0x299f88(0x38b)](_0x299f88(0x380))[_0x299f88(0x246)]['display']=_0x299f88(0x310),document['getElementById']('encryptFileName')[_0x299f88(0x2a2)]=encryptFileName;},_0x12f242[_0x1e4d97(0x264)](_0x3e49e8);}function handleDecryptFileSelect(_0x27ea43){const _0x4b4a62=_0x1df063;if(_0x27ea43[_0x4b4a62(0x392)]===0x0)return;const _0x26d3d2=_0x27ea43[0x0];decryptFileName=_0x26d3d2['name'];const _0x59015b=document[_0x4b4a62(0x38b)](_0x4b4a62(0x2e7))[_0x4b4a62(0x24c)]['trim'](),_0xf35862=new FileReader();_0xf35862[_0x4b4a62(0x384)]=function(_0x2cc5b5){const _0x537150=_0x4b4a62,_0x3fb87a=_0x2cc5b5[_0x537150(0x22f)][_0x537150(0x2b9)];isValidEncryptedMessage(_0x3fb87a,_0x59015b)?(document[_0x537150(0x38b)](_0x537150(0x2d1))[_0x537150(0x24c)]=_0x3fb87a,decryptFileData=null,document[_0x537150(0x38b)](_0x537150(0x39a))[_0x537150(0x246)]['display']='flex',document[_0x537150(0x38b)](_0x537150(0x396))[_0x537150(0x2a2)]=decryptFileName,showStatus('decryptStatus',_0x537150(0x3bc),_0x537150(0x28b))):(showStatus(_0x537150(0x20b),_0x537150(0x215),_0x537150(0x3b8)),document[_0x537150(0x38b)](_0x537150(0x39a))['style'][_0x537150(0x386)]='none');},_0xf35862[_0x4b4a62(0x37a)]=function(){const _0x2fe47e=_0x4b4a62;showStatus(_0x2fe47e(0x20b),_0x2fe47e(0x2b1),_0x2fe47e(0x3b8));},_0xf35862[_0x4b4a62(0x3ae)](_0x26d3d2);}function clearEncryptFile(){const _0x3a1ca0=_0x1df063;encryptFileData=null,encryptFileName='',document[_0x3a1ca0(0x38b)](_0x3a1ca0(0x3cb))[_0x3a1ca0(0x24c)]='',document[_0x3a1ca0(0x38b)](_0x3a1ca0(0x380))[_0x3a1ca0(0x246)]['display']=_0x3a1ca0(0x303),document['getElementById'](_0x3a1ca0(0x2fb))[_0x3a1ca0(0x24c)]='';}function clearDecryptFile(){const _0x422c6f=_0x1df063;decryptFileData=null,decryptFileName='',document[_0x422c6f(0x38b)](_0x422c6f(0x2d1))['value']='',document[_0x422c6f(0x38b)]('decryptFileInfo')[_0x422c6f(0x246)][_0x422c6f(0x386)]=_0x422c6f(0x303),document[_0x422c6f(0x38b)](_0x422c6f(0x2dd))[_0x422c6f(0x24c)]='';}function formatFileSize(_0xaf24c4){const _0x1f73d3=_0x1df063;if(_0xaf24c4===0x0)return _0x1f73d3(0x36f);const _0x1a632f=0x400,_0x37fc7e=[_0x1f73d3(0x289),'KB','MB','GB'],_0x3dbc2f=Math[_0x1f73d3(0x317)](Math['log'](_0xaf24c4)/Math['log'](_0x1a632f));return parseFloat((_0xaf24c4/Math[_0x1f73d3(0x2de)](_0x1a632f,_0x3dbc2f))['toFixed'](0x2))+'\x20'+_0x37fc7e[_0x3dbc2f];}function generateRandomFileName(_0x274a60=0x6){const _0x1d5ee5=_0x1df063,_0x444354=_0x1d5ee5(0x389);let _0x1903d8='';for(let _0x3a341d=0x0;_0x3a341d<_0x274a60;_0x3a341d++){_0x1903d8+=_0x444354[_0x1d5ee5(0x38e)](Math['floor'](Math['random']()*_0x444354[_0x1d5ee5(0x392)]));}return _0x1903d8;}

    </script>
<div id="passwordModal" class="modal">
    <div class="modal-content">
        <h3 id="passwordModalTitle">Enter Password</h3>
        <p id="passwordModalMessage">Please enter a password to continue:</p>
        <div class="form-group">
            <input type="password" id="passwordModalInput" placeholder="Enter password">
            <div id="passwordModalStrength" class="password-strength"></div>
            <div id="passwordModalFeedback" class="password-feedback"></div>
        </div>
        <div class="btn-group">
            <button id="passwordModalConfirm" class="btn-primary">Confirm</button>
            <button id="passwordModalCancel" class="btn-secondary">Cancel</button>
        </div>
    </div>
</div>
</body>
</html>
