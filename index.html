<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';"><meta http-equiv="X-Content-Type-Options" content="nosniff"><meta http-equiv="Referrer-Policy" content="no-referrer"><meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=()"><meta name="theme-color" content="#000000"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lemonade"><link rel="icon" href="icon.svg"><link rel="apple-touch-icon" href="icon.svg"><link rel="manifest" href="manifest.json"><title>Lemonade</title><style>:root { --bg-color: #ffffff; --text-color: #000000; --title-gradient: linear-gradient(90deg, #000000, #000000); --card-bg: #ffffff; --accent-color: #000000; --border-color: #dddddd; --input-bg: #ffffff; --button-bg: #000000; --button-text: #ffffff; --button-hover: #333333; --success-color: #00cc66; --error-color: #cc3300; --warning-color: #f0ad4e; --cyber-line: rgba(0, 0, 0, 0.15); --cyber-glow: rgba(0, 0, 0, 0.4); --security-high: #00cc66; --security-medium: #f0ad4e; --security-low: #cc3300; --output-bg: #f8f8f8; --output-text: #222222;}body.dark-mode { --bg-color: #000000; --text-color: #E0E0E0; --title-gradient: linear-gradient(90deg, #cccccc, #ffffff); --card-bg: #0A0A0A; --accent-color: #007bff; --border-color: #2A2A2A; --input-bg: #101010; --button-bg: #007bff; --button-text: #ffffff; --button-hover: #0056b3; --success-color: #28a745; --error-color: #dc3545; --warning-color: #ffc107; --cyber-line: rgba(0, 123, 255, 0.3); --cyber-glow: rgba(0, 123, 255, 0.1); --security-high: #28a745; --security-medium: #ffc107; --security-low: #dc3545; --output-bg: #050505; --output-text: #E0E0E0;}body.dark-mode.theme-punk { --title-gradient: linear-gradient(90deg, #FFFF00, #00FFFF, #FF3131); --accent-color: #FFFF00; --button-bg: #00FFFF; --button-text: #000000; --button-hover: #FF3131; --success-color: #39FF14; --error-color: #FF3131; --warning-color: #FFFF00; --cyber-line: rgba(255, 255, 0, 0.3); --cyber-glow: rgba(255, 255, 0, 0.1); --output-text: #F0F0F0; }body.dark-mode.theme-natural { --title-gradient: linear-gradient(90deg, #FF4500, #FFD700); --accent-color: #FF4500; --border-color: #4a2a00; --button-bg: #FF8C00; --button-text: #000000; --button-hover: #FFA500; --success-color: #32CD32; --error-color: #DC143C; --warning-color: #FFD700; --cyber-line: rgba(255, 69, 0, 0.3); --cyber-glow: rgba(255, 69, 0, 0.1); --output-text: #FFF8DC; }body.dark-mode.theme-zulu { --title-gradient: linear-gradient(90deg, #FF00FF, #FF1493); --accent-color: #FF00FF; --border-color: #4B0082; --button-bg: #FF1493; --button-text: #FFFFFF; --button-hover: #C71585; --success-color: #00FA9A; --error-color: #FF69B4; --warning-color: #F0E68C; --cyber-line: rgba(255, 0, 255, 0.3); --cyber-glow: rgba(255, 0, 255, 0.1); --output-text: #FFF0F5; }body.dark-mode.theme-zing { --bg-color: #000000; --text-color: #00FF00; --title-gradient: linear-gradient(90deg, #00FF00, #00CC00, #00FF00); --accent-color: #00FF00; --border-color: #003300; --button-bg: #00CC00; --button-text: #000000; --button-hover: #00FF00; --success-color: #00FF00; --error-color: #FF0000; --warning-color: #FFFF00; --cyber-line: rgba(0, 255, 0, 0.3); --cyber-glow: rgba(0, 255, 0, 0.2); --output-text: #00FF00; }body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 0; transition: background-color 0.3s, color 0.3s; line-height: 1.6; position: relative; overflow-x: hidden;}body::before { display: none; }body.dark-mode::before { content: ""; display: block; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background-color: #000000; opacity: 1;}body.dark-mode::after { content: ""; display: block; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: repeating-linear-gradient( 0deg, rgba(57, 255, 20, 0.05), rgba(57, 255, 20, 0.05) 1px, transparent 1px, transparent 3px ); pointer-events: none;}body.dark-mode .app-title { color: var(--accent-color); text-shadow: none; background: none;}body.dark-mode .card { border: 1px solid var(--accent-color); box-shadow: none; backdrop-filter: none; }body.dark-mode button { border: 1px solid transparent; box-shadow: none; text-shadow: none; transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease; position: relative; overflow: hidden;}body.dark-mode button:hover { background-color: var(--button-hover); color: var(--button-text); box-shadow: none; transform: translateY(-1px); }body.dark-mode button::before { display: none; }body.dark-mode input,body.dark-mode textarea,body.dark-mode select { border: 1px solid var(--border-color); box-shadow: none; backdrop-filter: none; transition: border-color 0.2s ease; }body.dark-mode input:focus,body.dark-mode textarea:focus,body.dark-mode select:focus { border-color: var(--accent-color); box-shadow: none; }body.dark-mode .security-badge { text-shadow: none; }body.dark-mode .key-item { border: 1px solid var(--border-color); background-color: var(--card-bg); box-shadow: none; transition: border-color 0.2s ease; }body.dark-mode .key-item:hover { transform: none; border-color: var(--accent-color); box-shadow: none;}body.dark-mode .tab-btn.active { background-color: var(--accent-color); color: var(--button-text); border-bottom-color: var(--accent-color); box-shadow: none; }body.dark-mode .tab-btn:hover:not(.active) { color: var(--accent-color); border-bottom-color: var(--accent-color);}body.dark-mode .slider { background-color: #333; box-shadow: none;}body.dark-mode input:checked + .slider { background-color: var(--accent-color); }body.dark-mode .slider:before { box-shadow: none; background-color: #111; }body.dark-mode input:checked + .slider:before { background-color: #000; }body.dark-mode .status.success,body.dark-mode .status.warning,body.dark-mode .status.error { border-width: 1px; border-style: solid;}body.dark-mode .status.success { background-color: rgba(57, 255, 20, 0.1); border-color: var(--success-color); color: var(--success-color); }body.dark-mode .status.warning { background-color: rgba(255, 255, 0, 0.1); border-color: var(--warning-color); color: var(--warning-color); }body.dark-mode .status.error { background-color: rgba(255, 49, 49, 0.1); border-color: var(--error-color); color: var(--error-color); }body.dark-mode .spinner { border: 3px solid rgba(224, 224, 224, 0.2); border-top-color: var(--accent-color); animation: spin 1s linear infinite; }.app-title { font-size: 1.8rem; margin: 0; color: var(--text-color); background: none;}body.dark-mode .app-title { color: var(--accent-color); text-shadow: none;}body.dark-mode .app-header::after { background: linear-gradient(90deg, transparent, var(--accent-color), transparent); }body.dark-mode .card::before { background: var(--accent-color); height: 2px;}body.dark-mode .tab-btn:hover::after { background-color: var(--accent-color); }body.dark-mode input:focus, body.dark-mode textarea:focus, body.dark-mode select:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 2px var(--cyber-glow); }body.dark-mode .btn-secondary { border: 1px solid var(--accent-color); color: var(--accent-color); background-color: transparent;}body.dark-mode .btn-secondary:hover { background-color: rgba(57, 255, 20, 0.1); color: #39FF14; }body.dark-mode .security-badge { transition: none;}body.dark-mode .security-badge.high { background-color: rgba(57, 255, 20, 0.1); color: var(--security-high); border: 1px solid var(--security-high); box-shadow: none; }body.dark-mode .security-badge.medium { background-color: rgba(255, 255, 0, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); box-shadow: none; }body.dark-mode .security-badge.low { background-color: rgba(255, 49, 49, 0.1); color: var(--security-low); border: 1px solid var(--security-low); box-shadow: none; }body.dark-mode .key-pair-badge.full { background-color: rgba(57, 255, 20, 0.1); color: var(--security-high); border: 1px solid var(--security-high); box-shadow: none; }body.dark-mode .key-pair-badge.private { background-color: rgba(255, 49, 49, 0.1); color: var(--security-low); border: 1px solid var(--security-low); box-shadow: none; }body.dark-mode .key-pair-badge.public { background-color: rgba(255, 255, 0, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); box-shadow: none; }body.dark-mode .private-key-btn { border: 1px solid var(--error-color) !important; color: var(--error-color) !important;}body.dark-mode .private-key-btn:hover { background-color: rgba(255, 49, 49, 0.2) !important; color: #FF3131 !important; }body.dark-mode .modal-content { border: 1px solid var(--accent-color); box-shadow: none; background-color: var(--card-bg); }body.dark-mode .btn-primary { background-color: var(--accent-color); color: #000000; }body.dark-mode .btn-primary:hover { background-color: #4CFF3A; }body.dark-mode .btn-zero { background-color: var(--error-color); color: #FFFFFF; border: 1px solid #FF0000; }body.dark-mode .btn-zero:hover { background-color: #FF5555; }body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 0; transition: background-color 0.3s, color 0.3s; line-height: 1.6; position: relative; overflow-x: hidden;}.container { max-width: 600px; margin: 0 auto; padding: 20px; transition: max-width 0.3s ease-in-out;}.app-header { text-align: center; margin-bottom: 20px; position: relative;}.app-subtitle { font-size: 0.9rem; margin: 0; padding-top: 2px; font-style: italic; color: var(--text-color); opacity: 0.8;}.app-header::after { content: ''; position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); width: 80%; height: 2px; background: linear-gradient(90deg, transparent, var(--accent-color), transparent);}.card { background-color: var(--card-bg); border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); padding: 20px; margin-bottom: 20px; border: 1px solid var(--border-color); position: relative; overflow: hidden;}.card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 3px; background: linear-gradient(90deg, #33aaff, #0066cc); }.tabs { display: flex; justify-content: center; margin-bottom: 20px; border-bottom: 1px solid var(--border-color); overflow-x: auto; }.tab-btn { background: none; border: none; padding: 10px 20px; font-size: 1rem; cursor: pointer; color: var(--text-color); border-bottom: 2px solid transparent; transition: all 0.3s; position: relative; overflow: hidden; white-space: nowrap; }.tab-btn.active { border-bottom: 2px solid var(--accent-color); color: var(--accent-color);}.tab-btn::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 2px; background-color: var(--accent-color); transition: width 0.3s;}.tab-btn:hover::after { width: 100%;}.tab-content { display: none !important;}.tab-content.active { display: block !important; }.form-group { margin-bottom: 15px;}label { display: block; margin-bottom: 5px; font-weight: 500;}input, textarea, select { width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--input-bg); color: var(--text-color); font-size: 1rem; box-sizing: border-box; transition: border-color 0.3s, box-shadow 0.3s;}input:focus, textarea:focus, select:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 2px var(--cyber-glow); }#encryptedOutput,#decryptedOutput { min-height: 120px; background-color: var(--output-bg); color: var(--output-text); border-width: 1px; border-style: solid; border-color: var(--border-color); font-family: 'Consolas', 'Courier New', monospace; width: 100%; resize: vertical; padding: 15px; overflow-y: auto;}.form-group:has(#encryptedOutput),.form-group:has(#decryptedOutput) { width: 100%;}#encrypt .form-group:nth-of-type(3),#decrypt .form-group:nth-of-type(3) { width: 100%;}textarea { min-height: 100px; resize: vertical;}button { background-color: var(--button-bg); color: var(--button-text); border: none; border-radius: 8px; padding: 12px 20px; font-size: 1rem; cursor: pointer; transition: background-color 0.3s, transform 0.1s; position: relative; overflow: hidden;}button:hover { background-color: var(--button-hover);}button:active { transform: scale(0.98);}button::after { display: none;}.btn-group { display: flex; gap: 10px; margin-top: 15px;}.btn-secondary { background-color: transparent; border: 1px solid var(--accent-color); color: var(--accent-color);}.btn-secondary:hover { background-color: rgba(0,0,0, 0.05); }.status { padding: 10px; border-radius: 8px; margin-top: 15px; display: none; }.status.success { background-color: rgba(0, 204, 102, 0.1); color: var(--success-color); border: 1px solid var(--success-color); display: block;}.status.warning { background-color: rgba(240, 173, 78, 0.1); color: var(--warning-color); border: 1px solid var(--warning-color); display: block;}.status.error { background-color: rgba(204, 51, 0, 0.1); color: var(--error-color); border: 1px solid var(--error-color); display: block;}.keys-container { display: flex; flex-direction: column; gap: 20px;}.keys-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; width: 100%;}.key-form { display: flex; flex-direction: column; gap: 15px;}.key-item { background-color: var(--input-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 15px; display: flex; flex-direction: column; height: 100%;}.key-item-content { flex: 1; display: flex; flex-direction: column;}.key-item h3 { margin-top: 0; margin-bottom: 10px;}.key-header { text-align: center; margin-bottom: 15px;}.key-actions { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-top: auto; padding-top: 15px; border-top: 1px solid var(--border-color);}.key-actions button { flex: 1 1 auto; min-width: 80px; padding: 8px 12px; font-size: 0.9rem;}.key-meta { font-size: 0.9rem; color: #888; margin-bottom: 5px;}.key-management-buttons { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px;}.key-management-buttons button { flex: 1 1 auto; min-width: 100px;}.btn-zero { background-color: #cc3300; color: white; margin-top: 20px; width: 100%; font-weight: bold; border: 1px solid #aa2200;}.btn-zero:hover { background-color: #ff3300;}.loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); display: flex; justify-content: center; align-items: center; z-index: 1000; display: none; }.spinner { width: 50px; height: 50px; border: 5px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top-color: var(--accent-color); animation: spin 1s linear infinite; }@keyframes spin { to { transform: rotate(360deg); }}.password-strength { height: 5px; border-radius: 5px; margin-top: 5px; transition: all 0.3s;}.password-strength.weak { background-color: var(--security-low); width: 30%; }.password-strength.medium { background-color: var(--security-medium); width: 60%; }.password-strength.strong { background-color: var(--security-high); width: 100%; }.password-feedback { font-size: 0.8rem; margin-top: 5px; color: var(--text-color); opacity: 0.9;}.security-badge { display: inline-flex; align-items: center; padding: 2px 8px; border-radius: 12px; font-size: 0.8rem; margin-left: 8px; font-weight: bold;}.security-badge.high { background-color: rgba(0, 204, 102, 0.1); color: var(--security-high); border: 1px solid var(--security-high); }.security-badge.medium { background-color: rgba(240, 173, 78, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); }.security-badge.low { background-color: rgba(204, 51, 0, 0.1); color: var(--security-low); border: 1px solid var(--security-low); }.key-pair-badge { display: inline-flex; align-items: center; padding: 2px 8px; border-radius: 12px; font-size: 0.8rem; font-weight: bold; margin-top: 5px;}.key-pair-badge.full { background-color: rgba(0, 204, 102, 0.1); color: var(--security-high); border: 1px solid var(--security-high); }.key-pair-badge.private { background-color: rgba(204, 51, 0, 0.1); color: var(--security-low); border: 1px solid var(--security-low); }.key-pair-badge.public { background-color: rgba(240, 173, 78, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); }.private-key-btn { border: 1px solid var(--error-color) !important; color: var(--error-color) !important;}.private-key-btn:hover { background-color: rgba(204, 51, 0, 0.1) !important;}.config-toggle { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;}.config-toggle label { display: inline; margin-bottom: 0;}.switch { position: relative; display: inline-block; width: 50px; height: 24px;}.switch input { opacity: 0; width: 0; height: 0; }.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;}.slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%;}input:checked + .slider { background-color: var(--accent-color); } input:focus + .slider { box-shadow: 0 0 1px var(--accent-color); }input:checked + .slider:before { transform: translateX(26px); }.security-info { font-size: 0.9rem; padding: 10px; border-left: 3px solid var(--accent-color); background-color: rgba(0,0,0, 0.03); margin-bottom: 15px;}body.dark-mode .security-info { background-color: rgba(57, 255, 20, 0.05); border-left-color: var(--accent-color); color: var(--text-color);}.key-expiry { font-size: 0.8rem; color: var(--warning-color); margin-top: 5px; font-style: italic;}#inactivityModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); z-index: 1001; justify-content: center; align-items: center;}.modal-content { background-color: var(--card-bg); padding: 20px; border-radius: 12px; max-width: 400px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.3); width: 90%; position: relative; }.timer { font-size: 2rem; margin: 20px 0; color: var(--warning-color);}#settings { display: none; } .settings-section { margin-bottom: 20px; }.settings-section h3 { margin-top: 0; border-bottom: 1px solid var(--border-color); padding-bottom: 5px;}.file-info { margin-top: 10px; font-size: 0.9rem; background-color: var(--input-bg); padding: 8px; border-radius: 4px; display: flex; align-items: center; justify-content: space-between;}.file-info-name { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }.file-icon { margin-right: 8px; font-size: 1.2rem; }.remove-file { cursor: pointer; color: var(--error-color); padding: 2px 6px; border-radius: 4px; margin-left: 8px; }.remove-file:hover { background-color: rgba(204, 51, 0, 0.1); } body.dark-mode .remove-file:hover { background-color: rgba(255, 49, 49, 0.2); }.modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); z-index: 1001; justify-content: center; align-items: center;}.btn-primary { background-color: var(--accent-color); color: var(--button-text); border: none; border-radius: 8px; padding: 12px 20px; font-size: 1rem; cursor: pointer; transition: background-color 0.3s, transform 0.1s;}.btn-primary:hover { background-color: var(--button-hover);}@media (max-width: 600px) { .container { padding: 15px; } .card { padding: 15px; } .app-title { font-size: 1.5rem; } .btn-group { flex-direction: column; } .btn-group button { width: 100%; } .key-actions button { width: 100%; margin-bottom: 5px; } .tab-btn { padding: 10px 10px; font-size: 0.9rem; } .key-actions { flex-direction: column; }}@media (max-width: 767px) { .keys-container { flex-direction: column; } .key-form, .keys-list-container { width: 100%; }}@media (min-width: 768px) { .container { max-width: 750px; } .app-title { font-size: 2rem; } .card { padding: 25px; } #encryptedOutput, #decryptedOutput { min-height: 150px; font-size: 1.05rem; } .keys-container { flex-direction: row; align-items: flex-start; } .key-form { width: 40%; position: sticky; top: 20px; } .keys-list-container { width: 60%; } .key-item h3 { font-size: 1.1rem; margin-top: 0; margin-bottom: 10px; word-break: break-word; }}@media (min-width: 1024px) { .container { max-width: 900px; } #encryptedOutput, #decryptedOutput { min-height: 180px; font-size: 1.1rem; padding: 18px; } #keys .card { display: flex; flex-wrap: wrap; gap: 20px; } #keys .card > h2, #keys .card > .security-info { width: 100%; } #keys .card > .form-group, #keys .card > button#generateKeyBtn { width: calc(40% - 10px); } #keys .card > div:has(#keysList) { width: calc(60% - 10px); margin-top: 0; } #keys .card > div:nth-last-child(3) { width: calc(60% - 10px); margin-top: 0; } #keys .card > .btn-group, #keys .card > div:has(#zeroKeysBtn) { width: 100%; } #encrypt .card, #decrypt .card { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; } #encrypt .card > .form-group:first-child, #decrypt .card > .form-group:first-child, #encrypt .card > .form-group:has(#encryptedOutput), #decrypt .card > .form-group:has(#decryptedOutput), #encrypt .card > .form-group:nth-child(3), #decrypt .card > .form-group:nth-child(3) { grid-column: 1 / span 2; } #encrypt .card > button, #decrypt .card > button { grid-column: 1 / span 2; } #encrypt .card > .btn-group, #decrypt .card > .btn-group { grid-column: 1 / span 2; } #encrypt .card > #encryptStatus, #decrypt .card > #decryptStatus { grid-column: 1 / span 2; }}@media (min-width: 1200px) { .container { max-width: 1140px; } .keys-grid { grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); }}@media (min-width: 1440px) { .container { max-width: 1200px; } #encryptedOutput, #decryptedOutput { min-height: 220px; font-size: 1.15rem; padding: 20px; } #settings .card { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; } #settings .card > h2 { grid-column: 1 / span 2; } #settings .card > .btn-group { grid-column: 1 / span 2; justify-content: center; } #settings .card > #settingsStatus { grid-column: 1 / span 2; } #keysList { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; } @media (min-width: 1800px) { #encrypt .card, #decrypt .card { grid-template-columns: 1fr 1fr 1fr; } #encrypt .card > .form-group:first-child, #decrypt .card > .form-group:first-child, #encrypt .card > .form-group:has(#encryptedOutput), #decrypt .card > .form-group:has(#decryptedOutput), #encrypt .card > .form-group:nth-child(3), #decrypt .card > .form-group:nth-child(3), #encrypt .card > button, #decrypt .card > button, #encrypt .card > .btn-group, #decrypt .card > .btn-group, #encrypt .card > #encryptStatus, #decrypt .card > #decryptStatus { grid-column: 1 / span 3; } }}@media (min-width: 601px) { .btn-group { flex-direction: row; } .btn-group button { flex: 1; }}@media print { body { background-color: white; color: black; } body.dark-mode { --bg-color: #ffffff; --text-color: #000000; --card-bg: #ffffff; --border-color: #dddddd; --input-bg: #ffffff; --output-bg: #f8f8f8; --output-text: #222222; } body.dark-mode .app-title { background: none; color: #000000; text-shadow: none; } body.dark-mode .tab-btn.active { color: #000000; background: none; } body.dark-mode .security-info { background-color: #f0f0f0; border-left-color: #ccc; color: #000; } .card { box-shadow: none; border: 1px solid #ddd; } .btn-group, button, .tabs, .app-subtitle, .key-actions, .key-management-buttons, .config-toggle, #installContainer, .remove-file { display: none !important; } .container { max-width: 100%; padding: 0; } #encryptedOutput, #decryptedOutput { border: 1px solid #ddd; background-color: white; color: black; min-height: auto; } .key-item { page-break-inside: avoid; } .keys-grid { grid-template-columns: 1fr !important; } } </style></head><body><div class="container"><div class="app-header"><h1 class="app-title">LC6</h1><div class="app-subtitle">by elkmire</div></div><div class="tabs"><button class="tab-btn active" data-tab="encrypt">Encrypt</button><button class="tab-btn" data-tab="decrypt">Decrypt</button><button class="tab-btn" data-tab="keys">Key Management</button><button class="tab-btn" data-tab="settings">Settings</button><button class="tab-btn" data-tab="learn">Learn</button></div><div class="tab-content active" id="encrypt"><div class="card"><div class="form-group"><label for="encryptMessage">To Encrypt</label><textarea id="encryptMessage" placeholder="Free-type here or load file for encryption..."></textarea><div style="display: flex; gap: 10px; margin-top: 5px;"><button id="encryptBrowseBtn" class="btn-secondary">Browse Files</button><button id="clearEncryptMessageBtn" class="btn-secondary">Clear</button><input type="file" id="encryptFileInput" style="display: none;"></div><div id="encryptFileInfo" style="display: none;" class="file-info"><span><span class="file-icon">ðŸ“„</span><span id="encryptFileName" class="file-info-name"></span></span><span class="remove-file" id="removeEncryptFile">Ã—</span></div></div><div class="form-group"><label for="encryptionKey">Encryption Key</label><select id="encryptionKey"><option value="">Select a key...</option></select></div><div class="form-group"><label for="encryptObfKey">Extra Option</label><input type="text" id="encryptObfKey" placeholder="Optional*"></div><div class="form-group" id="encryptSignGroup" style="display: none;"><div class="config-toggle"><label for="encryptSign" style="cursor: pointer;">Sign Message (Digital Signature)</label><label class="switch"><input type="checkbox" id="encryptSign"><span class="slider"></span></label></div></div><div class="form-group" id="encryptionPasswordGroup" style="display: none;"><label for="encryptionPassword">Key Password</label><input type="password" id="encryptionPassword" placeholder="Enter key password"></div><button id="encryptBtn">Encrypt Data</button><div class="form-group" style="margin-top: 20px;"><label for="encryptedOutput">Encrypted Data</label><textarea id="encryptedOutput" readonly></textarea></div><div class="btn-group"><button id="downloadEncryptedBtn" class="btn-secondary">Download Encrypted File</button><button id="copyEncryptedBtn" class="btn-secondary">Copy to Clipboard</button><button id="clearEncryptBtn" class="btn-secondary">Clear All</button></div><div id="encryptStatus" class="status"></div></div></div><div class="tab-content" id="decrypt"><div class="card"><div class="form-group"><label for="encryptedMessage">To Decrypt</label><textarea id="encryptedMessage" placeholder="Paste the encrypted data here or load encrypted data..."></textarea><div style="display: flex; gap: 10px; margin-top: 5px;"><button id="decryptBrowseBtn" class="btn-secondary">Browse Files</button><button id="clearEncryptedMessageBtn" class="btn-secondary">Clear</button><input type="file" id="decryptFileInput" style="display: none;"></div><div id="decryptFileInfo" style="display: none;" class="file-info"><span><span class="file-icon">ðŸ“„</span><span id="decryptFileName" class="file-info-name"></span></span><span class="remove-file" id="removeDecryptFile">Ã—</span></div></div><div class="form-group"><label for="decryptionKey">Decryption Key</label><select id="decryptionKey"><option value="">Select a key...</option></select></div><div class="form-group"><label for="decryptObfKey">Extra Option</label><input type="text" id="decryptObfKey" placeholder="Optional*"></div><div class="form-group" id="decryptVerifyGroup" style="display: none;"><div class="config-toggle"><label for="decryptVerify" style="cursor: pointer;">Verify Signature</label><label class="switch"><input type="checkbox" id="decryptVerify"><span class="slider"></span></label></div></div><div class="form-group" id="decryptionPasswordGroup" style="display: none;"><label for="decryptionPassword">Key Password</label><input type="password" id="decryptionPassword" placeholder="Enter key password"></div><button id="decryptBtn">Decrypt Data</button><div class="form-group" style="margin-top: 20px;"><label for="decryptedOutput">Decrypted Data</label><textarea id="decryptedOutput" readonly></textarea></div><div class="btn-group"><button id="downloadDecryptedBtn" class="btn-secondary">Download Decrypted File</button><button id="copyDecryptedBtn" class="btn-secondary">Copy to Clipboard</button><button id="clearDecryptBtn" class="btn-secondary">Clear All</button></div><div id="decryptStatus" class="status"></div></div></div><div class="tab-content" id="keys"><div class="card"><h2>Key Management</h2><div class="security-info"><strong>Security Note:</strong> All keys are stored locally in your browser's protected storage and never sent to any server. </div><div class="keys-container"><div class="key-form"><div class="form-group"><label for="keyName">Key Name</label><input type="text" id="keyName" placeholder="e.g., enter crypto name"></div><div class="form-group"><label for="keyType">Key Type</label><select id="keyType"><option value="aes">AES-GCM (Symmetric) - 256 bits</option><option value="rsa">RSA-OAEP (Asymmetric) - 2048 bits</option><option value="rsa-4096">RSA-OAEP (Asymmetric) - 4096 bits</option><option value="ecc">ECC (Asymmetric) - P-256</option><option value="ecc-p384">ECC (Asymmetric) - P-384</option><option value="ecc-p521">ECC (Asymmetric) - P-521</option></select></div><div class="form-group"><label for="keyExpiry">Key Expiration (Optional)</label><select id="keyExpiry"><option value="">Never (Not Recommended)</option><option value="30">30 Days</option><option value="90">90 Days</option><option value="180">180 Days</option><option value="365">1 Year</option></select></div><div class="form-group" id="keyPasswordGroup"><label for="keyPassword">Key Password (Recommended)</label><input type="password" id="keyPassword" placeholder="Enter optional password"><div id="passwordStrength" class="password-strength"></div><div id="passwordFeedback" class="password-feedback"></div></div><div class="form-group" id="confirmKeyPasswordGroup"><label for="confirmKeyPassword">Confirm Password</label><input type="password" id="confirmKeyPassword" placeholder="Confirm your password"></div><button id="generateKeyBtn">Generate New Key</button><div class="key-management-buttons"><button id="importKeyBtn" class="btn-secondary">Import Key</button><button id="exportAllKeysBtn" class="btn-secondary">Export State</button><button id="importStateBtn" class="btn-secondary">Import State</button></div><div style="text-align: center; margin-top: 20px;"><button id="zeroKeysBtn" class="btn-zero">ZERO ALL KEYS</button></div><div id="keyStatus" class="status"></div></div><div class="keys-list-container"><h3>Your Keys</h3><div id="keysList" class="keys-grid"></div></div></div></div></div><div class="tab-content" id="settings"><div class="card"><h2>Security Settings</h2><p> (Must SAVE for changes to take effect) <p><div class="settings-section"><h3>Storage Options</h3><div class="config-toggle"><label for="useIndexedDB">Use IndexedDB for key storage (more secure)</label><label class="switch"><input type="checkbox" id="useIndexedDB" checked><span class="slider"></span></label></div><div class="config-toggle"><label for="sessionOnly">Session-only mode (keys aren't saved when browser closes)</label><label class="switch"><input type="checkbox" id="sessionOnly"><span class="slider"></span></label></div></div><div class="settings-section"><h3>Security Parameters</h3><div class="config-toggle"><label for="enforcePwdProtection">Enforce password protection for keys</label><label class="switch"><input type="checkbox" id="enforcePwdProtection"><span class="slider"></span></label></div><div class="config-toggle"><label for="enforceKeyExpiry">Enforce key expiration</label><label class="switch"><input type="checkbox" id="enforceKeyExpiry"><span class="slider"></span></label></div><div class="form-group"><label for="pbkdf2Iterations">PBKDF2 Iterations (higher = more secure but slower)</label><select id="pbkdf2Iterations"><option value="100000">100,000 (Default)</option><option value="200000">200,000</option><option value="300000">300,000</option><option value="500000">500,000</option></select></div></div><div class="settings-section"><h3>Appearance</h3><div class="config-toggle"><label for="darkMode">Dark Mode</label><label class="switch"><input type="checkbox" id="darkMode"><span class="slider"></span></label></div><div id="darkThemeOptions" style="display: none; margin-top: 15px; padding-left: 20px; border-left: 2px solid var(--border-color);"><h4>Extended Themes</h4><div class="config-toggle"><label for="themePunk">Lemon</label><label class="switch"><input type="checkbox" id="themePunk" class="theme-toggle" data-theme="punk"><span class="slider"></span></label></div><div class="config-toggle"><label for="themeNatural">Burnt</label><label class="switch"><input type="checkbox" id="themeNatural" class="theme-toggle" data-theme="natural"><span class="slider"></span></label></div><div class="config-toggle"><label for="themeZulu">Zulu</label><label class="switch"><input type="checkbox" id="themeZulu" class="theme-toggle" data-theme="zulu"><span class="slider"></span></label></div><div class="config-toggle"><label for="themeZing">Zing</label><label class="switch"><input type="checkbox" id="themeZing" class="theme-toggle" data-theme="zing"><span class="slider"></span></label></div></div></div><div class="settings-section"><h3>Install App</h3><p>Installs PWA (must be Chromium-based browser or Safari for IOS)</p><div id="installContainer"><button id="installBtn" class="btn-secondary">Install Lemonade App</button><p class="install-note" style="margin-top: 8px; font-size: 0.85rem; color: #888;"> (Button will be enabled when installation is available) </p></div><div id="installStatus" class="status"></div></div><div class="btn-group"><button id="saveSettingsBtn">Save Settings</button><button id="resetSettingsBtn" class="btn-secondary">Reset to Defaults</button></div><div id="settingsStatus" class="status"></div></div></div><div class="tab-content" id="learn"><div class="card"><h2>Learn About Lemonade</h2><p>Welcome! This section provides an overview of the powerful cryptographic features available in this application.</p><div class="settings-section"><h3>Core Functionality: Encrypt & Decrypt</h3><p>The <strong>Encrypt</strong> and <strong>Decrypt</strong> tabs are the heart of the application. You can secure your text messages or entire files using state-of-the-art cryptographic algorithms.</p><ul><li><strong>Free-typing or File Loading:</strong> You can either type your message directly or use the "Browse Files" button to load a file for encryption.</li><li><strong>Key Selection:</strong> Choose from your managed keys to perform the operation. The application intelligently shows you the correct keys (public keys for encryption, private keys for decryption).</li><li><strong>Digital Signatures:</strong> When using an asymmetric key (like RSA or ECC), you can "Sign" your message. This proves the message came from you and hasn't been tampered with. The recipient can then "Verify" the signature.</li><li><strong>Extra Option (Obfuscation Key):</strong> This adds an extra layer of simple, password-based obfuscation on top of the strong encryption. It makes the encrypted output look different and can help hide it. It is NOT a substitute for a strong key.</li></ul></div><div class="settings-section"><h3>Key Management Tab</h3><p>This is your command center for managing cryptographic keys. All keys are stored securely in your browser and are never sent over the network.</p><ul><li><strong>Generate New Keys:</strong> Create powerful keys with different algorithms: <ul><li><strong>AES-GCM:</strong> A fast and secure symmetric algorithm. The same key is used to encrypt and decrypt. Great for personal data protection.</li><li><strong>RSA-OAEP:</strong> An asymmetric algorithm (public/private key pair). Share your public key with others so they can send you encrypted messages that only you can open with your private key.</li><li><strong>ECC:</strong> A more modern and efficient asymmetric algorithm. It provides the same level of security as RSA but with smaller key sizes.</li></ul></li><li><strong>Key Passwords:</strong> You can (and should!) protect your keys with a password. This encrypts the key itself in your browser's storage, providing a crucial layer of security.</li><li><strong>Import/Export:</strong> You can export individual keys (public or private) or export the entire application state (all your keys) to a backup file. This allows you to move your keys to another device or browser.</li><li><strong>ZERO ALL KEYS:</strong> A powerful, irreversible function to securely delete all keys from your browser. Use with extreme caution.</li></ul></div><div class="settings-section"><h3>Settings Tab</h3><p>Customize the application's behavior to fit your security needs.</p><ul><li><strong>Storage Options:</strong> Choose between more secure IndexedDB or session-only storage (which forgets keys when you close the browser).</li><li><strong>Security Parameters:</strong> Enforce policies like requiring passwords for all keys or mandating key expiration dates. You can also increase the PBKDF2 iterations for stronger password-derived keys.</li><li><strong>Install App:</strong> On compatible browsers, you can install this web app to your device for an experience that feels like a native application.</li></ul></div><div class="security-info"><strong>Your Security is Paramount:</strong> This application is designed to run entirely on your device. Your keys, passwords, and unencrypted data are never sent to any server. All cryptographic operations happen locally in your browser. </div></div></div></div><div class="loading-overlay" id="loadingOverlay"><div class="spinner"></div></div><script>const _0x378a5e=_0x5b81;(function(_0x251c14,_0x58eeab){const _0x27ba6d=_0x5b81,_0x2b252f=_0x251c14();while(!![]){try{const _0x26d2c8=-parseInt(_0x27ba6d(0x23e))/0x1+-parseInt(_0x27ba6d(0x1b5))/0x2*(parseInt(_0x27ba6d(0x177))/0x3)+parseInt(_0x27ba6d(0x2c7))/0x4*(-parseInt(_0x27ba6d(0x222))/0x5)+-parseInt(_0x27ba6d(0x227))/0x6*(-parseInt(_0x27ba6d(0x2e1))/0x7)+parseInt(_0x27ba6d(0x15d))/0x8*(parseInt(_0x27ba6d(0x1f0))/0x9)+parseInt(_0x27ba6d(0x174))/0xa+-parseInt(_0x27ba6d(0x2e3))/0xb*(-parseInt(_0x27ba6d(0x25f))/0xc);if(_0x26d2c8===_0x58eeab)break;else _0x2b252f['push'](_0x2b252f['shift']());}catch(_0x22ea03){_0x2b252f['push'](_0x2b252f['shift']());}}}(_0x4dff,0xb648a));function hi(){const _0x35b06b=_0x5b81;console[_0x35b06b(0x241)](_0x35b06b(0x1b6));}hi();const PBKDF2_CONFIG={'ITERATIONS':0x186a0,'HASH':'SHA-256'},AES_CONFIG={'KEY_LENGTH':0x100,'MODE':'AES-GCM','IV_LENGTH':0xc,'TAG_LENGTH':0x80},RSA_CONFIG={'KEY_SIZE':0x800,'KEY_SIZE_4096':0x1000,'ALGORITHM':'RSA-OAEP','HASH':_0x378a5e(0x276)},ECC_CONFIG={'CURVE':_0x378a5e(0x179),'CURVE_P384':_0x378a5e(0x187),'CURVE_P521':_0x378a5e(0x2d3),'ALGORITHM':_0x378a5e(0x17b),'KEY_DERIVATION':_0x378a5e(0x1c5),'KDF_HASH':_0x378a5e(0x276),'ENC_ALGORITHM':_0x378a5e(0x1bb)},SIGN_CONFIG={'RSA_ALGORITHM':_0x378a5e(0x194),'ECC_ALGORITHM':_0x378a5e(0x2b2),'HASH':_0x378a5e(0x31b),'SALT_LENGTH':0x20},DB_NAME=_0x378a5e(0x28d),DB_VERSION=0x1,KEYS_STORE='keys',SETTINGS_STORE=_0x378a5e(0x217),DEFAULT_SETTINGS={'useIndexedDB':!![],'sessionOnly':![],'enforcePwdProtection':![],'enforceKeyExpiry':![],'pbkdf2Iterations':0x186a0,'theme':null};let db=null,keys=[],appSettings={...DEFAULT_SETTINGS};const tabBtns=document[_0x378a5e(0x1a7)](_0x378a5e(0x19c)),tabContents=document[_0x378a5e(0x1a7)]('.tab-content'),encryptionKeySelect=document['getElementById'](_0x378a5e(0x18b)),decryptionKeySelect=document[_0x378a5e(0x2fd)]('decryptionKey'),keysList=document['getElementById']('keysList'),loadingOverlay=document[_0x378a5e(0x2fd)](_0x378a5e(0x1bc)),inactivityModal=document[_0x378a5e(0x2fd)](_0x378a5e(0x325)),timeoutTimer=document['getElementById']('timeoutTimer'),safeMemory={'sensitiveData':new WeakMap(),'store':function(_0xea76ca){const _0x3597a8=_0x378a5e,_0xd23d48={'id':crypto[_0x3597a8(0x19d)]()};return this['sensitiveData']['set'](_0xd23d48,_0xea76ca),_0xd23d48;},'retrieve':function(_0x35c2cc,_0x46601f=![]){const _0x38246b=_0x378a5e;if(!this[_0x38246b(0x286)][_0x38246b(0x339)](_0x35c2cc))return null;const _0x251c19=this[_0x38246b(0x286)][_0x38246b(0x201)](_0x35c2cc);return _0x46601f&&this['sensitiveData'][_0x38246b(0x17c)](_0x35c2cc),_0x251c19;},'delete':function(_0x13b718){const _0x1e851a=_0x378a5e;if(this[_0x1e851a(0x286)][_0x1e851a(0x339)](_0x13b718))return this[_0x1e851a(0x286)][_0x1e851a(0x17c)](_0x13b718),!![];return![];},'clearAll':function(){const _0x4e893b=_0x378a5e;this[_0x4e893b(0x286)]=new WeakMap();if(typeof window['gc']==='function')try{window['gc']();}catch(_0x3daefa){console[_0x4e893b(0x241)](_0x4e893b(0x1e1));}}},validator={'sanitizeHTML':function(_0x3c7bf3){const _0x54813a=_0x378a5e,_0x4ea48e=document[_0x54813a(0x2cc)](_0x54813a(0x182));return _0x4ea48e[_0x54813a(0x13c)]=_0x3c7bf3,_0x4ea48e['innerHTML'];},'validateInput':function(_0x1eeb92,_0x379832=![]){const _0x59c9ef=_0x378a5e;if(_0x1eeb92===null||_0x1eeb92===undefined)return'';const _0x5f2fd5=String(_0x1eeb92);return _0x379832?_0x5f2fd5:this[_0x59c9ef(0x14d)](_0x5f2fd5);},'isValidKeyName':function(_0x8cc905){return/^[A-Za-z0-9 ._-]{1,50}$/['test'](_0x8cc905);},'isValidEncryptedMessage':function(_0x26c6ff){const _0x4eb69d=_0x378a5e;return/^--LM--\s*[A-Za-z0-9+/=]+\s*--EM--$/s[_0x4eb69d(0x269)](_0x26c6ff);},'measurePasswordStrength':function(_0x108cea){const _0x229148=_0x378a5e;let _0x12dbc5=0x0;if(!_0x108cea)return{'score':0x0,'feedback':'Password\x20is\x20required'};const _0x113c44=_0x108cea['length'];_0x12dbc5+=Math['min'](0x5,Math[_0x229148(0x138)](_0x113c44/0x4));if(/[a-z]/[_0x229148(0x269)](_0x108cea))_0x12dbc5+=0x1;if(/[A-Z]/['test'](_0x108cea))_0x12dbc5+=0x1;if(/[0-9]/['test'](_0x108cea))_0x12dbc5+=0x1;if(/[^A-Za-z0-9]/[_0x229148(0x269)](_0x108cea))_0x12dbc5+=0x2;if(/^[a-zA-Z]+$/['test'](_0x108cea))_0x12dbc5-=0x1;if(/^[0-9]+$/['test'](_0x108cea))_0x12dbc5-=0x1;if(/(.)\1{2,}/['test'](_0x108cea))_0x12dbc5-=0x1;let _0x3a9a6e,_0x363087;if(_0x12dbc5<0x4)_0x3a9a6e='weak',_0x363087=_0x229148(0x267);else _0x12dbc5<0x8?(_0x3a9a6e='medium',_0x363087=_0x229148(0x250)):(_0x3a9a6e=_0x229148(0x186),_0x363087=_0x229148(0x2e0));return{'score':_0x12dbc5,'strengthCategory':_0x3a9a6e,'feedback':_0x363087};}},escapeRegex=_0x45b3da=>{const _0x3a7e9c=_0x378a5e;if(typeof _0x45b3da!==_0x3a7e9c(0x2af))return'';return _0x45b3da[_0x3a7e9c(0x2fa)](/[.*+?^${}()|[\]\\]/g,_0x3a7e9c(0x233));};document[_0x378a5e(0x215)](_0x378a5e(0x240),async()=>{const _0xb5de60=_0x378a5e;document[_0xb5de60(0x1a7)](_0xb5de60(0x19c))[_0xb5de60(0x264)](_0x4fc83d=>{_0x4fc83d['addEventListener']('click',_0x43207b=>{const _0x18c996=_0x5b81;_0x43207b[_0x18c996(0x281)]();const _0x26c08b=_0x4fc83d[_0x18c996(0x209)](_0x18c996(0x1c9));console['log']('Tab\x20button\x20clicked:',_0x26c08b),switchTab(_0x26c08b);});}),document[_0xb5de60(0x2fd)](_0xb5de60(0x1d9))[_0xb5de60(0x215)](_0xb5de60(0x1ba),handleDarkModeToggle),document['querySelectorAll'](_0xb5de60(0x167))[_0xb5de60(0x264)](_0x46edf7=>{const _0x49099b=_0xb5de60;_0x46edf7['addEventListener'](_0x49099b(0x1ba),handleThemeToggle);});const _0xdf6e48=localStorage[_0xb5de60(0x1e0)]('LemonadeDarkMode');_0xdf6e48==='true'&&(document[_0xb5de60(0x2fd)](_0xb5de60(0x1d9))[_0xb5de60(0x326)]=!![],document['body'][_0xb5de60(0x1d2)][_0xb5de60(0x19f)](_0xb5de60(0x2f1)),applyTheme(appSettings['theme']),document[_0xb5de60(0x2fd)]('darkThemeOptions')[_0xb5de60(0x189)][_0xb5de60(0x1e2)]=_0xb5de60(0x1da)),document[_0xb5de60(0x2fd)]('clearEncryptMessageBtn')[_0xb5de60(0x215)](_0xb5de60(0x139),()=>{clearEncryptFile();}),document['getElementById']('clearEncryptedMessageBtn')[_0xb5de60(0x215)](_0xb5de60(0x139),()=>{clearDecryptFile();}),await initDatabase(),await loadSettings(),initSettingsUI(),await loadKeys(),document[_0xb5de60(0x2fd)](_0xb5de60(0x22f))[_0xb5de60(0x215)](_0xb5de60(0x1f2),updatePasswordStrength),document[_0xb5de60(0x2fd)](_0xb5de60(0x2e6))['addEventListener'](_0xb5de60(0x139),encryptMessage),document[_0xb5de60(0x2fd)](_0xb5de60(0x178))[_0xb5de60(0x215)](_0xb5de60(0x139),decryptMessage),document[_0xb5de60(0x2fd)]('generateKeyBtn')[_0xb5de60(0x215)]('click',generateKey),document[_0xb5de60(0x2fd)]('copyEncryptedBtn')['addEventListener']('click',()=>copyToClipboard(_0xb5de60(0x265),_0xb5de60(0x261))),document['getElementById'](_0xb5de60(0x230))[_0xb5de60(0x215)](_0xb5de60(0x139),()=>copyToClipboard(_0xb5de60(0x1ac),_0xb5de60(0x2f4))),document[_0xb5de60(0x2fd)]('clearEncryptBtn')[_0xb5de60(0x215)](_0xb5de60(0x139),()=>{const _0x4022ef=_0xb5de60;document[_0x4022ef(0x2fd)](_0x4022ef(0x137))['value']='',document[_0x4022ef(0x2fd)]('encryptedOutput')[_0x4022ef(0x1ad)]='',document[_0x4022ef(0x2fd)](_0x4022ef(0x261))[_0x4022ef(0x320)]=_0x4022ef(0x172),document[_0x4022ef(0x2fd)](_0x4022ef(0x261))[_0x4022ef(0x13c)]='',clearEncryptFile();}),document[_0xb5de60(0x2fd)](_0xb5de60(0x1ee))[_0xb5de60(0x215)](_0xb5de60(0x139),()=>{const _0x13412b=_0xb5de60;document[_0x13412b(0x2fd)](_0x13412b(0x148))[_0x13412b(0x1ad)]='',document[_0x13412b(0x2fd)](_0x13412b(0x1ac))[_0x13412b(0x1ad)]='',document[_0x13412b(0x2fd)]('decryptStatus')[_0x13412b(0x320)]=_0x13412b(0x172),document[_0x13412b(0x2fd)](_0x13412b(0x2f4))[_0x13412b(0x13c)]='',clearDecryptFile(),window[_0x13412b(0x223)]=null;}),document['getElementById'](_0xb5de60(0x33f))[_0xb5de60(0x215)](_0xb5de60(0x139),importKey),document['getElementById'](_0xb5de60(0x238))[_0xb5de60(0x215)](_0xb5de60(0x139),exportAllKeys),document[_0xb5de60(0x2fd)](_0xb5de60(0x1f1))['addEventListener']('click',importState),document[_0xb5de60(0x2fd)]('saveSettingsBtn')[_0xb5de60(0x215)](_0xb5de60(0x139),saveSettings),document[_0xb5de60(0x2fd)](_0xb5de60(0x15e))[_0xb5de60(0x215)](_0xb5de60(0x139),resetSettings),document[_0xb5de60(0x2fd)](_0xb5de60(0x224))[_0xb5de60(0x215)]('click',zeroAllKeys),encryptionKeySelect['addEventListener']('change',handleEncryptionKeyChange),decryptionKeySelect[_0xb5de60(0x215)](_0xb5de60(0x1ba),handleDecryptionKeyChange);});async function initDatabase(){const _0x29d5d0=_0x378a5e;if(!window[_0x29d5d0(0x156)]){showStatus(_0x29d5d0(0x24b),_0x29d5d0(0x13a),_0x29d5d0(0x19e)),appSettings[_0x29d5d0(0x2a1)]=![];return;}return new Promise((_0xff069d,_0x25ab94)=>{const _0xb52321=_0x29d5d0,_0x5d1b56=indexedDB[_0xb52321(0x20a)](DB_NAME,DB_VERSION);_0x5d1b56[_0xb52321(0x1cd)]=function(_0x4d6689){const _0x13e3c3=_0xb52321,_0x3e8f09=_0x4d6689[_0x13e3c3(0x164)]['result'];!_0x3e8f09[_0x13e3c3(0x275)][_0x13e3c3(0x27e)](KEYS_STORE)&&_0x3e8f09[_0x13e3c3(0x305)](KEYS_STORE,{'keyPath':'id'}),!_0x3e8f09['objectStoreNames'][_0x13e3c3(0x27e)](SETTINGS_STORE)&&_0x3e8f09['createObjectStore'](SETTINGS_STORE,{'keyPath':'id'});},_0x5d1b56['onsuccess']=function(_0x330b84){const _0xf18a8=_0xb52321;db=_0x330b84[_0xf18a8(0x164)][_0xf18a8(0x206)],console[_0xf18a8(0x241)]('Database\x20initialized\x20successfully'),_0xff069d();},_0x5d1b56['onerror']=function(_0x4ec794){const _0x311ab8=_0xb52321;console['error'](_0x311ab8(0x170),_0x4ec794[_0x311ab8(0x164)][_0x311ab8(0x334)]),showStatus(_0x311ab8(0x24b),_0x311ab8(0x2c4),_0x311ab8(0x19e)),appSettings[_0x311ab8(0x2a1)]=![],_0xff069d();};});}function switchTab(_0x1f70bb){const _0x570ac3=_0x378a5e;console[_0x570ac3(0x241)]('Switching\x20to\x20tab:',_0x1f70bb),tabBtns[_0x570ac3(0x264)](_0x87ae22=>{const _0x5218ed=_0x570ac3;_0x87ae22[_0x5218ed(0x209)](_0x5218ed(0x1c9))===_0x1f70bb?_0x87ae22['classList'][_0x5218ed(0x19f)](_0x5218ed(0x1d0)):_0x87ae22[_0x5218ed(0x1d2)][_0x5218ed(0x2f3)](_0x5218ed(0x1d0));}),document['getElementById'](_0x570ac3(0x137))[_0x570ac3(0x1ad)]='',document[_0x570ac3(0x2fd)](_0x570ac3(0x265))[_0x570ac3(0x1ad)]='',document[_0x570ac3(0x2fd)](_0x570ac3(0x261))[_0x570ac3(0x320)]=_0x570ac3(0x172),document[_0x570ac3(0x2fd)](_0x570ac3(0x261))[_0x570ac3(0x13c)]='',document[_0x570ac3(0x2fd)](_0x570ac3(0x18b))['value']='',document[_0x570ac3(0x2fd)](_0x570ac3(0x199))[_0x570ac3(0x1ad)]='',document['getElementById'](_0x570ac3(0x152))['style'][_0x570ac3(0x1e2)]='none',document[_0x570ac3(0x2fd)](_0x570ac3(0x175))[_0x570ac3(0x1ad)]='',document['getElementById']('encryptSign')[_0x570ac3(0x326)]=![],document[_0x570ac3(0x2fd)](_0x570ac3(0x242))['style'][_0x570ac3(0x1e2)]=_0x570ac3(0x2c5),clearEncryptFile(),document[_0x570ac3(0x2fd)]('encryptedMessage')[_0x570ac3(0x1ad)]='',document[_0x570ac3(0x2fd)](_0x570ac3(0x1ac))['value']='',document[_0x570ac3(0x2fd)](_0x570ac3(0x2f4))[_0x570ac3(0x320)]=_0x570ac3(0x172),document[_0x570ac3(0x2fd)](_0x570ac3(0x2f4))[_0x570ac3(0x13c)]='',document[_0x570ac3(0x2fd)]('decryptionKey')[_0x570ac3(0x1ad)]='',document[_0x570ac3(0x2fd)](_0x570ac3(0x2a3))['value']='',document[_0x570ac3(0x2fd)](_0x570ac3(0x29b))[_0x570ac3(0x189)][_0x570ac3(0x1e2)]=_0x570ac3(0x2c5),document[_0x570ac3(0x2fd)](_0x570ac3(0x2ee))[_0x570ac3(0x1ad)]='',document['getElementById']('decryptVerify')[_0x570ac3(0x326)]=![],document['getElementById'](_0x570ac3(0x21c))[_0x570ac3(0x189)][_0x570ac3(0x1e2)]='none',clearDecryptFile(),window[_0x570ac3(0x223)]=null,document['getElementById'](_0x570ac3(0x25e))[_0x570ac3(0x1d2)][_0x570ac3(0x2f3)]('active'),document['getElementById']('decrypt')[_0x570ac3(0x1d2)][_0x570ac3(0x2f3)](_0x570ac3(0x1d0)),document[_0x570ac3(0x2fd)](_0x570ac3(0x13d))[_0x570ac3(0x1d2)][_0x570ac3(0x2f3)](_0x570ac3(0x1d0)),document['getElementById'](_0x570ac3(0x217))[_0x570ac3(0x1d2)][_0x570ac3(0x2f3)](_0x570ac3(0x1d0)),document['getElementById'](_0x570ac3(0x33e))[_0x570ac3(0x1d2)][_0x570ac3(0x2f3)]('active'),document['getElementById'](_0x1f70bb)[_0x570ac3(0x1d2)][_0x570ac3(0x19f)](_0x570ac3(0x1d0));}function setLoading(_0x5a281e){const _0x4d8f9c=_0x378a5e;loadingOverlay[_0x4d8f9c(0x189)]['display']=_0x5a281e?_0x4d8f9c(0x162):_0x4d8f9c(0x2c5);}async function loadSettings(){const _0x5595c9=_0x378a5e;if(appSettings[_0x5595c9(0x2a1)]&&db)try{const _0x3e483f=await getFromDatabase(SETTINGS_STORE,_0x5595c9(0x2dd));_0x3e483f&&(appSettings={...DEFAULT_SETTINGS,..._0x3e483f});}catch(_0x1065f7){console['error']('Error\x20loading\x20settings\x20from\x20database:',_0x1065f7);try{const _0x11880e=localStorage[_0x5595c9(0x1e0)](_0x5595c9(0x150));_0x11880e&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x5595c9(0x1d8)](_0x11880e)});}catch(_0xb821a0){console[_0x5595c9(0x334)](_0x5595c9(0x198),_0xb821a0);}}else try{const _0x4043fe=localStorage[_0x5595c9(0x1e0)](_0x5595c9(0x150));_0x4043fe&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x5595c9(0x1d8)](_0x4043fe)});}catch(_0x3c7112){console[_0x5595c9(0x334)](_0x5595c9(0x198),_0x3c7112);}return PBKDF2_CONFIG['ITERATIONS']=appSettings[_0x5595c9(0x1d3)],appSettings;}function initSettingsUI(){const _0x514740=_0x378a5e;document[_0x514740(0x2fd)](_0x514740(0x2a1))[_0x514740(0x326)]=appSettings[_0x514740(0x2a1)],document[_0x514740(0x2fd)](_0x514740(0x2c0))[_0x514740(0x326)]=appSettings['sessionOnly'],document[_0x514740(0x2fd)](_0x514740(0x2cb))['checked']=appSettings['enforcePwdProtection'],document[_0x514740(0x2fd)](_0x514740(0x2ac))['checked']=appSettings[_0x514740(0x2ac)],document[_0x514740(0x2fd)](_0x514740(0x1d9))[_0x514740(0x326)]=localStorage['getItem'](_0x514740(0x2ed))==='true',document['getElementById']('pbkdf2Iterations')[_0x514740(0x1ad)]=appSettings[_0x514740(0x1d3)],applyTheme(appSettings[_0x514740(0x270)]);}async function saveSettings(){const _0x149699=_0x378a5e;try{appSettings[_0x149699(0x2a1)]=document[_0x149699(0x2fd)]('useIndexedDB')[_0x149699(0x326)],appSettings[_0x149699(0x2c0)]=document[_0x149699(0x2fd)]('sessionOnly')[_0x149699(0x326)],appSettings[_0x149699(0x2cb)]=document[_0x149699(0x2fd)](_0x149699(0x2cb))['checked'],appSettings[_0x149699(0x2ac)]=document['getElementById'](_0x149699(0x2ac))[_0x149699(0x326)],appSettings[_0x149699(0x1d9)]=document['getElementById'](_0x149699(0x1d9))[_0x149699(0x326)],appSettings[_0x149699(0x1d3)]=parseInt(document[_0x149699(0x2fd)](_0x149699(0x1d3))[_0x149699(0x1ad)]);const _0x2b1ebc=document[_0x149699(0x2c3)](_0x149699(0x33a));appSettings[_0x149699(0x270)]=_0x2b1ebc?_0x2b1ebc[_0x149699(0x17f)]['theme']:null,handleDarkModeToggle(),PBKDF2_CONFIG[_0x149699(0x2f7)]=appSettings[_0x149699(0x1d3)],appSettings[_0x149699(0x2a1)]&&db?await saveToDatabase(SETTINGS_STORE,{'id':_0x149699(0x2dd),...appSettings}):localStorage['setItem'](_0x149699(0x150),JSON['stringify'](appSettings)),showStatus(_0x149699(0x321),_0x149699(0x293),'success');}catch(_0x24ca1a){console['error'](_0x149699(0x245),_0x24ca1a),showStatus('settingsStatus','Error\x20saving\x20settings:\x20'+_0x24ca1a[_0x149699(0x2ae)],'error');}}function resetSettings(){const _0x12633a=_0x378a5e,_0x652a7f=confirm(_0x12633a(0x214));if(!_0x652a7f)return;appSettings={...DEFAULT_SETTINGS},initSettingsUI(),saveSettings();}function updatePasswordStrength(){const _0x5ad0aa=_0x378a5e,_0x1523c9=document[_0x5ad0aa(0x2fd)](_0x5ad0aa(0x22f))[_0x5ad0aa(0x1ad)],_0xf6839b=validator[_0x5ad0aa(0x1ae)](_0x1523c9),_0x470eab=document[_0x5ad0aa(0x2fd)]('passwordStrength'),_0x10a64c=document[_0x5ad0aa(0x2fd)](_0x5ad0aa(0x2b8));_0x470eab[_0x5ad0aa(0x320)]=_0x5ad0aa(0x2da),_0x1523c9?(_0x470eab[_0x5ad0aa(0x1d2)][_0x5ad0aa(0x19f)](_0xf6839b[_0x5ad0aa(0x31e)]),_0x10a64c[_0x5ad0aa(0x13c)]=_0xf6839b[_0x5ad0aa(0x2e8)]):_0x10a64c[_0x5ad0aa(0x13c)]='';}async function loadKeys(){const _0x325cf5=_0x378a5e;try{keys=[];if(appSettings[_0x325cf5(0x2a1)]&&db){const _0x49cbab=await getAllFromDatabase(KEYS_STORE);_0x49cbab&&_0x49cbab[_0x325cf5(0x256)]>0x0&&(keys=_0x49cbab);}else{const _0x3be106=localStorage[_0x325cf5(0x1e0)](_0x325cf5(0x22c));_0x3be106&&(keys=JSON['parse'](_0x3be106));}checkExpiredKeys(),updateKeysList(),updateKeySelects();}catch(_0x3181f3){console[_0x325cf5(0x334)](_0x325cf5(0x1d7),_0x3181f3),showStatus(_0x325cf5(0x24b),_0x325cf5(0x14f)+_0x3181f3[_0x325cf5(0x2ae)],_0x325cf5(0x334));}}async function saveKeys(){const _0x41ee11=_0x378a5e;try{if(appSettings['sessionOnly'])console[_0x41ee11(0x241)](_0x41ee11(0x18e));else{if(appSettings[_0x41ee11(0x2a1)]&&db){await clearDatabase(KEYS_STORE);for(const _0xa523d8 of keys){await saveToDatabase(KEYS_STORE,_0xa523d8);}}else localStorage[_0x41ee11(0x2d5)](_0x41ee11(0x22c),JSON[_0x41ee11(0x181)](keys));}updateKeysList(),updateKeySelects();}catch(_0x455866){console[_0x41ee11(0x334)](_0x41ee11(0x18d),_0x455866),showStatus(_0x41ee11(0x24b),_0x41ee11(0x18f)+_0x455866[_0x41ee11(0x2ae)],_0x41ee11(0x334));}}function checkExpiredKeys(){const _0x2685e7=_0x378a5e,_0x24b081=new Date(),_0x3d5b1c=[];keys[_0x2685e7(0x264)](_0x44d8af=>{const _0x19e065=_0x2685e7;if(_0x44d8af[_0x19e065(0x288)]){const _0x7e8617=new Date(_0x44d8af[_0x19e065(0x288)]);_0x7e8617<_0x24b081&&_0x3d5b1c[_0x19e065(0x1a8)](_0x44d8af['id']);}}),_0x3d5b1c[_0x2685e7(0x256)]>0x0&&(keys=keys[_0x2685e7(0x1b4)](_0x28a92b=>!_0x3d5b1c[_0x2685e7(0x25c)](_0x28a92b['id'])),saveKeys(),showStatus(_0x2685e7(0x24b),_0x3d5b1c[_0x2685e7(0x256)]+_0x2685e7(0x31a),_0x2685e7(0x19e)));}async function generateKey(){const _0x73dc97=_0x378a5e;try{setLoading(!![]);const _0x129d7f=document[_0x73dc97(0x2fd)](_0x73dc97(0x29c))[_0x73dc97(0x1ad)]['trim'](),_0x203e19=document['getElementById'](_0x73dc97(0x1a9))[_0x73dc97(0x1ad)],_0x4faf26=document[_0x73dc97(0x2fd)]('keyPassword')[_0x73dc97(0x1ad)],_0xf52f68=document[_0x73dc97(0x2fd)](_0x73dc97(0x1e3))[_0x73dc97(0x1ad)],_0x3f1706=document[_0x73dc97(0x2fd)](_0x73dc97(0x31f))['value'];if(!_0x129d7f){showStatus(_0x73dc97(0x24b),_0x73dc97(0x2e9),_0x73dc97(0x334));return;}if(!validator[_0x73dc97(0x197)](_0x129d7f)){showStatus(_0x73dc97(0x24b),'Key\x20name\x20can\x20only\x20contain\x20letters,\x20numbers,\x20spaces,\x20and\x20basic\x20punctuation\x20(._-)',_0x73dc97(0x334));return;}if(appSettings[_0x73dc97(0x2cb)]&&!_0x4faf26){showStatus('keyStatus',_0x73dc97(0x2f9),_0x73dc97(0x334));return;}if(_0x4faf26){const _0x336d38=validator[_0x73dc97(0x1ae)](_0x4faf26);if(_0x336d38['score']<0x4){showStatus(_0x73dc97(0x24b),'Please\x20use\x20a\x20stronger\x20password:\x20'+_0x336d38[_0x73dc97(0x2e8)],_0x73dc97(0x334));return;}if(_0x4faf26!==_0xf52f68){showStatus('keyStatus',_0x73dc97(0x20d),_0x73dc97(0x334));return;}}if(appSettings[_0x73dc97(0x2ac)]&&!_0x3f1706){showStatus('keyStatus',_0x73dc97(0x2a5),_0x73dc97(0x334));return;}const _0x1e1d38={'id':crypto[_0x73dc97(0x19d)](),'name':_0x129d7f,'type':_0x203e19,'created':new Date()[_0x73dc97(0x16c)]()};if(_0x3f1706){const _0x8b6f8e=parseInt(_0x3f1706),_0x60e933=new Date();_0x60e933[_0x73dc97(0x1e4)](_0x60e933[_0x73dc97(0x2b3)]()+_0x8b6f8e),_0x1e1d38[_0x73dc97(0x288)]=_0x60e933[_0x73dc97(0x16c)]();}const _0xbdaa88=_0x203e19==='rsa'||_0x203e19===_0x73dc97(0x2c1)||_0x203e19===_0x73dc97(0x1f6)||_0x203e19===_0x73dc97(0x23a)||_0x203e19===_0x73dc97(0x283);_0xbdaa88&&(_0x1e1d38[_0x73dc97(0x216)]=!![],_0x1e1d38[_0x73dc97(0x13f)]=!![],_0x1e1d38[_0x73dc97(0x165)]=_0x1e1d38['id']);if(_0x203e19===_0x73dc97(0x155))await generateAESKey(_0x1e1d38,_0x4faf26);else{if(_0x203e19==='rsa')await generateRSAKey(_0x1e1d38,_0x4faf26,RSA_CONFIG[_0x73dc97(0x2d4)]);else{if(_0x203e19===_0x73dc97(0x2c1))await generateRSAKey(_0x1e1d38,_0x4faf26,RSA_CONFIG['KEY_SIZE_4096']);else{if(_0x203e19==='ecc')await generateECCKey(_0x1e1d38,_0x4faf26,ECC_CONFIG[_0x73dc97(0x2b4)]);else{if(_0x203e19===_0x73dc97(0x23a))await generateECCKey(_0x1e1d38,_0x4faf26,ECC_CONFIG['CURVE_P384']);else _0x203e19===_0x73dc97(0x283)&&await generateECCKey(_0x1e1d38,_0x4faf26,ECC_CONFIG['CURVE_P521']);}}}}keys[_0x73dc97(0x1a8)](_0x1e1d38),await saveKeys(),document[_0x73dc97(0x2fd)](_0x73dc97(0x29c))[_0x73dc97(0x1ad)]='',document[_0x73dc97(0x2fd)](_0x73dc97(0x22f))['value']='',document[_0x73dc97(0x2fd)](_0x73dc97(0x1e3))[_0x73dc97(0x1ad)]='',document[_0x73dc97(0x2fd)](_0x73dc97(0x289))[_0x73dc97(0x320)]='password-strength',document[_0x73dc97(0x2fd)](_0x73dc97(0x2b8))[_0x73dc97(0x13c)]='';const _0x296aaa=getKeyTypeDisplay(_0x1e1d38);showStatus(_0x73dc97(0x24b),_0x296aaa+_0x73dc97(0x309)+_0x129d7f+_0x73dc97(0x285),_0x73dc97(0x1db));}catch(_0xb0146f){console[_0x73dc97(0x334)]('Error\x20generating\x20key:',_0xb0146f),showStatus(_0x73dc97(0x24b),_0x73dc97(0x2e4)+_0xb0146f['message'],_0x73dc97(0x334));}finally{setLoading(![]);}}function getPairedKeyIds(_0x322560){const _0x45a3b4=_0x378a5e;if(_0x322560[_0x45a3b4(0x165)])return _0x322560[_0x45a3b4(0x165)];if(_0x322560['hasPrivate']&&_0x322560[_0x45a3b4(0x216)])return _0x322560['id'];if((_0x322560[_0x45a3b4(0x1eb)]==='rsa'||_0x322560[_0x45a3b4(0x1eb)]===_0x45a3b4(0x2c1)||_0x322560[_0x45a3b4(0x1eb)]===_0x45a3b4(0x1f6)||_0x322560[_0x45a3b4(0x1eb)]===_0x45a3b4(0x23a))&&(_0x322560[_0x45a3b4(0x216)]||_0x322560[_0x45a3b4(0x13f)])){const _0x2e588f=keys[_0x45a3b4(0x1b4)](_0xd8603f=>_0xd8603f['id']!==_0x322560['id']&&_0xd8603f['type']===_0x322560[_0x45a3b4(0x1eb)]&&(_0x322560[_0x45a3b4(0x216)]&&_0xd8603f[_0x45a3b4(0x13f)]||_0x322560['hasPrivate']&&_0xd8603f[_0x45a3b4(0x216)])&&(_0xd8603f['publicKeyHash']&&_0x322560[_0x45a3b4(0x2df)]&&_0xd8603f[_0x45a3b4(0x2df)]===_0x322560['publicKeyHash']));if(_0x2e588f[_0x45a3b4(0x256)]>0x0)return _0x2e588f[0x0]['id'];}return null;}function zeroAllKeys(){const _0x18dbf6=_0x378a5e;if(keys['length']===0x0){showStatus(_0x18dbf6(0x24b),_0x18dbf6(0x1ce),_0x18dbf6(0x19e));return;}const _0x39e84b=confirm('WARNING:\x20This\x20will\x20permanently\x20delete\x20ALL\x20your\x20encryption\x20keys.\x20This\x20action\x20CANNOT\x20be\x20undone.\x0a\x0aAre\x20you\x20absolutely\x20sure\x20you\x20want\x20to\x20continue?');if(_0x39e84b){const _0xcf6c4=keys[_0x18dbf6(0x256)];keys=[],appSettings[_0x18dbf6(0x2a1)]&&db?clearDatabase(KEYS_STORE)[_0x18dbf6(0x1c2)](()=>{console['log']('All\x20keys\x20cleared\x20from\x20database');})[_0x18dbf6(0x13b)](_0x2224b7=>{const _0xa728f=_0x18dbf6;console[_0xa728f(0x334)](_0xa728f(0x25d),_0x2224b7);}):localStorage[_0x18dbf6(0x2a9)]('LemonadeKeys'),updateKeysList(),updateKeySelects(),showStatus(_0x18dbf6(0x24b),'All\x20keys\x20('+_0xcf6c4+_0x18dbf6(0x301),_0x18dbf6(0x1db));}else showStatus(_0x18dbf6(0x24b),_0x18dbf6(0x2ba),_0x18dbf6(0x1dd));}async function generateAESKey(_0x2aa9ee,_0xd440bb){const _0x4c7b9e=_0x378a5e,_0x414c1a=await window['crypto']['subtle'][_0x4c7b9e(0x1b1)]({'name':AES_CONFIG[_0x4c7b9e(0x1b8)],'length':AES_CONFIG[_0x4c7b9e(0x2c8)]},!![],[_0x4c7b9e(0x25e),_0x4c7b9e(0x2a7)]),_0x20c07a=await window['crypto'][_0x4c7b9e(0x16f)][_0x4c7b9e(0x184)](_0x4c7b9e(0x262),_0x414c1a);_0x2aa9ee[_0x4c7b9e(0x2e2)]=arrayBufferToBase64(_0x20c07a),_0x2aa9ee[_0x4c7b9e(0x20f)]=AES_CONFIG[_0x4c7b9e(0x1b8)],_0x2aa9ee[_0x4c7b9e(0x256)]=AES_CONFIG[_0x4c7b9e(0x2c8)],_0xd440bb&&await encryptKeyWithPassword(_0x2aa9ee,_0xd440bb);}async function generateRSAKey(_0x4402f3,_0x5b6642,_0x3a4652){const _0x191532=_0x378a5e,_0x5d41ad=await window[_0x191532(0x1e6)][_0x191532(0x16f)][_0x191532(0x1b1)]({'name':RSA_CONFIG[_0x191532(0x1e5)],'modulusLength':_0x3a4652,'publicExponent':new Uint8Array([0x1,0x0,0x1]),'hash':RSA_CONFIG['HASH']},!![],[_0x191532(0x25e),_0x191532(0x2a7)]),_0x1b67e3=await window[_0x191532(0x1e6)][_0x191532(0x16f)][_0x191532(0x184)](_0x191532(0x27d),_0x5d41ad[_0x191532(0x203)]),_0x172199=await window[_0x191532(0x1e6)][_0x191532(0x16f)][_0x191532(0x184)](_0x191532(0x335),_0x5d41ad[_0x191532(0x1a0)]);_0x4402f3[_0x191532(0x203)]=arrayBufferToBase64(_0x1b67e3),_0x4402f3[_0x191532(0x1a0)]=arrayBufferToBase64(_0x172199),_0x4402f3[_0x191532(0x20f)]=RSA_CONFIG[_0x191532(0x1e5)],_0x4402f3['length']=_0x3a4652;const _0x37831d=await window[_0x191532(0x1e6)][_0x191532(0x16f)][_0x191532(0x1b1)]({'name':SIGN_CONFIG[_0x191532(0x19a)],'modulusLength':_0x3a4652,'publicExponent':new Uint8Array([0x1,0x0,0x1]),'hash':SIGN_CONFIG[_0x191532(0x218)]},!![],[_0x191532(0x2de),_0x191532(0x144)]),_0x45e385=await window[_0x191532(0x1e6)]['subtle']['exportKey'](_0x191532(0x27d),_0x37831d['publicKey']),_0x3229a3=await window[_0x191532(0x1e6)][_0x191532(0x16f)][_0x191532(0x184)]('pkcs8',_0x37831d['privateKey']);_0x4402f3['signingPublicKey']=arrayBufferToBase64(_0x45e385),_0x4402f3[_0x191532(0x337)]=arrayBufferToBase64(_0x3229a3),_0x4402f3[_0x191532(0x2d2)]=!![],_0x4402f3['hasSigningPrivate']=!![];const _0x3e66ad=await computeKeyHash(_0x1b67e3);_0x4402f3[_0x191532(0x2df)]=_0x3e66ad,_0x5b6642&&await encryptKeyWithPassword(_0x4402f3,_0x5b6642);}async function generateECCKey(_0x10a056,_0x278c2d,_0x33eb20){const _0x541976=_0x378a5e,_0x4b38c8=await window[_0x541976(0x1e6)][_0x541976(0x16f)][_0x541976(0x1b1)]({'name':_0x541976(0x17b),'namedCurve':_0x33eb20},!![],[_0x541976(0x1aa),_0x541976(0x295)]),_0x522a28=await window[_0x541976(0x1e6)]['subtle'][_0x541976(0x184)](_0x541976(0x27d),_0x4b38c8[_0x541976(0x203)]),_0x2a0edc=await window[_0x541976(0x1e6)][_0x541976(0x16f)]['exportKey'](_0x541976(0x335),_0x4b38c8[_0x541976(0x1a0)]);_0x10a056[_0x541976(0x203)]=arrayBufferToBase64(_0x522a28),_0x10a056['privateKey']=arrayBufferToBase64(_0x2a0edc),_0x10a056[_0x541976(0x20f)]=_0x541976(0x17b),_0x10a056[_0x541976(0x1cf)]=_0x33eb20;const _0x910737=await window[_0x541976(0x1e6)][_0x541976(0x16f)][_0x541976(0x1b1)]({'name':SIGN_CONFIG[_0x541976(0x195)],'namedCurve':_0x33eb20},!![],[_0x541976(0x2de),'verify']),_0x3a690c=await window[_0x541976(0x1e6)][_0x541976(0x16f)][_0x541976(0x184)](_0x541976(0x27d),_0x910737[_0x541976(0x203)]),_0x372852=await window[_0x541976(0x1e6)]['subtle'][_0x541976(0x184)](_0x541976(0x335),_0x910737[_0x541976(0x1a0)]);_0x10a056[_0x541976(0x140)]=arrayBufferToBase64(_0x3a690c),_0x10a056[_0x541976(0x337)]=arrayBufferToBase64(_0x372852),_0x10a056[_0x541976(0x2d2)]=!![],_0x10a056['hasSigningPrivate']=!![];const _0x3ad35f=await computeKeyHash(_0x522a28);_0x10a056[_0x541976(0x2df)]=_0x3ad35f,_0x278c2d&&await encryptKeyWithPassword(_0x10a056,_0x278c2d);}async function computeKeyHash(_0x152a86){const _0x432db1=_0x378a5e,_0x1f4188=await crypto[_0x432db1(0x16f)][_0x432db1(0x191)](_0x432db1(0x276),_0x152a86);return arrayBufferToBase64(_0x1f4188);}async function encryptKeyWithPassword(_0x3f8256,_0x366f6e){const _0x836ada=_0x378a5e,_0x2002c8=window[_0x836ada(0x1e6)]['getRandomValues'](new Uint8Array(0x10));_0x3f8256[_0x836ada(0x1b2)]=arrayBufferToBase64(_0x2002c8);const _0x32d14a=await deriveKeyFromPassword(_0x366f6e,_0x2002c8),_0x229ee9=window[_0x836ada(0x1e6)]['getRandomValues'](new Uint8Array(AES_CONFIG[_0x836ada(0x1ca)]));_0x3f8256['iv']=arrayBufferToBase64(_0x229ee9);if(_0x3f8256[_0x836ada(0x1eb)]===_0x836ada(0x155)){const _0x2acc0e=await encryptWithDerivedKey(_0x32d14a,base64ToArrayBuffer(_0x3f8256[_0x836ada(0x2e2)]),_0x229ee9);_0x3f8256[_0x836ada(0x2e2)]=arrayBufferToBase64(_0x2acc0e),_0x3f8256[_0x836ada(0x2cd)]=!![];}else{const _0x26b3fd=await encryptWithDerivedKey(_0x32d14a,base64ToArrayBuffer(_0x3f8256[_0x836ada(0x1a0)]),_0x229ee9);_0x3f8256['privateKey']=arrayBufferToBase64(_0x26b3fd);if(_0x3f8256[_0x836ada(0x337)]){const _0x53bd28=await encryptWithDerivedKey(_0x32d14a,base64ToArrayBuffer(_0x3f8256['signingPrivateKey']),_0x229ee9);_0x3f8256[_0x836ada(0x337)]=arrayBufferToBase64(_0x53bd28);}_0x3f8256[_0x836ada(0x2cd)]=!![];}}async function decryptKeyWithPassword(_0x44123b,_0x3cb0b0){const _0x4c824a=_0x378a5e;try{if(!_0x44123b||!_0x3cb0b0)throw new Error('Key\x20data\x20and\x20password\x20are\x20required');if(!_0x44123b[_0x4c824a(0x1b2)]||!_0x44123b['iv'])throw new Error(_0x4c824a(0x205));const _0xdb1a2c=base64ToArrayBuffer(_0x44123b[_0x4c824a(0x1b2)]),_0x321984=await deriveKeyFromPassword(_0x3cb0b0,_0xdb1a2c),_0x42abf5=base64ToArrayBuffer(_0x44123b['iv']),_0x48b757={..._0x44123b};if(_0x44123b[_0x4c824a(0x1eb)]===_0x4c824a(0x155)){if(!_0x44123b[_0x4c824a(0x2e2)])throw new Error('Missing\x20encrypted\x20key\x20data');const _0x83cc70=await decryptWithDerivedKey(_0x321984,base64ToArrayBuffer(_0x44123b[_0x4c824a(0x2e2)]),_0x42abf5);_0x48b757[_0x4c824a(0x2e2)]=arrayBufferToBase64(_0x83cc70),_0x48b757[_0x4c824a(0x299)]=await importAESKey(_0x83cc70);}else{if(_0x44123b['type']===_0x4c824a(0x25b)||_0x44123b[_0x4c824a(0x1eb)]===_0x4c824a(0x2c1)||_0x44123b['type']===_0x4c824a(0x1f6)||_0x44123b[_0x4c824a(0x1eb)]===_0x4c824a(0x23a)||_0x44123b[_0x4c824a(0x1eb)]===_0x4c824a(0x283)){if(!_0x44123b[_0x4c824a(0x1a0)])throw new Error(_0x4c824a(0x13e));const _0x375419=await decryptWithDerivedKey(_0x321984,base64ToArrayBuffer(_0x44123b[_0x4c824a(0x1a0)]),_0x42abf5);_0x48b757[_0x4c824a(0x1a0)]=arrayBufferToBase64(_0x375419);_0x44123b['type'][_0x4c824a(0x25c)](_0x4c824a(0x25b))?(_0x48b757[_0x4c824a(0x322)]=await importRSAPrivateKey(_0x375419,_0x44123b[_0x4c824a(0x256)]||RSA_CONFIG[_0x4c824a(0x2d4)]),_0x44123b[_0x4c824a(0x203)]&&(_0x48b757[_0x4c824a(0x1af)]=await importRSAPublicKey(base64ToArrayBuffer(_0x44123b[_0x4c824a(0x203)]),_0x44123b[_0x4c824a(0x256)]||RSA_CONFIG[_0x4c824a(0x2d4)]))):(_0x48b757['_privateKey']=await importECCPrivateKey(_0x375419,_0x44123b[_0x4c824a(0x1cf)]||ECC_CONFIG[_0x4c824a(0x2b4)]),_0x44123b[_0x4c824a(0x203)]&&(_0x48b757['_publicKey']=await importECCPublicKey(base64ToArrayBuffer(_0x44123b[_0x4c824a(0x203)]),_0x44123b[_0x4c824a(0x1cf)]||ECC_CONFIG[_0x4c824a(0x2b4)],_0x4c824a(0x27d))));if(_0x44123b[_0x4c824a(0x337)]){const _0x68f086=await decryptWithDerivedKey(_0x321984,base64ToArrayBuffer(_0x44123b[_0x4c824a(0x337)]),_0x42abf5);_0x48b757[_0x4c824a(0x337)]=arrayBufferToBase64(_0x68f086);const _0x145854=_0x44123b['type'][_0x4c824a(0x25c)](_0x4c824a(0x25b)),_0x3fcbd5=_0x145854?SIGN_CONFIG[_0x4c824a(0x19a)]:SIGN_CONFIG[_0x4c824a(0x195)],_0x2c13da=_0x145854?{'name':_0x3fcbd5,'hash':SIGN_CONFIG[_0x4c824a(0x218)]}:{'name':_0x3fcbd5,'namedCurve':_0x44123b['curve']||ECC_CONFIG['CURVE']};_0x48b757['_signingPrivateKey']=await window[_0x4c824a(0x1e6)][_0x4c824a(0x16f)][_0x4c824a(0x2f6)]('pkcs8',_0x68f086,_0x2c13da,![],[_0x4c824a(0x2de)]);}}else throw new Error('Unsupported\x20key\x20type:\x20'+_0x44123b['type']);}return safeMemory[_0x4c824a(0x23f)](_0x48b757);}catch(_0x2681ce){console[_0x4c824a(0x334)]('Decryption\x20error:',_0x2681ce);throw new Error(_0x4c824a(0x204));}}function updateKeysList(){const _0x201613=_0x378a5e;keysList[_0x201613(0x30b)]='';if(keys[_0x201613(0x256)]===0x0){keysList[_0x201613(0x30b)]=_0x201613(0x235);return;}keys['forEach'](_0x2ca3b2=>{const _0xd894ae=_0x201613,_0x3fc4f6=document['createElement'](_0xd894ae(0x182));_0x3fc4f6[_0xd894ae(0x320)]='key-item';const _0x1ca6c2=getKeyTypeDisplay(_0x2ca3b2),_0x1f2aef=_0x2ca3b2['protected']?_0xd894ae(0x2f2):'';let _0x8bd9fd='';if(_0x2ca3b2[_0xd894ae(0x1eb)]===_0xd894ae(0x155))_0x8bd9fd='';else{if(_0x2ca3b2['hasPrivate']&&_0x2ca3b2[_0xd894ae(0x216)])_0x8bd9fd=_0xd894ae(0x271);else{if(_0x2ca3b2['hasPrivate'])_0x8bd9fd=_0xd894ae(0x296);else _0x2ca3b2[_0xd894ae(0x216)]&&(_0x8bd9fd=_0xd894ae(0x1d1));}}let _0x25b0d7='',_0x511eec=determineKeySecurityLevel(_0x2ca3b2);_0x25b0d7='<span\x20class=\x22security-badge\x20'+_0x511eec+'\x22>'+_0x511eec[_0xd894ae(0x23d)]()+_0xd894ae(0x143);let _0x1853c3='';if(_0x2ca3b2[_0xd894ae(0x288)]){const _0x2f9bd0=new Date(_0x2ca3b2['expiry']),_0x37b6c3=Math[_0xd894ae(0x16d)]((_0x2f9bd0-new Date())/(0x3e8*0x3c*0x3c*0x18));_0x1853c3=_0xd894ae(0x2d7)+_0x37b6c3+'\x20days\x20('+_0x2f9bd0[_0xd894ae(0x15c)]()+')</div>';}let _0x933039='';if(_0x2ca3b2[_0xd894ae(0x1eb)]==='aes')_0x933039+=_0xd894ae(0x237)+_0x2ca3b2['id']+_0xd894ae(0x2b0);else _0x2ca3b2[_0xd894ae(0x216)]&&(_0x933039+=_0xd894ae(0x237)+_0x2ca3b2['id']+'\x27)\x22>Export\x20Public</button>');_0x2ca3b2['type']!=='aes'&&_0x2ca3b2[_0xd894ae(0x13f)]&&(_0x933039+='<button\x20class=\x22btn-secondary\x20private-key-btn\x22\x20onclick=\x22exportPrivateKey(\x27'+_0x2ca3b2['id']+_0xd894ae(0x211)),_0x933039+=_0xd894ae(0x333)+_0x2ca3b2['id']+_0xd894ae(0x278),_0x3fc4f6[_0xd894ae(0x30b)]=_0xd894ae(0x2d0)+validator[_0xd894ae(0x14d)](_0x2ca3b2[_0xd894ae(0x2bf)])+'\x20('+_0x1ca6c2+_0x1f2aef+')\x20'+_0x25b0d7+_0xd894ae(0x1f5)+_0x8bd9fd+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Created:\x20'+new Date(_0x2ca3b2[_0xd894ae(0x232)])['toLocaleString']()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Algorithm:\x20'+(_0x2ca3b2[_0xd894ae(0x20f)]||'')+'\x20'+(_0x2ca3b2[_0xd894ae(0x256)]?_0x2ca3b2[_0xd894ae(0x256)]+_0xd894ae(0x2fc):_0x2ca3b2[_0xd894ae(0x1cf)]||'')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1853c3+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x933039+_0xd894ae(0x1d4),keysList[_0xd894ae(0x304)](_0x3fc4f6);});}function getKeyTypeDisplay(_0x496467){const _0x258cc1=_0x378a5e;if(_0x496467[_0x258cc1(0x1eb)]===_0x258cc1(0x155))return _0x258cc1(0x32f);else{if(_0x496467[_0x258cc1(0x1eb)]===_0x258cc1(0x25b))return _0x258cc1(0x14a);else{if(_0x496467[_0x258cc1(0x1eb)]===_0x258cc1(0x2c1))return'RSA-4096';else{if(_0x496467[_0x258cc1(0x1eb)]===_0x258cc1(0x1f6))return _0x258cc1(0x1ec);else{if(_0x496467[_0x258cc1(0x1eb)]===_0x258cc1(0x23a))return _0x258cc1(0x1d5);else{if(_0x496467[_0x258cc1(0x1eb)]===_0x258cc1(0x283))return _0x258cc1(0x302);}}}}}return _0x496467[_0x258cc1(0x1eb)][_0x258cc1(0x23d)]();}function updateKeySelects(){const _0x5efd22=_0x378a5e;encryptionKeySelect[_0x5efd22(0x30b)]=_0x5efd22(0x23b),decryptionKeySelect[_0x5efd22(0x30b)]=_0x5efd22(0x23b),keys['forEach'](_0xdf020a=>{const _0x554a69=_0x5efd22;if(_0xdf020a['type']==='aes'||_0xdf020a[_0x554a69(0x216)]){const _0x6aec16=document['createElement'](_0x554a69(0x14c));_0x6aec16[_0x554a69(0x1ad)]=_0xdf020a['id'];const _0x3fb375=getKeyTypeDisplay(_0xdf020a),_0xf5c5d2=_0xdf020a['protected']?_0x554a69(0x2f2):'';let _0x3fd019='';_0xdf020a[_0x554a69(0x1eb)]!==_0x554a69(0x155)&&(_0x3fd019=_0xdf020a[_0x554a69(0x13f)]&&_0xdf020a[_0x554a69(0x216)]?_0x554a69(0x2a0):_0x554a69(0x1e7)),_0x6aec16[_0x554a69(0x1f7)]=_0xdf020a['name']+'\x20('+_0x3fb375+_0x3fd019+_0xf5c5d2+')',encryptionKeySelect[_0x554a69(0x304)](_0x6aec16);}}),keys[_0x5efd22(0x264)](_0x1faf65=>{const _0xbfce9b=_0x5efd22;if(_0x1faf65[_0xbfce9b(0x1eb)]===_0xbfce9b(0x155)||_0x1faf65[_0xbfce9b(0x13f)]){const _0x22c463=document['createElement'](_0xbfce9b(0x14c));_0x22c463[_0xbfce9b(0x1ad)]=_0x1faf65['id'];const _0x4157e7=getKeyTypeDisplay(_0x1faf65),_0x489c62=_0x1faf65[_0xbfce9b(0x2cd)]?_0xbfce9b(0x2f2):'';let _0x5849ea='';_0x1faf65[_0xbfce9b(0x1eb)]!==_0xbfce9b(0x155)&&(_0x5849ea=_0x1faf65[_0xbfce9b(0x13f)]&&_0x1faf65[_0xbfce9b(0x216)]?_0xbfce9b(0x2a0):_0xbfce9b(0x2bb)),_0x22c463[_0xbfce9b(0x1f7)]=_0x1faf65['name']+'\x20('+_0x4157e7+_0x5849ea+_0x489c62+')',decryptionKeySelect[_0xbfce9b(0x304)](_0x22c463);}});}function handleEncryptionKeyChange(){const _0x15f62c=_0x378a5e,_0xb7c3f2=encryptionKeySelect[_0x15f62c(0x1ad)];document[_0x15f62c(0x2fd)](_0x15f62c(0x242))[_0x15f62c(0x189)][_0x15f62c(0x1e2)]=_0x15f62c(0x2c5),document[_0x15f62c(0x2fd)](_0x15f62c(0x234))['checked']=![];if(!_0xb7c3f2){document['getElementById']('encryptionPasswordGroup')[_0x15f62c(0x189)][_0x15f62c(0x1e2)]=_0x15f62c(0x2c5);return;}const _0x316cd6=keys[_0x15f62c(0x1dc)](_0x9fb6aa=>_0x9fb6aa['id']===_0xb7c3f2);if(!_0x316cd6)return;_0x316cd6[_0x15f62c(0x15a)]&&(document[_0x15f62c(0x2fd)](_0x15f62c(0x242))['style'][_0x15f62c(0x1e2)]=_0x15f62c(0x1da)),document[_0x15f62c(0x2fd)](_0x15f62c(0x152))[_0x15f62c(0x189)][_0x15f62c(0x1e2)]=_0x316cd6[_0x15f62c(0x2cd)]?_0x15f62c(0x1da):_0x15f62c(0x2c5);}function handleDecryptionKeyChange(){const _0x152e0f=_0x378a5e,_0x2f1c98=decryptionKeySelect[_0x152e0f(0x1ad)];document['getElementById'](_0x152e0f(0x21c))['style'][_0x152e0f(0x1e2)]=_0x152e0f(0x2c5),document['getElementById'](_0x152e0f(0x312))[_0x152e0f(0x326)]=![];if(!_0x2f1c98){document['getElementById'](_0x152e0f(0x29b))[_0x152e0f(0x189)][_0x152e0f(0x1e2)]=_0x152e0f(0x2c5);return;}const _0x570a19=keys[_0x152e0f(0x1dc)](_0x2620ea=>_0x2620ea['id']===_0x2f1c98);if(!_0x570a19)return;_0x570a19['hasSigningPublic']&&(document['getElementById'](_0x152e0f(0x21c))[_0x152e0f(0x189)][_0x152e0f(0x1e2)]=_0x152e0f(0x1da)),document[_0x152e0f(0x2fd)](_0x152e0f(0x29b))[_0x152e0f(0x189)][_0x152e0f(0x1e2)]=_0x570a19[_0x152e0f(0x2cd)]?_0x152e0f(0x1da):_0x152e0f(0x2c5);}async function encryptMessage(){const _0x547c54=_0x378a5e;try{let _0xe0f501,_0x352e6f='';if(encryptFileData)_0xe0f501=encryptFileData,_0x352e6f=generateRandomFileName(0x6)+_0x547c54(0x2eb);else{const _0x52e57d=document[_0x547c54(0x2fd)](_0x547c54(0x137))[_0x547c54(0x1ad)];if(!_0x52e57d){showStatus(_0x547c54(0x261),'Please\x20enter\x20a\x20message\x20or\x20add\x20a\x20file\x20to\x20encrypt',_0x547c54(0x334));return;}_0xe0f501=new TextEncoder()['encode'](_0x52e57d);}const _0x3c91bd=document[_0x547c54(0x2fd)](_0x547c54(0x18b))['value'],_0xd5983a=document[_0x547c54(0x2fd)](_0x547c54(0x199))[_0x547c54(0x1ad)];let _0x22281f=document[_0x547c54(0x2fd)]('encryptObfKey')[_0x547c54(0x1ad)];if(!_0x3c91bd){showStatus('encryptStatus',_0x547c54(0x28b),_0x547c54(0x334));return;}setLoading(!![]);const _0x2e7ecc=keys[_0x547c54(0x1dc)](_0x696cea=>_0x696cea['id']===_0x3c91bd);if(!_0x2e7ecc){showStatus('encryptStatus',_0x547c54(0x200),_0x547c54(0x334)),setLoading(![]);return;}let _0x30662b=null,_0x2c9f4b=_0x2e7ecc;if(_0x2e7ecc[_0x547c54(0x2cd)]){if(!_0xd5983a){showStatus(_0x547c54(0x261),_0x547c54(0x1c4),_0x547c54(0x334)),setLoading(![]);return;}try{_0x30662b=await decryptKeyWithPassword(_0x2e7ecc,_0xd5983a),_0x2c9f4b=safeMemory[_0x547c54(0x185)](_0x30662b);if(!_0x2c9f4b)throw new Error(_0x547c54(0x290));}catch(_0x591470){console[_0x547c54(0x334)](_0x547c54(0x287),_0x591470),showStatus('encryptStatus',_0x547c54(0x318),_0x547c54(0x334)),setLoading(![]);return;}}const _0x4b49f5=document[_0x547c54(0x2fd)]('encryptSign')[_0x547c54(0x326)];let _0x498256=await encryptData(_0xe0f501,_0x2c9f4b,_0x4b49f5);encryptFileData&&(_0x498256[_0x547c54(0x28a)]=encryptFileName,_0x498256[_0x547c54(0x323)]=encryptFileData[_0x547c54(0x300)],_0x498256[_0x547c54(0x254)]=!![]);const _0x1fdde3=createEncryptedMessageString(_0x498256,_0x22281f);_0x30662b&&safeMemory['delete'](_0x30662b),document['getElementById'](_0x547c54(0x265))[_0x547c54(0x1ad)]=_0x1fdde3,document[_0x547c54(0x2fd)](_0x547c54(0x31c))['setAttribute'](_0x547c54(0x15f),_0x352e6f),showStatus('encryptStatus','Message\x20encrypted\x20successfully','success');}catch(_0x180782){console[_0x547c54(0x334)](_0x547c54(0x1bf),{'errorType':_0x180782[_0x547c54(0x2b6)][_0x547c54(0x2bf)],'errorMessage':_0x180782[_0x547c54(0x2ae)],'stack':_0x180782[_0x547c54(0x147)]}),showStatus(_0x547c54(0x261),'Encryption\x20failed.\x20Please\x20check\x20your\x20key\x20and\x20message.',_0x547c54(0x334));}finally{document[_0x547c54(0x2fd)](_0x547c54(0x199))[_0x547c54(0x1ad)]='',setLoading(![]);}}async function encryptWithAES(_0x3952eb,_0x4353d1){const _0x497ded=_0x378a5e;try{const _0x537a29=window[_0x497ded(0x1e6)][_0x497ded(0x188)](new Uint8Array(AES_CONFIG['IV_LENGTH']));let _0x55faf4;if(_0x4353d1[_0x497ded(0x299)])_0x55faf4=_0x4353d1['_cryptoKey'];else{const _0x1aa260=base64ToArrayBuffer(_0x4353d1[_0x497ded(0x2e2)]);_0x55faf4=await window[_0x497ded(0x1e6)][_0x497ded(0x16f)][_0x497ded(0x2f6)]('raw',_0x1aa260,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG[_0x497ded(0x2c8)]},![],[_0x497ded(0x25e)]);}const _0x2f67f6=arrayBufferToBase64(_0x3952eb),_0x19be64=0x10+Math[_0x497ded(0x138)](Math[_0x497ded(0x1f9)]()*0xf1),_0x4107b5=window[_0x497ded(0x1e6)][_0x497ded(0x188)](new Uint8Array(_0x19be64)),_0x145a99=arrayBufferToBase64(_0x4107b5['buffer']),_0x1943c6={'k':_0x4353d1['id'],'t':new Date()['toISOString'](),'a':AES_CONFIG[_0x497ded(0x1b8)]};encryptFileData&&encryptFileName&&(_0x1943c6['f']={'n':encryptFileName,'s':encryptFileData[_0x497ded(0x300)]});const _0x251713={'msg':_0x2f67f6,'meta':_0x1943c6,'pad':_0x145a99},_0x22f535=JSON['stringify'](_0x251713),_0x5b67b0=new TextEncoder()[_0x497ded(0x1c3)](_0x22f535),_0x7dd28=await window['crypto'][_0x497ded(0x16f)][_0x497ded(0x25e)]({'name':AES_CONFIG[_0x497ded(0x1b8)],'iv':_0x537a29,'tagLength':AES_CONFIG[_0x497ded(0x2a2)]},_0x55faf4,_0x5b67b0),_0x4b58d5=new Uint8Array(_0x537a29[_0x497ded(0x300)]+_0x7dd28[_0x497ded(0x300)]);return _0x4b58d5['set'](_0x537a29,0x0),_0x4b58d5[_0x497ded(0x2c9)](new Uint8Array(_0x7dd28),_0x537a29[_0x497ded(0x300)]),{'version':0x4,'data':arrayBufferToBase64(_0x4b58d5['buffer'])};}catch(_0x41749d){console[_0x497ded(0x334)]('[ENCRYPT-AES]\x20Technical\x20error\x20details:',{'errorType':_0x41749d[_0x497ded(0x2b6)]['name'],'errorMessage':_0x41749d['message'],'stack':_0x41749d[_0x497ded(0x147)]});throw new Error(_0x497ded(0x292));}}async function deriveMetadataKey(_0x11b6a8,_0x40ddf6){const _0x1e917b=_0x378a5e,_0x2b6ef7=await window[_0x1e917b(0x1e6)]['subtle'][_0x1e917b(0x184)](_0x1e917b(0x262),_0x11b6a8),_0x3ffefe=new Uint8Array(_0x2b6ef7['byteLength']+_0x40ddf6[_0x1e917b(0x300)]);_0x3ffefe[_0x1e917b(0x2c9)](new Uint8Array(_0x2b6ef7),0x0),_0x3ffefe['set'](_0x40ddf6,_0x2b6ef7[_0x1e917b(0x300)]);const _0x115288=await window[_0x1e917b(0x1e6)]['subtle']['importKey'](_0x1e917b(0x262),_0x3ffefe,{'name':_0x1e917b(0x1c5)},![],[_0x1e917b(0x1aa)]);return window['crypto'][_0x1e917b(0x16f)][_0x1e917b(0x1aa)]({'name':'HKDF','hash':_0x1e917b(0x276),'salt':_0x40ddf6,'info':new Uint8Array([0x1,0x2,0x3,0x4])},_0x115288,{'name':AES_CONFIG[_0x1e917b(0x1b8)],'length':AES_CONFIG[_0x1e917b(0x2c8)]},![],['encrypt',_0x1e917b(0x2a7)]);}async function encryptWithRSA(_0x2e4344,_0x24bef1,_0x3f7be7){const _0x3a531f=_0x378a5e,_0x3b5a94=await window[_0x3a531f(0x1e6)]['subtle']['generateKey']({'name':AES_CONFIG[_0x3a531f(0x1b8)],'length':AES_CONFIG[_0x3a531f(0x2c8)]},!![],['encrypt']),_0x12d420=arrayBufferToBase64(_0x2e4344);let _0x251f4f=null;if(_0x3f7be7&&_0x24bef1['hasSigningPrivate'])try{let _0xfecaf5=_0x24bef1[_0x3a531f(0x327)];!_0xfecaf5&&_0x24bef1[_0x3a531f(0x337)]&&(_0xfecaf5=await window[_0x3a531f(0x1e6)][_0x3a531f(0x16f)]['importKey'](_0x3a531f(0x335),base64ToArrayBuffer(_0x24bef1[_0x3a531f(0x337)]),{'name':SIGN_CONFIG['RSA_ALGORITHM'],'hash':SIGN_CONFIG['HASH']},![],[_0x3a531f(0x2de)]));if(_0xfecaf5){const _0x51c76c=await window[_0x3a531f(0x1e6)][_0x3a531f(0x16f)][_0x3a531f(0x2de)]({'name':SIGN_CONFIG[_0x3a531f(0x19a)],'saltLength':SIGN_CONFIG[_0x3a531f(0x247)]},_0xfecaf5,_0x2e4344);_0x251f4f=arrayBufferToBase64(_0x51c76c);}}catch(_0x38adf9){console[_0x3a531f(0x334)]('Signing\x20failed:',_0x38adf9);}const _0x9a5222=0x10+Math['floor'](Math[_0x3a531f(0x1f9)]()*0xf1),_0x3da8f8=window['crypto']['getRandomValues'](new Uint8Array(_0x9a5222)),_0x440f29=arrayBufferToBase64(_0x3da8f8[_0x3a531f(0x160)]),_0x1d9a73={'k':_0x24bef1['id'],'t':new Date()[_0x3a531f(0x16c)](),'a':RSA_CONFIG[_0x3a531f(0x1e5)]+'+'+AES_CONFIG[_0x3a531f(0x1b8)],'s':_0x24bef1[_0x3a531f(0x256)]||RSA_CONFIG['KEY_SIZE']};_0x251f4f&&(_0x1d9a73[_0x3a531f(0x24a)]=_0x251f4f);encryptFileData&&encryptFileName&&(_0x1d9a73['f']={'n':encryptFileName,'s':encryptFileData[_0x3a531f(0x300)]});const _0x4d8680={'msg':_0x12d420,'meta':_0x1d9a73,'pad':_0x440f29},_0x22793c=JSON[_0x3a531f(0x181)](_0x4d8680),_0x119a02=new TextEncoder()[_0x3a531f(0x1c3)](_0x22793c),_0x472626=window[_0x3a531f(0x1e6)][_0x3a531f(0x188)](new Uint8Array(AES_CONFIG[_0x3a531f(0x1ca)])),_0x4901d2=await window[_0x3a531f(0x1e6)][_0x3a531f(0x16f)][_0x3a531f(0x25e)]({'name':AES_CONFIG[_0x3a531f(0x1b8)],'iv':_0x472626,'tagLength':AES_CONFIG[_0x3a531f(0x2a2)]},_0x3b5a94,_0x119a02),_0x2f3bda=await window[_0x3a531f(0x1e6)][_0x3a531f(0x16f)][_0x3a531f(0x184)](_0x3a531f(0x262),_0x3b5a94);let _0x20369e;if(_0x24bef1[_0x3a531f(0x1af)])_0x20369e=_0x24bef1[_0x3a531f(0x1af)];else{const _0x2e5d93=base64ToArrayBuffer(_0x24bef1[_0x3a531f(0x203)]);_0x20369e=await importRSAPublicKey(_0x2e5d93,_0x24bef1[_0x3a531f(0x256)]||RSA_CONFIG[_0x3a531f(0x2d4)]);}const _0x45648b=await window[_0x3a531f(0x1e6)][_0x3a531f(0x16f)]['encrypt']({'name':RSA_CONFIG[_0x3a531f(0x1e5)]},_0x20369e,_0x2f3bda),_0x1dde27=new Uint8Array(_0x45648b[_0x3a531f(0x300)]+_0x472626[_0x3a531f(0x300)]+_0x4901d2[_0x3a531f(0x300)]);let _0x449986=0x0;return _0x1dde27[_0x3a531f(0x2c9)](new Uint8Array(_0x45648b),_0x449986),_0x449986+=_0x45648b[_0x3a531f(0x300)],_0x1dde27['set'](_0x472626,_0x449986),_0x449986+=_0x472626[_0x3a531f(0x300)],_0x1dde27[_0x3a531f(0x2c9)](new Uint8Array(_0x4901d2),_0x449986),{'version':0x4,'data':arrayBufferToBase64(_0x1dde27[_0x3a531f(0x160)])};}async function encryptWithECC(_0x348969,_0x3d9e19,_0x4f2335){const _0x12b555=_0x378a5e,_0x3f294d=await window[_0x12b555(0x1e6)][_0x12b555(0x16f)][_0x12b555(0x1b1)]({'name':'ECDH','namedCurve':_0x3d9e19[_0x12b555(0x1cf)]||ECC_CONFIG[_0x12b555(0x2b4)]},!![],['deriveKey',_0x12b555(0x295)]),_0x118f05=await window[_0x12b555(0x1e6)][_0x12b555(0x16f)][_0x12b555(0x184)](_0x12b555(0x262),_0x3f294d['publicKey']);let _0x3a2875;if(_0x3d9e19['_publicKey'])_0x3a2875=_0x3d9e19[_0x12b555(0x1af)];else{const _0x7cedf1=base64ToArrayBuffer(_0x3d9e19[_0x12b555(0x203)]);_0x3a2875=await importECCPublicKey(_0x7cedf1,_0x3d9e19['curve']||ECC_CONFIG[_0x12b555(0x2b4)],_0x12b555(0x27d));}const _0x4ef90b=await window[_0x12b555(0x1e6)]['subtle']['deriveBits']({'name':_0x12b555(0x17b),'public':_0x3a2875},_0x3f294d['privateKey'],0x100),_0x5c0426=await window[_0x12b555(0x1e6)]['subtle'][_0x12b555(0x2f6)](_0x12b555(0x262),_0x4ef90b,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG[_0x12b555(0x2c8)]},![],[_0x12b555(0x25e)]),_0x276eff=arrayBufferToBase64(_0x348969);let _0x6dd873=null;if(_0x4f2335&&_0x3d9e19[_0x12b555(0x15a)])try{let _0x2ebaab=_0x3d9e19[_0x12b555(0x327)];!_0x2ebaab&&_0x3d9e19['signingPrivateKey']&&(_0x2ebaab=await window['crypto'][_0x12b555(0x16f)]['importKey']('pkcs8',base64ToArrayBuffer(_0x3d9e19['signingPrivateKey']),{'name':SIGN_CONFIG['ECC_ALGORITHM'],'namedCurve':_0x3d9e19['curve']||ECC_CONFIG['CURVE']},![],['sign']));if(_0x2ebaab){const _0x1826a0=await window[_0x12b555(0x1e6)][_0x12b555(0x16f)]['sign']({'name':SIGN_CONFIG['ECC_ALGORITHM'],'hash':SIGN_CONFIG[_0x12b555(0x218)]},_0x2ebaab,_0x348969);_0x6dd873=arrayBufferToBase64(_0x1826a0);}}catch(_0xf40c69){console[_0x12b555(0x334)](_0x12b555(0x1c0),_0xf40c69);}const _0x4b3e4e=0x10+Math[_0x12b555(0x138)](Math[_0x12b555(0x1f9)]()*0xf1),_0x4f012e=window[_0x12b555(0x1e6)]['getRandomValues'](new Uint8Array(_0x4b3e4e)),_0x241d62=arrayBufferToBase64(_0x4f012e[_0x12b555(0x160)]),_0x3438f9={'k':_0x3d9e19['id'],'t':new Date()[_0x12b555(0x16c)](),'a':_0x12b555(0x21b)+AES_CONFIG['MODE'],'c':_0x3d9e19[_0x12b555(0x1cf)]||ECC_CONFIG[_0x12b555(0x2b4)]};_0x6dd873&&(_0x3438f9[_0x12b555(0x24a)]=_0x6dd873);encryptFileData&&encryptFileName&&(_0x3438f9['f']={'n':encryptFileName,'s':encryptFileData[_0x12b555(0x300)]});const _0x2db338={'msg':_0x276eff,'meta':_0x3438f9,'pad':_0x241d62},_0x5659d7=JSON[_0x12b555(0x181)](_0x2db338),_0x601849=new TextEncoder()[_0x12b555(0x1c3)](_0x5659d7),_0x4fe2ee=window[_0x12b555(0x1e6)][_0x12b555(0x188)](new Uint8Array(AES_CONFIG[_0x12b555(0x1ca)])),_0x379622=await window[_0x12b555(0x1e6)][_0x12b555(0x16f)][_0x12b555(0x25e)]({'name':AES_CONFIG['MODE'],'iv':_0x4fe2ee,'tagLength':AES_CONFIG[_0x12b555(0x2a2)]},_0x5c0426,_0x601849),_0x258eb0=Math['floor'](Math[_0x12b555(0x1f9)]()*0x100),_0x5ac77a=window['crypto'][_0x12b555(0x188)](new Uint8Array(_0x258eb0)),_0x4658bc=new Uint8Array(0x1+_0x258eb0+_0x118f05[_0x12b555(0x300)]+_0x4fe2ee['byteLength']+_0x379622['byteLength']);let _0x352eb1=0x0;return _0x4658bc[_0x352eb1]=_0x258eb0,_0x352eb1+=0x1,_0x4658bc[_0x12b555(0x2c9)](_0x5ac77a,_0x352eb1),_0x352eb1+=_0x258eb0,_0x4658bc[_0x12b555(0x2c9)](new Uint8Array(_0x118f05),_0x352eb1),_0x352eb1+=_0x118f05[_0x12b555(0x300)],_0x4658bc[_0x12b555(0x2c9)](_0x4fe2ee,_0x352eb1),_0x352eb1+=_0x4fe2ee[_0x12b555(0x300)],_0x4658bc[_0x12b555(0x2c9)](new Uint8Array(_0x379622),_0x352eb1),{'version':0x4,'data':arrayBufferToBase64(_0x4658bc[_0x12b555(0x160)])};}async function decryptMessage(){const _0x2af013=_0x378a5e;try{let _0x5d18c6,_0x2c7cef=document[_0x2af013(0x2fd)]('encryptedMessage')[_0x2af013(0x1ad)];const _0x26e8b6=document[_0x2af013(0x2fd)]('decryptObfKey')[_0x2af013(0x1ad)];if(!_0x2c7cef){showStatus(_0x2af013(0x2f4),'Please\x20enter\x20an\x20encrypted\x20message\x20or\x20add\x20an\x20encrypted\x20file',_0x2af013(0x334));return;}if(!isValidEncryptedMessage(_0x2c7cef,_0x26e8b6)){showStatus(_0x2af013(0x2f4),_0x2af013(0x1fd),'error');return;}const _0x4608c9=document[_0x2af013(0x2fd)](_0x2af013(0x20c))[_0x2af013(0x1ad)],_0x4217a4=document[_0x2af013(0x2fd)]('decryptionPassword')[_0x2af013(0x1ad)];if(!_0x4608c9){showStatus(_0x2af013(0x2f4),_0x2af013(0x24c),_0x2af013(0x334));return;}setLoading(!![]);const _0x4ff70e=keys[_0x2af013(0x1dc)](_0x491db3=>_0x491db3['id']===_0x4608c9);if(!_0x4ff70e){showStatus(_0x2af013(0x2f4),_0x2af013(0x1fd),'error'),setLoading(![]);return;}let _0x1d12de=null,_0x3820ba=_0x4ff70e;if(_0x4ff70e[_0x2af013(0x2cd)]){if(!_0x4217a4){showStatus(_0x2af013(0x2f4),_0x2af013(0x1c4),'error'),setLoading(![]);return;}try{_0x1d12de=await decryptKeyWithPassword(_0x4ff70e,_0x4217a4),_0x3820ba=safeMemory[_0x2af013(0x185)](_0x1d12de);if(!_0x3820ba)throw new Error(_0x2af013(0x290));}catch(_0x271a45){console['error'](_0x2af013(0x308),_0x271a45),showStatus(_0x2af013(0x2f4),_0x2af013(0x1fd),_0x2af013(0x334)),setLoading(![]);return;}}const _0x165bbc=document['getElementById'](_0x2af013(0x312))['checked'];let _0x128b15,_0x5159f0,_0x542e4c=null;_0x5d18c6=parseEncryptedMessage(_0x2c7cef,_0x26e8b6);let _0x5cf8a8=await decryptData(_0x5d18c6,_0x3820ba);_0x5cf8a8[_0x2af013(0x310)]?(_0x128b15=_0x5cf8a8['data'],_0x5159f0=_0x5cf8a8['metadata']):(_0x128b15=_0x5cf8a8,_0x5159f0=null);_0x1d12de&&safeMemory[_0x2af013(0x17c)](_0x1d12de);let _0x357d01=![],_0x38086f=null,_0x313f53=null;if(!_0x5d18c6[_0x2af013(0x29e)]&&_0x5d18c6[_0x2af013(0x254)]&&_0x5d18c6[_0x2af013(0x28a)])_0x357d01=!![],_0x38086f=_0x5d18c6[_0x2af013(0x28a)],_0x313f53=_0x5d18c6['fileSize']||_0x128b15[_0x2af013(0x300)];else _0x5159f0&&_0x5159f0['f']&&(_0x357d01=!![],_0x38086f=_0x5159f0['f']['n'],_0x313f53=_0x5159f0['f']['s']||_0x128b15[_0x2af013(0x300)]);if(_0x357d01)document['getElementById'](_0x2af013(0x1ac))[_0x2af013(0x1ad)]='File:\x20'+_0x38086f+'\x20('+formatFileSize(_0x313f53)+')',document[_0x2af013(0x2fd)](_0x2af013(0x2be))[_0x2af013(0x1b9)]('data-filename',_0x38086f),document[_0x2af013(0x2fd)]('downloadDecryptedBtn')[_0x2af013(0x1b9)](_0x2af013(0x2ad),_0x2af013(0x2b9)),window[_0x2af013(0x223)]=_0x128b15;else{const _0x59ce47=new TextDecoder()[_0x2af013(0x29f)](_0x128b15);document[_0x2af013(0x2fd)](_0x2af013(0x1ac))['value']=_0x59ce47,document[_0x2af013(0x2fd)](_0x2af013(0x2be))['setAttribute']('data-filename',_0x2af013(0x2bc)),document[_0x2af013(0x2fd)](_0x2af013(0x2be))[_0x2af013(0x1b9)](_0x2af013(0x2ad),_0x2af013(0x32e)),window['decryptedBinaryData']=null;}let _0x9b1270=_0x2af013(0x2ff),_0x3ba3eb=_0x2af013(0x1db);if(_0x165bbc){if(_0x5159f0&&_0x5159f0[_0x2af013(0x24a)]&&_0x3820ba['hasSigningPublic'])try{let _0x58246f=_0x3820ba[_0x2af013(0x22e)];if(!_0x58246f&&_0x3820ba[_0x2af013(0x140)]){const _0x967831=_0x3820ba[_0x2af013(0x1eb)][_0x2af013(0x25c)]('rsa'),_0x4fe3b0=_0x967831?{'name':SIGN_CONFIG[_0x2af013(0x19a)],'hash':SIGN_CONFIG[_0x2af013(0x218)]}:{'name':SIGN_CONFIG[_0x2af013(0x195)],'namedCurve':_0x3820ba[_0x2af013(0x1cf)]};_0x58246f=await window[_0x2af013(0x1e6)][_0x2af013(0x16f)][_0x2af013(0x2f6)](_0x2af013(0x27d),base64ToArrayBuffer(_0x3820ba[_0x2af013(0x140)]),_0x4fe3b0,![],[_0x2af013(0x144)]);}const _0x3b9702=base64ToArrayBuffer(_0x5159f0[_0x2af013(0x24a)]),_0x2656d4=await verifySignature(_0x58246f,_0x3b9702,_0x128b15,_0x3820ba[_0x2af013(0x1eb)]);_0x542e4c=_0x2656d4;}catch(_0x55561a){console[_0x2af013(0x334)](_0x2af013(0x2a8),_0x55561a),_0x542e4c=![];}}if(_0x542e4c===!![])_0x9b1270+=_0x2af013(0x315);else{if(_0x542e4c===![])_0x9b1270+=_0x2af013(0x259),_0x3ba3eb=_0x2af013(0x19e);else _0x165bbc&&_0x542e4c===null&&(_0x9b1270+=_0x2af013(0x277));}showStatus(_0x2af013(0x2f4),_0x9b1270,_0x3ba3eb);}catch(_0x48c9dd){console[_0x2af013(0x334)](_0x2af013(0x2a6),{'errorType':_0x48c9dd['constructor'][_0x2af013(0x2bf)],'errorMessage':_0x48c9dd[_0x2af013(0x2ae)],'stack':_0x48c9dd[_0x2af013(0x147)]}),showStatus(_0x2af013(0x2f4),_0x2af013(0x1fd),_0x2af013(0x334));}finally{document['getElementById'](_0x2af013(0x2a3))['value']='',setLoading(![]);}}async function decryptWithAES(_0x44b221,_0x251ddb){const _0x57aee4=_0x378a5e;try{const _0x3aeb08=base64ToArrayBuffer(_0x44b221[_0x57aee4(0x310)]),_0x59dd06=new Uint8Array(_0x3aeb08),_0x581913=_0x59dd06[_0x57aee4(0x192)](0x0,AES_CONFIG[_0x57aee4(0x1ca)]),_0x53ca0a=_0x59dd06['slice'](AES_CONFIG[_0x57aee4(0x1ca)]);let _0x4178ae;if(_0x251ddb[_0x57aee4(0x299)])_0x4178ae=_0x251ddb[_0x57aee4(0x299)];else{const _0x3fc38b=base64ToArrayBuffer(_0x251ddb[_0x57aee4(0x2e2)]);_0x4178ae=await window[_0x57aee4(0x1e6)][_0x57aee4(0x16f)]['importKey'](_0x57aee4(0x262),_0x3fc38b,{'name':AES_CONFIG[_0x57aee4(0x1b8)],'length':AES_CONFIG[_0x57aee4(0x2c8)]},![],[_0x57aee4(0x2a7)]);}const _0x3fd33e=await window[_0x57aee4(0x1e6)][_0x57aee4(0x16f)]['decrypt']({'name':AES_CONFIG[_0x57aee4(0x1b8)],'iv':_0x581913,'tagLength':AES_CONFIG[_0x57aee4(0x2a2)]},_0x4178ae,_0x53ca0a),_0x187b82=new TextDecoder()[_0x57aee4(0x29f)](_0x3fd33e),_0x56f578=JSON[_0x57aee4(0x1d8)](_0x187b82),_0xdc1de3=base64ToArrayBuffer(_0x56f578[_0x57aee4(0x1ab)]),_0x3766ca=_0x56f578['meta'];if(_0x3766ca['k']!==_0x251ddb['id'])throw new Error(_0x57aee4(0x324));return{'data':_0xdc1de3,'metadata':_0x3766ca};}catch(_0x34c51b){console[_0x57aee4(0x334)](_0x57aee4(0x168),{'errorType':_0x34c51b[_0x57aee4(0x2b6)][_0x57aee4(0x2bf)],'errorMessage':_0x34c51b[_0x57aee4(0x2ae)],'stack':_0x34c51b[_0x57aee4(0x147)]});throw new Error(_0x57aee4(0x1fd));}}function isValidEncryptedMessage(_0x2bc748,_0x1d9666=''){const _0x17bc10=_0x378a5e,_0x21e9b3=/[A-Za-z0-9+\/\s]{100,}={0,2}/;if(_0x21e9b3[_0x17bc10(0x269)](_0x2bc748))return!![];const _0x2c983d='@!',_0x37e829='!@',_0x3355dd=escapeRegex(_0x2c983d),_0x3decf7=escapeRegex(_0x37e829),_0x1a27e7=_0x17bc10(0x158)+_0x3355dd+_0x17bc10(0x1ea)+_0x3decf7+_0x17bc10(0x26d),_0x143823=new RegExp(_0x1a27e7);return _0x143823['test'](_0x2bc748);}function createEncryptedMessageString(_0x1d9bb6,_0x264361=''){const _0x1ea98b=_0x378a5e;let _0x3b9078=typeof _0x1d9bb6['data']===_0x1ea98b(0x2af)?_0x1d9bb6['data'][_0x1ea98b(0x282)]():_0x1d9bb6[_0x1ea98b(0x310)];if(_0x264361&&_0x264361[_0x1ea98b(0x282)]()){const _0x4878ff=base64ToArrayBuffer(_0x3b9078),_0x2c54f4=xorCipher(_0x4878ff,_0x264361);_0x3b9078=arrayBufferToBase64(_0x2c54f4);}return _0x3b9078;}function parseEncryptedMessage(_0x2655d6,_0x25adc2=''){const _0x366146=_0x378a5e;let _0x57ee61=_0x2655d6[_0x366146(0x282)]()[_0x366146(0x2fa)](/\s+/g,'');if(!/^[A-Za-z0-9+\/]+={0,2}$/[_0x366146(0x269)](_0x57ee61))throw new Error(_0x366146(0x274));if(_0x25adc2&&_0x25adc2[_0x366146(0x282)]())try{const _0x272f1b=base64ToArrayBuffer(_0x57ee61),_0x399f0b=xorCipher(_0x272f1b,_0x25adc2);_0x57ee61=arrayBufferToBase64(_0x399f0b);}catch(_0x4cc666){console['error'](_0x366146(0x1fc),_0x4cc666);throw new Error(_0x366146(0x328));}return{'version':0x4,'data':_0x57ee61};}function updateEncryptionOutput(_0x439b51){return createEncryptedMessageString(_0x439b51);}function generateRandomString(_0x56829a=0x5){const _0x2bbf97=_0x378a5e,_0x1ba5a8=_0x2bbf97(0x2aa);let _0x2efc39='';for(let _0x3456a1=0x0;_0x3456a1<_0x56829a;_0x3456a1++){_0x2efc39+=_0x1ba5a8[_0x2bbf97(0x149)](Math[_0x2bbf97(0x138)](Math[_0x2bbf97(0x1f9)]()*_0x1ba5a8['length']));}return _0x2efc39;}function determineKeySecurityLevel(_0x209973){const _0x55ee08=_0x378a5e;let _0x101c6a=_0x55ee08(0x190);if(_0x209973[_0x55ee08(0x1eb)]==='aes'||_0x209973['type']===_0x55ee08(0x2c1)||_0x209973[_0x55ee08(0x1eb)]===_0x55ee08(0x23a)||_0x209973[_0x55ee08(0x1eb)]===_0x55ee08(0x283))_0x101c6a='medium';else(_0x209973[_0x55ee08(0x1eb)]===_0x55ee08(0x25b)||_0x209973[_0x55ee08(0x1eb)]==='ecc')&&(_0x101c6a='low');let _0x48a089=0x0;_0x209973[_0x55ee08(0x2cd)]&&(_0x48a089+=0x2);_0x209973[_0x55ee08(0x1eb)]!==_0x55ee08(0x155)&&(_0x209973['hasPublic']&&_0x209973[_0x55ee08(0x13f)]&&(_0x48a089+=0x1));_0x209973[_0x55ee08(0x288)]&&(_0x48a089+=0x1);let _0x2b8236;if(_0x101c6a==='medium'){if(_0x48a089>=0x3)_0x2b8236=_0x55ee08(0x32a);else _0x48a089>=0x1?_0x2b8236=_0x55ee08(0x2b5):_0x2b8236=_0x55ee08(0x190);}else{if(_0x48a089>=0x4)_0x2b8236=_0x55ee08(0x32a);else _0x48a089>=0x2?_0x2b8236=_0x55ee08(0x2b5):_0x2b8236=_0x55ee08(0x190);}return _0x2b8236;}async function decryptWithRSA(_0x513bf8,_0x2c74df,_0x467698){const _0x5a07e8=_0x378a5e;try{const _0x787580=base64ToArrayBuffer(_0x513bf8[_0x5a07e8(0x310)]),_0x454092=new Uint8Array(_0x787580),_0x5cae9e=_0x2c74df[_0x5a07e8(0x256)]||RSA_CONFIG['KEY_SIZE'],_0x321127=_0x5cae9e/0x8;let _0x3a556c=0x0;const _0x4ec6c8=_0x454092['slice'](_0x3a556c,_0x3a556c+_0x321127);_0x3a556c+=_0x321127;const _0x5b5499=_0x454092['slice'](_0x3a556c,_0x3a556c+AES_CONFIG['IV_LENGTH']);_0x3a556c+=AES_CONFIG['IV_LENGTH'];const _0x5ad28a=_0x454092[_0x5a07e8(0x192)](_0x3a556c);let _0x11df83;if(_0x2c74df['_privateKey'])_0x11df83=_0x2c74df[_0x5a07e8(0x322)];else{const _0x1ab23c=base64ToArrayBuffer(_0x2c74df['privateKey']);_0x11df83=await importRSAPrivateKey(_0x1ab23c,_0x5cae9e);}const _0x2f1a1e=await window[_0x5a07e8(0x1e6)][_0x5a07e8(0x16f)][_0x5a07e8(0x2a7)]({'name':RSA_CONFIG[_0x5a07e8(0x1e5)]},_0x11df83,_0x4ec6c8),_0x4ca489=await importAESKey(_0x2f1a1e),_0x43886d=await window[_0x5a07e8(0x1e6)][_0x5a07e8(0x16f)]['decrypt']({'name':AES_CONFIG['MODE'],'iv':_0x5b5499,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x4ca489,_0x5ad28a),_0x230c96=new TextDecoder()['decode'](_0x43886d),_0x22ec64=JSON[_0x5a07e8(0x1d8)](_0x230c96),_0x5bb421=base64ToArrayBuffer(_0x22ec64[_0x5a07e8(0x1ab)]),_0x496b01=_0x22ec64['meta'];if(_0x496b01['k']!==_0x2c74df['id'])throw new Error('Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message');return{'data':_0x5bb421,'metadata':_0x496b01};}catch(_0x416fb9){console['error'](_0x5a07e8(0x161),{'errorType':_0x416fb9['constructor'][_0x5a07e8(0x2bf)],'errorMessage':_0x416fb9[_0x5a07e8(0x2ae)],'stack':_0x416fb9['stack']});throw new Error(_0x5a07e8(0x1fd));}}async function decryptWithECC(_0x1be784,_0x5db03c){const _0x2b8f56=_0x378a5e;try{const _0x2ffa63=base64ToArrayBuffer(_0x1be784[_0x2b8f56(0x310)]),_0x428cf0=new Uint8Array(_0x2ffa63);let _0x1f2e3a=0x0;const _0x3da28a=_0x428cf0[_0x1f2e3a];_0x1f2e3a+=0x1,_0x1f2e3a+=_0x3da28a;const _0x421aeb=_0x5db03c['curve']||ECC_CONFIG[_0x2b8f56(0x2b4)];let _0x234864;if(_0x421aeb===_0x2b8f56(0x179))_0x234864=0x41;else{if(_0x421aeb==='P-384')_0x234864=0x61;else{if(_0x421aeb===_0x2b8f56(0x2d3))_0x234864=0x85;else throw new Error('Unsupported\x20ECC\x20curve:\x20'+_0x421aeb);}}const _0x2da1ee=_0x428cf0[_0x2b8f56(0x192)](_0x1f2e3a,_0x1f2e3a+_0x234864);_0x1f2e3a+=_0x234864;const _0x1f5eb6=_0x428cf0[_0x2b8f56(0x192)](_0x1f2e3a,_0x1f2e3a+AES_CONFIG[_0x2b8f56(0x1ca)]);_0x1f2e3a+=AES_CONFIG[_0x2b8f56(0x1ca)];const _0x40674d=_0x428cf0[_0x2b8f56(0x192)](_0x1f2e3a),_0x3a9666=await importECCPublicKey(_0x2da1ee,_0x421aeb);let _0x5c9a46;if(_0x5db03c['_privateKey'])_0x5c9a46=_0x5db03c[_0x2b8f56(0x322)];else{const _0x44eb9f=base64ToArrayBuffer(_0x5db03c['privateKey']);_0x5c9a46=await importECCPrivateKey(_0x44eb9f,_0x421aeb);}const _0x15f772=await window[_0x2b8f56(0x1e6)][_0x2b8f56(0x16f)][_0x2b8f56(0x295)]({'name':'ECDH','public':_0x3a9666},_0x5c9a46,0x100),_0x25c2d0=await window['crypto'][_0x2b8f56(0x16f)][_0x2b8f56(0x2f6)](_0x2b8f56(0x262),_0x15f772,{'name':AES_CONFIG[_0x2b8f56(0x1b8)],'length':AES_CONFIG[_0x2b8f56(0x2c8)]},![],[_0x2b8f56(0x2a7)]),_0x3e4bfc=await window['crypto'][_0x2b8f56(0x16f)]['decrypt']({'name':AES_CONFIG[_0x2b8f56(0x1b8)],'iv':_0x1f5eb6,'tagLength':AES_CONFIG[_0x2b8f56(0x2a2)]},_0x25c2d0,_0x40674d),_0x5f46a6=new TextDecoder()[_0x2b8f56(0x29f)](_0x3e4bfc),_0x1dca65=JSON[_0x2b8f56(0x1d8)](_0x5f46a6),_0x2053fa=base64ToArrayBuffer(_0x1dca65[_0x2b8f56(0x1ab)]),_0x447035=_0x1dca65[_0x2b8f56(0x284)];if(_0x447035['k']!==_0x5db03c['id'])throw new Error(_0x2b8f56(0x324));return{'data':_0x2053fa,'metadata':_0x447035};}catch(_0x59d531){console[_0x2b8f56(0x334)](_0x2b8f56(0x2bd),{'errorType':_0x59d531[_0x2b8f56(0x2b6)][_0x2b8f56(0x2bf)],'errorMessage':_0x59d531['message'],'stack':_0x59d531[_0x2b8f56(0x147)]});throw new Error('Decryption\x20failed.\x20Please\x20check\x20your\x20key\x20and\x20message.');}}function reverseString(_0x3db1ab){const _0x2cb152=_0x378a5e;if(typeof _0x3db1ab!==_0x2cb152(0x2af))return'';return _0x3db1ab['split']('')[_0x2cb152(0x294)]()[_0x2cb152(0x157)]('');}async function verifySignature(_0x323a1f,_0x3676a6,_0x52df21,_0x165fd8){const _0x3c512c=_0x378a5e,_0x273c1b=_0x165fd8[_0x3c512c(0x25c)]('rsa'),_0x128229=_0x273c1b?{'name':SIGN_CONFIG[_0x3c512c(0x19a)],'saltLength':SIGN_CONFIG[_0x3c512c(0x247)]}:{'name':SIGN_CONFIG[_0x3c512c(0x195)],'hash':SIGN_CONFIG[_0x3c512c(0x218)]};return await window[_0x3c512c(0x1e6)][_0x3c512c(0x16f)]['verify'](_0x128229,_0x323a1f,_0x3676a6,_0x52df21);}const ENABLE_COMPRESSION=![];async function compressData(_0x5ceb88){const _0x38909d=_0x378a5e;try{if(!ENABLE_COMPRESSION)return console[_0x38909d(0x241)]('Compression\x20disabled,\x20returning\x20uncompressed\x20data'),_0x5ceb88;if(typeof CompressionStream===_0x38909d(0x244))return console[_0x38909d(0x29d)](_0x38909d(0x1a3)),_0x5ceb88;const _0x284837=new ReadableStream({'start'(_0x4f5cfc){const _0x24b714=_0x38909d;_0x4f5cfc[_0x24b714(0x330)](new Uint8Array(_0x5ceb88)),_0x4f5cfc[_0x24b714(0x266)]();}}),_0x14b8b6=_0x284837[_0x38909d(0x14b)](new CompressionStream('gzip')),_0x24f414=_0x14b8b6['getReader'](),_0xab481e=[];while(!![]){const {done:_0x2bf529,value:_0x2bdcc}=await _0x24f414[_0x38909d(0x317)]();if(_0x2bf529)break;_0xab481e[_0x38909d(0x1a8)](_0x2bdcc);}const _0x4ccb96=_0xab481e[_0x38909d(0x208)]((_0x6a9e7,_0x47ce36)=>_0x6a9e7+_0x47ce36[_0x38909d(0x256)],0x0),_0x5bc9fa=new Uint8Array(_0x4ccb96);let _0x59a928=0x0;for(const _0x324688 of _0xab481e){_0x5bc9fa[_0x38909d(0x2c9)](_0x324688,_0x59a928),_0x59a928+=_0x324688['length'];}const _0x4e96b8=new Uint8Array(_0x5ceb88);return console[_0x38909d(0x241)]('Compression:\x20input\x20first\x204\x20bytes:',Array[_0x38909d(0x1bd)](_0x4e96b8[_0x38909d(0x192)](0x0,0x4))[_0x38909d(0x307)](_0x205227=>'0x'+_0x205227[_0x38909d(0x1c8)](0x10))['join']('\x20')),console[_0x38909d(0x241)](_0x38909d(0x225),Array['from'](_0x5bc9fa['slice'](0x0,0x4))[_0x38909d(0x307)](_0x1f5172=>'0x'+_0x1f5172[_0x38909d(0x1c8)](0x10))[_0x38909d(0x157)]('\x20')),console[_0x38909d(0x241)]('Compression:\x20input\x20length:',_0x4e96b8[_0x38909d(0x256)],_0x38909d(0x2ce),_0x5bc9fa[_0x38909d(0x256)]),_0x5bc9fa[_0x38909d(0x160)];}catch(_0x1493a9){return console[_0x38909d(0x334)](_0x38909d(0x2ab),_0x1493a9),_0x5ceb88;}}async function decompressData(_0x163a13){const _0x12a0f3=_0x378a5e;try{if(typeof DecompressionStream==='undefined')return console[_0x12a0f3(0x29d)](_0x12a0f3(0x16a)),_0x163a13;const _0x4c0611=new Uint8Array(_0x163a13);console[_0x12a0f3(0x241)]('Decompression\x20attempt\x20-\x20first\x204\x20bytes:',Array['from'](_0x4c0611[_0x12a0f3(0x192)](0x0,0x4))[_0x12a0f3(0x307)](_0x3093ad=>'0x'+_0x3093ad[_0x12a0f3(0x1c8)](0x10))[_0x12a0f3(0x157)]('\x20'));if(_0x4c0611['length']<0x2||_0x4c0611[0x0]!==0x1f||_0x4c0611[0x1]!==0x8b)return console[_0x12a0f3(0x241)](_0x12a0f3(0x1cc)),_0x163a13;const _0x367df2=new ReadableStream({'start'(_0x5532c6){const _0x53607f=_0x12a0f3;_0x5532c6['enqueue'](new Uint8Array(_0x163a13)),_0x5532c6[_0x53607f(0x266)]();}}),_0x59d683=_0x367df2[_0x12a0f3(0x14b)](new DecompressionStream(_0x12a0f3(0x1c1))),_0x3bb224=_0x59d683['getReader'](),_0x523494=[];while(!![]){const {done:_0x4753a9,value:_0x3e2e19}=await _0x3bb224['read']();if(_0x4753a9)break;_0x523494[_0x12a0f3(0x1a8)](_0x3e2e19);}const _0x35fff8=_0x523494['reduce']((_0x44501e,_0x15d723)=>_0x44501e+_0x15d723['length'],0x0),_0x157a98=new Uint8Array(_0x35fff8);let _0x19449d=0x0;for(const _0x12f782 of _0x523494){_0x157a98['set'](_0x12f782,_0x19449d),_0x19449d+=_0x12f782[_0x12a0f3(0x256)];}return console[_0x12a0f3(0x241)]('Decompression\x20successful!\x20Output\x20first\x204\x20bytes:',Array[_0x12a0f3(0x1bd)](_0x157a98[_0x12a0f3(0x192)](0x0,0x4))[_0x12a0f3(0x307)](_0x3e856d=>'0x'+_0x3e856d[_0x12a0f3(0x1c8)](0x10))[_0x12a0f3(0x157)]('\x20')),console[_0x12a0f3(0x241)]('Decompressed\x20size:',_0x157a98[_0x12a0f3(0x256)],'bytes'),_0x157a98[_0x12a0f3(0x160)];}catch(_0x15a09b){return console[_0x12a0f3(0x334)]('Decompression\x20FAILED:',_0x15a09b),console[_0x12a0f3(0x334)](_0x12a0f3(0x273)),_0x163a13;}}function downloadEncryptedFile(){const _0xba980=_0x378a5e,_0x5e4fe4=document[_0xba980(0x2fd)](_0xba980(0x265))['value'];if(!_0x5e4fe4){showStatus(_0xba980(0x261),_0xba980(0x30c),_0xba980(0x334));return;}const _0x252de5=document[_0xba980(0x2fd)](_0xba980(0x31c))[_0xba980(0x209)](_0xba980(0x15f))||generateRandomFileName(0x6)+_0xba980(0x2eb),_0x2843de=new Blob([_0x5e4fe4],{'type':_0xba980(0x32c)});downloadBlob(_0x2843de,_0x252de5),showStatus(_0xba980(0x261),_0xba980(0x18c)+_0x252de5+_0xba980(0x338),_0xba980(0x1db));}function downloadDecryptedFile(){const _0x3bd2a5=_0x378a5e;if(window[_0x3bd2a5(0x223)]){const _0x18103c=document[_0x3bd2a5(0x2fd)](_0x3bd2a5(0x2be))[_0x3bd2a5(0x209)](_0x3bd2a5(0x15f))||_0x3bd2a5(0x18a),_0x44d00f=new Blob([window[_0x3bd2a5(0x223)]],{'type':'application/octet-stream'});downloadBlob(_0x44d00f,_0x18103c);}else{const _0x56e7d5=document[_0x3bd2a5(0x2fd)]('decryptedOutput')['value'];if(!_0x56e7d5){showStatus(_0x3bd2a5(0x2f4),'No\x20decrypted\x20data\x20to\x20download','error');return;}const _0x204aaf=document[_0x3bd2a5(0x2fd)](_0x3bd2a5(0x2be))[_0x3bd2a5(0x209)]('data-filename')||_0x3bd2a5(0x2bc),_0x15b1bc=new Blob([_0x56e7d5],{'type':_0x3bd2a5(0x32c)});downloadBlob(_0x15b1bc,_0x204aaf);}showStatus(_0x3bd2a5(0x2f4),_0x3bd2a5(0x26f),_0x3bd2a5(0x1db));}function downloadBlob(_0x3a526e,_0x575080){const _0x3e7c87=_0x378a5e,_0x3de279=URL[_0x3e7c87(0x27c)](_0x3a526e),_0x72f4f6=document[_0x3e7c87(0x2cc)]('a');_0x72f4f6[_0x3e7c87(0x166)]=_0x3de279,_0x72f4f6[_0x3e7c87(0x1b3)]=_0x575080,document[_0x3e7c87(0x253)][_0x3e7c87(0x304)](_0x72f4f6),_0x72f4f6[_0x3e7c87(0x139)](),document[_0x3e7c87(0x253)]['removeChild'](_0x72f4f6),URL[_0x3e7c87(0x23c)](_0x3de279);}function importKey(){const _0x221151=_0x378a5e,_0x1d29d0=createKeyFileInput();_0x1d29d0[_0x221151(0x139)]();}async function exportKey(_0xdafc67,_0x31d02e=![]){const _0xe7853c=_0x378a5e;try{const _0x362882=keys[_0xe7853c(0x1dc)](_0x45d782=>_0x45d782['id']===_0xdafc67);if(!_0x362882){alert(_0xe7853c(0x200));return;}const _0x38cb9a=_0x362882['type']===_0xe7853c(0x25b)||_0x362882[_0xe7853c(0x1eb)]==='rsa-4096'||_0x362882['type']==='ecc'||_0x362882['type']===_0xe7853c(0x23a)||_0x362882[_0xe7853c(0x1eb)]===_0xe7853c(0x283);let _0x4659e4=_0x362882,_0x145307=_0xe7853c(0x30f);if(_0x38cb9a&&_0x31d02e){let _0x442bd3='';try{_0x442bd3=await showPasswordModal(_0xe7853c(0x163),_0xe7853c(0x180),!![]);}catch(_0x5282f){return;}if(!_0x442bd3){if(!confirm('Warning:\x20Exporting\x20a\x20private\x20key\x20without\x20password\x20protection\x20is\x20a\x20security\x20risk.\x20Continue\x20anyway?'))return;}_0x4659e4={'id':_0x362882['id'],'name':_0x362882[_0xe7853c(0x2bf)],'type':_0x362882[_0xe7853c(0x1eb)],'created':_0x362882['created'],'expiry':_0x362882[_0xe7853c(0x288)],'privateKey':_0x362882['privateKey'],'protected':_0x362882[_0xe7853c(0x2cd)],'salt':_0x362882[_0xe7853c(0x1b2)],'iv':_0x362882['iv'],'algorithm':_0x362882[_0xe7853c(0x20f)],'hasPrivate':!![],'hasPublic':![],'pairedKeyId':_0x362882['id'],'publicKeyHash':_0x362882[_0xe7853c(0x2df)]};if(_0x362882[_0xe7853c(0x1eb)]===_0xe7853c(0x25b)||_0x362882['type']===_0xe7853c(0x2c1))_0x4659e4['length']=_0x362882[_0xe7853c(0x256)];else(_0x362882['type']===_0xe7853c(0x1f6)||_0x362882[_0xe7853c(0x1eb)]===_0xe7853c(0x23a)||_0x362882[_0xe7853c(0x1eb)]===_0xe7853c(0x283))&&(_0x4659e4['curve']=_0x362882[_0xe7853c(0x1cf)]);if(_0x442bd3){if(_0x362882[_0xe7853c(0x2cd)])try{const _0x3d910e=await showPasswordModal('Enter\x20Current\x20Password',_0xe7853c(0x2b7),![]),_0x527270=await decryptKeyWithPassword(_0x362882,_0x3d910e),_0x235c49=safeMemory['retrieve'](_0x527270,!![]);_0x4659e4[_0xe7853c(0x1a0)]=_0x235c49['privateKey'],_0x4659e4['protected']=![];}catch(_0x22721a){showStatus(_0xe7853c(0x24b),_0xe7853c(0x2f5)+_0x22721a[_0xe7853c(0x2ae)],_0xe7853c(0x334));return;}await encryptKeyWithPassword(_0x4659e4,_0x442bd3);}_0x145307=_0xe7853c(0x246);}else{if(_0x38cb9a&&!_0x31d02e){_0x4659e4={'id':_0x362882['id'],'name':_0x362882[_0xe7853c(0x2bf)],'type':_0x362882['type'],'created':_0x362882[_0xe7853c(0x232)],'expiry':_0x362882[_0xe7853c(0x288)],'publicKey':_0x362882[_0xe7853c(0x203)],'algorithm':_0x362882[_0xe7853c(0x20f)],'hasPublic':!![],'hasPrivate':![],'pairedKeyId':_0x362882['id'],'publicKeyHash':_0x362882['publicKeyHash']};if(_0x362882[_0xe7853c(0x1eb)]==='rsa'||_0x362882[_0xe7853c(0x1eb)]==='rsa-4096')_0x4659e4[_0xe7853c(0x256)]=_0x362882[_0xe7853c(0x256)];else(_0x362882[_0xe7853c(0x1eb)]===_0xe7853c(0x1f6)||_0x362882[_0xe7853c(0x1eb)]===_0xe7853c(0x23a)||_0x362882[_0xe7853c(0x1eb)]===_0xe7853c(0x283))&&(_0x4659e4[_0xe7853c(0x1cf)]=_0x362882['curve']);}}const _0x22217a=JSON[_0xe7853c(0x181)](_0x4659e4),_0x3f7209=btoa(_0x22217a),_0xe21adc=new Blob([_0x3f7209],{'type':'application/octet-stream'}),_0x3c0f36=URL[_0xe7853c(0x27c)](_0xe21adc),_0x2891c5=document[_0xe7853c(0x2cc)]('a');_0x2891c5[_0xe7853c(0x166)]=_0x3c0f36,_0x2891c5[_0xe7853c(0x1b3)]=''+_0x362882[_0xe7853c(0x2bf)][_0xe7853c(0x2fa)](/[^a-z0-9]/gi,'_')+_0x145307,document[_0xe7853c(0x253)][_0xe7853c(0x304)](_0x2891c5),_0x2891c5[_0xe7853c(0x139)](),document[_0xe7853c(0x253)]['removeChild'](_0x2891c5),URL[_0xe7853c(0x23c)](_0x3c0f36);const _0x480b7f=_0x31d02e?'private\x20key':_0x38cb9a?_0xe7853c(0x22b):_0xe7853c(0x2e2);showStatus(_0xe7853c(0x24b),'Key\x20\x22'+_0x362882[_0xe7853c(0x2bf)]+'\x22\x20'+_0x480b7f+'\x20exported\x20as\x20'+_0x145307+_0xe7853c(0x14e),_0xe7853c(0x1db));}catch(_0x4b9cd6){console[_0xe7853c(0x334)]('Export\x20error:',_0x4b9cd6),showStatus(_0xe7853c(0x24b),_0xe7853c(0x280)+_0x4b9cd6['message'],'error');}}async function exportPrivateKey(_0x405b5e){const _0x318982=_0x378a5e,_0x1b998a=keys[_0x318982(0x1dc)](_0xcef07b=>_0xcef07b['id']===_0x405b5e);if(!_0x1b998a){alert('Key\x20not\x20found');return;}if(!_0x1b998a[_0x318982(0x13f)]){showStatus(_0x318982(0x24b),'This\x20key\x20does\x20not\x20have\x20a\x20private\x20key\x20component\x20to\x20export','error');return;}const _0x5641eb=confirm('WARNING:\x20Exporting\x20a\x20private\x20key\x20is\x20a\x20security\x20risk.\x20'+_0x318982(0x16e)+'Do\x20you\x20want\x20to\x20continue?');_0x5641eb&&await exportKey(_0x405b5e,!![]);}function createKeyFileInput(){const _0x132d67=_0x378a5e;let _0x518955=document[_0x132d67(0x2fd)](_0x132d67(0x2dc));return!_0x518955&&(_0x518955=document[_0x132d67(0x2cc)](_0x132d67(0x1f2)),_0x518955['type']=_0x132d67(0x30d),_0x518955['id']=_0x132d67(0x2dc),_0x518955[_0x132d67(0x24e)]='.lim,.lem',_0x518955[_0x132d67(0x189)][_0x132d67(0x1e2)]=_0x132d67(0x2c5),document[_0x132d67(0x253)]['appendChild'](_0x518955),_0x518955[_0x132d67(0x215)](_0x132d67(0x1ba),handleKeyFileSelect)),_0x518955;}async function handleKeyFileSelect(_0x585393){const _0x56f96f=_0x378a5e;try{const _0x347309=_0x585393[_0x56f96f(0x164)][_0x56f96f(0x220)];if(!_0x347309||_0x347309[_0x56f96f(0x256)]===0x0)return;setLoading(!![]);const _0x54a8d1=_0x347309[0x0],_0x51a348=_0x54a8d1[_0x56f96f(0x2bf)][_0x56f96f(0x26a)]()[_0x56f96f(0x183)](_0x56f96f(0x246)),_0x543c38=_0x54a8d1[_0x56f96f(0x2bf)][_0x56f96f(0x26a)]()['endsWith'](_0x56f96f(0x30f)),_0x31832e=new FileReader();_0x31832e['onload']=async function(_0x156088){const _0x588079=_0x56f96f;try{const _0xac17e8=_0x156088['target'][_0x588079(0x206)];let _0x304474;try{const _0x1c287d=atob(_0xac17e8);_0x304474=JSON[_0x588079(0x1d8)](_0x1c287d);}catch(_0x2351a5){throw new Error(_0x588079(0x20b));}if(!_0x304474['id']||!_0x304474[_0x588079(0x2bf)]||!_0x304474[_0x588079(0x1eb)]||!_0x304474[_0x588079(0x232)])throw new Error('Missing\x20required\x20key\x20properties');if(!validator['isValidKeyName'](_0x304474[_0x588079(0x2bf)]))throw new Error('Invalid\x20key\x20name\x20format');if(_0x304474[_0x588079(0x1eb)]===_0x588079(0x155))_0x304474[_0x588079(0x216)]=!![],_0x304474[_0x588079(0x13f)]=!![];else{_0x304474[_0x588079(0x216)]=!!_0x304474['publicKey'],_0x304474[_0x588079(0x13f)]=!!_0x304474[_0x588079(0x1a0)];if(_0x51a348&&!_0x304474['hasPrivate'])throw new Error(_0x588079(0x1e8));if(_0x543c38&&!_0x304474[_0x588079(0x216)])throw new Error(_0x588079(0x210));}if(_0x304474[_0x588079(0x13f)]&&_0x304474['protected']){let _0x5ee4e6='';try{_0x5ee4e6=await showPasswordModal(_0x588079(0x1f8),'This\x20private\x20key\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import\x20it:',![]);}catch(_0x395487){throw new Error(_0x588079(0x1ef));}if(!_0x5ee4e6)throw new Error(_0x588079(0x1ef));_0x304474[_0x588079(0x2d1)]=_0x5ee4e6;}const _0x4af939=keys[_0x588079(0x1ed)](_0x485fe7=>_0x485fe7['id']===_0x304474['id']);let _0x3fee20=![],_0xfb730e=-0x1;if(_0x4af939>=0x0){const _0x284037=keys[_0x4af939];if(_0x304474['hasPrivate']&&!_0x284037[_0x588079(0x13f)]&&_0x284037[_0x588079(0x216)])_0x3fee20=!![],_0xfb730e=_0x4af939;else _0x304474[_0x588079(0x216)]&&!_0x284037[_0x588079(0x216)]&&_0x284037[_0x588079(0x13f)]&&(_0x3fee20=!![],_0xfb730e=_0x4af939);}else _0x304474[_0x588079(0x2df)]&&(_0xfb730e=keys[_0x588079(0x1ed)](_0x4ff5ac=>_0x4ff5ac[_0x588079(0x2df)]===_0x304474[_0x588079(0x2df)]&&_0x4ff5ac[_0x588079(0x1eb)]===_0x304474[_0x588079(0x1eb)]&&(_0x4ff5ac[_0x588079(0x13f)]&&!_0x4ff5ac['hasPublic']&&_0x304474[_0x588079(0x216)]||_0x4ff5ac[_0x588079(0x216)]&&!_0x4ff5ac[_0x588079(0x13f)]&&_0x304474['hasPrivate'])),_0xfb730e>=0x0&&(_0x3fee20=!![]));if(_0x3fee20&&_0xfb730e>=0x0){const _0x5813fe=confirm(_0x588079(0x2e5)+(_0x304474['hasPrivate']?_0x588079(0x1f4):_0x588079(0x27a))+'\x20key\x20part\x20of\x20an\x20existing\x20key.\x20'+'Would\x20you\x20like\x20to\x20merge\x20them\x20into\x20a\x20complete\x20key\x20pair?');if(_0x5813fe){const _0x27bdd5=keys[_0xfb730e];_0x304474[_0x588079(0x13f)]&&!_0x27bdd5[_0x588079(0x13f)]&&(_0x27bdd5[_0x588079(0x1a0)]=_0x304474[_0x588079(0x1a0)],_0x27bdd5[_0x588079(0x13f)]=!![],_0x304474['protected']&&(_0x27bdd5[_0x588079(0x2cd)]=!![],_0x27bdd5[_0x588079(0x1b2)]=_0x304474['salt'],_0x27bdd5['iv']=_0x304474['iv'])),_0x304474[_0x588079(0x216)]&&!_0x27bdd5[_0x588079(0x216)]&&(_0x27bdd5['publicKey']=_0x304474['publicKey'],_0x27bdd5[_0x588079(0x216)]=!![],_0x304474['publicKeyHash']&&(_0x27bdd5[_0x588079(0x2df)]=_0x304474[_0x588079(0x2df)])),_0x27bdd5[_0x588079(0x165)]=_0x27bdd5['id'],await saveKeys(),showStatus(_0x588079(0x24b),_0x588079(0x2c6)+_0x27bdd5[_0x588079(0x2bf)]+'\x22\x20updated\x20with\x20'+(_0x304474['hasPrivate']?_0x588079(0x1f4):_0x588079(0x27a))+'\x20key\x20part.\x20Security\x20level:\x20'+determineKeySecurityLevel(_0x27bdd5)[_0x588079(0x23d)](),_0x588079(0x1db));}else _0x304474['id']=crypto[_0x588079(0x19d)](),keys[_0x588079(0x1a8)](_0x304474),await saveKeys(),showStatus(_0x588079(0x24b),_0x588079(0x2c6)+_0x304474[_0x588079(0x2bf)]+'\x22\x20imported\x20as\x20separate\x20key',_0x588079(0x1db));}else{if(_0x4af939>=0x0){const _0x4cb1cc=confirm(_0x588079(0x2ea)+_0x304474['name']+_0x588079(0x176));_0x4cb1cc?keys[_0x4af939]=_0x304474:(_0x304474['id']=crypto['randomUUID'](),keys[_0x588079(0x1a8)](_0x304474)),await saveKeys(),showStatus(_0x588079(0x24b),_0x588079(0x2c6)+_0x304474[_0x588079(0x2bf)]+_0x588079(0x228),_0x588079(0x1db));}else{keys['push'](_0x304474),await saveKeys();if(_0x304474[_0x588079(0x1eb)]==='aes')showStatus('keyStatus',_0x588079(0x306)+_0x304474[_0x588079(0x2bf)]+_0x588079(0x228),'success');else{if(_0x304474[_0x588079(0x13f)]&&_0x304474[_0x588079(0x216)])showStatus(_0x588079(0x24b),_0x588079(0x2ef)+_0x304474[_0x588079(0x2bf)]+'\x22\x20imported\x20successfully',_0x588079(0x1db));else _0x304474[_0x588079(0x13f)]?showStatus(_0x588079(0x24b),_0x588079(0x33b)+_0x304474[_0x588079(0x2bf)]+_0x588079(0x228),_0x588079(0x1db)):showStatus('keyStatus','Public\x20key\x20\x22'+_0x304474[_0x588079(0x2bf)]+_0x588079(0x228),_0x588079(0x1db));}}}}catch(_0x1b93be){console['error'](_0x588079(0x260),_0x1b93be),showStatus(_0x588079(0x24b),_0x588079(0x249)+_0x1b93be[_0x588079(0x2ae)],_0x588079(0x334));}finally{setLoading(![]),document[_0x588079(0x2fd)](_0x588079(0x2dc))[_0x588079(0x1ad)]='';}},_0x31832e[_0x56f96f(0x1c6)]=function(){const _0x4b9909=_0x56f96f;setLoading(![]),showStatus(_0x4b9909(0x24b),_0x4b9909(0x2f0),_0x4b9909(0x334)),document[_0x4b9909(0x2fd)](_0x4b9909(0x2dc))[_0x4b9909(0x1ad)]='';},_0x31832e[_0x56f96f(0x154)](_0x54a8d1);}catch(_0x1102d8){console[_0x56f96f(0x334)](_0x56f96f(0x260),_0x1102d8),showStatus(_0x56f96f(0x24b),_0x56f96f(0x249)+_0x1102d8[_0x56f96f(0x2ae)],_0x56f96f(0x334)),setLoading(![]),document[_0x56f96f(0x2fd)](_0x56f96f(0x2dc))[_0x56f96f(0x1ad)]='';}}async function exportAllKeys(){const _0x29f055=_0x378a5e;try{if(keys['length']===0x0){showStatus(_0x29f055(0x24b),_0x29f055(0x26e),'warning');return;}let _0x12fcbd='';try{_0x12fcbd=await showPasswordModal('Secure\x20Your\x20Key\x20Backup',_0x29f055(0x229),!![]);}catch(_0x19cf93){return;}let _0x385ba3;if(_0x12fcbd){const _0xc8eb34=JSON[_0x29f055(0x181)](keys),_0x1b8f22=new TextEncoder()['encode'](_0xc8eb34),_0x232c12=window['crypto'][_0x29f055(0x188)](new Uint8Array(0x10)),_0x58a120=await deriveKeyFromPassword(_0x12fcbd,_0x232c12),_0x302f90=window[_0x29f055(0x1e6)][_0x29f055(0x188)](new Uint8Array(AES_CONFIG[_0x29f055(0x1ca)])),_0x5db835=await encryptWithDerivedKey(_0x58a120,_0x1b8f22,_0x302f90);_0x385ba3=JSON[_0x29f055(0x181)]({'format':_0x29f055(0x329),'salt':arrayBufferToBase64(_0x232c12),'iv':arrayBufferToBase64(_0x302f90),'data':arrayBufferToBase64(_0x5db835)});}else{const _0x38ccc2=confirm(_0x29f055(0x2d8));if(!_0x38ccc2)return;_0x385ba3=JSON[_0x29f055(0x181)](keys);}const _0x1698a8=new Blob([_0x385ba3],{'type':_0x29f055(0x32c)}),_0x32ee0a=URL[_0x29f055(0x27c)](_0x1698a8),_0x2dee3c=document['createElement']('a');_0x2dee3c[_0x29f055(0x166)]=_0x32ee0a,_0x2dee3c['download']='Lemonade-state.state',document[_0x29f055(0x253)]['appendChild'](_0x2dee3c),_0x2dee3c['click'](),document[_0x29f055(0x253)][_0x29f055(0x28f)](_0x2dee3c),URL[_0x29f055(0x23c)](_0x32ee0a),showStatus(_0x29f055(0x24b),_0x29f055(0x16b),_0x29f055(0x1db));}catch(_0x45b4c4){console['error'](_0x29f055(0x173),_0x45b4c4),showStatus(_0x29f055(0x24b),_0x29f055(0x280)+_0x45b4c4['message'],_0x29f055(0x334));}}function createStateFileInput(){const _0x3eb3a6=_0x378a5e;let _0x4447fb=document[_0x3eb3a6(0x2fd)](_0x3eb3a6(0x30e));return!_0x4447fb&&(_0x4447fb=document[_0x3eb3a6(0x2cc)](_0x3eb3a6(0x1f2)),_0x4447fb[_0x3eb3a6(0x1eb)]=_0x3eb3a6(0x30d),_0x4447fb['id']='stateFileInput',_0x4447fb[_0x3eb3a6(0x24e)]=_0x3eb3a6(0x2ca),_0x4447fb[_0x3eb3a6(0x189)]['display']=_0x3eb3a6(0x2c5),document[_0x3eb3a6(0x253)][_0x3eb3a6(0x304)](_0x4447fb),_0x4447fb[_0x3eb3a6(0x215)]('change',handleStateFileSelect)),_0x4447fb;}async function handleStateFileSelect(_0x5e22ff){const _0x5ed059=_0x378a5e;try{const _0x2db6ca=_0x5e22ff['target'][_0x5ed059(0x220)];if(!_0x2db6ca||_0x2db6ca[_0x5ed059(0x256)]===0x0)return;setLoading(!![]);const _0x3be878=_0x2db6ca[0x0],_0xf51bda=new FileReader();_0xf51bda['onload']=async function(_0x111052){const _0x885566=_0x5ed059;try{const _0x3caf80=_0x111052[_0x885566(0x164)][_0x885566(0x206)];let _0x3946fa;try{_0x3946fa=JSON[_0x885566(0x1d8)](_0x3caf80);}catch(_0x15eba7){throw new Error(_0x885566(0x314));}if(_0x3946fa[_0x885566(0x331)]===_0x885566(0x329)){let _0x248722='';try{_0x248722=await showPasswordModal(_0x885566(0x26c),'This\x20state\x20file\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import:',![]);}catch(_0x2cdd8e){throw new Error(_0x885566(0x20e));}if(!_0x248722)throw new Error(_0x885566(0x20e));const _0x1ecdbe=base64ToArrayBuffer(_0x3946fa['salt']),_0x79788a=base64ToArrayBuffer(_0x3946fa['iv']),_0x241248=base64ToArrayBuffer(_0x3946fa[_0x885566(0x310)]),_0x5909e1=await deriveKeyFromPassword(_0x248722,_0x1ecdbe),_0x5dd429=await decryptWithDerivedKey(_0x5909e1,_0x241248,_0x79788a),_0x25dd3e=new TextDecoder()[_0x885566(0x29f)](_0x5dd429);_0x3946fa=JSON['parse'](_0x25dd3e);}if(!Array[_0x885566(0x145)](_0x3946fa))throw new Error(_0x885566(0x24d));const _0x518719=confirm(_0x885566(0x17d)+_0x3946fa[_0x885566(0x256)]+_0x885566(0x213));if(!_0x518719)return;keys=_0x3946fa,await saveKeys(),showStatus(_0x885566(0x24b),_0x885566(0x1f3)+_0x3946fa[_0x885566(0x256)]+_0x885566(0x1df),_0x885566(0x1db));}catch(_0x45623d){console[_0x885566(0x334)](_0x885566(0x258),_0x45623d),showStatus(_0x885566(0x24b),_0x885566(0x21e)+_0x45623d['message'],_0x885566(0x334));}finally{setLoading(![]),document['getElementById'](_0x885566(0x30e))[_0x885566(0x1ad)]='';}},_0xf51bda['onerror']=function(){const _0x130a95=_0x5ed059;setLoading(![]),showStatus(_0x130a95(0x24b),_0x130a95(0x1a2),_0x130a95(0x334)),document['getElementById'](_0x130a95(0x30e))[_0x130a95(0x1ad)]='';},_0xf51bda['readAsText'](_0x3be878);}catch(_0x211c58){console[_0x5ed059(0x334)](_0x5ed059(0x258),_0x211c58),showStatus('keyStatus','State\x20import\x20error:\x20'+_0x211c58[_0x5ed059(0x2ae)],_0x5ed059(0x334)),setLoading(![]),document[_0x5ed059(0x2fd)]('stateFileInput')[_0x5ed059(0x1ad)]='';}}function importState(){const _0x12fe77=_0x378a5e,_0x489d59=createStateFileInput();_0x489d59[_0x12fe77(0x139)]();}async function secureClipboardCopy(_0x32acda){const _0x323111=_0x378a5e;try{return await navigator[_0x323111(0x171)]['writeText'](_0x32acda),!![];}catch(_0x4f7f82){return console[_0x323111(0x241)]('Modern\x20clipboard\x20API\x20failed:',_0x4f7f82),![];}}function deleteKey(_0x261d0e){const _0x1b5934=_0x378a5e,_0x117d32=keys['find'](_0x103038=>_0x103038['id']===_0x261d0e);if(!_0x117d32){alert(_0x1b5934(0x200));return;}const _0x5e4501=window[_0x1b5934(0x1cb)](_0x1b5934(0x33c)+_0x117d32[_0x1b5934(0x2bf)]+_0x1b5934(0x2d6));_0x5e4501&&(keys=keys['filter'](_0x5bf895=>_0x5bf895['id']!==_0x261d0e),saveKeys(),showStatus(_0x1b5934(0x24b),'Key\x20\x22'+_0x117d32['name']+_0x1b5934(0x2cf),_0x1b5934(0x1db)));}function xorCipher(_0x4964b4,_0x539c46){const _0x334a1a=_0x378a5e;if(!_0x539c46)return _0x4964b4;const _0x1e8bc1=new TextEncoder()[_0x334a1a(0x1c3)](_0x539c46),_0x1e1efc=new Uint8Array(_0x4964b4),_0x414a21=new Uint8Array(_0x4964b4[_0x334a1a(0x300)]);for(let _0xb6f0b5=0x0;_0xb6f0b5<_0x1e1efc[_0x334a1a(0x256)];_0xb6f0b5++){_0x414a21[_0xb6f0b5]=_0x1e1efc[_0xb6f0b5]^_0x1e8bc1[_0xb6f0b5%_0x1e8bc1[_0x334a1a(0x256)]];}return _0x414a21[_0x334a1a(0x160)];}function showStatus(_0x4dbf73,_0x15cdac,_0x3859f3){const _0x43b20f=_0x378a5e,_0x30b9b0=document[_0x43b20f(0x2fd)](_0x4dbf73);_0x30b9b0['textContent']=validator[_0x43b20f(0x14d)](_0x15cdac),_0x30b9b0[_0x43b20f(0x320)]='status\x20'+_0x3859f3,setTimeout(()=>{const _0x3aaa76=_0x43b20f;_0x30b9b0[_0x3aaa76(0x13c)]===validator[_0x3aaa76(0x14d)](_0x15cdac)&&(_0x30b9b0[_0x3aaa76(0x320)]='status');},0x2710);}let passwordModalCallback=null,passwordModalResolve=null,passwordModalReject=null;function showPasswordModal(_0x25cc46,_0x5798b2,_0x226c93=![]){return new Promise((_0x51b97e,_0x34e9bc)=>{const _0x5e2c3a=_0x5b81,_0x432456=document[_0x5e2c3a(0x2fd)](_0x5e2c3a(0x219)),_0x3ad0b2=document[_0x5e2c3a(0x2fd)](_0x5e2c3a(0x1a5)),_0x4fd6b9=document[_0x5e2c3a(0x2fd)]('passwordModalMessage'),_0x1a4ddb=document['getElementById'](_0x5e2c3a(0x319)),_0x48367c=document['getElementById'](_0x5e2c3a(0x27b)),_0x377bb1=document[_0x5e2c3a(0x2fd)](_0x5e2c3a(0x1fb));_0x3ad0b2[_0x5e2c3a(0x13c)]=_0x25cc46,_0x4fd6b9['textContent']=_0x5798b2,_0x1a4ddb['value']='',_0x48367c[_0x5e2c3a(0x320)]=_0x5e2c3a(0x2da),_0x377bb1[_0x5e2c3a(0x13c)]='',_0x48367c[_0x5e2c3a(0x189)][_0x5e2c3a(0x1e2)]=_0x226c93?_0x5e2c3a(0x1da):'none',_0x377bb1[_0x5e2c3a(0x189)]['display']=_0x226c93?_0x5e2c3a(0x1da):'none',passwordModalResolve=_0x51b97e,passwordModalReject=_0x34e9bc,_0x432456[_0x5e2c3a(0x189)][_0x5e2c3a(0x1e2)]=_0x5e2c3a(0x162),setTimeout(()=>{const _0x141aed=_0x5e2c3a;_0x1a4ddb[_0x141aed(0x279)]();},0x64);});}function confirmPasswordModal(){const _0x1da277=_0x378a5e,_0x5de155=document[_0x1da277(0x2fd)]('passwordModalInput'),_0x42272d=_0x5de155[_0x1da277(0x1ad)],_0x56b5ce=document[_0x1da277(0x2fd)](_0x1da277(0x27b)),_0x4a3aff=document[_0x1da277(0x2fd)]('passwordModalFeedback');_0x56b5ce[_0x1da277(0x320)]=_0x1da277(0x2da),_0x4a3aff[_0x1da277(0x13c)]='',document[_0x1da277(0x2fd)](_0x1da277(0x219))['style'][_0x1da277(0x1e2)]=_0x1da277(0x2c5),passwordModalResolve&&(passwordModalResolve(_0x42272d),passwordModalResolve=null,passwordModalReject=null);}function cancelPasswordModal(){const _0x2b05c4=_0x378a5e,_0x12fc55=document[_0x2b05c4(0x2fd)](_0x2b05c4(0x319)),_0xd3cae0=document[_0x2b05c4(0x2fd)](_0x2b05c4(0x27b)),_0x466186=document[_0x2b05c4(0x2fd)](_0x2b05c4(0x1fb));_0x12fc55[_0x2b05c4(0x1ad)]='',_0xd3cae0[_0x2b05c4(0x320)]=_0x2b05c4(0x2da),_0x466186['textContent']='',document[_0x2b05c4(0x2fd)]('passwordModal')[_0x2b05c4(0x189)][_0x2b05c4(0x1e2)]='none',passwordModalReject&&(passwordModalReject(new Error(_0x2b05c4(0x21d))),passwordModalResolve=null,passwordModalReject=null);}function updateModalPasswordStrength(){const _0x184fce=_0x378a5e,_0x624353=document[_0x184fce(0x2fd)](_0x184fce(0x319))[_0x184fce(0x1ad)],_0x1c9124=validator[_0x184fce(0x1ae)](_0x624353),_0x1db4fe=document[_0x184fce(0x2fd)](_0x184fce(0x27b)),_0x571221=document[_0x184fce(0x2fd)](_0x184fce(0x1fb));_0x1db4fe['className']='password-strength',_0x624353?(_0x1db4fe[_0x184fce(0x1d2)][_0x184fce(0x19f)](_0x1c9124[_0x184fce(0x31e)]),_0x571221[_0x184fce(0x13c)]=_0x1c9124[_0x184fce(0x2e8)]):_0x571221[_0x184fce(0x13c)]='';}async function copyToClipboard(_0x417c3b,_0x3eecb8){const _0x2a6af2=_0x378a5e,_0x3576de=document[_0x2a6af2(0x2fd)](_0x417c3b)[_0x2a6af2(0x1ad)];if(!_0x3576de){showStatus(_0x3eecb8,_0x2a6af2(0x2d9),'error');return;}const _0x438e75=await secureClipboardCopy(_0x3576de);if(_0x438e75)showStatus(_0x3eecb8,'Copied\x20to\x20clipboard',_0x2a6af2(0x1db)),appSettings[_0x2a6af2(0x236)]&&scheduleClipboardClear();else{showStatus(_0x3eecb8,_0x2a6af2(0x239),_0x2a6af2(0x19e));const _0x3d829d=document[_0x2a6af2(0x2fd)](_0x417c3b);_0x3d829d[_0x2a6af2(0x279)](),_0x3d829d[_0x2a6af2(0x15b)]();}}function handleDarkModeToggle(){const _0x10555d=_0x378a5e,_0x459a18=document['getElementById'](_0x10555d(0x1d9))[_0x10555d(0x326)],_0xd7a075=document['getElementById']('darkThemeOptions');_0x459a18?(_0xd7a075[_0x10555d(0x189)][_0x10555d(0x1e2)]=_0x10555d(0x1da),applyTheme(appSettings[_0x10555d(0x270)])):(_0xd7a075[_0x10555d(0x189)][_0x10555d(0x1e2)]=_0x10555d(0x2c5),document[_0x10555d(0x253)][_0x10555d(0x320)]='',document['querySelectorAll'](_0x10555d(0x167))[_0x10555d(0x264)](_0x420e11=>_0x420e11[_0x10555d(0x326)]=![])),localStorage[_0x10555d(0x2d5)](_0x10555d(0x2ed),_0x459a18);}function handleThemeToggle(_0x22213d){const _0x5d929f=_0x378a5e,_0x5cbc5c=_0x22213d[_0x5d929f(0x164)],_0x2f4eb1=document['querySelectorAll'](_0x5d929f(0x167));_0x2f4eb1['forEach'](_0x78e790=>{const _0x3719be=_0x5d929f;_0x78e790!==_0x5cbc5c&&(_0x78e790[_0x3719be(0x326)]=![]);});const _0xea13e9=_0x5cbc5c[_0x5d929f(0x326)]?_0x5cbc5c['dataset'][_0x5d929f(0x270)]:null;appSettings[_0x5d929f(0x270)]=_0xea13e9,applyTheme(_0xea13e9);}function applyTheme(_0x46261c){const _0x134594=_0x378a5e,_0x41f9fe=document[_0x134594(0x2fd)](_0x134594(0x1d9))[_0x134594(0x326)];_0x41f9fe&&(document[_0x134594(0x253)][_0x134594(0x320)]=_0x134594(0x2f1),_0x46261c&&document['body']['classList'][_0x134594(0x19f)](_0x134594(0x33d)+_0x46261c)),document[_0x134594(0x1a7)](_0x134594(0x167))[_0x134594(0x264)](_0x4373e2=>{const _0x4c0e08=_0x134594;_0x4373e2[_0x4c0e08(0x326)]=_0x4373e2[_0x4c0e08(0x17f)]['theme']===_0x46261c;});}function arrayBufferToBase64(_0x8f4fda){const _0x2dc094=_0x378a5e,_0x4da5b9=new Uint8Array(_0x8f4fda);let _0x16a500='';for(let _0x292473=0x0;_0x292473<_0x4da5b9[_0x2dc094(0x300)];_0x292473++){_0x16a500+=String[_0x2dc094(0x141)](_0x4da5b9[_0x292473]);}return btoa(_0x16a500);}function base64ToArrayBuffer(_0x3a517c){const _0x12de4a=_0x378a5e;try{const _0xa5e6ed=atob(_0x3a517c),_0x260d02=new Uint8Array(_0xa5e6ed[_0x12de4a(0x256)]);for(let _0x322833=0x0;_0x322833<_0xa5e6ed['length'];_0x322833++){_0x260d02[_0x322833]=_0xa5e6ed[_0x12de4a(0x2ec)](_0x322833);}return _0x260d02['buffer'];}catch(_0x2c7d61){console[_0x12de4a(0x334)]('[BASE64]\x20Decoding\x20error:',_0x2c7d61);throw new Error(_0x12de4a(0x328));}}async function encryptData(_0x46d349,_0x305c68,_0x392545){const _0x47bb78=_0x378a5e;if(_0x305c68[_0x47bb78(0x1eb)]===_0x47bb78(0x155))return await encryptWithAES(_0x46d349,_0x305c68);else{if(_0x305c68[_0x47bb78(0x1eb)]===_0x47bb78(0x25b)||_0x305c68[_0x47bb78(0x1eb)]===_0x47bb78(0x2c1))return await encryptWithRSA(_0x46d349,_0x305c68,_0x392545);else{if(_0x305c68['type']===_0x47bb78(0x1f6)||_0x305c68[_0x47bb78(0x1eb)]===_0x47bb78(0x23a)||_0x305c68[_0x47bb78(0x1eb)]===_0x47bb78(0x283))return await encryptWithECC(_0x46d349,_0x305c68,_0x392545);else throw new Error(_0x47bb78(0x207));}}}async function decryptData(_0x4f18d0,_0x323fcd){const _0xff864c=_0x378a5e;if(_0x4f18d0['version']>=0x2){if(_0x323fcd[_0xff864c(0x1eb)]===_0xff864c(0x155))return await decryptWithAES(_0x4f18d0,_0x323fcd);else{if(_0x323fcd[_0xff864c(0x1eb)]===_0xff864c(0x25b)||_0x323fcd['type']===_0xff864c(0x2c1))return await decryptWithRSA(_0x4f18d0,_0x323fcd);else{if(_0x323fcd[_0xff864c(0x1eb)]===_0xff864c(0x1f6)||_0x323fcd[_0xff864c(0x1eb)]==='ecc-p384'||_0x323fcd[_0xff864c(0x1eb)]===_0xff864c(0x283))return await decryptWithECC(_0x4f18d0,_0x323fcd);}}}if(_0x4f18d0[_0xff864c(0x20f)]===AES_CONFIG[_0xff864c(0x1b8)])return await decryptWithAES(_0x4f18d0,_0x323fcd);else{if(_0x4f18d0['algorithm']===RSA_CONFIG[_0xff864c(0x1e5)]+'+'+AES_CONFIG[_0xff864c(0x1b8)]||_0x4f18d0[_0xff864c(0x20f)]===_0xff864c(0x212))return await decryptWithRSA(_0x4f18d0,_0x323fcd);else{if(_0x4f18d0[_0xff864c(0x20f)]==='ECDH+'+AES_CONFIG['MODE']||_0x4f18d0[_0xff864c(0x20f)]===_0xff864c(0x1b7))return await decryptWithECC(_0x4f18d0,_0x323fcd);else throw new Error(_0xff864c(0x142)+_0x4f18d0[_0xff864c(0x20f)]);}}}async function deriveKeyFromPassword(_0x27c57d,_0x6e8263){const _0x3fd56e=_0x378a5e,_0x528172=new TextEncoder()[_0x3fd56e(0x1c3)](_0x27c57d),_0x1fea45=await window[_0x3fd56e(0x1e6)]['subtle'][_0x3fd56e(0x2f6)](_0x3fd56e(0x262),_0x528172,{'name':_0x3fd56e(0x22d)},![],[_0x3fd56e(0x1aa)]);return window[_0x3fd56e(0x1e6)]['subtle'][_0x3fd56e(0x1aa)]({'name':_0x3fd56e(0x22d),'salt':_0x6e8263,'iterations':PBKDF2_CONFIG['ITERATIONS'],'hash':PBKDF2_CONFIG['HASH']},_0x1fea45,{'name':AES_CONFIG[_0x3fd56e(0x1b8)],'length':AES_CONFIG['KEY_LENGTH']},!![],[_0x3fd56e(0x25e),_0x3fd56e(0x2a7)]);}function _0x4dff(){const _0xa00304=['485516BEBklN','KEY_LENGTH','set','.state,application/octet-stream','enforcePwdProtection','createElement','protected','output\x20length:','\x22\x20deleted\x20successfully','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-item-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','_importPassword','hasSigningPublic','P-521','KEY_SIZE','setItem','\x22?\x20This\x20action\x20cannot\x20be\x20undone.','<div\x20class=\x22key-expiry\x22>Expires\x20in\x20','WARNING:\x20Exporting\x20keys\x20without\x20a\x20password\x20is\x20not\x20secure.\x20Anyone\x20with\x20access\x20to\x20this\x20file\x20will\x20be\x20able\x20to\x20use\x20your\x20keys.\x20Continue\x20anyway?','Nothing\x20to\x20copy','password-strength','location','keyFileInput','app-settings','sign','publicKeyHash','Strong\x20-\x20Good\x20password!','14apeFzk','key','6255491SfssJr','Error\x20generating\x20key:\x20','This\x20appears\x20to\x20be\x20the\x20','encryptBtn','Lemonade\x20has\x20been\x20installed\x20successfully!','feedback','Please\x20enter\x20a\x20key\x20name','A\x20key\x20with\x20name\x20\x22','.lmn','charCodeAt','LemonadeDarkMode','decryptObfKey','Complete\x20asymmetric\x20key\x20pair\x20\x22','Error\x20reading\x20the\x20key\x20file','dark-mode','\x20ðŸ”’','remove','decryptStatus','Export\x20cancelled:\x20','importKey','ITERATIONS','Escape','Password\x20protection\x20is\x20required\x20by\x20your\x20security\x20settings','replace','disabled','\x20bits','getElementById','protocol','Message\x20decrypted\x20successfully','byteLength',')\x20have\x20been\x20permanently\x20deleted','ECC-P521','matchMedia','appendChild','createObjectStore','Symmetric\x20key\x20\x22','map','[DECRYPT-UI]\x20Key\x20password\x20error:','\x20key\x20\x22','File:\x20','innerHTML','No\x20encrypted\x20data\x20to\x20download','file','stateFileInput','.lim','data','userChoice','decryptVerify','passwordModalCancel','Invalid\x20state\x20file\x20format','\x20âœ…\x20VALID\x20SIGNATURE','readonly','read','Failed\x20to\x20unlock\x20key.\x20Please\x20check\x20your\x20password.','passwordModalInput','\x20expired\x20key(s)\x20removed\x20for\x20security','SHA-512','downloadEncryptedBtn','Database\x20not\x20initialized','strengthCategory','keyExpiry','className','settingsStatus','_privateKey','fileSize','Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message','inactivityModal','checked','_signingPrivateKey','Invalid\x20encrypted\x20message\x20format','LemonadeProtectedBackup','high','decryptFileInput','application/octet-stream','file:','false','AES','enqueue','format','onload','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22deleteKey(\x27','error','pkcs8','put','signingPrivateKey','\x22\x20downloaded\x20successfully','has','.theme-toggle:checked','Private\x20key\x20\x22','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20key\x20\x22','theme-','learn','importKeyBtn','exportPrivateKey','Lemonade\x20was\x20installed','encryptMessage','floor','click','Your\x20browser\x20doesn\x27t\x20support\x20secure\x20storage.\x20Using\x20less\x20secure\x20localStorage\x20instead.','catch','textContent','keys','Missing\x20encrypted\x20private\x20key\x20data','hasPrivate','signingPublicKey','fromCharCode','Unsupported\x20encryption\x20algorithm:\x20','</span>','verify','isArray','installStatus','stack','encryptedMessage','charAt','RSA-2048','pipeThrough','option','sanitizeHTML','\x20file','Error\x20loading\x20keys:\x20','LemonadeSettings','passwordModalConfirm','encryptionPasswordGroup','prompt','readAsText','aes','indexedDB','join','^.*?(','keypress','hasSigningPrivate','select','toLocaleDateString','24592zcuePQ','resetSettingsBtn','data-filename','buffer','[DECRYPT-RSA]\x20Technical\x20error\x20details:','flex','Secure\x20Your\x20Private\x20Key','target','pairedKeyId','href','.theme-toggle','[DECRYPT-AES]\x20Technical\x20error\x20details:','Service\x20Worker\x20registration\x20failed.\x20PWA\x20features\x20unavailable.','DecompressionStream\x20not\x20supported,\x20returning\x20data\x20as-is','Application\x20state\x20exported\x20successfully','toISOString','ceil','Only\x20export\x20private\x20keys\x20if\x20you\x20absolutely\x20need\x20to\x20use\x20them\x20on\x20another\x20device.\x20','subtle','Database\x20error:','clipboard','status','Export\x20error:','3544320IEdQAg','encryptObfKey','\x22\x20already\x20exists.\x20Overwrite?','6861xtNHvy','decryptBtn','P-256','Service\x20Worker\x20registration\x20failed:','ECDH','delete','This\x20will\x20import\x20','load','dataset','Please\x20enter\x20a\x20password\x20to\x20protect\x20this\x20private\x20key:','stringify','div','endsWith','exportKey','retrieve','strong','P-384','getRandomValues','style','decrypted_file','encryptionKey','File\x20\x22','Error\x20saving\x20keys:','Session-only\x20mode:\x20Keys\x20not\x20saved\x20persistently','Error\x20saving\x20keys:\x20','low','digest','slice','https:','RSA-PSS','ECC_ALGORITHM','pow','isValidKeyName','Error\x20loading\x20settings\x20from\x20localStorage:','encryptionPassword','RSA_ALGORITHM','encryptFileInput','.tab-btn','randomUUID','warning','add','privateKey','toFixed','Error\x20reading\x20the\x20state\x20file','CompressionStream\x20not\x20supported,\x20returning\x20uncompressed\x20data','matches','passwordModalTitle','onsuccess','querySelectorAll','push','keyType','deriveKey','msg','decryptedOutput','value','measurePasswordStrength','_publicKey','accepted','generateKey','salt','download','filter','174XOpdVt','Hello\x20World!','ECDH+AES-GCM','MODE','setAttribute','change','AES-GCM','loadingOverlay','from','getAll','[ENCRYPT-UI]\x20Encryption\x20error:','Signing\x20failed:','gzip','then','encode','Password\x20required\x20for\x20this\x20key','HKDF','onerror','(display-mode:\x20standalone)','toString','data-tab','IV_LENGTH','confirm','Data\x20does\x20not\x20appear\x20to\x20be\x20GZIP\x20compressed\x20(no\x20magic\x20bytes\x200x1f\x200x8b),\x20returning\x20as-is','onupgradeneeded','No\x20keys\x20to\x20delete','curve','active','<span\x20class=\x22key-pair-badge\x20public\x22>PUBLIC\x20KEY</span>','classList','pbkdf2Iterations','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ECC-P384','keydown','Error\x20loading\x20keys:','parse','darkMode','block','success','find','info','beforeinstallprompt','\x20keys\x20imported\x20successfully','getItem','Manual\x20garbage\x20collection\x20not\x20available','display','confirmKeyPassword','setDate','ALGORITHM','crypto','\x20[Public]','This\x20.lem\x20file\x20does\x20not\x20contain\x20a\x20private\x20key','0\x20Bytes',')[\x5cs\x5cS]+?(','type','ECC-P256','findIndex','clearDecryptBtn','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20private\x20key','414bajTyj','importStateBtn','input','Application\x20state\x20with\x20','private','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ecc','text','Protected\x20Private\x20Key','random','serviceWorker','passwordModalFeedback','[PARSE]\x20Extra\x20password\x20processing\x20error:','Decryption\x20failed.\x20Please\x20check\x20your\x20key\x20and\x20message.','encryptFileInfo','register','Key\x20not\x20found','get','.install-note','publicKey','Incorrect\x20password\x20or\x20corrupted\x20private\x20key','Key\x20is\x20missing\x20salt\x20or\x20IV\x20data','result','Unsupported\x20key\x20type','reduce','getAttribute','open','Invalid\x20key\x20file\x20format','decryptionKey','Passwords\x20do\x20not\x20match','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20state\x20file','algorithm','This\x20.lim\x20file\x20does\x20not\x20contain\x20a\x20public\x20key','\x27)\x22>Private\x20Key</button>','RSA-OAEP+AES-GCM','\x20keys\x20into\x20your\x20application.\x20Continue?','Are\x20you\x20sure\x20you\x20want\x20to\x20reset\x20all\x20settings\x20to\x20defaults?','addEventListener','hasPublic','settings','HASH','passwordModal','Lemonade\x20is\x20running\x20as\x20an\x20installed\x20app','ECDH+','decryptVerifyGroup','Password\x20entry\x20cancelled','State\x20import\x20error:\x20','Service\x20Worker\x20registered\x20with\x20scope:','files','decryptFileName','15lzvaJe','decryptedBinaryData','zeroKeysBtn','Compression:\x20output\x20first\x204\x20bytes:','decryptBrowseBtn','3419670NCPbwC','\x22\x20imported\x20successfully','Please\x20enter\x20a\x20password\x20to\x20protect\x20your\x20key\x20backup.\x20This\x20is\x20highly\x20recommended\x20for\x20security.','sw.js','public\x20key','LemonadeKeys','PBKDF2','_signingPublicKey','keyPassword','copyDecryptedBtn','readwrite','created','\x5c$&','encryptSign','<p>No\x20keys\x20available.\x20Generate\x20or\x20import\x20a\x20key\x20to\x20get\x20started.</p>','clearClipboard','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22exportKey(\x27','exportAllKeysBtn','Unable\x20to\x20copy\x20automatically.\x20Please\x20select\x20the\x20text\x20and\x20press\x20Ctrl+C\x20(or\x20âŒ˜+C)\x20to\x20copy\x20manually.','ecc-p384','<option\x20value=\x22\x22>Select\x20a\x20key...</option>','revokeObjectURL','toUpperCase','894667uvvjkU','store','DOMContentLoaded','log','encryptSignGroup','size','undefined','Error\x20saving\x20settings:','.lem','SALT_LENGTH','removeEncryptFile','Import\x20error:\x20','sig','keyStatus','Please\x20select\x20a\x20decryption\x20key','Invalid\x20state\x20data\x20format','accept','User\x20response\x20to\x20install\x20prompt:\x20','Medium\x20-\x20Add\x20more\x20variety\x20or\x20length\x20for\x20better\x20security','deleteKey','Installation\x20not\x20available\x20in\x20this\x20browser\x20or\x20app\x20is\x20already\x20installed','body','isFile','installContainer','length','Encrypted\x20file\x20loaded.\x20Select\x20key\x20and\x20enter\x20OBF\x20key\x20if\x20needed.','State\x20import\x20error:','\x20âŒ\x20INVALID\x20SIGNATURE','App\x20is\x20already\x20running\x20in\x20standalone\x20mode\x20(installed)','rsa','includes','Error\x20clearing\x20keys\x20from\x20database:','encrypt','12OflzUi','Import\x20error:','encryptStatus','raw','Service\x20Workers\x20not\x20supported\x20or\x20not\x20in\x20secure\x20context','forEach','encryptedOutput','close','Weak\x20-\x20Use\x20a\x20longer\x20password\x20with\x20numbers\x20and\x20special\x20characters','encryptBrowseBtn','test','toLowerCase','Bytes','Protected\x20State\x20File',').*$','No\x20keys\x20available\x20to\x20export','File\x20downloaded\x20successfully','theme','<span\x20class=\x22key-pair-badge\x20full\x22>FULL\x20KEY\x20PAIR</span>','127.0.0.1','Returning\x20compressed\x20data\x20as-is','Invalid\x20encrypted\x20message\x20format.\x20Expected\x20Base64\x20data.','objectStoreNames','SHA-256','\x20(No\x20signature\x20found\x20to\x20verify)','\x27)\x22>Delete</button>','focus','public','passwordModalStrength','createObjectURL','spki','contains','Unable\x20to\x20read\x20the\x20file.','Export\x20error:\x20','preventDefault','trim','ecc-p521','meta','\x22\x20generated\x20successfully','sensitiveData','[ENCRYPT-UI]\x20Key\x20password\x20error:','expiry','passwordStrength','fileName','Please\x20select\x20an\x20encryption\x20key','decryptFileInfo','LemonadeSecureDB','readAsArrayBuffer','removeChild','Failed\x20to\x20retrieve\x20decrypted\x20key\x20from\x20memory.','Installation\x20was\x20canceled','Encryption\x20failed.\x20Please\x20check\x20your\x20key\x20and\x20message.','Settings\x20saved\x20successfully','reverse','deriveBits','<span\x20class=\x22key-pair-badge\x20private\x22>PRIVATE\x20KEY</span>','Installation\x20is\x20now\x20available!','clear','_cryptoKey','PWA\x20installation\x20requires\x20HTTPS.\x20You\x20are\x20viewing\x20this\x20file\x20locally.','decryptionPasswordGroup','keyName','warn','version','decode','\x20[Full\x20Pair]','useIndexedDB','TAG_LENGTH','decryptionPassword','objectStore','Key\x20expiration\x20is\x20required\x20by\x20your\x20security\x20settings','[DECRYPT-UI]\x20Decryption\x20error:','decrypt','Verification\x20failed:','removeItem','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','Compression\x20error:','enforceKeyExpiry','data-binary','message','string','\x27)\x22>Export</button>','transaction','ECDSA','getDate','CURVE','medium','constructor','Enter\x20the\x20current\x20key\x20password\x20to\x20continue:','passwordFeedback','true','Key\x20deletion\x20canceled','\x20[Private]','decrypted.txt','[DECRYPT-ECC]\x20Technical\x20error\x20details:','downloadDecryptedBtn','name','sessionOnly','rsa-4096','Enter','querySelector','Database\x20initialization\x20failed.\x20Using\x20less\x20secure\x20localStorage\x20instead.','none','Key\x20\x22'];_0x4dff=function(){return _0xa00304;};return _0x4dff();}async function encryptWithDerivedKey(_0xdc9909,_0x661dd1,_0x3916a4){const _0x28182f=_0x378a5e;return window[_0x28182f(0x1e6)][_0x28182f(0x16f)][_0x28182f(0x25e)]({'name':AES_CONFIG[_0x28182f(0x1b8)],'iv':_0x3916a4,'tagLength':AES_CONFIG[_0x28182f(0x2a2)]},_0xdc9909,_0x661dd1);}async function decryptWithDerivedKey(_0xa0013e,_0xf41aba,_0x5b61c6){const _0x509305=_0x378a5e;return window[_0x509305(0x1e6)][_0x509305(0x16f)][_0x509305(0x2a7)]({'name':AES_CONFIG['MODE'],'iv':_0x5b61c6,'tagLength':AES_CONFIG[_0x509305(0x2a2)]},_0xa0013e,_0xf41aba);}async function importAESKey(_0x461c32){const _0x301d47=_0x378a5e;return window[_0x301d47(0x1e6)]['subtle'][_0x301d47(0x2f6)](_0x301d47(0x262),_0x461c32,{'name':AES_CONFIG[_0x301d47(0x1b8)],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x301d47(0x25e),_0x301d47(0x2a7)]);}async function importRSAPublicKey(_0x4eeafc,_0x238508){const _0x4c9344=_0x378a5e;return window[_0x4c9344(0x1e6)][_0x4c9344(0x16f)][_0x4c9344(0x2f6)](_0x4c9344(0x27d),_0x4eeafc,{'name':RSA_CONFIG[_0x4c9344(0x1e5)],'hash':RSA_CONFIG[_0x4c9344(0x218)]},![],[_0x4c9344(0x25e)]);}async function importRSAPrivateKey(_0x2dfea8,_0x15081b){const _0x146307=_0x378a5e;return window[_0x146307(0x1e6)]['subtle']['importKey'](_0x146307(0x335),_0x2dfea8,{'name':RSA_CONFIG[_0x146307(0x1e5)],'hash':RSA_CONFIG[_0x146307(0x218)]},![],[_0x146307(0x2a7)]);}async function importECCPublicKey(_0x9a8efb,_0x17c0e1,_0x279bc5=_0x378a5e(0x262)){const _0x4ad1dd=_0x378a5e;return window[_0x4ad1dd(0x1e6)][_0x4ad1dd(0x16f)][_0x4ad1dd(0x2f6)](_0x279bc5,_0x9a8efb,{'name':'ECDH','namedCurve':_0x17c0e1},![],[]);}async function importECCPrivateKey(_0x44f13f,_0xa176bd){return window['crypto']['subtle']['importKey']('pkcs8',_0x44f13f,{'name':'ECDH','namedCurve':_0xa176bd},![],['deriveKey','deriveBits']);}async function saveToDatabase(_0x33d3b0,_0x1af069){return new Promise((_0x3cfce6,_0x9ed664)=>{const _0x4f0c82=_0x5b81;if(!db){_0x9ed664(new Error(_0x4f0c82(0x31d)));return;}const _0x77bd6e=db[_0x4f0c82(0x2b1)](_0x33d3b0,_0x4f0c82(0x231)),_0x2d9bdc=_0x77bd6e['objectStore'](_0x33d3b0),_0x3622b9=_0x2d9bdc[_0x4f0c82(0x336)](_0x1af069);_0x3622b9[_0x4f0c82(0x1a6)]=()=>_0x3cfce6(),_0x3622b9[_0x4f0c82(0x1c6)]=()=>_0x9ed664(_0x3622b9[_0x4f0c82(0x334)]);});}function _0x5b81(_0x58d5bc,_0x1bd8ff){_0x58d5bc=_0x58d5bc-0x137;const _0x4dff1d=_0x4dff();let _0x5b8107=_0x4dff1d[_0x58d5bc];return _0x5b8107;}async function getFromDatabase(_0x5797e0,_0x6e7c5d){return new Promise((_0x818c25,_0x427258)=>{const _0x31e25c=_0x5b81;if(!db){_0x427258(new Error(_0x31e25c(0x31d)));return;}const _0x5c49e4=db[_0x31e25c(0x2b1)](_0x5797e0,_0x31e25c(0x316)),_0x2deb2e=_0x5c49e4[_0x31e25c(0x2a4)](_0x5797e0),_0x42271b=_0x2deb2e['get'](_0x6e7c5d);_0x42271b[_0x31e25c(0x1a6)]=()=>_0x818c25(_0x42271b['result']),_0x42271b[_0x31e25c(0x1c6)]=()=>_0x427258(_0x42271b[_0x31e25c(0x334)]);});}async function getAllFromDatabase(_0x5a7624){return new Promise((_0x44ccdd,_0xb2a52c)=>{const _0x12c266=_0x5b81;if(!db){_0xb2a52c(new Error('Database\x20not\x20initialized'));return;}const _0x2b48fc=db[_0x12c266(0x2b1)](_0x5a7624,_0x12c266(0x316)),_0x2febce=_0x2b48fc[_0x12c266(0x2a4)](_0x5a7624),_0x13c1c6=_0x2febce[_0x12c266(0x1be)]();_0x13c1c6[_0x12c266(0x1a6)]=()=>_0x44ccdd(_0x13c1c6[_0x12c266(0x206)]),_0x13c1c6['onerror']=()=>_0xb2a52c(_0x13c1c6[_0x12c266(0x334)]);});}async function clearDatabase(_0x57f51f){return new Promise((_0x171779,_0x6803d7)=>{const _0x354206=_0x5b81;if(!db){_0x6803d7(new Error(_0x354206(0x31d)));return;}const _0x394461=db['transaction'](_0x57f51f,_0x354206(0x231)),_0x363a00=_0x394461[_0x354206(0x2a4)](_0x57f51f),_0x533fb9=_0x363a00[_0x354206(0x298)]();_0x533fb9[_0x354206(0x1a6)]=()=>_0x171779(),_0x533fb9[_0x354206(0x1c6)]=()=>_0x6803d7(_0x533fb9[_0x354206(0x334)]);});}window[_0x378a5e(0x184)]=exportKey,window[_0x378a5e(0x340)]=exportPrivateKey,window[_0x378a5e(0x251)]=deleteKey;let deferredPrompt;const installBtn=document[_0x378a5e(0x2fd)]('installBtn'),installContainer=document[_0x378a5e(0x2fd)](_0x378a5e(0x255)),installStatus=document['getElementById']('installStatus');installBtn&&(installBtn[_0x378a5e(0x2fb)]=!![]);window['addEventListener'](_0x378a5e(0x1de),_0xa62d46=>{const _0x553ec5=_0x378a5e;_0xa62d46[_0x553ec5(0x281)](),deferredPrompt=_0xa62d46;if(installBtn){installBtn['disabled']=![];const _0x30e4bd=installContainer[_0x553ec5(0x2c3)](_0x553ec5(0x202));_0x30e4bd&&(_0x30e4bd['style'][_0x553ec5(0x1e2)]='none'),showStatus('installStatus',_0x553ec5(0x297),_0x553ec5(0x1db));}});installBtn&&installBtn[_0x378a5e(0x215)](_0x378a5e(0x139),async()=>{const _0x522320=_0x378a5e;if(!deferredPrompt){showStatus('installStatus',_0x522320(0x252),_0x522320(0x19e));return;}deferredPrompt[_0x522320(0x153)]();const {outcome:_0x52a735}=await deferredPrompt[_0x522320(0x311)];console[_0x522320(0x241)](_0x522320(0x24f)+_0x52a735),_0x52a735===_0x522320(0x1b0)?showStatus('installStatus','Lemonade\x20has\x20been\x20installed\x20successfully!',_0x522320(0x1db)):showStatus(_0x522320(0x146),_0x522320(0x291),_0x522320(0x19e)),deferredPrompt=null,installBtn[_0x522320(0x2fb)]=!![];});window[_0x378a5e(0x215)]('appinstalled',()=>{const _0x204267=_0x378a5e;console[_0x204267(0x241)](_0x204267(0x341)),deferredPrompt=null,installBtn&&(installBtn[_0x204267(0x2fb)]=!![]),showStatus('installStatus',_0x204267(0x2e7),_0x204267(0x1db));});_0x378a5e(0x1fa)in navigator&&(window[_0x378a5e(0x2db)][_0x378a5e(0x2fe)]===_0x378a5e(0x193)||window[_0x378a5e(0x2db)]['hostname']==='localhost'||window[_0x378a5e(0x2db)]['hostname']===_0x378a5e(0x272))?window[_0x378a5e(0x215)](_0x378a5e(0x17e),function(){const _0x4c9327=_0x378a5e;navigator['serviceWorker'][_0x4c9327(0x1ff)](_0x4c9327(0x22a))['then'](function(_0x5dbe7a){const _0x3c30d9=_0x4c9327;console[_0x3c30d9(0x241)](_0x3c30d9(0x21f),_0x5dbe7a['scope']);})[_0x4c9327(0x13b)](function(_0x422c10){const _0x5a8a40=_0x4c9327;console[_0x5a8a40(0x334)](_0x5a8a40(0x17a),_0x422c10),showStatus(_0x5a8a40(0x146),_0x5a8a40(0x169),'warning');});}):(console[_0x378a5e(0x241)](_0x378a5e(0x263)),installStatus&&(window[_0x378a5e(0x2db)][_0x378a5e(0x2fe)]===_0x378a5e(0x32d)?showStatus(_0x378a5e(0x146),_0x378a5e(0x29a),_0x378a5e(0x19e)):showStatus(_0x378a5e(0x146),'Your\x20browser\x20does\x20not\x20support\x20PWA\x20installation\x20features.',_0x378a5e(0x19e))));window[_0x378a5e(0x303)](_0x378a5e(0x1c7))[_0x378a5e(0x1a4)]&&(console[_0x378a5e(0x241)](_0x378a5e(0x25a)),installStatus&&showStatus(_0x378a5e(0x146),_0x378a5e(0x21a),_0x378a5e(0x1db)));let encryptFileData=null,encryptFileName='',decryptFileData=null,decryptFileName='';document['addEventListener'](_0x378a5e(0x240),function(){const _0x33532e=_0x378a5e,_0x4253f5=document['getElementById'](_0x33532e(0x19b)),_0x5f2db1=document[_0x33532e(0x2fd)](_0x33532e(0x268)),_0x2f416d=document[_0x33532e(0x2fd)](_0x33532e(0x1fe)),_0x9ff4d4=document['getElementById']('encryptFileName'),_0x31ea59=document[_0x33532e(0x2fd)](_0x33532e(0x248)),_0x3eceb3=document['getElementById']('decryptFileInput'),_0x1070e4=document[_0x33532e(0x2fd)](_0x33532e(0x226)),_0x16513b=document[_0x33532e(0x2fd)](_0x33532e(0x28c)),_0x9a9063=document[_0x33532e(0x2fd)](_0x33532e(0x221)),_0x22c4e9=document[_0x33532e(0x2fd)]('removeDecryptFile'),_0x5916dd=document['getElementById']('downloadEncryptedBtn'),_0x164aaf=document[_0x33532e(0x2fd)](_0x33532e(0x2be));_0x5f2db1['addEventListener'](_0x33532e(0x139),()=>{_0x4253f5['click']();}),_0x4253f5[_0x33532e(0x215)]('change',_0x3b9e92=>{const _0x5808d8=_0x33532e;handleEncryptFileSelect(_0x3b9e92[_0x5808d8(0x164)][_0x5808d8(0x220)]);}),_0x31ea59['addEventListener'](_0x33532e(0x139),()=>{clearEncryptFile();}),_0x1070e4[_0x33532e(0x215)](_0x33532e(0x139),()=>{const _0x4c6cdd=_0x33532e;_0x3eceb3[_0x4c6cdd(0x139)]();}),_0x3eceb3['addEventListener']('change',_0x414cf3=>{const _0x51d962=_0x33532e;handleDecryptFileSelect(_0x414cf3[_0x51d962(0x164)][_0x51d962(0x220)]);}),_0x22c4e9['addEventListener'](_0x33532e(0x139),()=>{clearDecryptFile();}),createKeyFileInput(),_0x5916dd[_0x33532e(0x215)](_0x33532e(0x139),downloadEncryptedFile),_0x164aaf[_0x33532e(0x215)](_0x33532e(0x139),downloadDecryptedFile),document['getElementById'](_0x33532e(0x2e6))[_0x33532e(0x215)]('click',function(){const _0x812207=_0x33532e;window[_0x812207(0x223)]=null;}),document[_0x33532e(0x2fd)](_0x33532e(0x151))[_0x33532e(0x215)](_0x33532e(0x139),confirmPasswordModal),document[_0x33532e(0x2fd)](_0x33532e(0x313))[_0x33532e(0x215)]('click',cancelPasswordModal),document[_0x33532e(0x2fd)](_0x33532e(0x319))[_0x33532e(0x215)]('input',updateModalPasswordStrength),document[_0x33532e(0x2fd)](_0x33532e(0x319))[_0x33532e(0x215)](_0x33532e(0x159),function(_0x414876){const _0x1ca9d0=_0x33532e;_0x414876[_0x1ca9d0(0x2e2)]===_0x1ca9d0(0x2c2)&&confirmPasswordModal();}),document[_0x33532e(0x215)](_0x33532e(0x1d6),function(_0x232566){const _0x4114f8=_0x33532e;_0x232566['key']===_0x4114f8(0x2f8)&&document[_0x4114f8(0x2fd)]('passwordModal')['style']['display']==='flex'&&cancelPasswordModal();});});function handleEncryptFileSelect(_0x589923){const _0x24b1d8=_0x378a5e;if(_0x589923['length']===0x0)return;const _0x7fed7b=_0x589923[0x0];encryptFileName=_0x7fed7b[_0x24b1d8(0x2bf)];const _0x3b9e12=new FileReader();_0x3b9e12[_0x24b1d8(0x332)]=function(_0x20b8af){const _0x17214f=_0x24b1d8;encryptFileData=_0x20b8af[_0x17214f(0x164)][_0x17214f(0x206)],document[_0x17214f(0x2fd)]('encryptMessage')[_0x17214f(0x1ad)]=_0x17214f(0x30a)+encryptFileName+'\x20('+formatFileSize(_0x7fed7b[_0x17214f(0x243)])+')',document[_0x17214f(0x2fd)](_0x17214f(0x1fe))[_0x17214f(0x189)][_0x17214f(0x1e2)]='flex',document[_0x17214f(0x2fd)]('encryptFileName')[_0x17214f(0x13c)]=encryptFileName;},_0x3b9e12[_0x24b1d8(0x28e)](_0x7fed7b);}function handleDecryptFileSelect(_0x1a84c7){const _0xda55d4=_0x378a5e;if(_0x1a84c7[_0xda55d4(0x256)]===0x0)return;const _0x41f85f=_0x1a84c7[0x0];decryptFileName=_0x41f85f[_0xda55d4(0x2bf)];const _0x4fb214=new FileReader();_0x4fb214['onload']=function(_0x17de84){const _0x25b5aa=_0xda55d4,_0x10a906=_0x17de84[_0x25b5aa(0x164)]['result'];document['getElementById'](_0x25b5aa(0x148))[_0x25b5aa(0x1ad)]=_0x10a906,decryptFileData=null,document['getElementById']('decryptFileInfo')[_0x25b5aa(0x189)]['display']=_0x25b5aa(0x162),document[_0x25b5aa(0x2fd)](_0x25b5aa(0x221))[_0x25b5aa(0x13c)]=decryptFileName,showStatus(_0x25b5aa(0x2f4),_0x25b5aa(0x257),'success');},_0x4fb214['onerror']=function(){const _0x23ec09=_0xda55d4;showStatus(_0x23ec09(0x2f4),_0x23ec09(0x27f),'error');},_0x4fb214['readAsText'](_0x41f85f);}function clearEncryptFile(){const _0x4f7d47=_0x378a5e;encryptFileData=null,encryptFileName='',document['getElementById'](_0x4f7d47(0x137))[_0x4f7d47(0x1ad)]='',document[_0x4f7d47(0x2fd)]('encryptFileInfo')[_0x4f7d47(0x189)]['display']=_0x4f7d47(0x2c5),document[_0x4f7d47(0x2fd)](_0x4f7d47(0x19b))['value']='';}function clearDecryptFile(){const _0x535412=_0x378a5e;decryptFileData=null,decryptFileName='',document[_0x535412(0x2fd)](_0x535412(0x148))[_0x535412(0x1ad)]='',document[_0x535412(0x2fd)](_0x535412(0x28c))[_0x535412(0x189)]['display']=_0x535412(0x2c5),document[_0x535412(0x2fd)](_0x535412(0x32b))[_0x535412(0x1ad)]='';}function formatFileSize(_0x1fa9e6){const _0x3068c8=_0x378a5e;if(_0x1fa9e6===0x0)return _0x3068c8(0x1e9);const _0x30d0ac=0x400,_0x50a711=[_0x3068c8(0x26b),'KB','MB','GB'],_0x19365f=Math['floor'](Math[_0x3068c8(0x241)](_0x1fa9e6)/Math[_0x3068c8(0x241)](_0x30d0ac));return parseFloat((_0x1fa9e6/Math[_0x3068c8(0x196)](_0x30d0ac,_0x19365f))[_0x3068c8(0x1a1)](0x2))+'\x20'+_0x50a711[_0x19365f];}function generateRandomFileName(_0x1b92ff=0x6){const _0x1235f0=_0x378a5e,_0x46e346='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let _0x66375d='';for(let _0x593f2e=0x0;_0x593f2e<_0x1b92ff;_0x593f2e++){_0x66375d+=_0x46e346[_0x1235f0(0x149)](Math[_0x1235f0(0x138)](Math[_0x1235f0(0x1f9)]()*_0x46e346[_0x1235f0(0x256)]));}return _0x66375d;} </script><div id="passwordModal" class="modal"><div class="modal-content"><h3 id="passwordModalTitle">Enter Password</h3><p id="passwordModalMessage">Please enter a password to continue:</p><div class="form-group"><input type="password" id="passwordModalInput" placeholder="Enter password"><div id="passwordModalStrength" class="password-strength"></div><div id="passwordModalFeedback" class="password-feedback"></div></div><div class="btn-group"><button id="passwordModalConfirm" class="btn-primary">Confirm</button><button id="passwordModalCancel" class="btn-secondary">Cancel</button></div></div></div></body></html>
