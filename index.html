<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="no-referrer">
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=()">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Lemonade">
    <link rel="icon" href="icon.svg">
    <link rel="apple-touch-icon" href="icon.svg">
    <link rel="manifest" href="manifest.json">
    <title>Lemonade</title>
    <style>
/* CSS with dark/light mode support */
:root {
    --bg-color: #ffffff;
    --text-color: #000000;
    --title-gradient: linear-gradient(90deg, #000000, #000000);
    --card-bg: #ffffff;
    --accent-color: #000000;
    --border-color: #dddddd;
    --input-bg: #ffffff;
    --button-bg: #000000;
    --button-text: #ffffff;
    --button-hover: #333333;
    --success-color: #00cc66;
    --error-color: #cc3300;
    --warning-color: #f0ad4e;
    --cyber-line: rgba(0, 0, 0, 0.15); /* Kept for light mode, dark mode will override */
    --cyber-glow: rgba(0, 0, 0, 0.4); /* Kept for light mode, dark mode will override */
    --security-high: #00cc66;
    --security-medium: #f0ad4e;
    --security-low: #cc3300;
    --output-bg: #f8f8f8;
    --output-text: #222222;
}

/* Dark mode class */
body.dark-mode {
    --bg-color: #000000; /* Pitch black background */
    --text-color: #E0E0E0; /* Light grey/off-white for general text */
    --title-gradient: linear-gradient(90deg, #39FF14, #FF00FF, #00FFFF); /* Green, Pink, Blue */
    --card-bg: #0A0A0A; /* Very dark grey, almost black, solid */
    --accent-color: #39FF14; /* Terminal Green */
    --border-color: #2A2A2A; /* Darker grey for subtle borders */
    --input-bg: #101010; /* Dark grey for inputs */
    --button-bg: #00FFFF; /* Cyber Blue for buttons */
    --button-text: #000000; /* Black for text on blue buttons */
    --button-hover: #FF00FF; /* Hot Pink for button hover */
    --success-color: #39FF14; /* Terminal Green for success */
    --error-color: #FF3131; /* Neon Red for error */
    --warning-color: #FFFF00; /* Neon Yellow for warning */
    --cyber-line: rgba(57, 255, 20, 0.3); /* Terminal Green, slightly transparent line */
    --cyber-glow: rgba(57, 255, 20, 0.1); /* Terminal Green, very subtle glow or none */
    --security-high: #39FF14;
    --security-medium: #FFFF00;
    --security-low: #FF3131;
    --output-bg: #050505; /* Even darker for output boxes */
    --output-text: #B2F2BB; /* Light terminal green for output text */
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    transition: background-color 0.3s, color 0.3s;
    line-height: 1.6;
    position: relative;
    overflow-x: hidden;
}

body::before {
    display: none; /* Removed psychedelic background for performance */
}

/* Solid Black Background for Dark Mode */
body.dark-mode::before {
    content: "";
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    background-color: #000000; /* Pitch black */
    opacity: 1;
}

/* Static scanlines overlay (kept as it's not resource-intensive) */
body.dark-mode::after {
    content: "";
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1; /* Ensure it's behind content */
    background: repeating-linear-gradient(
        0deg,
        rgba(57, 255, 20, 0.05), /* Very subtle green scanlines */
        rgba(57, 255, 20, 0.05) 1px,
        transparent 1px,
        transparent 3px /* Increased spacing for subtlety */
    );
    pointer-events: none;
}

/* Enhanced App Title - No animation */
body.dark-mode .app-title {
    color: var(--accent-color); /* Use accent color for solid text */
    text-shadow: none; /* Removed text-shadow */
    background: none;
}

/* Enhanced Cards - No animation or heavy shadows */
body.dark-mode .card {
    border: 1px solid var(--accent-color); /* Terminal green border */
    box-shadow: none; /* Removed box-shadow */
    backdrop-filter: none; /* Removed backdrop-filter */
    /* animation: border-pulse 4s infinite; REMOVED */
}

/* Enhanced Buttons - No animation or heavy shadows */
body.dark-mode button {
    border: 1px solid transparent;
    box-shadow: none; /* Removed box-shadow */
    text-shadow: none; /* Removed text-shadow */
    transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease; /* Simplified transition */
    position: relative;
    overflow: hidden;
}

body.dark-mode button:hover {
    background-color: var(--button-hover); /* Uses --button-hover (Hot Pink) */
    color: var(--button-text); /* Ensure text remains readable, or set a specific hover text color */
    box-shadow: none; /* Ensure no shadow on hover */
    transform: translateY(-1px); /* Slight lift effect */
}

/* Removed Psychedelic button effects */
body.dark-mode button::before {
    display: none; /* Removed animated gradient */
}

/* Enhanced Input Fields - No animation or heavy shadows */
body.dark-mode input,
body.dark-mode textarea,
body.dark-mode select {
    border: 1px solid var(--border-color);
    box-shadow: none; /* Removed inset shadow */
    backdrop-filter: none; /* Removed backdrop-filter */
    transition: border-color 0.2s ease; /* Simplified transition */
}

body.dark-mode input:focus,
body.dark-mode textarea:focus,
body.dark-mode select:focus {
    border-color: var(--accent-color); /* Terminal green border on focus */
    box-shadow: none; /* Removed focus shadow and animation */
    /* animation: focus-pulse 2s infinite; REMOVED */
}

/* Enhanced Security Badges - No animation */
body.dark-mode .security-badge {
    /* animation: security-pulse 2s infinite; REMOVED */
    text-shadow: none; /* Removed text-shadow */
}

/* Enhanced Key Items - Simplified */
body.dark-mode .key-item {
    border: 1px solid var(--border-color);
    background-color: var(--card-bg); /* Consistent with card background */
    box-shadow: none; /* Removed box-shadow */
    transition: border-color 0.2s ease; /* Simplified transition */
}

body.dark-mode .key-item:hover {
    transform: none; /* Removed transform */
    border-color: var(--accent-color); /* Green border on hover */
    box-shadow: none;
}

/* Tab Button Enhancement - Simplified */
body.dark-mode .tab-btn.active {
    background-color: var(--accent-color); /* Terminal green background */
    color: var(--button-text); /* Black text for contrast */
    border-bottom-color: var(--accent-color);
    box-shadow: none;
    /* animation: tab-shift 3s infinite; REMOVED */
}
body.dark-mode .tab-btn:hover:not(.active) {
    color: var(--accent-color);
    border-bottom-color: var(--accent-color);
}


/* Switch slider enhancement - Simplified */
body.dark-mode .slider {
    background-color: #333; /* Dark grey for off state */
    box-shadow: none;
}

body.dark-mode input:checked + .slider {
    background-color: var(--accent-color); /* Terminal green for on state */
}

body.dark-mode .slider:before {
    box-shadow: none;
    background-color: #111; /* Darker circle */
}
body.dark-mode input:checked + .slider:before {
    background-color: #000; /* Black circle when active */
}


/* Status enhancement - No animation */
body.dark-mode .status.success,
body.dark-mode .status.warning,
body.dark-mode .status.error {
    /* animation: status-pulse 2s infinite; REMOVED */
    border-width: 1px;
    border-style: solid;
}
body.dark-mode .status.success { background-color: rgba(57, 255, 20, 0.1); border-color: var(--success-color); color: var(--success-color); }
body.dark-mode .status.warning { background-color: rgba(255, 255, 0, 0.1); border-color: var(--warning-color); color: var(--warning-color); }
body.dark-mode .status.error { background-color: rgba(255, 49, 49, 0.1); border-color: var(--error-color); color: var(--error-color); }


/* Loading animation enhancement - Simplified */
body.dark-mode .spinner {
    border: 3px solid rgba(224, 224, 224, 0.2); /* Lighter, subtle border */
    border-top-color: var(--accent-color); /* Terminal Green */
    /* animation: spin 1s ease-in-out infinite, color-shift 3s linear infinite; REMOVED color-shift */
    animation: spin 1s linear infinite; /* Kept spin animation */
}

/* Ensure base styles for .app-title are present if needed */
.app-title {
    font-size: 1.8rem;
    margin: 0;
    color: var(--text-color); /* Use text color for light mode */
    background: none;
}

/* Updated Dark Mode styles for elements previously animated or heavily styled */
body.dark-mode .app-title {
    color: var(--accent-color); /* Use accent color for solid text */
    text-shadow: none;
}

body.dark-mode .app-header::after {
    background: linear-gradient(90deg, transparent, var(--accent-color), transparent); /* Green accent line */
}

body.dark-mode .card::before { /* Top border highlight for card */
    background: var(--accent-color); /* Solid Green */
    height: 2px;
}

body.dark-mode .tab-btn:hover::after {
    background-color: var(--accent-color); /* Green underline on hover */
}

body.dark-mode input:focus, 
body.dark-mode textarea:focus, 
body.dark-mode select:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px var(--cyber-glow); /* Using the new subtle glow */
}

body.dark-mode .btn-secondary {
    border: 1px solid var(--accent-color); /* Green border */
    color: var(--accent-color); /* Green text */
    background-color: transparent;
}

body.dark-mode .btn-secondary:hover {
    background-color: rgba(57, 255, 20, 0.1); /* Slight green tint on hover */
    color: #39FF14; /* Brighter green text on hover */
}

/* Security Badges in Dark Mode - Static, no pulse */
body.dark-mode .security-badge {
    /* animation: securityPulse 2s infinite; REMOVED */
    transition: none;
}
body.dark-mode .security-badge.high { background-color: rgba(57, 255, 20, 0.1); color: var(--security-high); border: 1px solid var(--security-high); box-shadow: none; }
body.dark-mode .security-badge.medium { background-color: rgba(255, 255, 0, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); box-shadow: none; }
body.dark-mode .security-badge.low { background-color: rgba(255, 49, 49, 0.1); color: var(--security-low); border: 1px solid var(--security-low); box-shadow: none; }

/* Key Pair Badges in Dark Mode - Static */
body.dark-mode .key-pair-badge.full { background-color: rgba(57, 255, 20, 0.1); color: var(--security-high); border: 1px solid var(--security-high); box-shadow: none; }
body.dark-mode .key-pair-badge.private { background-color: rgba(255, 49, 49, 0.1); color: var(--security-low); border: 1px solid var(--security-low); box-shadow: none; }
body.dark-mode .key-pair-badge.public { background-color: rgba(255, 255, 0, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); box-shadow: none; }

body.dark-mode .private-key-btn {
    border: 1px solid var(--error-color) !important;
    color: var(--error-color) !important;
}
body.dark-mode .private-key-btn:hover {
    background-color: rgba(255, 49, 49, 0.2) !important;
    color: #FF3131 !important; /* Brighter red on hover */
}

/* Modal Content in Dark Mode */
body.dark-mode .modal-content {
    border: 1px solid var(--accent-color); /* Green border */
    box-shadow: none; /* Removed glow */
    background-color: var(--card-bg); /* Consistent with card backgrounds */
}

/* Primary button in dark mode (often used in modals) */
body.dark-mode .btn-primary {
    background-color: var(--accent-color); /* Green */
    color: #000000; /* Black text for contrast */
}
body.dark-mode .btn-primary:hover {
    background-color: #4CFF3A; /* Lighter green for hover */
}

/* Zero Keys button dark mode override */
body.dark-mode .btn-zero {
    background-color: var(--error-color); /* Neon Red */
    color: #FFFFFF; /* White text for contrast */
    border: 1px solid #FF0000; /* Brighter Red border */
}
body.dark-mode .btn-zero:hover {
    background-color: #FF5555; /* Lighter Neon Red */
}

/* Ensure general body styles and other non-dark-mode specific styles remain below */

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    transition: background-color 0.3s, color 0.3s;
    line-height: 1.6;
    position: relative;
    overflow-x: hidden;
}

/* Base container - Responsive container sizing */
.container {
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
    transition: max-width 0.3s ease-in-out;
}

.app-header {
    text-align: center;
    margin-bottom: 20px;
    position: relative;
}

/* .app-title is already defined above with dark mode considerations */

.app-subtitle {
    font-size: 0.9rem;
    margin: 0;
    padding-top: 2px;
    font-style: italic;
    color: var(--text-color);
    opacity: 0.8;
}

.app-header::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 80%;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
}

.card {
    background-color: var(--card-bg);
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    padding: 20px;
    margin-bottom: 20px;
    border: 1px solid var(--border-color);
    position: relative;
    overflow: hidden;
}

.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, #33aaff, #0066cc); /* Default for light mode */
}
/* Dark mode card::before is handled by body.dark-mode .card::before */


.tabs {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
    border-bottom: 1px solid var(--border-color);
    overflow-x: auto; /* Allow scrolling on small screens */
}

.tab-btn {
    background: none;
    border: none;
    padding: 10px 20px;
    font-size: 1rem;
    cursor: pointer;
    color: var(--text-color);
    border-bottom: 2px solid transparent;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
    white-space: nowrap; /* Prevent text wrapping */
}

.tab-btn.active {
    border-bottom: 2px solid var(--accent-color);
    color: var(--accent-color);
}
/* body.dark-mode .tab-btn.active is already defined */

.tab-btn::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background-color: var(--accent-color);
    transition: width 0.3s;
}

.tab-btn:hover::after {
    width: 100%;
}
/* body.dark-mode .tab-btn:hover::after is already defined */

.tab-content {
    display: none !important;
}

.tab-content.active {
    display: block !important;
    /* animation: fadeIn 0.3s ease-in-out; REMOVED animation for performance */
}

/* @keyframes fadeIn { REMOVED
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
} */

.form-group {
    margin-bottom: 15px;
}

label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
}

input, textarea, select {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background-color: var(--input-bg);
    color: var(--text-color);
    font-size: 1rem;
    box-sizing: border-box;
    transition: border-color 0.3s, box-shadow 0.3s;
}

input:focus, textarea:focus, select:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px var(--cyber-glow); /* Default glow, dark mode overrides this */
}
/* body.dark-mode input:focus etc. is already defined */


/* Enhanced output textareas */
#encryptedOutput,
#decryptedOutput {
    min-height: 120px;
    background-color: var(--output-bg);
    color: var(--output-text);
    border-width: 1px;
    border-style: solid;
    border-color: var(--border-color);
    font-family: 'Consolas', 'Courier New', monospace;
    width: 100%;
    resize: vertical;
    padding: 15px;
    overflow-y: auto;
}

/* Make sure parent containers don't restrict width */
.form-group:has(#encryptedOutput),
.form-group:has(#decryptedOutput) {
    width: 100%;
}

/* Non :has() fallback for better browser compatibility */
#encrypt .form-group:nth-of-type(3),
#decrypt .form-group:nth-of-type(3) {
    width: 100%;
}

textarea {
    min-height: 100px;
    resize: vertical;
}

button {
    background-color: var(--button-bg);
    color: var(--button-text);
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.1s;
    position: relative;
    overflow: hidden;
}

button:hover {
    background-color: var(--button-hover);
}
/* body.dark-mode button:hover is already defined */


button:active {
    transform: scale(0.98);
}

/* Removed ripple effect for performance */
button::after {
    display: none;
}
/* @keyframes ripple { REMOVED ... } */

.btn-group {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}

.btn-secondary {
    background-color: transparent;
    border: 1px solid var(--accent-color);
    color: var(--accent-color);
}
/* body.dark-mode .btn-secondary is already defined */

.btn-secondary:hover {
    background-color: rgba(0,0,0, 0.05); /* Subtle hover for light mode */
}
/* body.dark-mode .btn-secondary:hover is already defined */

.status {
    padding: 10px;
    border-radius: 8px;
    margin-top: 15px;
    display: none; /* Hidden by default */
}

.status.success {
    background-color: rgba(0, 204, 102, 0.1);
    color: var(--success-color);
    border: 1px solid var(--success-color);
    display: block;
}

.status.warning {
    background-color: rgba(240, 173, 78, 0.1);
    color: var(--warning-color);
    border: 1px solid var(--warning-color);
    display: block;
}

.status.error {
    background-color: rgba(204, 51, 0, 0.1);
    color: var(--error-color);
    border: 1px solid var(--error-color);
    display: block;
}
/* body.dark-mode .status styles are already defined */

.keys-container {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.keys-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px;
    width: 100%;
}

.key-form {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.key-item {
    background-color: var(--input-bg); /* Light mode uses input background */
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 15px;
    display: flex;
    flex-direction: column;
    height: 100%;
}
/* body.dark-mode .key-item is already defined */


.key-item-content {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.key-item h3 {
    margin-top: 0;
    margin-bottom: 10px;
}

.key-header {
    text-align: center;
    margin-bottom: 15px;
}

.key-actions {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
    margin-top: auto;
    padding-top: 15px;
    border-top: 1px solid var(--border-color);
}

.key-actions button {
    flex: 1 1 auto;
    min-width: 80px;
    padding: 8px 12px;
    font-size: 0.9rem;
}

.key-meta {
    font-size: 0.9rem;
    color: #888; /* Consistent for both modes, or use var(--text-color) with opacity */
    margin-bottom: 5px;
}

.key-management-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 20px;
}

.key-management-buttons button {
    flex: 1 1 auto;
    min-width: 100px;
}

.btn-zero {
    background-color: #cc3300;
    color: white;
    margin-top: 20px;
    width: 100%;
    font-weight: bold;
    border: 1px solid #aa2200;
}
.btn-zero:hover {
    background-color: #ff3300;
}
/* body.dark-mode .btn-zero is already defined */


.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent black */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    display: none; /* Hidden by default */
}

.spinner {
    width: 50px;
    height: 50px;
    border: 5px solid rgba(255, 255, 255, 0.3); /* Default for light mode, or when overlay is on light bg */
    border-radius: 50%;
    border-top-color: var(--accent-color); /* Uses current accent color */
    animation: spin 1s linear infinite; /* Simplified animation */
}
/* body.dark-mode .spinner is already defined */

@keyframes spin {
    to { transform: rotate(360deg); }
}
/* @keyframes color-shift { REMOVED ... } */


.password-strength {
    height: 5px;
    border-radius: 5px;
    margin-top: 5px;
    transition: all 0.3s;
}
.password-strength.weak { background-color: var(--security-low); width: 30%; }
.password-strength.medium { background-color: var(--security-medium); width: 60%; }
.password-strength.strong { background-color: var(--security-high); width: 100%; }

.password-feedback {
    font-size: 0.8rem;
    margin-top: 5px;
    color: var(--text-color); /* Ensure it's readable in dark mode */
    opacity: 0.9;
}

.security-badge {
    display: inline-flex;
    align-items: center;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    margin-left: 8px;
    font-weight: bold;
}
.security-badge.high { background-color: rgba(0, 204, 102, 0.1); color: var(--security-high); border: 1px solid var(--security-high); }
.security-badge.medium { background-color: rgba(240, 173, 78, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); }
.security-badge.low { background-color: rgba(204, 51, 0, 0.1); color: var(--security-low); border: 1px solid var(--security-low); }
/* body.dark-mode .security-badge (static) is already defined */

/* @keyframes securityPulse { REMOVED ... } */


.key-pair-badge {
    display: inline-flex;
    align-items: center;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: bold;
    margin-top: 5px;
}
.key-pair-badge.full { background-color: rgba(0, 204, 102, 0.1); color: var(--security-high); border: 1px solid var(--security-high); }
.key-pair-badge.private { background-color: rgba(204, 51, 0, 0.1); color: var(--security-low); border: 1px solid var(--security-low); }
.key-pair-badge.public { background-color: rgba(240, 173, 78, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); }
/* body.dark-mode .key-pair-badge (static) is already defined */


.private-key-btn { /* Base style for light mode */
    border: 1px solid var(--error-color) !important;
    color: var(--error-color) !important;
}
.private-key-btn:hover {
    background-color: rgba(204, 51, 0, 0.1) !important;
}
/* body.dark-mode .private-key-btn is already defined */


.config-toggle {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}
.config-toggle label {
    display: inline;
    margin-bottom: 0;
}

.switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 24px;
}
.switch input { opacity: 0; width: 0; height: 0; }

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc; /* Light mode off */
    transition: .4s;
    border-radius: 24px;
}
.slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: white; /* Light mode handle */
    transition: .4s;
    border-radius: 50%;
}
input:checked + .slider { background-color: var(--accent-color); } /* Uses current accent */
input:focus + .slider { box-shadow: 0 0 1px var(--accent-color); }
input:checked + .slider:before { transform: translateX(26px); }
/* body.dark-mode .slider styles are already defined */


.security-info {
    font-size: 0.9rem;
    padding: 10px;
    border-left: 3px solid var(--accent-color);
    background-color: rgba(0,0,0, 0.03); /* Very light grey for light mode */
    margin-bottom: 15px;
}
body.dark-mode .security-info {
    background-color: rgba(57, 255, 20, 0.05); /* Subtle green background */
    border-left-color: var(--accent-color); /* Green left border */
    color: var(--text-color);
}

.key-expiry {
    font-size: 0.8rem;
    color: var(--warning-color); /* Uses warning color */
    margin-top: 5px;
    font-style: italic;
}

#inactivityModal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 1001;
    justify-content: center;
    align-items: center;
}
.modal-content { /* Base styles for modal, dark mode overrides parts of this */
    background-color: var(--card-bg);
    padding: 20px;
    border-radius: 12px;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3); /* Light mode shadow */
    width: 90%; /* Added for responsiveness */
    position: relative; /* Added for positioning context if needed */
}
/* body.dark-mode .modal-content is already defined */

.timer {
    font-size: 2rem;
    margin: 20px 0;
    color: var(--warning-color);
}

#settings { display: none; } /* Base, active state is .tab-content.active */

.settings-section { margin-bottom: 20px; }
.settings-section h3 {
    margin-top: 0;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 5px;
}

.file-info {
    margin-top: 10px;
    font-size: 0.9rem;
    background-color: var(--input-bg);
    padding: 8px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.file-info-name { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.file-icon { margin-right: 8px; font-size: 1.2rem; }
.remove-file { cursor: pointer; color: var(--error-color); padding: 2px 6px; border-radius: 4px; margin-left: 8px; }
.remove-file:hover { background-color: rgba(204, 51, 0, 0.1); } /* Light mode hover */
body.dark-mode .remove-file:hover { background-color: rgba(255, 49, 49, 0.2); }


/* Password Modal Styles */
.modal { /* General modal styling, used by passwordModal too */
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 1001;
    justify-content: center;
    align-items: center;
}

.btn-primary { /* Base btn-primary, dark mode overrides */
    background-color: var(--accent-color);
    color: var(--button-text);
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.1s;
}
.btn-primary:hover {
    background-color: var(--button-hover);
}
/* body.dark-mode .btn-primary is already defined */


/* Mobile Optimization */
@media (max-width: 600px) {
    .container { padding: 15px; }
    .card { padding: 15px; }
    .app-title { font-size: 1.5rem; }
    .btn-group { flex-direction: column; }
    /* button { width: 100%; } This was too broad, specific buttons might need this */
    .btn-group button { width: 100%; } /* Apply to buttons within btn-group */
    .key-actions button { width: 100%; margin-bottom: 5px; }


    .tab-btn { padding: 10px 10px; font-size: 0.9rem; }
    .key-actions { flex-direction: column; }
}

@media (max-width: 767px) {
    .keys-container { flex-direction: column; }
    .key-form, .keys-list-container { width: 100%; }
}

/* Medium screens (tablets and small desktops) */
@media (min-width: 768px) {
    .container { max-width: 750px; }
    .app-title { font-size: 2rem; }
    .card { padding: 25px; }
    #encryptedOutput, #decryptedOutput { min-height: 150px; font-size: 1.05rem; }
    .keys-container { flex-direction: row; align-items: flex-start; }
    .key-form { width: 40%; position: sticky; top: 20px; }
    .keys-list-container { width: 60%; }
    .key-item h3 { font-size: 1.1rem; margin-top: 0; margin-bottom: 10px; word-break: break-word; }
}

/* Large screens (desktops and large tablets in landscape) */
@media (min-width: 1024px) {
    .container { max-width: 900px; }
    #encryptedOutput, #decryptedOutput { min-height: 180px; font-size: 1.1rem; padding: 18px; }
    #keys .card { display: flex; flex-wrap: wrap; gap: 20px; }
    #keys .card > h2, #keys .card > .security-info { width: 100%; }
    #keys .card > .form-group, #keys .card > button#generateKeyBtn { width: calc(40% - 10px); }
    #keys .card > div:has(#keysList) { width: calc(60% - 10px); margin-top: 0; }
    #keys .card > div:nth-last-child(3) { /* Fallback */ width: calc(60% - 10px); margin-top: 0; }
    #keys .card > .btn-group, #keys .card > div:has(#zeroKeysBtn) { width: 100%; }
    #encrypt .card, #decrypt .card { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    #encrypt .card > .form-group:first-child,
    #decrypt .card > .form-group:first-child,
    #encrypt .card > .form-group:has(#encryptedOutput),
    #decrypt .card > .form-group:has(#decryptedOutput),
    #encrypt .card > .form-group:nth-child(3), /* Fallback */
    #decrypt .card > .form-group:nth-child(3) /* Fallback */
    { grid-column: 1 / span 2; }
    #encrypt .card > button, #decrypt .card > button { grid-column: 1 / span 2; }
    #encrypt .card > .btn-group, #decrypt .card > .btn-group { grid-column: 1 / span 2; }
    #encrypt .card > #encryptStatus, #decrypt .card > #decryptStatus { grid-column: 1 / span 2; }
}

@media (min-width: 1200px) {
    .container { max-width: 1140px; }
    .keys-grid { grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); }
}

/* Extra large screens */
@media (min-width: 1440px) {
    .container { max-width: 1200px; }
    #encryptedOutput, #decryptedOutput { min-height: 220px; font-size: 1.15rem; padding: 20px; }
    #settings .card { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
    #settings .card > h2 { grid-column: 1 / span 2; }
    #settings .card > .btn-group { grid-column: 1 / span 2; justify-content: center; }
    #settings .card > #settingsStatus { grid-column: 1 / span 2; }
    #keysList { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }

    @media (min-width: 1800px) {
        #encrypt .card, #decrypt .card { grid-template-columns: 1fr 1fr 1fr; }
        #encrypt .card > .form-group:first-child,
        #decrypt .card > .form-group:first-child,
        #encrypt .card > .form-group:has(#encryptedOutput),
        #decrypt .card > .form-group:has(#decryptedOutput),
        #encrypt .card > .form-group:nth-child(3), /* Fallback */
        #decrypt .card > .form-group:nth-child(3), /* Fallback */
        #encrypt .card > button, #decrypt .card > button,
        #encrypt .card > .btn-group, #decrypt .card > .btn-group,
        #encrypt .card > #encryptStatus, #decrypt .card > #decryptStatus
        { grid-column: 1 / span 3; }
    }
}

/* Ensure button groups stack properly on mobile but stay horizontal on larger screens */
/* This is already handled well by the (max-width: 600px) rule for .btn-group */
@media (min-width: 601px) {
    .btn-group { flex-direction: row; }
    .btn-group button { flex: 1; }
}


/* Print styles */
@media print {
    body { background-color: white; color: black; }
    body.dark-mode { /* Override dark mode for print */
        --bg-color: #ffffff;
        --text-color: #000000;
        --card-bg: #ffffff;
        --border-color: #dddddd;
        --input-bg: #ffffff;
        --output-bg: #f8f8f8;
        --output-text: #222222;
    }
    body.dark-mode .app-title { /* Ensure title is visible when printing from dark mode */
        background: none;
        color: #000000;
        text-shadow: none;
    }
    body.dark-mode .tab-btn.active {
        color: #000000; /* Black text for active tab in print */
        background: none;
    }
    body.dark-mode .security-info {
        background-color: #f0f0f0;
        border-left-color: #ccc;
        color: #000;
    }


    .card { box-shadow: none; border: 1px solid #ddd; }
    .btn-group, button, .tabs, .app-subtitle, .key-actions, .key-management-buttons, .config-toggle, #installContainer, .remove-file { display: none !important; }
    .container { max-width: 100%; padding: 0; }
    #encryptedOutput, #decryptedOutput { border: 1px solid #ddd; background-color: white; color: black; min-height: auto; }
    .key-item { page-break-inside: avoid; }
    .keys-grid { grid-template-columns: 1fr !important; } /* Single column for printing keys */
}
    </style>
</head>
<body>
    <div class="container">
        <div class="app-header">
            <h1 class="app-title">LC5</h1>
            <div class="app-subtitle">by elkmire</div>
            <p>Secure MSG.FILE option</p>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" data-tab="encrypt">Encrypt</button>
            <button class="tab-btn" data-tab="decrypt">Decrypt</button>
            <button class="tab-btn" data-tab="keys">Key Management</button>
            <button class="tab-btn" data-tab="settings">Settings</button>
        </div>
        
        <div class="tab-content active" id="encrypt">
            <div class="card">
                <div class="form-group">
                    <label for="encryptMessage">To Encrypt</label>
                    <textarea id="encryptMessage" placeholder="Free-type here or load file for encryption..."></textarea>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <button id="encryptBrowseBtn" class="btn-secondary">Browse Files</button>
                        <button id="clearEncryptMessageBtn" class="btn-secondary">Clear</button>
                        <input type="file" id="encryptFileInput" style="display: none;">
                    </div>
                    <div id="encryptFileInfo" style="display: none;" class="file-info">
                        <span><span class="file-icon">ðŸ“„</span> <span id="encryptFileName" class="file-info-name"></span></span>
                        <span class="remove-file" id="removeEncryptFile">Ã—</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="encryptionKey">Encryption Key</label>
                    <select id="encryptionKey">
                        <option value="">Select a key...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="encryptObfKey">OBF Key</label>
                    <input type="text" id="encryptObfKey" placeholder="Optional*">
                </div>
                
                <div class="form-group" id="encryptionPasswordGroup" style="display: none;">
                    <label for="encryptionPassword">Key Password</label>
                    <input type="password" id="encryptionPassword" placeholder="Enter key password">
                </div>
                
                <button id="encryptBtn">Encrypt Data</button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="encryptedOutput">Encrypted Data</label>
                    <textarea id="encryptedOutput" readonly></textarea>
                </div>
                
                <div class="btn-group">
                    <button id="downloadEncryptedBtn" class="btn-secondary">Download Encrypted File</button>
                    <button id="copyEncryptedBtn" class="btn-secondary">Copy to Clipboard</button>
                    <button id="clearEncryptBtn" class="btn-secondary">Clear All</button>
                </div>
                
                <div id="encryptStatus" class="status"></div>
            </div>
        </div>
        
        <div class="tab-content" id="decrypt">
            <div class="card">
                <div class="form-group">
                    <label for="encryptedMessage">To Decrypt</label>
                    <textarea id="encryptedMessage" placeholder="Paste the encrypted data here or load encrypted data..."></textarea>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <button id="decryptBrowseBtn" class="btn-secondary">Browse Files</button>
                        <button id="clearEncryptedMessageBtn" class="btn-secondary">Clear</button>
                        <input type="file" id="decryptFileInput" style="display: none;">
                    </div>
                    <div id="decryptFileInfo" style="display: none;" class="file-info">
                        <span><span class="file-icon">ðŸ“„</span> <span id="decryptFileName" class="file-info-name"></span></span>
                        <span class="remove-file" id="removeDecryptFile">Ã—</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="decryptionKey">Decryption Key</label>
                    <select id="decryptionKey">
                        <option value="">Select a key...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="decryptObfKey">OBF Key</label>
                    <input type="text" id="decryptObfKey" placeholder="Optional*">
                </div>
                
                <div class="form-group" id="decryptionPasswordGroup" style="display: none;">
                    <label for="decryptionPassword">Key Password</label>
                    <input type="password" id="decryptionPassword" placeholder="Enter key password">
                </div>
                
                <button id="decryptBtn">Decrypt Data</button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="decryptedOutput">Decrypted Data</label>
                    <textarea id="decryptedOutput" readonly></textarea>
                </div>
                
                <div class="btn-group">
                    <button id="downloadDecryptedBtn" class="btn-secondary">Download Decrypted File</button>
                    <button id="copyDecryptedBtn" class="btn-secondary">Copy to Clipboard</button>
                    <button id="clearDecryptBtn" class="btn-secondary">Clear All</button>
                </div>
                
                <div id="decryptStatus" class="status"></div>
            </div>
        </div>
        
        <div class="tab-content" id="keys">
            <div class="card">
                <h2>Key Management</h2>
                
                <div class="security-info">
                    <strong>Security Note:</strong> All keys are stored locally in your browser's protected storage and never sent to any server.
                </div>
                
                <div class="keys-container">
                    <div class="key-form">
                        <div class="form-group">
                            <label for="keyName">Key Name</label>
                            <input type="text" id="keyName" placeholder="e.g., enter crypto name">
                        </div>
                        
                        <div class="form-group">
                            <label for="keyType">Key Type</label>
                            <select id="keyType">
                                <option value="aes">AES-GCM (Symmetric) - 256 bits</option>
                                <option value="rsa">RSA-OAEP (Asymmetric) - 2048 bits</option>
                                <option value="rsa-4096">RSA-OAEP (Asymmetric) - 4096 bits</option>
                                <option value="ecc">ECC (Asymmetric) - P-256</option>
                                <option value="ecc-p384">ECC (Asymmetric) - P-384</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="keyExpiry">Key Expiration (Optional)</label>
                            <select id="keyExpiry">
                                <option value="">Never (Not Recommended)</option>
                                <option value="30">30 Days</option>
                                <option value="90">90 Days</option>
                                <option value="180">180 Days</option>
                                <option value="365">1 Year</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="keyPasswordGroup">
                            <label for="keyPassword">Key Password (Recommended)</label>
                            <input type="password" id="keyPassword" placeholder="Enter optional password">
                            <div id="passwordStrength" class="password-strength"></div>
                            <div id="passwordFeedback" class="password-feedback"></div>
                        </div>
                        
                        <div class="form-group" id="confirmKeyPasswordGroup">
                            <label for="confirmKeyPassword">Confirm Password</label>
                            <input type="password" id="confirmKeyPassword" placeholder="Confirm your password">
                        </div>
                        
                        <button id="generateKeyBtn">Generate New Key</button>
                        
                        <div class="key-management-buttons">
                            <button id="importKeyBtn" class="btn-secondary">Import Key</button>
                            <button id="exportAllKeysBtn" class="btn-secondary">Export State</button>
                            <button id="importStateBtn" class="btn-secondary">Import State</button>
                        </div>
        
                        <div style="text-align: center; margin-top: 20px;">
                            <button id="zeroKeysBtn" class="btn-zero">ZERO ALL KEYS</button>
                        </div>
                        
                        <div id="keyStatus" class="status"></div>
                    </div>
                    
                    <div class="keys-list-container">
                        <h3>Your Keys</h3>
                        <div id="keysList" class="keys-grid">
                            <!-- Keys will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="settings">
            <div class="card">
                <h2>Security Settings</h2>
<p> (Must SAVE for changes to take effect) <p>
                
                <div class="settings-section">
                    <h3>Storage Options</h3>
                    
                    <div class="config-toggle">
                        <label for="useIndexedDB">Use IndexedDB for key storage (more secure)</label>
                        <label class="switch">
                            <input type="checkbox" id="useIndexedDB" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="config-toggle">
                        <label for="sessionOnly">Session-only mode (keys aren't saved when browser closes)</label>
                        <label class="switch">
                            <input type="checkbox" id="sessionOnly">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>Security Parameters</h3>
                    
                    <div class="config-toggle">
                        <label for="enforcePwdProtection">Enforce password protection for keys</label>
                        <label class="switch">
                            <input type="checkbox" id="enforcePwdProtection">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="config-toggle">
                        <label for="enforceKeyExpiry">Enforce key expiration</label>
                        <label class="switch">
                            <input type="checkbox" id="enforceKeyExpiry">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label for="pbkdf2Iterations">PBKDF2 Iterations (higher = more secure but slower)</label>
                        <select id="pbkdf2Iterations">
                            <option value="100000">100,000 (Default)</option>
                            <option value="200000">200,000</option>
                            <option value="300000">300,000</option>
                            <option value="500000">500,000</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Appearance</h3>
                    
                    <div class="config-toggle">
                        <label for="darkMode">Dark Mode</label>
                        <label class="switch">
                            <input type="checkbox" id="darkMode">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Install App</h3>
                    <p>Installs PWA (must be Chromium-based browser or Safari for IOS)</p>
                    <div id="installContainer">
                        <button id="installBtn" class="btn-secondary">Install Lemonade App</button>
                        <p class="install-note" style="margin-top: 8px; font-size: 0.85rem; color: #888;">
                            (Button will be enabled when installation is available)
                        </p>
                    </div>
                    <div id="installStatus" class="status"></div>
                </div>

                <div class="btn-group">
                    <button id="saveSettingsBtn">Save Settings</button>
                    <button id="resetSettingsBtn" class="btn-secondary">Reset to Defaults</button>
                </div>
                
                <div id="settingsStatus" class="status"></div>
            </div>
        </div>
    </div>
    
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>
    
    <script>
const _0x11a23a=_0x4803;(function(_0x331bad,_0x4c509b){const _0xd349ee=_0x4803,_0x57c9e2=_0x331bad();while(!![]){try{const _0x4b3718=-parseInt(_0xd349ee(0x133))/0x1*(-parseInt(_0xd349ee(0x134))/0x2)+parseInt(_0xd349ee(0x16c))/0x3+parseInt(_0xd349ee(0x14c))/0x4+parseInt(_0xd349ee(0x19c))/0x5+parseInt(_0xd349ee(0x1f1))/0x6+parseInt(_0xd349ee(0x195))/0x7*(parseInt(_0xd349ee(0x1f5))/0x8)+parseInt(_0xd349ee(0x164))/0x9*(-parseInt(_0xd349ee(0x21b))/0xa);if(_0x4b3718===_0x4c509b)break;else _0x57c9e2['push'](_0x57c9e2['shift']());}catch(_0x1def67){_0x57c9e2['push'](_0x57c9e2['shift']());}}}(_0x54a4,0x7de50));const PBKDF2_CONFIG={'ITERATIONS':0x186a0,'HASH':'SHA-256'},AES_CONFIG={'KEY_LENGTH':0x100,'MODE':_0x11a23a(0x158),'IV_LENGTH':0xc,'TAG_LENGTH':0x80},RSA_CONFIG={'KEY_SIZE':0x800,'KEY_SIZE_4096':0x1000,'ALGORITHM':_0x11a23a(0xd9),'HASH':_0x11a23a(0x155)},ECC_CONFIG={'CURVE':_0x11a23a(0x17b),'CURVE_P384':_0x11a23a(0x1aa),'ALGORITHM':_0x11a23a(0x18d),'KEY_DERIVATION':_0x11a23a(0x204),'KDF_HASH':_0x11a23a(0x155),'ENC_ALGORITHM':_0x11a23a(0x158)},SECURE_DELIMITER=_0x11a23a(0x244),DB_NAME=_0x11a23a(0x108),DB_VERSION=0x1,KEYS_STORE=_0x11a23a(0x167),SETTINGS_STORE=_0x11a23a(0x114),DEFAULT_SETTINGS={'useIndexedDB':!![],'sessionOnly':![],'enforcePwdProtection':![],'enforceKeyExpiry':![],'pbkdf2Iterations':0x186a0};let db=null,keys=[],appSettings={...DEFAULT_SETTINGS};const tabBtns=document[_0x11a23a(0x159)](_0x11a23a(0x1d8)),tabContents=document[_0x11a23a(0x159)](_0x11a23a(0x8a)),encryptionKeySelect=document['getElementById']('encryptionKey'),decryptionKeySelect=document[_0x11a23a(0x123)](_0x11a23a(0x18f)),keysList=document[_0x11a23a(0x123)](_0x11a23a(0xc3)),loadingOverlay=document[_0x11a23a(0x123)](_0x11a23a(0x116)),inactivityModal=document['getElementById']('inactivityModal'),timeoutTimer=document[_0x11a23a(0x123)](_0x11a23a(0x1c9)),safeMemory={'sensitiveData':new WeakMap(),'store':function(_0x432ae3){const _0x43c88a=_0x11a23a,_0x4b172f={'id':crypto[_0x43c88a(0xa8)]()};return this[_0x43c88a(0x243)][_0x43c88a(0xd6)](_0x4b172f,_0x432ae3),_0x4b172f;},'retrieve':function(_0x18b655,_0x2c9c40=![]){const _0x26aac9=_0x11a23a;if(!this['sensitiveData'][_0x26aac9(0xba)](_0x18b655))return null;const _0x17ada4=this[_0x26aac9(0x243)]['get'](_0x18b655);return _0x2c9c40&&this['sensitiveData'][_0x26aac9(0x107)](_0x18b655),_0x17ada4;},'delete':function(_0x5178ab){const _0x4dcdae=_0x11a23a;if(this[_0x4dcdae(0x243)]['has'](_0x5178ab))return this[_0x4dcdae(0x243)][_0x4dcdae(0x107)](_0x5178ab),!![];return![];},'clearAll':function(){const _0x2ed48d=_0x11a23a;this['sensitiveData']=new WeakMap();if(typeof window['gc']===_0x2ed48d(0x1b8))try{window['gc']();}catch(_0x2af701){console[_0x2ed48d(0x104)](_0x2ed48d(0x11d));}}},validator={'sanitizeHTML':function(_0x3389ba){const _0x420f10=_0x11a23a,_0x45c0b2=document[_0x420f10(0x187)](_0x420f10(0x25d));return _0x45c0b2['textContent']=_0x3389ba,_0x45c0b2[_0x420f10(0x121)];},'validateInput':function(_0xb65813,_0x5ecf76=![]){const _0x4517e8=_0x11a23a;if(_0xb65813===null||_0xb65813===undefined)return'';const _0x282acd=String(_0xb65813);return _0x5ecf76?_0x282acd:this[_0x4517e8(0x206)](_0x282acd);},'isValidKeyName':function(_0x1b8684){const _0x5263eb=_0x11a23a;return/^[A-Za-z0-9 ._-]{1,50}$/[_0x5263eb(0x175)](_0x1b8684);},'isValidEncryptedMessage':function(_0x48608b){const _0x2d74aa=_0x11a23a;return/^--LM--\s*[A-Za-z0-9+/=]+\s*--EM--$/s[_0x2d74aa(0x175)](_0x48608b);},'measurePasswordStrength':function(_0x4942a0){const _0x142571=_0x11a23a;let _0x41dfc7=0x0;if(!_0x4942a0)return{'score':0x0,'feedback':'Password\x20is\x20required'};const _0x4b5ecc=_0x4942a0[_0x142571(0xdf)];_0x41dfc7+=Math[_0x142571(0x1ee)](0x5,Math[_0x142571(0x88)](_0x4b5ecc/0x4));if(/[a-z]/[_0x142571(0x175)](_0x4942a0))_0x41dfc7+=0x1;if(/[A-Z]/[_0x142571(0x175)](_0x4942a0))_0x41dfc7+=0x1;if(/[0-9]/[_0x142571(0x175)](_0x4942a0))_0x41dfc7+=0x1;if(/[^A-Za-z0-9]/[_0x142571(0x175)](_0x4942a0))_0x41dfc7+=0x2;if(/^[a-zA-Z]+$/[_0x142571(0x175)](_0x4942a0))_0x41dfc7-=0x1;if(/^[0-9]+$/[_0x142571(0x175)](_0x4942a0))_0x41dfc7-=0x1;if(/(.)\1{2,}/['test'](_0x4942a0))_0x41dfc7-=0x1;let _0x1a576c,_0x2c4955;if(_0x41dfc7<0x4)_0x1a576c=_0x142571(0x149),_0x2c4955='Weak\x20-\x20Use\x20a\x20longer\x20password\x20with\x20numbers\x20and\x20special\x20characters';else _0x41dfc7<0x8?(_0x1a576c='medium',_0x2c4955='Medium\x20-\x20Add\x20more\x20variety\x20or\x20length\x20for\x20better\x20security'):(_0x1a576c=_0x142571(0x22f),_0x2c4955=_0x142571(0x19a));return{'score':_0x41dfc7,'strengthCategory':_0x1a576c,'feedback':_0x2c4955};}},escapeRegex=_0x54f3f3=>{const _0x5c913a=_0x11a23a;if(typeof _0x54f3f3!==_0x5c913a(0x1ea))return'';return _0x54f3f3[_0x5c913a(0x1be)](/[.*+?^${}()|[\]\\]/g,_0x5c913a(0xa1));};document[_0x11a23a(0x92)](_0x11a23a(0x1df),async()=>{const _0x32272b=_0x11a23a;document[_0x32272b(0x159)](_0x32272b(0x1d8))[_0x32272b(0xde)](_0x263a30=>{const _0x547308=_0x32272b;_0x263a30['addEventListener'](_0x547308(0x145),_0x121349=>{const _0x362ce0=_0x547308;_0x121349[_0x362ce0(0x1fb)]();const _0xb646c4=_0x263a30[_0x362ce0(0x1ae)]('data-tab');console[_0x362ce0(0x104)](_0x362ce0(0x208),_0xb646c4),switchTab(_0xb646c4);});}),document['getElementById'](_0x32272b(0x24d))['addEventListener'](_0x32272b(0x258),toggleDarkMode);const _0x1f4367=localStorage[_0x32272b(0xeb)]('LemonadeDarkMode');_0x1f4367===_0x32272b(0x101)&&(document[_0x32272b(0x123)](_0x32272b(0x24d))[_0x32272b(0x24c)]=!![],document['body'][_0x32272b(0x210)]['add'](_0x32272b(0x8d))),document[_0x32272b(0x123)](_0x32272b(0x85))[_0x32272b(0x92)]('click',()=>{clearEncryptFile();}),document[_0x32272b(0x123)](_0x32272b(0x215))['addEventListener'](_0x32272b(0x145),()=>{clearDecryptFile();}),await initDatabase(),await loadSettings(),initSettingsUI(),await loadKeys(),document[_0x32272b(0x123)](_0x32272b(0xc4))[_0x32272b(0x92)](_0x32272b(0x91),updatePasswordStrength),document['getElementById'](_0x32272b(0xd7))[_0x32272b(0x92)]('click',encryptMessage),document[_0x32272b(0x123)](_0x32272b(0x140))[_0x32272b(0x92)](_0x32272b(0x145),decryptMessage),document['getElementById'](_0x32272b(0x144))[_0x32272b(0x92)]('click',generateKey),document[_0x32272b(0x123)](_0x32272b(0x1c3))[_0x32272b(0x92)]('click',()=>copyToClipboard(_0x32272b(0x16b),'encryptStatus')),document[_0x32272b(0x123)]('copyDecryptedBtn')[_0x32272b(0x92)](_0x32272b(0x145),()=>copyToClipboard('decryptedOutput',_0x32272b(0xbf))),document['getElementById'](_0x32272b(0xc0))['addEventListener'](_0x32272b(0x145),()=>{const _0xbf3dc8=_0x32272b;document[_0xbf3dc8(0x123)](_0xbf3dc8(0x213))[_0xbf3dc8(0x1f4)]='',document['getElementById']('encryptedOutput')[_0xbf3dc8(0x1f4)]='',document[_0xbf3dc8(0x123)](_0xbf3dc8(0x239))['className']=_0xbf3dc8(0x139),document[_0xbf3dc8(0x123)](_0xbf3dc8(0x239))[_0xbf3dc8(0x24a)]='',clearEncryptFile();}),document[_0x32272b(0x123)](_0x32272b(0x90))['addEventListener']('click',()=>{const _0x4985f4=_0x32272b;document[_0x4985f4(0x123)]('encryptedMessage')[_0x4985f4(0x1f4)]='',document[_0x4985f4(0x123)](_0x4985f4(0x1fe))[_0x4985f4(0x1f4)]='',document[_0x4985f4(0x123)](_0x4985f4(0xbf))[_0x4985f4(0xc9)]=_0x4985f4(0x139),document[_0x4985f4(0x123)](_0x4985f4(0xbf))[_0x4985f4(0x24a)]='',clearDecryptFile(),window[_0x4985f4(0xad)]=null;}),document[_0x32272b(0x123)](_0x32272b(0x96))[_0x32272b(0x92)](_0x32272b(0x145),importKey),document[_0x32272b(0x123)](_0x32272b(0x9b))[_0x32272b(0x92)](_0x32272b(0x145),exportAllKeys),document[_0x32272b(0x123)](_0x32272b(0x169))[_0x32272b(0x92)](_0x32272b(0x145),importState),document[_0x32272b(0x123)]('saveSettingsBtn')[_0x32272b(0x92)]('click',saveSettings),document[_0x32272b(0x123)]('resetSettingsBtn')['addEventListener'](_0x32272b(0x145),resetSettings),document['getElementById'](_0x32272b(0x1e4))['addEventListener']('click',zeroAllKeys),encryptionKeySelect['addEventListener']('change',handleEncryptionKeyChange),decryptionKeySelect[_0x32272b(0x92)](_0x32272b(0x258),handleDecryptionKeyChange);});async function initDatabase(){const _0x19e495=_0x11a23a;if(!window[_0x19e495(0x1d9)]){showStatus('keyStatus',_0x19e495(0xae),_0x19e495(0x1bb)),appSettings[_0x19e495(0x13e)]=![];return;}return new Promise((_0x418357,_0x33bac8)=>{const _0x2f3812=_0x19e495,_0x5836a7=indexedDB['open'](DB_NAME,DB_VERSION);_0x5836a7[_0x2f3812(0x176)]=function(_0x49ea67){const _0x148ad0=_0x2f3812,_0x5ecefc=_0x49ea67[_0x148ad0(0x250)][_0x148ad0(0x20e)];!_0x5ecefc[_0x148ad0(0xb7)][_0x148ad0(0x1b2)](KEYS_STORE)&&_0x5ecefc[_0x148ad0(0x8e)](KEYS_STORE,{'keyPath':'id'}),!_0x5ecefc[_0x148ad0(0xb7)][_0x148ad0(0x1b2)](SETTINGS_STORE)&&_0x5ecefc[_0x148ad0(0x8e)](SETTINGS_STORE,{'keyPath':'id'});},_0x5836a7[_0x2f3812(0x23a)]=function(_0x5ce83f){const _0x49a8e1=_0x2f3812;db=_0x5ce83f[_0x49a8e1(0x250)][_0x49a8e1(0x20e)],console[_0x49a8e1(0x104)]('Database\x20initialized\x20successfully'),_0x418357();},_0x5836a7[_0x2f3812(0x24f)]=function(_0x4d62ef){const _0x2cb4ae=_0x2f3812;console[_0x2cb4ae(0x240)](_0x2cb4ae(0x241),_0x4d62ef[_0x2cb4ae(0x250)][_0x2cb4ae(0x240)]),showStatus(_0x2cb4ae(0x192),_0x2cb4ae(0x161),_0x2cb4ae(0x1bb)),appSettings[_0x2cb4ae(0x13e)]=![],_0x418357();};});}function switchTab(_0x198d68){const _0x3b16b6=_0x11a23a;console['log'](_0x3b16b6(0x21c),_0x198d68),tabBtns[_0x3b16b6(0xde)](_0x2fc886=>{const _0x363545=_0x3b16b6;_0x2fc886[_0x363545(0x1ae)](_0x363545(0x153))===_0x198d68?_0x2fc886['classList'][_0x363545(0x20b)]('active'):_0x2fc886[_0x363545(0x210)][_0x363545(0x242)](_0x363545(0x1e0));}),document[_0x3b16b6(0x123)]('encryptMessage')['value']='',document[_0x3b16b6(0x123)](_0x3b16b6(0x16b))[_0x3b16b6(0x1f4)]='',document[_0x3b16b6(0x123)](_0x3b16b6(0x239))[_0x3b16b6(0xc9)]=_0x3b16b6(0x139),document['getElementById'](_0x3b16b6(0x239))[_0x3b16b6(0x24a)]='',document[_0x3b16b6(0x123)](_0x3b16b6(0x9a))['value']='',document['getElementById'](_0x3b16b6(0x15d))[_0x3b16b6(0x1f4)]='',document[_0x3b16b6(0x123)](_0x3b16b6(0xb2))[_0x3b16b6(0x191)][_0x3b16b6(0x94)]=_0x3b16b6(0xab),clearEncryptFile(),document[_0x3b16b6(0x123)]('encryptedMessage')[_0x3b16b6(0x1f4)]='',document[_0x3b16b6(0x123)]('decryptedOutput')['value']='',document[_0x3b16b6(0x123)](_0x3b16b6(0xbf))[_0x3b16b6(0xc9)]=_0x3b16b6(0x139),document[_0x3b16b6(0x123)]('decryptStatus')[_0x3b16b6(0x24a)]='',document[_0x3b16b6(0x123)](_0x3b16b6(0x18f))[_0x3b16b6(0x1f4)]='',document[_0x3b16b6(0x123)](_0x3b16b6(0xf6))['value']='',document['getElementById']('decryptionPasswordGroup')[_0x3b16b6(0x191)][_0x3b16b6(0x94)]=_0x3b16b6(0xab),clearDecryptFile(),window[_0x3b16b6(0xad)]=null,document[_0x3b16b6(0x123)](_0x3b16b6(0x115))['classList'][_0x3b16b6(0x242)]('active'),document[_0x3b16b6(0x123)]('decrypt')[_0x3b16b6(0x210)][_0x3b16b6(0x242)]('active'),document[_0x3b16b6(0x123)](_0x3b16b6(0x167))[_0x3b16b6(0x210)][_0x3b16b6(0x242)](_0x3b16b6(0x1e0)),document[_0x3b16b6(0x123)](_0x3b16b6(0x114))[_0x3b16b6(0x210)]['remove']('active'),document[_0x3b16b6(0x123)](_0x198d68)[_0x3b16b6(0x210)][_0x3b16b6(0x20b)](_0x3b16b6(0x1e0));}function setLoading(_0x3695b1){const _0x221cdb=_0x11a23a;loadingOverlay[_0x221cdb(0x191)][_0x221cdb(0x94)]=_0x3695b1?_0x221cdb(0xbb):_0x221cdb(0xab);}async function loadSettings(){const _0x29c636=_0x11a23a;if(appSettings['useIndexedDB']&&db)try{const _0xf56550=await getFromDatabase(SETTINGS_STORE,_0x29c636(0x227));_0xf56550&&(appSettings={...DEFAULT_SETTINGS,..._0xf56550});}catch(_0xade47f){console[_0x29c636(0x240)]('Error\x20loading\x20settings\x20from\x20database:',_0xade47f);try{const _0x2a4c18=localStorage[_0x29c636(0xeb)](_0x29c636(0x1f9));_0x2a4c18&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x29c636(0x1ec)](_0x2a4c18)});}catch(_0x2f438d){console[_0x29c636(0x240)]('Error\x20loading\x20settings\x20from\x20localStorage:',_0x2f438d);}}else try{const _0x24560b=localStorage['getItem'](_0x29c636(0x1f9));_0x24560b&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x29c636(0x1ec)](_0x24560b)});}catch(_0x238ffc){console[_0x29c636(0x240)]('Error\x20loading\x20settings\x20from\x20localStorage:',_0x238ffc);}return PBKDF2_CONFIG[_0x29c636(0x231)]=appSettings[_0x29c636(0x10f)],appSettings;}function initSettingsUI(){const _0x21c733=_0x11a23a;document[_0x21c733(0x123)](_0x21c733(0x13e))['checked']=appSettings[_0x21c733(0x13e)],document['getElementById'](_0x21c733(0xb0))[_0x21c733(0x24c)]=appSettings[_0x21c733(0xb0)],document[_0x21c733(0x123)]('enforcePwdProtection')[_0x21c733(0x24c)]=appSettings['enforcePwdProtection'],document[_0x21c733(0x123)](_0x21c733(0x1ad))[_0x21c733(0x24c)]=appSettings[_0x21c733(0x1ad)],document[_0x21c733(0x123)](_0x21c733(0x10f))[_0x21c733(0x1f4)]=appSettings[_0x21c733(0x10f)];}async function saveSettings(){const _0x3a5726=_0x11a23a;try{appSettings[_0x3a5726(0x13e)]=document['getElementById'](_0x3a5726(0x13e))[_0x3a5726(0x24c)],appSettings[_0x3a5726(0xb0)]=document[_0x3a5726(0x123)]('sessionOnly')[_0x3a5726(0x24c)],appSettings[_0x3a5726(0x1f6)]=document[_0x3a5726(0x123)](_0x3a5726(0x1f6))[_0x3a5726(0x24c)],appSettings[_0x3a5726(0x1ad)]=document[_0x3a5726(0x123)](_0x3a5726(0x1ad))[_0x3a5726(0x24c)],appSettings['pbkdf2Iterations']=parseInt(document[_0x3a5726(0x123)](_0x3a5726(0x10f))[_0x3a5726(0x1f4)]),PBKDF2_CONFIG[_0x3a5726(0x231)]=appSettings[_0x3a5726(0x10f)],appSettings[_0x3a5726(0x13e)]&&db?await saveToDatabase(SETTINGS_STORE,{'id':_0x3a5726(0x227),...appSettings}):localStorage['setItem']('LemonadeSettings',JSON[_0x3a5726(0x132)](appSettings)),showStatus('settingsStatus',_0x3a5726(0x249),_0x3a5726(0x23d));}catch(_0x5e65ab){console[_0x3a5726(0x240)](_0x3a5726(0x141),_0x5e65ab),showStatus('settingsStatus',_0x3a5726(0x211)+_0x5e65ab[_0x3a5726(0xaa)],_0x3a5726(0x240));}}function resetSettings(){const _0x537a57=_0x11a23a,_0x2328ff=confirm(_0x537a57(0x253));if(!_0x2328ff)return;appSettings={...DEFAULT_SETTINGS},initSettingsUI(),saveSettings();}function updatePasswordStrength(){const _0x400059=_0x11a23a,_0x4ea4ff=document[_0x400059(0x123)]('keyPassword')['value'],_0x240469=validator[_0x400059(0x226)](_0x4ea4ff),_0x464317=document[_0x400059(0x123)](_0x400059(0x235)),_0x48b010=document[_0x400059(0x123)](_0x400059(0x224));_0x464317['className']=_0x400059(0x25b),_0x4ea4ff?(_0x464317[_0x400059(0x210)]['add'](_0x240469[_0x400059(0x18a)]),_0x48b010[_0x400059(0x24a)]=_0x240469['feedback']):_0x48b010['textContent']='';}async function loadKeys(){const _0x695fb9=_0x11a23a;try{keys=[];if(appSettings[_0x695fb9(0x13e)]&&db){const _0xc597ec=await getAllFromDatabase(KEYS_STORE);_0xc597ec&&_0xc597ec[_0x695fb9(0xdf)]>0x0&&(keys=_0xc597ec);}else{const _0x3c6554=localStorage[_0x695fb9(0xeb)](_0x695fb9(0x25e));_0x3c6554&&(keys=JSON['parse'](_0x3c6554));}checkExpiredKeys(),updateKeysList(),updateKeySelects();}catch(_0x1d8f47){console[_0x695fb9(0x240)](_0x695fb9(0x25c),_0x1d8f47),showStatus('keyStatus',_0x695fb9(0x1cc)+_0x1d8f47[_0x695fb9(0xaa)],_0x695fb9(0x240));}}async function saveKeys(){const _0x4897c2=_0x11a23a;try{if(appSettings[_0x4897c2(0xb0)])console[_0x4897c2(0x104)](_0x4897c2(0x1e6));else{if(appSettings[_0x4897c2(0x13e)]&&db){await clearDatabase(KEYS_STORE);for(const _0x2b9f9c of keys){await saveToDatabase(KEYS_STORE,_0x2b9f9c);}}else localStorage[_0x4897c2(0x103)]('LemonadeKeys',JSON[_0x4897c2(0x132)](keys));}updateKeysList(),updateKeySelects();}catch(_0x332704){console[_0x4897c2(0x240)]('Error\x20saving\x20keys:',_0x332704),showStatus('keyStatus',_0x4897c2(0x13f)+_0x332704[_0x4897c2(0xaa)],_0x4897c2(0x240));}}function checkExpiredKeys(){const _0x2513f7=_0x11a23a,_0x4c68ca=new Date(),_0x2453de=[];keys[_0x2513f7(0xde)](_0x341d7b=>{const _0x1aad3b=_0x2513f7;if(_0x341d7b['expiry']){const _0x5ecc19=new Date(_0x341d7b[_0x1aad3b(0x209)]);_0x5ecc19<_0x4c68ca&&_0x2453de[_0x1aad3b(0x112)](_0x341d7b['id']);}}),_0x2453de[_0x2513f7(0xdf)]>0x0&&(keys=keys[_0x2513f7(0x16d)](_0x457b7f=>!_0x2453de[_0x2513f7(0x15b)](_0x457b7f['id'])),saveKeys(),showStatus(_0x2513f7(0x192),_0x2453de[_0x2513f7(0xdf)]+_0x2513f7(0x1dc),'warning'));}async function generateKey(){const _0x27913d=_0x11a23a;try{setLoading(!![]);const _0x432fd8=document['getElementById'](_0x27913d(0x1c0))[_0x27913d(0x1f4)][_0x27913d(0x9f)](),_0x49e1f9=document[_0x27913d(0x123)](_0x27913d(0xcb))[_0x27913d(0x1f4)],_0x4367a1=document['getElementById'](_0x27913d(0xc4))[_0x27913d(0x1f4)],_0x3b40db=document['getElementById'](_0x27913d(0x125))['value'],_0x320998=document[_0x27913d(0x123)](_0x27913d(0x15f))['value'];if(!_0x432fd8){showStatus('keyStatus','Please\x20enter\x20a\x20key\x20name',_0x27913d(0x240));return;}if(!validator[_0x27913d(0xf1)](_0x432fd8)){showStatus(_0x27913d(0x192),_0x27913d(0x1dd),_0x27913d(0x240));return;}if(appSettings[_0x27913d(0x1f6)]&&!_0x4367a1){showStatus('keyStatus',_0x27913d(0x234),_0x27913d(0x240));return;}if(_0x4367a1){const _0x2b5791=validator['measurePasswordStrength'](_0x4367a1);if(_0x2b5791[_0x27913d(0x1c7)]<0x4){showStatus(_0x27913d(0x192),_0x27913d(0x1a5)+_0x2b5791['feedback'],'error');return;}if(_0x4367a1!==_0x3b40db){showStatus(_0x27913d(0x192),'Passwords\x20do\x20not\x20match',_0x27913d(0x240));return;}}if(appSettings[_0x27913d(0x1ad)]&&!_0x320998){showStatus(_0x27913d(0x192),_0x27913d(0x105),_0x27913d(0x240));return;}const _0x33d5e6={'id':crypto[_0x27913d(0xa8)](),'name':_0x432fd8,'type':_0x49e1f9,'created':new Date()[_0x27913d(0x22c)]()};if(_0x320998){const _0xc1d6f2=parseInt(_0x320998),_0x2bcbe8=new Date();_0x2bcbe8[_0x27913d(0xb3)](_0x2bcbe8[_0x27913d(0x1b6)]()+_0xc1d6f2),_0x33d5e6[_0x27913d(0x209)]=_0x2bcbe8[_0x27913d(0x22c)]();}const _0xe7ec6=_0x49e1f9==='rsa'||_0x49e1f9===_0x27913d(0xf4)||_0x49e1f9==='ecc'||_0x49e1f9==='ecc-p384';_0xe7ec6&&(_0x33d5e6[_0x27913d(0x12c)]=!![],_0x33d5e6[_0x27913d(0xc5)]=!![],_0x33d5e6[_0x27913d(0x137)]=_0x33d5e6['id']);if(_0x49e1f9==='aes')await generateAESKey(_0x33d5e6,_0x4367a1);else{if(_0x49e1f9===_0x27913d(0xe7))await generateRSAKey(_0x33d5e6,_0x4367a1,RSA_CONFIG[_0x27913d(0x17e)]);else{if(_0x49e1f9===_0x27913d(0xf4))await generateRSAKey(_0x33d5e6,_0x4367a1,RSA_CONFIG['KEY_SIZE_4096']);else{if(_0x49e1f9===_0x27913d(0xa5))await generateECCKey(_0x33d5e6,_0x4367a1,ECC_CONFIG['CURVE']);else _0x49e1f9===_0x27913d(0x95)&&await generateECCKey(_0x33d5e6,_0x4367a1,ECC_CONFIG[_0x27913d(0x13b)]);}}}keys[_0x27913d(0x112)](_0x33d5e6),await saveKeys(),document[_0x27913d(0x123)](_0x27913d(0x1c0))['value']='',document[_0x27913d(0x123)](_0x27913d(0xc4))['value']='',document[_0x27913d(0x123)](_0x27913d(0x125))[_0x27913d(0x1f4)]='',document['getElementById'](_0x27913d(0x235))[_0x27913d(0xc9)]=_0x27913d(0x25b),document[_0x27913d(0x123)](_0x27913d(0x224))[_0x27913d(0x24a)]='';const _0x1b479f=getKeyTypeDisplay(_0x33d5e6);showStatus('keyStatus',_0x1b479f+_0x27913d(0x152)+_0x432fd8+'\x22\x20generated\x20successfully',_0x27913d(0x23d));}catch(_0x19d141){console[_0x27913d(0x240)]('Error\x20generating\x20key:',_0x19d141),showStatus(_0x27913d(0x192),_0x27913d(0x218)+_0x19d141['message'],_0x27913d(0x240));}finally{setLoading(![]);}}function getPairedKeyIds(_0x545b05){const _0x23c8c0=_0x11a23a;if(_0x545b05[_0x23c8c0(0x137)])return _0x545b05['pairedKeyId'];if(_0x545b05[_0x23c8c0(0xc5)]&&_0x545b05['hasPublic'])return _0x545b05['id'];if((_0x545b05[_0x23c8c0(0xca)]===_0x23c8c0(0xe7)||_0x545b05[_0x23c8c0(0xca)]===_0x23c8c0(0xf4)||_0x545b05[_0x23c8c0(0xca)]===_0x23c8c0(0xa5)||_0x545b05['type']===_0x23c8c0(0x95))&&(_0x545b05['hasPublic']||_0x545b05[_0x23c8c0(0xc5)])){const _0x3f9120=keys[_0x23c8c0(0x16d)](_0x2e782b=>_0x2e782b['id']!==_0x545b05['id']&&_0x2e782b[_0x23c8c0(0xca)]===_0x545b05[_0x23c8c0(0xca)]&&(_0x545b05[_0x23c8c0(0x12c)]&&_0x2e782b[_0x23c8c0(0xc5)]||_0x545b05[_0x23c8c0(0xc5)]&&_0x2e782b[_0x23c8c0(0x12c)])&&(_0x2e782b[_0x23c8c0(0x1e2)]&&_0x545b05[_0x23c8c0(0x1e2)]&&_0x2e782b[_0x23c8c0(0x1e2)]===_0x545b05[_0x23c8c0(0x1e2)]));if(_0x3f9120[_0x23c8c0(0xdf)]>0x0)return _0x3f9120[0x0]['id'];}return null;}function zeroAllKeys(){const _0x193b58=_0x11a23a;if(keys[_0x193b58(0xdf)]===0x0){showStatus('keyStatus',_0x193b58(0x197),_0x193b58(0x1bb));return;}const _0x548937=confirm(_0x193b58(0xee));if(_0x548937){const _0x27df00=keys[_0x193b58(0xdf)];keys=[],appSettings['useIndexedDB']&&db?clearDatabase(KEYS_STORE)[_0x193b58(0x113)](()=>{const _0x5f522d=_0x193b58;console[_0x5f522d(0x104)](_0x5f522d(0x142));})[_0x193b58(0x237)](_0x33e416=>{const _0x43973a=_0x193b58;console['error'](_0x43973a(0x232),_0x33e416);}):localStorage['removeItem'](_0x193b58(0x25e)),updateKeysList(),updateKeySelects(),showStatus(_0x193b58(0x192),_0x193b58(0x166)+_0x27df00+_0x193b58(0x1ab),'success');}else showStatus(_0x193b58(0x192),'Key\x20deletion\x20canceled',_0x193b58(0x131));}async function generateAESKey(_0x4e05cf,_0x3cac6c){const _0x100124=_0x11a23a,_0x40a719=await window['crypto'][_0x100124(0xaf)]['generateKey']({'name':AES_CONFIG['MODE'],'length':AES_CONFIG['KEY_LENGTH']},!![],[_0x100124(0x115),_0x100124(0xe5)]),_0x1c1673=await window[_0x100124(0xb1)][_0x100124(0xaf)]['exportKey'](_0x100124(0xff),_0x40a719);_0x4e05cf[_0x100124(0xef)]=arrayBufferToBase64(_0x1c1673),_0x4e05cf['algorithm']=AES_CONFIG[_0x100124(0x194)],_0x4e05cf[_0x100124(0xdf)]=AES_CONFIG[_0x100124(0x130)],_0x3cac6c&&await encryptKeyWithPassword(_0x4e05cf,_0x3cac6c);}async function generateRSAKey(_0x160b89,_0x5aa894,_0x28a0fb){const _0x1432de=_0x11a23a,_0x34accc=await window[_0x1432de(0xb1)]['subtle'][_0x1432de(0x122)]({'name':RSA_CONFIG[_0x1432de(0x129)],'modulusLength':_0x28a0fb,'publicExponent':new Uint8Array([0x1,0x0,0x1]),'hash':RSA_CONFIG[_0x1432de(0x193)]},!![],['encrypt',_0x1432de(0xe5)]),_0x5c67e6=await window[_0x1432de(0xb1)]['subtle'][_0x1432de(0x10e)]('spki',_0x34accc[_0x1432de(0xdb)]),_0x2a6ff9=await window[_0x1432de(0xb1)][_0x1432de(0xaf)]['exportKey']('pkcs8',_0x34accc['privateKey']);_0x160b89[_0x1432de(0xdb)]=arrayBufferToBase64(_0x5c67e6),_0x160b89[_0x1432de(0x13c)]=arrayBufferToBase64(_0x2a6ff9),_0x160b89[_0x1432de(0x1c8)]=RSA_CONFIG[_0x1432de(0x129)],_0x160b89[_0x1432de(0xdf)]=_0x28a0fb;const _0x39e66f=await computeKeyHash(_0x5c67e6);_0x160b89[_0x1432de(0x1e2)]=_0x39e66f,_0x5aa894&&await encryptKeyWithPassword(_0x160b89,_0x5aa894);}async function generateECCKey(_0x30bf36,_0x40d0a2,_0x46e087){const _0x284a0d=_0x11a23a,_0x3ada39=await window['crypto'][_0x284a0d(0xaf)]['generateKey']({'name':_0x284a0d(0x18d),'namedCurve':_0x46e087},!![],[_0x284a0d(0x247),_0x284a0d(0x1b9)]),_0x34fada=await window['crypto'][_0x284a0d(0xaf)]['exportKey']('spki',_0x3ada39[_0x284a0d(0xdb)]),_0x4f4bc0=await window[_0x284a0d(0xb1)][_0x284a0d(0xaf)][_0x284a0d(0x10e)](_0x284a0d(0x109),_0x3ada39[_0x284a0d(0x13c)]);_0x30bf36[_0x284a0d(0xdb)]=arrayBufferToBase64(_0x34fada),_0x30bf36[_0x284a0d(0x13c)]=arrayBufferToBase64(_0x4f4bc0),_0x30bf36[_0x284a0d(0x1c8)]=_0x284a0d(0x18d),_0x30bf36[_0x284a0d(0x181)]=_0x46e087;const _0x4a7775=await computeKeyHash(_0x34fada);_0x30bf36[_0x284a0d(0x1e2)]=_0x4a7775,_0x40d0a2&&await encryptKeyWithPassword(_0x30bf36,_0x40d0a2);}async function computeKeyHash(_0x3bbf11){const _0x4d0e37=_0x11a23a,_0x4c02bb=await crypto[_0x4d0e37(0xaf)][_0x4d0e37(0x97)](_0x4d0e37(0x155),_0x3bbf11);return arrayBufferToBase64(_0x4c02bb);}async function encryptKeyWithPassword(_0x434a79,_0x145fce){const _0x1a293f=_0x11a23a,_0x3b5524=window[_0x1a293f(0xb1)][_0x1a293f(0xa0)](new Uint8Array(0x10));_0x434a79['salt']=arrayBufferToBase64(_0x3b5524);const _0x2e49fd=await deriveKeyFromPassword(_0x145fce,_0x3b5524),_0x2aca07=window[_0x1a293f(0xb1)]['getRandomValues'](new Uint8Array(AES_CONFIG[_0x1a293f(0x11e)]));_0x434a79['iv']=arrayBufferToBase64(_0x2aca07);if(_0x434a79['type']===_0x1a293f(0x205)){const _0x25510e=await encryptWithDerivedKey(_0x2e49fd,base64ToArrayBuffer(_0x434a79[_0x1a293f(0xef)]),_0x2aca07);_0x434a79[_0x1a293f(0xef)]=arrayBufferToBase64(_0x25510e),_0x434a79[_0x1a293f(0x190)]=!![];}else{const _0x4d66f9=await encryptWithDerivedKey(_0x2e49fd,base64ToArrayBuffer(_0x434a79[_0x1a293f(0x13c)]),_0x2aca07);_0x434a79[_0x1a293f(0x13c)]=arrayBufferToBase64(_0x4d66f9),_0x434a79[_0x1a293f(0x190)]=!![];}}async function decryptKeyWithPassword(_0x4097f0,_0x54ad2c){const _0x14f344=_0x11a23a;try{if(!_0x4097f0||!_0x54ad2c)throw new Error(_0x14f344(0xc1));if(!_0x4097f0['salt']||!_0x4097f0['iv'])throw new Error('Key\x20is\x20missing\x20salt\x20or\x20IV\x20data');const _0x21d76b=base64ToArrayBuffer(_0x4097f0['salt']),_0x2d91db=await deriveKeyFromPassword(_0x54ad2c,_0x21d76b),_0x284ca5=base64ToArrayBuffer(_0x4097f0['iv']),_0x39a1f1={..._0x4097f0};if(_0x4097f0[_0x14f344(0xca)]==='aes'){if(!_0x4097f0['key'])throw new Error('Missing\x20encrypted\x20key\x20data');const _0x234942=await decryptWithDerivedKey(_0x2d91db,base64ToArrayBuffer(_0x4097f0['key']),_0x284ca5);_0x39a1f1[_0x14f344(0xef)]=arrayBufferToBase64(_0x234942),_0x39a1f1[_0x14f344(0x16a)]=await importAESKey(_0x234942);}else{if(_0x4097f0['type']===_0x14f344(0xe7)||_0x4097f0['type']===_0x14f344(0xf4)){if(!_0x4097f0['privateKey'])throw new Error(_0x14f344(0x1b3));const _0x12043e=await decryptWithDerivedKey(_0x2d91db,base64ToArrayBuffer(_0x4097f0[_0x14f344(0x13c)]),_0x284ca5);_0x39a1f1['privateKey']=arrayBufferToBase64(_0x12043e),_0x39a1f1['_privateKey']=await importRSAPrivateKey(_0x12043e,_0x4097f0[_0x14f344(0xdf)]||RSA_CONFIG[_0x14f344(0x17e)]),_0x4097f0[_0x14f344(0xdb)]&&(_0x39a1f1['_publicKey']=await importRSAPublicKey(base64ToArrayBuffer(_0x4097f0['publicKey']),_0x4097f0[_0x14f344(0xdf)]||RSA_CONFIG[_0x14f344(0x17e)]));}else{if(_0x4097f0['type']===_0x14f344(0xa5)||_0x4097f0['type']===_0x14f344(0x95)){if(!_0x4097f0[_0x14f344(0x13c)])throw new Error(_0x14f344(0x1b3));const _0x701591=await decryptWithDerivedKey(_0x2d91db,base64ToArrayBuffer(_0x4097f0[_0x14f344(0x13c)]),_0x284ca5);_0x39a1f1[_0x14f344(0x13c)]=arrayBufferToBase64(_0x701591),_0x39a1f1[_0x14f344(0x12f)]=await importECCPrivateKey(_0x701591,_0x4097f0[_0x14f344(0x181)]||ECC_CONFIG[_0x14f344(0x16f)]),_0x4097f0[_0x14f344(0xdb)]&&(_0x39a1f1[_0x14f344(0x1e5)]=await importECCPublicKey(base64ToArrayBuffer(_0x4097f0[_0x14f344(0xdb)]),_0x4097f0[_0x14f344(0x181)]||ECC_CONFIG[_0x14f344(0x16f)]));}else throw new Error('Unsupported\x20key\x20type:\x20'+_0x4097f0[_0x14f344(0xca)]);}}return safeMemory[_0x14f344(0x201)](_0x39a1f1);}catch(_0x3f0bca){console[_0x14f344(0x240)]('Decryption\x20error:',_0x3f0bca);throw new Error(_0x14f344(0x203));}}function updateKeysList(){const _0x1a6979=_0x11a23a;keysList[_0x1a6979(0x121)]='';if(keys[_0x1a6979(0xdf)]===0x0){keysList['innerHTML']=_0x1a6979(0x13a);return;}keys['forEach'](_0x2c08bf=>{const _0x32aa6c=_0x1a6979,_0x2e5d2b=document[_0x32aa6c(0x187)]('div');_0x2e5d2b[_0x32aa6c(0xc9)]='key-item';const _0x42bbc0=getKeyTypeDisplay(_0x2c08bf),_0x17739c=_0x2c08bf[_0x32aa6c(0x190)]?_0x32aa6c(0x255):'';let _0x837699='';if(_0x2c08bf[_0x32aa6c(0xca)]==='aes')_0x837699='';else{if(_0x2c08bf[_0x32aa6c(0xc5)]&&_0x2c08bf[_0x32aa6c(0x12c)])_0x837699=_0x32aa6c(0x89);else{if(_0x2c08bf[_0x32aa6c(0xc5)])_0x837699='<span\x20class=\x22key-pair-badge\x20private\x22>PRIVATE\x20KEY</span>';else _0x2c08bf[_0x32aa6c(0x12c)]&&(_0x837699='<span\x20class=\x22key-pair-badge\x20public\x22>PUBLIC\x20KEY</span>');}}let _0x5d71a3='',_0x1bdb47=determineKeySecurityLevel(_0x2c08bf);_0x5d71a3=_0x32aa6c(0xbc)+_0x1bdb47+'\x22>'+_0x1bdb47['toUpperCase']()+'</span>';let _0x2ba7e7='';if(_0x2c08bf['expiry']){const _0x2c7037=new Date(_0x2c08bf[_0x32aa6c(0x209)]),_0x344376=Math[_0x32aa6c(0xac)]((_0x2c7037-new Date())/(0x3e8*0x3c*0x3c*0x18));_0x2ba7e7=_0x32aa6c(0x12a)+_0x344376+_0x32aa6c(0x236)+_0x2c7037['toLocaleDateString']()+')</div>';}let _0x21610f='';if(_0x2c08bf[_0x32aa6c(0xca)]===_0x32aa6c(0x205))_0x21610f+=_0x32aa6c(0x23b)+_0x2c08bf['id']+_0x32aa6c(0xcf);else _0x2c08bf[_0x32aa6c(0x12c)]&&(_0x21610f+='<button\x20class=\x22btn-secondary\x22\x20onclick=\x22exportKey(\x27'+_0x2c08bf['id']+'\x27)\x22>Export\x20Public</button>');_0x2c08bf[_0x32aa6c(0xca)]!=='aes'&&_0x2c08bf[_0x32aa6c(0xc5)]&&(_0x21610f+=_0x32aa6c(0x248)+_0x2c08bf['id']+_0x32aa6c(0xd8)),_0x21610f+=_0x32aa6c(0x17c)+_0x2c08bf['id']+_0x32aa6c(0x1d7),_0x2e5d2b[_0x32aa6c(0x121)]=_0x32aa6c(0x22a)+validator[_0x32aa6c(0x206)](_0x2c08bf['name'])+'\x20('+_0x42bbc0+_0x17739c+')\x20'+_0x5d71a3+_0x32aa6c(0x1de)+_0x837699+_0x32aa6c(0x21e)+new Date(_0x2c08bf[_0x32aa6c(0x162)])[_0x32aa6c(0x1ce)]()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Algorithm:\x20'+(_0x2c08bf[_0x32aa6c(0x1c8)]||'')+'\x20'+(_0x2c08bf[_0x32aa6c(0xdf)]?_0x2c08bf[_0x32aa6c(0xdf)]+_0x32aa6c(0x196):_0x2c08bf[_0x32aa6c(0x181)]||'')+_0x32aa6c(0x1bf)+_0x2ba7e7+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x21610f+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',keysList['appendChild'](_0x2e5d2b);});}function getKeyTypeDisplay(_0x35fd5b){const _0x2d7e37=_0x11a23a;if(_0x35fd5b[_0x2d7e37(0xca)]===_0x2d7e37(0x205))return _0x2d7e37(0x1d0);else{if(_0x35fd5b[_0x2d7e37(0xca)]===_0x2d7e37(0xe7))return _0x2d7e37(0x100);else{if(_0x35fd5b[_0x2d7e37(0xca)]===_0x2d7e37(0xf4))return _0x2d7e37(0x120);else{if(_0x35fd5b[_0x2d7e37(0xca)]==='ecc')return'ECC-P256';else{if(_0x35fd5b['type']===_0x2d7e37(0x95))return _0x2d7e37(0x19e);}}}}return _0x35fd5b['type'][_0x2d7e37(0x13d)]();}function updateKeySelects(){const _0x26d278=_0x11a23a;encryptionKeySelect[_0x26d278(0x121)]=_0x26d278(0x12d),decryptionKeySelect[_0x26d278(0x121)]=_0x26d278(0x12d),keys[_0x26d278(0xde)](_0x3a3f17=>{const _0x144b27=_0x26d278;if(_0x3a3f17[_0x144b27(0xca)]==='aes'||_0x3a3f17[_0x144b27(0x12c)]){const _0x2aea83=document['createElement'](_0x144b27(0xa4));_0x2aea83[_0x144b27(0x1f4)]=_0x3a3f17['id'];const _0x124d24=getKeyTypeDisplay(_0x3a3f17),_0x8166e7=_0x3a3f17['protected']?'\x20ðŸ”’':'';let _0xa539a9='';_0x3a3f17[_0x144b27(0xca)]!==_0x144b27(0x205)&&(_0xa539a9=_0x3a3f17[_0x144b27(0xc5)]&&_0x3a3f17[_0x144b27(0x12c)]?'\x20[Full\x20Pair]':_0x144b27(0xbd)),_0x2aea83[_0x144b27(0x219)]=_0x3a3f17[_0x144b27(0x12b)]+'\x20('+_0x124d24+_0xa539a9+_0x8166e7+')',encryptionKeySelect['appendChild'](_0x2aea83);}}),keys['forEach'](_0x43db1a=>{const _0x3ffe5d=_0x26d278;if(_0x43db1a[_0x3ffe5d(0xca)]===_0x3ffe5d(0x205)||_0x43db1a['hasPrivate']){const _0x7fa4b5=document[_0x3ffe5d(0x187)](_0x3ffe5d(0xa4));_0x7fa4b5[_0x3ffe5d(0x1f4)]=_0x43db1a['id'];const _0x473a9d=getKeyTypeDisplay(_0x43db1a),_0x41fa46=_0x43db1a['protected']?_0x3ffe5d(0x255):'';let _0x13b74b='';_0x43db1a['type']!=='aes'&&(_0x13b74b=_0x43db1a[_0x3ffe5d(0xc5)]&&_0x43db1a[_0x3ffe5d(0x12c)]?_0x3ffe5d(0x217):'\x20[Private]'),_0x7fa4b5['text']=_0x43db1a[_0x3ffe5d(0x12b)]+'\x20('+_0x473a9d+_0x13b74b+_0x41fa46+')',decryptionKeySelect[_0x3ffe5d(0xcc)](_0x7fa4b5);}});}function handleEncryptionKeyChange(){const _0x27c495=_0x11a23a,_0x55feb1=encryptionKeySelect[_0x27c495(0x1f4)];if(!_0x55feb1){document[_0x27c495(0x123)](_0x27c495(0xb2))[_0x27c495(0x191)][_0x27c495(0x94)]='none';return;}const _0x1e375c=keys[_0x27c495(0x1e7)](_0x15ab45=>_0x15ab45['id']===_0x55feb1);if(!_0x1e375c)return;document[_0x27c495(0x123)]('encryptionPasswordGroup')[_0x27c495(0x191)][_0x27c495(0x94)]=_0x1e375c['protected']?'block':_0x27c495(0xab);}function handleDecryptionKeyChange(){const _0x4275db=_0x11a23a,_0x5d0edc=decryptionKeySelect['value'];if(!_0x5d0edc){document[_0x4275db(0x123)](_0x4275db(0x1e3))[_0x4275db(0x191)]['display']=_0x4275db(0xab);return;}const _0x858132=keys[_0x4275db(0x1e7)](_0x2c23c=>_0x2c23c['id']===_0x5d0edc);if(!_0x858132)return;document[_0x4275db(0x123)](_0x4275db(0x1e3))[_0x4275db(0x191)]['display']=_0x858132[_0x4275db(0x190)]?'block':_0x4275db(0xab);}function _0x4803(_0x27dc76,_0x17ac11){const _0x54a474=_0x54a4();return _0x4803=function(_0x4803bf,_0x1e5a55){_0x4803bf=_0x4803bf-0x85;let _0x3d3e1c=_0x54a474[_0x4803bf];return _0x3d3e1c;},_0x4803(_0x27dc76,_0x17ac11);}async function encryptMessage(){const _0x598123=_0x11a23a;try{let _0x115232,_0x49cfd9='';if(encryptFileData)_0x115232=encryptFileData,_0x49cfd9=generateRandomFileName(0x6)+_0x598123(0x1ff);else{const _0x5efa5e=document['getElementById'](_0x598123(0x213))[_0x598123(0x1f4)];if(!_0x5efa5e){showStatus(_0x598123(0x239),_0x598123(0x1d2),_0x598123(0x240));return;}_0x115232=new TextEncoder()[_0x598123(0x10a)](_0x5efa5e);}const _0xc467d=document[_0x598123(0x123)]('encryptionKey')[_0x598123(0x1f4)],_0x1c7ec1=document[_0x598123(0x123)](_0x598123(0x15d))[_0x598123(0x1f4)];let _0x15171a=document[_0x598123(0x123)](_0x598123(0x99))[_0x598123(0x1f4)];_0x15171a&&(_0x115232=xorCipher(_0x115232,_0x15171a));if(!_0xc467d){showStatus(_0x598123(0x239),_0x598123(0x8c),'error');return;}setLoading(!![]);const _0x197ab5=keys[_0x598123(0x1e7)](_0x396ee5=>_0x396ee5['id']===_0xc467d);if(!_0x197ab5){showStatus(_0x598123(0x239),'Key\x20not\x20found','error'),setLoading(![]);return;}let _0x2c3900=null,_0x5e1047=_0x197ab5;if(_0x197ab5['protected']){if(!_0x1c7ec1){showStatus(_0x598123(0x239),_0x598123(0xcd),_0x598123(0x240)),setLoading(![]);return;}try{_0x2c3900=await decryptKeyWithPassword(_0x197ab5,_0x1c7ec1),_0x5e1047=safeMemory[_0x598123(0x157)](_0x2c3900);if(!_0x5e1047)throw new Error(_0x598123(0x147));}catch(_0x2388d0){showStatus(_0x598123(0x239),_0x598123(0xf2)+_0x2388d0[_0x598123(0xaa)],_0x598123(0x240)),setLoading(![]);return;}}let _0x1bc1af=await encryptData(_0x115232,_0x5e1047);_0x2c3900&&safeMemory['delete'](_0x2c3900);encryptFileData&&(_0x1bc1af['fileName']=encryptFileName,_0x1bc1af['fileSize']=encryptFileData['byteLength'],_0x1bc1af['isFile']=!![]);const _0x16462b=createEncryptedMessageString(_0x1bc1af,_0x15171a);document[_0x598123(0x123)]('encryptedOutput')['value']=_0x16462b,document[_0x598123(0x123)](_0x598123(0xfe))[_0x598123(0x198)](_0x598123(0x1f0),_0x49cfd9),showStatus(_0x598123(0x239),_0x598123(0x9d),'success');}catch(_0x405a57){console[_0x598123(0x240)](_0x598123(0x19d),_0x405a57),showStatus('encryptStatus',_0x598123(0x19f)+_0x405a57[_0x598123(0xaa)],_0x598123(0x240));}finally{document[_0x598123(0x123)](_0x598123(0x15d))[_0x598123(0x1f4)]='',setLoading(![]);}}async function encryptWithAES(_0x3f0603,_0xba436a){const _0x2e3970=_0x11a23a;try{const _0x3f0cc1=window[_0x2e3970(0xb1)][_0x2e3970(0xa0)](new Uint8Array(AES_CONFIG['IV_LENGTH']));let _0x3f07f3;if(_0xba436a[_0x2e3970(0x16a)])_0x3f07f3=_0xba436a['_cryptoKey'];else{const _0x372303=base64ToArrayBuffer(_0xba436a[_0x2e3970(0xef)]);_0x3f07f3=await window[_0x2e3970(0xb1)][_0x2e3970(0xaf)][_0x2e3970(0x1a0)]('raw',_0x372303,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x2e3970(0x115)]);}const _0x4aa9d2=await window[_0x2e3970(0xb1)]['subtle'][_0x2e3970(0x115)]({'name':AES_CONFIG[_0x2e3970(0x194)],'iv':_0x3f0cc1,'tagLength':AES_CONFIG[_0x2e3970(0x1b0)]},_0x3f07f3,_0x3f0603),_0x3ef96b={'k':_0xba436a['id'],'t':new Date()['toISOString'](),'a':AES_CONFIG[_0x2e3970(0x194)]};encryptFileData&&encryptFileName&&(_0x3ef96b['f']={'n':encryptFileName,'s':encryptFileData[_0x2e3970(0x151)]});const _0x507095=new TextEncoder()[_0x2e3970(0x10a)](JSON[_0x2e3970(0x132)](_0x3ef96b)),_0xc02069=window[_0x2e3970(0xb1)][_0x2e3970(0xa0)](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0x5b51a4=await window[_0x2e3970(0xb1)][_0x2e3970(0xaf)][_0x2e3970(0x122)]({'name':AES_CONFIG[_0x2e3970(0x194)],'length':AES_CONFIG[_0x2e3970(0x130)]},!![],[_0x2e3970(0x115)]),_0x3458db=await window['crypto'][_0x2e3970(0xaf)]['encrypt']({'name':AES_CONFIG[_0x2e3970(0x194)],'iv':_0xc02069,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x5b51a4,_0x507095),_0x40a89c=await window[_0x2e3970(0xb1)][_0x2e3970(0xaf)][_0x2e3970(0x10e)](_0x2e3970(0xff),_0x5b51a4),_0x57b3db=0x3,_0x5201bc=0x1+_0xc02069[_0x2e3970(0x151)]+0x4+_0x40a89c[_0x2e3970(0x151)]+0x4+_0x3458db['byteLength']+_0x3f0cc1[_0x2e3970(0x151)]+0x4+_0x4aa9d2['byteLength'],_0xfcf2aa=new Uint8Array(_0x5201bc);let _0xa25753=0x0;_0xfcf2aa[_0xa25753++]=_0x57b3db,_0xfcf2aa[_0x2e3970(0xd6)](_0xc02069,_0xa25753),_0xa25753+=_0xc02069[_0x2e3970(0x151)];const _0x353942=_0x40a89c[_0x2e3970(0x151)];_0xfcf2aa[_0xa25753++]=_0x353942>>0x18&0xff,_0xfcf2aa[_0xa25753++]=_0x353942>>0x10&0xff,_0xfcf2aa[_0xa25753++]=_0x353942>>0x8&0xff,_0xfcf2aa[_0xa25753++]=_0x353942&0xff,_0xfcf2aa[_0x2e3970(0xd6)](new Uint8Array(_0x40a89c),_0xa25753),_0xa25753+=_0x40a89c[_0x2e3970(0x151)];const _0x44d799=_0x3458db[_0x2e3970(0x151)];_0xfcf2aa[_0xa25753++]=_0x44d799>>0x18&0xff,_0xfcf2aa[_0xa25753++]=_0x44d799>>0x10&0xff,_0xfcf2aa[_0xa25753++]=_0x44d799>>0x8&0xff,_0xfcf2aa[_0xa25753++]=_0x44d799&0xff,_0xfcf2aa[_0x2e3970(0xd6)](new Uint8Array(_0x3458db),_0xa25753),_0xa25753+=_0x3458db[_0x2e3970(0x151)],_0xfcf2aa[_0x2e3970(0xd6)](_0x3f0cc1,_0xa25753),_0xa25753+=_0x3f0cc1[_0x2e3970(0x151)];const _0x33d0cb=_0x4aa9d2[_0x2e3970(0x151)];return _0xfcf2aa[_0xa25753++]=_0x33d0cb>>0x18&0xff,_0xfcf2aa[_0xa25753++]=_0x33d0cb>>0x10&0xff,_0xfcf2aa[_0xa25753++]=_0x33d0cb>>0x8&0xff,_0xfcf2aa[_0xa25753++]=_0x33d0cb&0xff,_0xfcf2aa[_0x2e3970(0xd6)](new Uint8Array(_0x4aa9d2),_0xa25753),{'version':0x3,'data':arrayBufferToBase64(_0xfcf2aa['buffer'])};}catch(_0x2cbada){console[_0x2e3970(0x240)](_0x2e3970(0x11c),_0x2cbada);throw new Error(_0x2e3970(0x1d6)+_0x2cbada[_0x2e3970(0xaa)]);}}async function deriveMetadataKey(_0x2c29b5,_0x41e945){const _0x2b22b4=_0x11a23a,_0x4a5645=await window[_0x2b22b4(0xb1)][_0x2b22b4(0xaf)][_0x2b22b4(0x10e)](_0x2b22b4(0xff),_0x2c29b5),_0x1c62cc=new Uint8Array(_0x4a5645[_0x2b22b4(0x151)]+_0x41e945[_0x2b22b4(0x151)]);_0x1c62cc[_0x2b22b4(0xd6)](new Uint8Array(_0x4a5645),0x0),_0x1c62cc[_0x2b22b4(0xd6)](_0x41e945,_0x4a5645[_0x2b22b4(0x151)]);const _0x576365=await window[_0x2b22b4(0xb1)][_0x2b22b4(0xaf)][_0x2b22b4(0x1a0)]('raw',_0x1c62cc,{'name':'HKDF'},![],[_0x2b22b4(0x247)]);return window[_0x2b22b4(0xb1)][_0x2b22b4(0xaf)][_0x2b22b4(0x247)]({'name':_0x2b22b4(0x204),'hash':_0x2b22b4(0x155),'salt':_0x41e945,'info':new Uint8Array([0x1,0x2,0x3,0x4])},_0x576365,{'name':AES_CONFIG[_0x2b22b4(0x194)],'length':AES_CONFIG[_0x2b22b4(0x130)]},![],['encrypt',_0x2b22b4(0xe5)]);}async function encryptWithRSA(_0x3dbde3,_0x1d4999){const _0x3b4469=_0x11a23a,_0x360377=await window[_0x3b4469(0xb1)][_0x3b4469(0xaf)][_0x3b4469(0x122)]({'name':AES_CONFIG[_0x3b4469(0x194)],'length':AES_CONFIG[_0x3b4469(0x130)]},!![],['encrypt',_0x3b4469(0xe5)]),_0x727a2b=window[_0x3b4469(0xb1)][_0x3b4469(0xa0)](new Uint8Array(AES_CONFIG[_0x3b4469(0x11e)])),_0x5bdd47=await window[_0x3b4469(0xb1)][_0x3b4469(0xaf)][_0x3b4469(0x115)]({'name':AES_CONFIG[_0x3b4469(0x194)],'iv':_0x727a2b,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x360377,_0x3dbde3),_0x4da78a=await window[_0x3b4469(0xb1)][_0x3b4469(0xaf)][_0x3b4469(0x10e)]('raw',_0x360377);let _0x3e32d9;if(_0x1d4999[_0x3b4469(0x1e5)])_0x3e32d9=_0x1d4999[_0x3b4469(0x1e5)];else{const _0x202053=base64ToArrayBuffer(_0x1d4999[_0x3b4469(0xdb)]);_0x3e32d9=await importRSAPublicKey(_0x202053,_0x1d4999[_0x3b4469(0xdf)]||RSA_CONFIG[_0x3b4469(0x17e)]);}const _0x8e11c3=await window[_0x3b4469(0xb1)][_0x3b4469(0xaf)]['encrypt']({'name':RSA_CONFIG[_0x3b4469(0x129)]},_0x3e32d9,_0x4da78a),_0x1ccf9a={'a':RSA_CONFIG[_0x3b4469(0x129)]+'+'+AES_CONFIG[_0x3b4469(0x194)],'k':_0x1d4999['id'],'t':new Date()['toISOString'](),'s':_0x1d4999[_0x3b4469(0xdf)]||RSA_CONFIG[_0x3b4469(0x17e)]};encryptFileData&&encryptFileName&&(_0x1ccf9a['f']={'n':encryptFileName,'s':encryptFileData[_0x3b4469(0x151)]});const _0x226969=new TextEncoder()[_0x3b4469(0x10a)](JSON[_0x3b4469(0x132)](_0x1ccf9a)),_0x1cbc70=await window[_0x3b4469(0xb1)][_0x3b4469(0xaf)][_0x3b4469(0x122)]({'name':AES_CONFIG[_0x3b4469(0x194)],'length':AES_CONFIG['KEY_LENGTH']},!![],[_0x3b4469(0x115),_0x3b4469(0xe5)]),_0x4ac765=window[_0x3b4469(0xb1)]['getRandomValues'](new Uint8Array(AES_CONFIG[_0x3b4469(0x11e)])),_0x3ab0de=await window[_0x3b4469(0xb1)][_0x3b4469(0xaf)][_0x3b4469(0x115)]({'name':AES_CONFIG[_0x3b4469(0x194)],'iv':_0x4ac765,'tagLength':AES_CONFIG[_0x3b4469(0x1b0)]},_0x1cbc70,_0x226969),_0x263398=await window[_0x3b4469(0xb1)][_0x3b4469(0xaf)][_0x3b4469(0x10e)](_0x3b4469(0xff),_0x1cbc70),_0x46a9ae=Math['floor'](Math['random']()*0x40)+0x1,_0x564a3e=window[_0x3b4469(0xb1)][_0x3b4469(0xa0)](new Uint8Array(_0x46a9ae)),_0x42e74f=new Uint8Array(0x1+_0x4ac765[_0x3b4469(0x151)]+0x4+_0x263398[_0x3b4469(0x151)]+0x4+_0x3ab0de['byteLength']+0x4+_0x8e11c3[_0x3b4469(0x151)]+_0x727a2b[_0x3b4469(0x151)]+0x4+_0x5bdd47[_0x3b4469(0x151)]+0x1+_0x564a3e['byteLength']);let _0xe6ba3c=0x0;_0x42e74f[_0xe6ba3c++]=_0x4ac765[_0x3b4469(0x151)],_0x42e74f[_0x3b4469(0xd6)](_0x4ac765,_0xe6ba3c),_0xe6ba3c+=_0x4ac765[_0x3b4469(0x151)];const _0x31c146=_0x263398['byteLength'];_0x42e74f[_0xe6ba3c++]=_0x31c146>>0x18&0xff,_0x42e74f[_0xe6ba3c++]=_0x31c146>>0x10&0xff,_0x42e74f[_0xe6ba3c++]=_0x31c146>>0x8&0xff,_0x42e74f[_0xe6ba3c++]=_0x31c146&0xff,_0x42e74f[_0x3b4469(0xd6)](new Uint8Array(_0x263398),_0xe6ba3c),_0xe6ba3c+=_0x263398[_0x3b4469(0x151)];const _0x41bbdc=_0x3ab0de[_0x3b4469(0x151)];_0x42e74f[_0xe6ba3c++]=_0x41bbdc>>0x18&0xff,_0x42e74f[_0xe6ba3c++]=_0x41bbdc>>0x10&0xff,_0x42e74f[_0xe6ba3c++]=_0x41bbdc>>0x8&0xff,_0x42e74f[_0xe6ba3c++]=_0x41bbdc&0xff,_0x42e74f[_0x3b4469(0xd6)](new Uint8Array(_0x3ab0de),_0xe6ba3c),_0xe6ba3c+=_0x3ab0de[_0x3b4469(0x151)];const _0x3dc403=_0x8e11c3[_0x3b4469(0x151)];_0x42e74f[_0xe6ba3c++]=_0x3dc403>>0x18&0xff,_0x42e74f[_0xe6ba3c++]=_0x3dc403>>0x10&0xff,_0x42e74f[_0xe6ba3c++]=_0x3dc403>>0x8&0xff,_0x42e74f[_0xe6ba3c++]=_0x3dc403&0xff,_0x42e74f[_0x3b4469(0xd6)](new Uint8Array(_0x8e11c3),_0xe6ba3c),_0xe6ba3c+=_0x8e11c3[_0x3b4469(0x151)],_0x42e74f[_0x3b4469(0xd6)](_0x727a2b,_0xe6ba3c),_0xe6ba3c+=_0x727a2b[_0x3b4469(0x151)];const _0x5117df=_0x5bdd47[_0x3b4469(0x151)];return _0x42e74f[_0xe6ba3c++]=_0x5117df>>0x18&0xff,_0x42e74f[_0xe6ba3c++]=_0x5117df>>0x10&0xff,_0x42e74f[_0xe6ba3c++]=_0x5117df>>0x8&0xff,_0x42e74f[_0xe6ba3c++]=_0x5117df&0xff,_0x42e74f[_0x3b4469(0xd6)](new Uint8Array(_0x5bdd47),_0xe6ba3c),_0xe6ba3c+=_0x5bdd47[_0x3b4469(0x151)],_0x42e74f[_0xe6ba3c++]=_0x564a3e[_0x3b4469(0x151)],_0x42e74f[_0x3b4469(0xd6)](_0x564a3e,_0xe6ba3c),{'version':0x2,'data':arrayBufferToBase64(_0x42e74f[_0x3b4469(0x93)])};}async function encryptWithECC(_0x12e4ce,_0x9592fc){const _0x1f99a9=_0x11a23a,_0x4eb6d5=await window[_0x1f99a9(0xb1)]['subtle']['generateKey']({'name':_0x1f99a9(0x18d),'namedCurve':_0x9592fc[_0x1f99a9(0x181)]||ECC_CONFIG[_0x1f99a9(0x16f)]},!![],[_0x1f99a9(0x247),_0x1f99a9(0x1b9)]),_0x5c2922=await window[_0x1f99a9(0xb1)]['subtle'][_0x1f99a9(0x10e)](_0x1f99a9(0x1d5),_0x4eb6d5[_0x1f99a9(0xdb)]);let _0x3352c1;if(_0x9592fc[_0x1f99a9(0x1e5)])_0x3352c1=_0x9592fc[_0x1f99a9(0x1e5)];else{const _0x23dad6=base64ToArrayBuffer(_0x9592fc[_0x1f99a9(0xdb)]);_0x3352c1=await importECCPublicKey(_0x23dad6,_0x9592fc[_0x1f99a9(0x181)]||ECC_CONFIG[_0x1f99a9(0x16f)]);}const _0x2fa9ee=window[_0x1f99a9(0xb1)][_0x1f99a9(0xa0)](new Uint8Array(AES_CONFIG[_0x1f99a9(0x11e)])),_0x33eb96=await window[_0x1f99a9(0xb1)][_0x1f99a9(0xaf)][_0x1f99a9(0x1b9)]({'name':_0x1f99a9(0x18d),'public':_0x3352c1},_0x4eb6d5[_0x1f99a9(0x13c)],0x100),_0x4b20b3=await window[_0x1f99a9(0xb1)]['subtle'][_0x1f99a9(0x1a0)](_0x1f99a9(0xff),_0x33eb96,{'name':AES_CONFIG[_0x1f99a9(0x194)],'length':AES_CONFIG[_0x1f99a9(0x130)]},![],[_0x1f99a9(0x115)]),_0x147910=await window[_0x1f99a9(0xb1)][_0x1f99a9(0xaf)][_0x1f99a9(0x115)]({'name':AES_CONFIG[_0x1f99a9(0x194)],'iv':_0x2fa9ee,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x4b20b3,_0x12e4ce),_0xccc162={'a':_0x1f99a9(0x1e9)+AES_CONFIG[_0x1f99a9(0x194)],'k':_0x9592fc['id'],'t':new Date()[_0x1f99a9(0x22c)](),'c':_0x9592fc[_0x1f99a9(0x181)]||ECC_CONFIG[_0x1f99a9(0x16f)]};encryptFileData&&encryptFileName&&(_0xccc162['f']={'n':encryptFileName,'s':encryptFileData[_0x1f99a9(0x151)]});const _0x19174e=new TextEncoder()[_0x1f99a9(0x10a)](JSON['stringify'](_0xccc162)),_0x7128fc=await window['crypto'][_0x1f99a9(0xaf)][_0x1f99a9(0x122)]({'name':AES_CONFIG[_0x1f99a9(0x194)],'length':AES_CONFIG[_0x1f99a9(0x130)]},!![],[_0x1f99a9(0x115),'decrypt']),_0xd3a91c=window[_0x1f99a9(0xb1)][_0x1f99a9(0xa0)](new Uint8Array(AES_CONFIG[_0x1f99a9(0x11e)])),_0x51c192=await window[_0x1f99a9(0xb1)][_0x1f99a9(0xaf)]['encrypt']({'name':AES_CONFIG[_0x1f99a9(0x194)],'iv':_0xd3a91c,'tagLength':AES_CONFIG[_0x1f99a9(0x1b0)]},_0x7128fc,_0x19174e),_0x2effe1=await window[_0x1f99a9(0xb1)][_0x1f99a9(0xaf)][_0x1f99a9(0x10e)](_0x1f99a9(0xff),_0x7128fc),_0x4ff527=Math[_0x1f99a9(0x88)](Math[_0x1f99a9(0x1af)]()*0x40)+0x1,_0x5f5213=window['crypto'][_0x1f99a9(0xa0)](new Uint8Array(_0x4ff527)),_0xeda7fe=new Uint8Array(0x1+_0xd3a91c[_0x1f99a9(0x151)]+0x4+_0x2effe1[_0x1f99a9(0x151)]+0x4+_0x51c192[_0x1f99a9(0x151)]+0x4+_0x5c2922[_0x1f99a9(0x151)]+_0x2fa9ee[_0x1f99a9(0x151)]+0x4+_0x147910[_0x1f99a9(0x151)]+0x1+_0x5f5213[_0x1f99a9(0x151)]);let _0x3bd037=0x0;_0xeda7fe[_0x3bd037++]=_0xd3a91c[_0x1f99a9(0x151)],_0xeda7fe[_0x1f99a9(0xd6)](_0xd3a91c,_0x3bd037),_0x3bd037+=_0xd3a91c[_0x1f99a9(0x151)];const _0x479b85=_0x2effe1[_0x1f99a9(0x151)];_0xeda7fe[_0x3bd037++]=_0x479b85>>0x18&0xff,_0xeda7fe[_0x3bd037++]=_0x479b85>>0x10&0xff,_0xeda7fe[_0x3bd037++]=_0x479b85>>0x8&0xff,_0xeda7fe[_0x3bd037++]=_0x479b85&0xff,_0xeda7fe[_0x1f99a9(0xd6)](new Uint8Array(_0x2effe1),_0x3bd037),_0x3bd037+=_0x2effe1[_0x1f99a9(0x151)];const _0x3e31f3=_0x51c192[_0x1f99a9(0x151)];_0xeda7fe[_0x3bd037++]=_0x3e31f3>>0x18&0xff,_0xeda7fe[_0x3bd037++]=_0x3e31f3>>0x10&0xff,_0xeda7fe[_0x3bd037++]=_0x3e31f3>>0x8&0xff,_0xeda7fe[_0x3bd037++]=_0x3e31f3&0xff,_0xeda7fe[_0x1f99a9(0xd6)](new Uint8Array(_0x51c192),_0x3bd037),_0x3bd037+=_0x51c192[_0x1f99a9(0x151)];const _0x13e097=_0x5c2922[_0x1f99a9(0x151)];_0xeda7fe[_0x3bd037++]=_0x13e097>>0x18&0xff,_0xeda7fe[_0x3bd037++]=_0x13e097>>0x10&0xff,_0xeda7fe[_0x3bd037++]=_0x13e097>>0x8&0xff,_0xeda7fe[_0x3bd037++]=_0x13e097&0xff,_0xeda7fe['set'](new Uint8Array(_0x5c2922),_0x3bd037),_0x3bd037+=_0x5c2922['byteLength'],_0xeda7fe['set'](_0x2fa9ee,_0x3bd037),_0x3bd037+=_0x2fa9ee[_0x1f99a9(0x151)];const _0x15953e=_0x147910['byteLength'];return _0xeda7fe[_0x3bd037++]=_0x15953e>>0x18&0xff,_0xeda7fe[_0x3bd037++]=_0x15953e>>0x10&0xff,_0xeda7fe[_0x3bd037++]=_0x15953e>>0x8&0xff,_0xeda7fe[_0x3bd037++]=_0x15953e&0xff,_0xeda7fe['set'](new Uint8Array(_0x147910),_0x3bd037),_0x3bd037+=_0x147910[_0x1f99a9(0x151)],_0xeda7fe[_0x3bd037++]=_0x5f5213[_0x1f99a9(0x151)],_0xeda7fe[_0x1f99a9(0xd6)](_0x5f5213,_0x3bd037),{'version':0x2,'data':arrayBufferToBase64(_0xeda7fe[_0x1f99a9(0x93)])};}async function decryptMessage(){const _0x2e02ee=_0x11a23a;try{let _0x3c8f80;const _0x28ac4e=document['getElementById'](_0x2e02ee(0xa9))['value'],_0x92ee4e=document[_0x2e02ee(0x123)](_0x2e02ee(0x163))[_0x2e02ee(0x1f4)];if(!_0x28ac4e){showStatus(_0x2e02ee(0xbf),'Please\x20enter\x20an\x20encrypted\x20message\x20or\x20add\x20an\x20encrypted\x20file',_0x2e02ee(0x240));return;}if(!isValidEncryptedMessage(_0x28ac4e,_0x92ee4e)){showStatus(_0x2e02ee(0xbf),_0x2e02ee(0xe6),'error');return;}try{_0x3c8f80=parseEncryptedMessage(_0x28ac4e,_0x92ee4e);}catch(_0x278713){showStatus('decryptStatus','Invalid\x20encrypted\x20message\x20data:\x20'+_0x278713[_0x2e02ee(0xaa)],_0x2e02ee(0x240));return;}const _0xa202ae=document[_0x2e02ee(0x123)](_0x2e02ee(0x18f))[_0x2e02ee(0x1f4)],_0x147370=document[_0x2e02ee(0x123)](_0x2e02ee(0xf6))[_0x2e02ee(0x1f4)];if(!_0xa202ae){showStatus('decryptStatus',_0x2e02ee(0x14a),_0x2e02ee(0x240));return;}setLoading(!![]);const _0x571825=keys[_0x2e02ee(0x1e7)](_0x5651ac=>_0x5651ac['id']===_0xa202ae);if(!_0x571825){showStatus(_0x2e02ee(0xbf),_0x2e02ee(0x230),_0x2e02ee(0x240)),setLoading(![]);return;}let _0x1dd496=null,_0x326781=_0x571825;if(_0x571825['protected']){if(!_0x147370){showStatus(_0x2e02ee(0xbf),'Password\x20required\x20for\x20this\x20key',_0x2e02ee(0x240)),setLoading(![]);return;}try{_0x1dd496=await decryptKeyWithPassword(_0x571825,_0x147370),_0x326781=safeMemory['retrieve'](_0x1dd496);if(!_0x326781)throw new Error(_0x2e02ee(0x147));}catch(_0x30c3cd){showStatus('decryptStatus',_0x2e02ee(0xf2)+_0x30c3cd['message'],_0x2e02ee(0x240)),setLoading(![]);return;}}let _0x8184eb=await decryptData(_0x3c8f80,_0x326781),_0x510bf8,_0x10515d;_0x8184eb['data']?(_0x510bf8=_0x8184eb[_0x2e02ee(0x148)],_0x10515d=_0x8184eb[_0x2e02ee(0x1e8)]):(_0x510bf8=_0x8184eb,_0x10515d=null);_0x1dd496&&safeMemory[_0x2e02ee(0x107)](_0x1dd496);_0x92ee4e&&(_0x510bf8=xorCipher(_0x510bf8,_0x92ee4e));let _0x35ed20=![],_0x1f51f7=null,_0x429ca0=null;if(!_0x3c8f80[_0x2e02ee(0x15c)]&&_0x3c8f80['isFile']&&_0x3c8f80[_0x2e02ee(0x225)])_0x35ed20=!![],_0x1f51f7=_0x3c8f80[_0x2e02ee(0x225)],_0x429ca0=_0x3c8f80[_0x2e02ee(0x1c6)]||_0x510bf8['byteLength'];else _0x10515d&&_0x10515d['f']&&(_0x35ed20=!![],_0x1f51f7=_0x10515d['f']['n'],_0x429ca0=_0x10515d['f']['s']||_0x510bf8['byteLength']);if(_0x35ed20)document[_0x2e02ee(0x123)](_0x2e02ee(0x1fe))['value']=_0x2e02ee(0x25a)+_0x1f51f7+'\x20('+formatFileSize(_0x429ca0)+')',document[_0x2e02ee(0x123)]('downloadDecryptedBtn')[_0x2e02ee(0x198)](_0x2e02ee(0x1f0),_0x1f51f7),document[_0x2e02ee(0x123)]('downloadDecryptedBtn')[_0x2e02ee(0x198)](_0x2e02ee(0x15e),'true'),window['decryptedBinaryData']=_0x510bf8;else{const _0x1b25df=new TextDecoder()['decode'](_0x510bf8);document[_0x2e02ee(0x123)](_0x2e02ee(0x1fe))[_0x2e02ee(0x1f4)]=_0x1b25df,document[_0x2e02ee(0x123)]('downloadDecryptedBtn')[_0x2e02ee(0x198)]('data-filename','decrypted.txt'),document['getElementById'](_0x2e02ee(0x128))[_0x2e02ee(0x198)]('data-binary',_0x2e02ee(0xc6)),window[_0x2e02ee(0xad)]=null;}showStatus(_0x2e02ee(0xbf),_0x2e02ee(0x189),_0x2e02ee(0x23d));}catch(_0x5144d5){console['error'](_0x2e02ee(0x229),_0x5144d5),showStatus(_0x2e02ee(0xbf),_0x2e02ee(0x221)+_0x5144d5[_0x2e02ee(0xaa)],_0x2e02ee(0x240));}finally{document[_0x2e02ee(0x123)](_0x2e02ee(0xf6))[_0x2e02ee(0x1f4)]='',setLoading(![]);}}async function decryptWithAES(_0x3c7f40,_0x5ba179){const _0x356a20=_0x11a23a;try{const _0x4ad285=base64ToArrayBuffer(_0x3c7f40[_0x356a20(0x148)]),_0x10221f=new Uint8Array(_0x4ad285);let _0x356298=0x0;const _0x2c3118=_0x10221f[_0x356298++];if(_0x2c3118!==0x3)throw new Error('Unsupported\x20data\x20format\x20version');const _0x3d3bbd=_0x10221f['slice'](_0x356298,_0x356298+AES_CONFIG[_0x356a20(0x11e)]);_0x356298+=AES_CONFIG[_0x356a20(0x11e)];const _0x5e54fb=_0x10221f[_0x356298]<<0x18|_0x10221f[_0x356298+0x1]<<0x10|_0x10221f[_0x356298+0x2]<<0x8|_0x10221f[_0x356298+0x3];_0x356298+=0x4;const _0x51b372=_0x10221f['slice'](_0x356298,_0x356298+_0x5e54fb);_0x356298+=_0x5e54fb;const _0x354ab7=_0x10221f[_0x356298]<<0x18|_0x10221f[_0x356298+0x1]<<0x10|_0x10221f[_0x356298+0x2]<<0x8|_0x10221f[_0x356298+0x3];_0x356298+=0x4;const _0x49430a=_0x10221f[_0x356a20(0x172)](_0x356298,_0x356298+_0x354ab7);_0x356298+=_0x354ab7;const _0x2134c5=_0x10221f[_0x356a20(0x172)](_0x356298,_0x356298+AES_CONFIG[_0x356a20(0x11e)]);_0x356298+=AES_CONFIG[_0x356a20(0x11e)];const _0x47b2aa=_0x10221f[_0x356298]<<0x18|_0x10221f[_0x356298+0x1]<<0x10|_0x10221f[_0x356298+0x2]<<0x8|_0x10221f[_0x356298+0x3];_0x356298+=0x4;const _0x578c00=_0x10221f[_0x356a20(0x172)](_0x356298,_0x356298+_0x47b2aa),_0x4dac0b=await window['crypto']['subtle'][_0x356a20(0x1a0)](_0x356a20(0xff),_0x51b372,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG[_0x356a20(0x130)]},![],[_0x356a20(0xe5)]),_0x475922=await window[_0x356a20(0xb1)]['subtle'][_0x356a20(0xe5)]({'name':AES_CONFIG[_0x356a20(0x194)],'iv':_0x3d3bbd,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x4dac0b,_0x49430a),_0x3c4e67=new TextDecoder()[_0x356a20(0xe9)](_0x475922),_0x5c5fd0=JSON['parse'](_0x3c4e67);if(_0x5c5fd0['k']!==_0x5ba179['id'])throw new Error('Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message');let _0x3f3d40;if(_0x5ba179[_0x356a20(0x16a)])_0x3f3d40=_0x5ba179[_0x356a20(0x16a)];else{const _0x47c5df=base64ToArrayBuffer(_0x5ba179[_0x356a20(0xef)]);_0x3f3d40=await window[_0x356a20(0xb1)]['subtle'][_0x356a20(0x1a0)](_0x356a20(0xff),_0x47c5df,{'name':AES_CONFIG[_0x356a20(0x194)],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x356a20(0xe5)]);}return{'data':await window[_0x356a20(0xb1)][_0x356a20(0xaf)][_0x356a20(0xe5)]({'name':AES_CONFIG['MODE'],'iv':_0x2134c5,'tagLength':AES_CONFIG[_0x356a20(0x1b0)]},_0x3f3d40,_0x578c00),'metadata':_0x5c5fd0};}catch(_0x501f11){console[_0x356a20(0x240)](_0x356a20(0x186),_0x501f11);if(_0x501f11 instanceof DOMException)throw new Error('Decryption\x20failed:\x20'+_0x501f11[_0x356a20(0x12b)]+_0x356a20(0x1fc)+(_0x501f11[_0x356a20(0xaa)]||_0x356a20(0x126)));else throw new Error('Decryption\x20failed:\x20'+_0x501f11['message']);}}function isValidEncryptedMessage(_0x6d0590,_0x187ecb=''){const _0x5c42d9=_0x11a23a;let _0x50e0b4=SECURE_DELIMITER,_0x3e5031=reverseString(SECURE_DELIMITER);const _0x313254='@!',_0x2f8957='!@',_0x52b87e=escapeRegex(_0x50e0b4),_0x6ee96d=escapeRegex(_0x3e5031),_0x3819d2=escapeRegex(_0x313254),_0x100348=escapeRegex(_0x2f8957),_0x30c831='^.*?('+_0x52b87e+'|'+_0x3819d2+_0x5c42d9(0x182)+_0x6ee96d+'|'+_0x100348+').*$',_0x1a9ad4=new RegExp(_0x30c831);return _0x1a9ad4[_0x5c42d9(0x175)](_0x6d0590);}function createEncryptedMessageString(_0x204692,_0x1899ef=''){const _0x11b4f3=_0x11a23a,_0x4af607=SECURE_DELIMITER,_0x57d01a=reverseString(SECURE_DELIMITER),_0x5782bd=generateRandomString(0x20+Math[_0x11b4f3(0x88)](Math['random']()*0x21)),_0x10db0d=generateRandomString(0x20+Math[_0x11b4f3(0x88)](Math[_0x11b4f3(0x1af)]()*0x21)),_0x37153b=typeof _0x204692[_0x11b4f3(0x148)]===_0x11b4f3(0x1ea)?_0x204692['data'][_0x11b4f3(0x1be)](/[\r\n\s]*(.*?)[\r\n\s]*$/s,'$1'):_0x204692['data'];return _0x5782bd+_0x4af607+_0x37153b+_0x57d01a+_0x10db0d;}function parseEncryptedMessage(_0x15ac1c,_0x3578da=''){const _0x1368b8=_0x11a23a,_0x2f5f34=SECURE_DELIMITER,_0x334a43=reverseString(SECURE_DELIMITER),_0x9181fa='@!',_0x134774='!@',_0x507e84=escapeRegex(_0x2f5f34),_0x22d050=escapeRegex(_0x334a43),_0x35ad7b=escapeRegex(_0x9181fa),_0x1e743f=escapeRegex(_0x134774),_0x5de26a=_0x1368b8(0x119)+_0x507e84+'|'+_0x35ad7b+_0x1368b8(0x1ef)+_0x22d050+'|'+_0x1e743f+').*$',_0x222cd=new RegExp(_0x5de26a),_0x577026=_0x15ac1c[_0x1368b8(0x183)](_0x222cd);if(!_0x577026||!_0x577026[0x2])throw new Error('Invalid\x20encrypted\x20message\x20format.\x20Could\x20not\x20find\x20valid\x20delimiters.');const _0x244b23=_0x577026[0x2][_0x1368b8(0x9f)]();return{'version':0x2,'data':_0x244b23};}function updateEncryptionOutput(_0x21c659){return createEncryptedMessageString(_0x21c659);}function generateRandomString(_0x4caf5a=0x5){const _0x5c87b6=_0x11a23a,_0x3b5610=_0x5c87b6(0xf0);let _0x20e8b3='';for(let _0x3af24d=0x0;_0x3af24d<_0x4caf5a;_0x3af24d++){_0x20e8b3+=_0x3b5610[_0x5c87b6(0x252)](Math[_0x5c87b6(0x88)](Math[_0x5c87b6(0x1af)]()*_0x3b5610[_0x5c87b6(0xdf)]));}return _0x20e8b3;}function determineKeySecurityLevel(_0x6c072d){const _0x41deb0=_0x11a23a;let _0x2e41b6=_0x41deb0(0x1f3);if(_0x6c072d[_0x41deb0(0xca)]===_0x41deb0(0x205)||_0x6c072d[_0x41deb0(0xca)]===_0x41deb0(0xf4)||_0x6c072d[_0x41deb0(0xca)]==='ecc-p384')_0x2e41b6=_0x41deb0(0x1a1);else(_0x6c072d[_0x41deb0(0xca)]===_0x41deb0(0xe7)||_0x6c072d[_0x41deb0(0xca)]===_0x41deb0(0xa5))&&(_0x2e41b6='low');let _0x2c0f1a=0x0;_0x6c072d[_0x41deb0(0x190)]&&(_0x2c0f1a+=0x2);_0x6c072d[_0x41deb0(0xca)]!==_0x41deb0(0x205)&&(_0x6c072d[_0x41deb0(0x12c)]&&_0x6c072d[_0x41deb0(0xc5)]&&(_0x2c0f1a+=0x1));_0x6c072d[_0x41deb0(0x209)]&&(_0x2c0f1a+=0x1);let _0x228488;if(_0x2e41b6===_0x41deb0(0x1a1)){if(_0x2c0f1a>=0x3)_0x228488='high';else _0x2c0f1a>=0x1?_0x228488=_0x41deb0(0x1a1):_0x228488=_0x41deb0(0x1f3);}else{if(_0x2c0f1a>=0x4)_0x228488=_0x41deb0(0x127);else _0x2c0f1a>=0x2?_0x228488=_0x41deb0(0x1a1):_0x228488='low';}return _0x228488;}async function decryptWithRSA(_0x1d8552,_0xf90611){const _0xee47df=_0x11a23a;if(!_0x1d8552['version']||_0x1d8552[_0xee47df(0x15c)]===0x1){const _0x501a0e=base64ToArrayBuffer(_0x1d8552['data']),_0x33475a=base64ToArrayBuffer(_0x1d8552['encryptedKey']),_0x101069=base64ToArrayBuffer(_0x1d8552['iv']);let _0x253c9f;if(_0xf90611[_0xee47df(0x12f)])_0x253c9f=_0xf90611[_0xee47df(0x12f)];else{const _0x5d05b3=base64ToArrayBuffer(_0xf90611[_0xee47df(0x13c)]);_0x253c9f=await importRSAPrivateKey(_0x5d05b3,_0x1d8552[_0xee47df(0x1a7)]||_0xf90611[_0xee47df(0xdf)]||RSA_CONFIG['KEY_SIZE']);}const _0x1dc0e9=await window[_0xee47df(0xb1)][_0xee47df(0xaf)][_0xee47df(0xe5)]({'name':RSA_CONFIG['ALGORITHM']},_0x253c9f,_0x33475a),_0xdc3d40=await importAESKey(_0x1dc0e9);return await window[_0xee47df(0xb1)][_0xee47df(0xaf)]['decrypt']({'name':AES_CONFIG[_0xee47df(0x194)],'iv':_0x101069,'tagLength':AES_CONFIG['TAG_LENGTH']},_0xdc3d40,_0x501a0e);}else{const _0x1fe356=base64ToArrayBuffer(_0x1d8552[_0xee47df(0x148)]),_0x300fbd=new Uint8Array(_0x1fe356);let _0x2e9d6e=0x0;const _0x27fae9=_0x300fbd[_0x2e9d6e++],_0x1e3f0f=_0x300fbd['slice'](_0x2e9d6e,_0x2e9d6e+_0x27fae9);_0x2e9d6e+=_0x27fae9;const _0x487113=_0x300fbd[_0x2e9d6e]<<0x18|_0x300fbd[_0x2e9d6e+0x1]<<0x10|_0x300fbd[_0x2e9d6e+0x2]<<0x8|_0x300fbd[_0x2e9d6e+0x3];_0x2e9d6e+=0x4;const _0x259cc1=_0x300fbd[_0xee47df(0x172)](_0x2e9d6e,_0x2e9d6e+_0x487113);_0x2e9d6e+=_0x487113;const _0x1757d6=_0x300fbd[_0x2e9d6e]<<0x18|_0x300fbd[_0x2e9d6e+0x1]<<0x10|_0x300fbd[_0x2e9d6e+0x2]<<0x8|_0x300fbd[_0x2e9d6e+0x3];_0x2e9d6e+=0x4;const _0x56588d=_0x300fbd['slice'](_0x2e9d6e,_0x2e9d6e+_0x1757d6);_0x2e9d6e+=_0x1757d6;const _0x1e56f4=_0x300fbd[_0x2e9d6e]<<0x18|_0x300fbd[_0x2e9d6e+0x1]<<0x10|_0x300fbd[_0x2e9d6e+0x2]<<0x8|_0x300fbd[_0x2e9d6e+0x3];_0x2e9d6e+=0x4;const _0x199711=_0x300fbd[_0xee47df(0x172)](_0x2e9d6e,_0x2e9d6e+_0x1e56f4);_0x2e9d6e+=_0x1e56f4;const _0x300675=_0x300fbd[_0xee47df(0x172)](_0x2e9d6e,_0x2e9d6e+AES_CONFIG[_0xee47df(0x11e)]);_0x2e9d6e+=AES_CONFIG[_0xee47df(0x11e)];const _0x1823bb=_0x300fbd[_0x2e9d6e]<<0x18|_0x300fbd[_0x2e9d6e+0x1]<<0x10|_0x300fbd[_0x2e9d6e+0x2]<<0x8|_0x300fbd[_0x2e9d6e+0x3];_0x2e9d6e+=0x4;const _0x2664e8=_0x300fbd[_0xee47df(0x172)](_0x2e9d6e,_0x2e9d6e+_0x1823bb);let _0x2d05b1;if(_0xf90611[_0xee47df(0x12f)])_0x2d05b1=_0xf90611[_0xee47df(0x12f)];else{const _0x5bc7af=base64ToArrayBuffer(_0xf90611[_0xee47df(0x13c)]);_0x2d05b1=await importRSAPrivateKey(_0x5bc7af,_0xf90611[_0xee47df(0xdf)]||RSA_CONFIG['KEY_SIZE']);}const _0x2d2db7=await window[_0xee47df(0xb1)][_0xee47df(0xaf)][_0xee47df(0xe5)]({'name':RSA_CONFIG[_0xee47df(0x129)]},_0x2d05b1,_0x199711),_0x2f28dc=await window[_0xee47df(0xb1)][_0xee47df(0xaf)]['importKey']('raw',_0x259cc1,{'name':AES_CONFIG[_0xee47df(0x194)],'length':_0x487113*0x8},![],[_0xee47df(0xe5)]),_0x23a5b1=await window[_0xee47df(0xb1)]['subtle'][_0xee47df(0xe5)]({'name':AES_CONFIG['MODE'],'iv':_0x1e3f0f,'tagLength':AES_CONFIG[_0xee47df(0x1b0)]},_0x2f28dc,_0x56588d),_0x31f939=new TextDecoder()[_0xee47df(0xe9)](_0x23a5b1),_0x18bd8b=JSON[_0xee47df(0x1ec)](_0x31f939);if(_0x18bd8b['k']!==_0xf90611['id'])throw new Error(_0xee47df(0x14f));const _0x4068a1=await importAESKey(_0x2d2db7);return{'data':await window[_0xee47df(0xb1)][_0xee47df(0xaf)]['decrypt']({'name':AES_CONFIG[_0xee47df(0x194)],'iv':_0x300675,'tagLength':AES_CONFIG[_0xee47df(0x1b0)]},_0x4068a1,_0x2664e8),'metadata':_0x18bd8b};}}function _0x54a4(){const _0x1b71c1=['Key\x20expiration\x20is\x20required\x20by\x20your\x20security\x20settings','writeText','delete','LemonadeSecureDB','pkcs8','encode','exportPrivateKey','encryptFileName','Error\x20reading\x20the\x20state\x20file','exportKey','pbkdf2Iterations','matches','disabled','push','then','settings','encrypt','loadingOverlay','ECDH+AES-GCM','serviceWorker','^.*?(','File\x20downloaded\x20successfully','Unsupported\x20key\x20type','AES\x20encryption\x20error:','Manual\x20garbage\x20collection\x20not\x20available','IV_LENGTH','readAsArrayBuffer','RSA-4096','innerHTML','generateKey','getElementById','\x22\x20downloaded\x20successfully','confirmKeyPassword','Unknown\x20WebCrypto\x20error','high','downloadDecryptedBtn','ALGORITHM','<div\x20class=\x22key-expiry\x22>Expires\x20in\x20','name','hasPublic','<option\x20value=\x22\x22>Select\x20a\x20key...</option>','Lemonade\x20is\x20running\x20as\x20an\x20installed\x20app','_privateKey','KEY_LENGTH','info','stringify','941ewSnfP','2lIOmAz','removeEncryptFile','readonly','pairedKeyId','focus','status','<p>No\x20keys\x20available.\x20Generate\x20or\x20import\x20a\x20key\x20to\x20get\x20started.</p>','CURVE_P384','privateKey','toUpperCase','useIndexedDB','Error\x20saving\x20keys:\x20','decryptBtn','Error\x20saving\x20settings:','All\x20keys\x20cleared\x20from\x20database','encryptFileInput','generateKeyBtn','click','salt','Failed\x20to\x20retrieve\x20decrypted\x20key\x20from\x20memory.','data','weak','Please\x20select\x20a\x20decryption\x20key','decryptFileInfo','3879124XSnUbT','passwordModalConfirm','Export\x20error:','Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message','Private\x20key\x20\x22','byteLength','\x20key\x20\x22','data-tab','feedback','SHA-256','Warning:\x20Exporting\x20a\x20private\x20key\x20without\x20password\x20protection\x20is\x20a\x20security\x20risk.\x20Continue\x20anyway?','retrieve','AES-GCM','querySelectorAll','Modern\x20clipboard\x20API\x20failed:','includes','version','encryptionPassword','data-binary','keyExpiry','Public\x20key\x20\x22','Database\x20initialization\x20failed.\x20Using\x20less\x20secure\x20localStorage\x20instead.','created','decryptObfKey','207AbmQGR','\x20exported\x20as\x20','All\x20keys\x20(','keys','Protected\x20Private\x20Key','importStateBtn','_cryptoKey','encryptedOutput','541188KjDwjt','filter','Enter\x20the\x20current\x20key\x20password\x20to\x20continue:','CURVE','file:','readwrite','slice','Unable\x20to\x20read\x20the\x20file.','href','test','onupgradeneeded','deleteKey','fromCharCode','.install-note','This\x20appears\x20to\x20be\x20the\x20','P-256','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22deleteKey(\x27','Lemonade\x20was\x20installed','KEY_SIZE','No\x20decrypted\x20data\x20to\x20download','WARNING:\x20Exporting\x20keys\x20without\x20a\x20password\x20is\x20not\x20secure.\x20Anyone\x20with\x20access\x20to\x20this\x20file\x20will\x20be\x20able\x20to\x20use\x20your\x20keys.\x20Continue\x20anyway?','curve',')[\x5cs\x5cS]+?(','match','public','file','AES\x20Decryption\x20error:','createElement','\x20key\x20part.\x20Security\x20level:\x20','Message\x20decrypted\x20successfully','strengthCategory','private','\x22?\x20This\x20action\x20cannot\x20be\x20undone.','ECDH','Import\x20error:\x20','decryptionKey','protected','style','keyStatus','HASH','MODE','3468045TVvLnT','\x20bits','No\x20keys\x20to\x20delete','setAttribute','passwordModalTitle','Strong\x20-\x20Good\x20password!','Only\x20export\x20private\x20keys\x20if\x20you\x20absolutely\x20need\x20to\x20use\x20them\x20on\x20another\x20device.\x20','4582485ALMJac','Encryption\x20error:','ECC-P384','Encryption\x20error:\x20','importKey','medium','appinstalled','Database\x20not\x20initialized','charCodeAt','Please\x20use\x20a\x20stronger\x20password:\x20','decrypted.txt','keySize','Do\x20you\x20want\x20to\x20continue?','revokeObjectURL','P-384',')\x20have\x20been\x20permanently\x20deleted','\x22\x20imported\x20successfully','enforceKeyExpiry','getAttribute','random','TAG_LENGTH','querySelector','contains','Missing\x20encrypted\x20private\x20key\x20data','decryptBrowseBtn','encryptFileInfo','getDate','ephemeralPublicKey','function','deriveBits','PBKDF2','warning','Escape','passwordModalMessage','replace','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','keyName','public\x20key','(display-mode:\x20standalone)','copyEncryptedBtn','endsWith','Enter\x20Current\x20Password','fileSize','score','algorithm','timeoutTimer','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20private\x20key','split','Error\x20loading\x20keys:\x20','join','toLocaleString','keypress','AES','keyFileInput','Please\x20enter\x20a\x20message\x20or\x20add\x20a\x20file\x20to\x20encrypt','Password\x20entry\x20cancelled','toLowerCase','spki','Encryption\x20failed:\x20','\x27)\x22>Delete</button>','.tab-btn','indexedDB','get','This\x20.lem\x20file\x20does\x20not\x20contain\x20a\x20private\x20key','\x20expired\x20key(s)\x20removed\x20for\x20security','Key\x20name\x20can\x20only\x20contain\x20letters,\x20numbers,\x20spaces,\x20and\x20basic\x20punctuation\x20(._-)','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','DOMContentLoaded','active','clearClipboard','publicKeyHash','decryptionPasswordGroup','zeroKeysBtn','_publicKey','Session-only\x20mode:\x20Keys\x20not\x20saved\x20persistently','find','metadata','ECDH+','string','decryptFileName','parse','Missing\x20required\x20key\x20properties','min',')([\x5cs\x5cS]+?)(','data-filename','2101218tMhgbQ','put','low','value','8PHmBKC','enforcePwdProtection','passwordModalStrength','private\x20key','LemonadeSettings','protocol','preventDefault','\x20-\x20','\x22\x20already\x20exists.\x20Overwrite?','decryptedOutput','.lmn','Enter','store','Installation\x20not\x20available\x20in\x20this\x20browser\x20or\x20app\x20is\x20already\x20installed','Incorrect\x20password\x20or\x20corrupted\x20private\x20key','HKDF','aes','sanitizeHTML','State\x20import\x20error:','Tab\x20button\x20clicked:','expiry','clear','add','load','application/octet-stream','result','Application\x20state\x20with\x20','classList','Error\x20saving\x20settings:\x20','Application\x20state\x20exported\x20successfully','encryptMessage','size','clearEncryptedMessageBtn','files','\x20[Full\x20Pair]','Error\x20generating\x20key:\x20','text','passwordModalFeedback','1042430CDtsWi','Switching\x20to\x20tab:','readAsText','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Created:\x20','Installation\x20is\x20now\x20available!','Bytes','Decryption\x20error:\x20','\x20file','matchMedia','passwordFeedback','fileName','measurePasswordStrength','app-settings','.lim','Decryption\x20error:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-item-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','location','toISOString','prompt','Nothing\x20to\x20copy','strong','Key\x20not\x20found','ITERATIONS','Error\x20clearing\x20keys\x20from\x20database:','This\x20state\x20file\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import:','Password\x20protection\x20is\x20required\x20by\x20your\x20security\x20settings','passwordStrength','\x20days\x20(','catch','passwordModalInput','encryptStatus','onsuccess','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22exportKey(\x27','.state,application/octet-stream','success','Service\x20Worker\x20registration\x20failed.\x20PWA\x20features\x20unavailable.','This\x20.lim\x20file\x20does\x20not\x20contain\x20a\x20public\x20key','error','Database\x20error:','remove','sensitiveData','c1a9f5d3-c2a8-4c6f-8b1e-3e4d5a6b7c8d','App\x20is\x20already\x20running\x20in\x20standalone\x20mode\x20(installed)','https:','deriveKey','<button\x20class=\x22btn-secondary\x20private-key-btn\x22\x20onclick=\x22exportPrivateKey(\x27','Settings\x20saved\x20successfully','textContent','Invalid\x20key\x20name\x20format','checked','darkMode','\x22\x20imported\x20as\x20separate\x20key','onerror','target','Lemonade\x20has\x20been\x20installed\x20successfully!','charAt','Are\x20you\x20sure\x20you\x20want\x20to\x20reset\x20all\x20settings\x20to\x20defaults?','stateFileInput','\x20ðŸ”’','passwordModalCancel','Service\x20Worker\x20registration\x20failed:','change','PWA\x20installation\x20requires\x20HTTPS.\x20You\x20are\x20viewing\x20this\x20file\x20locally.','File:\x20','password-strength','Error\x20loading\x20keys:','div','LemonadeKeys','clearEncryptMessageBtn','Error\x20reading\x20the\x20key\x20file','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20state\x20file','floor','<span\x20class=\x22key-pair-badge\x20full\x22>FULL\x20KEY\x20PAIR</span>','.tab-content','Export\x20error:\x20','Please\x20select\x20an\x20encryption\x20key','dark-mode','createObjectStore','passwordModal','clearDecryptBtn','input','addEventListener','buffer','display','ecc-p384','importKeyBtn','digest','scope','encryptObfKey','encryptionKey','exportAllKeysBtn','Service\x20Worker\x20registered\x20with\x20scope:','Message\x20encrypted\x20successfully','transaction','trim','getRandomValues','\x5c$&','sw.js','Key\x20\x22','option','ecc','RSA-OAEP+AES-GCM','127.0.0.1','randomUUID','encryptedMessage','message','none','ceil','decryptedBinaryData','Your\x20browser\x20doesn\x27t\x20support\x20secure\x20storage.\x20Using\x20less\x20secure\x20localStorage\x20instead.','subtle','sessionOnly','crypto','encryptionPasswordGroup','setDate','body','Base64\x20decoding\x20error:','Import\x20error:','objectStoreNames','Invalid\x20key\x20file\x20format','No\x20keys\x20available\x20to\x20export','has','flex','<span\x20class=\x22security-badge\x20','\x20[Public]','State\x20import\x20error:\x20','decryptStatus','clearEncryptBtn','Key\x20data\x20and\x20password\x20are\x20required','Invalid\x20state\x20file\x20format','keysList','keyPassword','hasPrivate','false','This\x20key\x20does\x20not\x20have\x20a\x20private\x20key\x20component\x20to\x20export','Symmetric\x20key\x20\x22','className','type','keyType','appendChild','Password\x20required\x20for\x20this\x20key','register','\x27)\x22>Export</button>','User\x20response\x20to\x20install\x20prompt:\x20','WARNING:\x20Exporting\x20a\x20private\x20key\x20is\x20a\x20security\x20risk.\x20','No\x20encrypted\x20data\x20to\x20download','objectStore','onload','removeChild','set','encryptBtn','\x27)\x22>Private\x20Key</button>','RSA-OAEP','_importPassword','publicKey','download','status\x20','forEach','length','LemonadeProtectedBackup','Service\x20Workers\x20not\x20supported\x20or\x20not\x20in\x20secure\x20context','Secure\x20Your\x20Key\x20Backup','Copied\x20to\x20clipboard','.lem','decrypt','Invalid\x20encrypted\x20message\x20format\x20or\x20OBF\x20Key\x20mismatch','rsa','Invalid\x20state\x20data\x20format','decode','beforeinstallprompt','getItem','Your\x20browser\x20does\x20not\x20support\x20PWA\x20installation\x20features.','decrypted_file','WARNING:\x20This\x20will\x20permanently\x20delete\x20ALL\x20your\x20encryption\x20keys.\x20This\x20action\x20CANNOT\x20be\x20undone.\x0a\x0aAre\x20you\x20absolutely\x20sure\x20you\x20want\x20to\x20continue?','key','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','isValidKeyName','Failed\x20to\x20decrypt\x20key:\x20','confirm','rsa-4096','keydown','decryptionPassword','installStatus','accept','encryptBrowseBtn','clipboard','createObjectURL','installBtn','findIndex','downloadEncryptedBtn','raw','RSA-2048','true','userChoice','setItem','log'];_0x54a4=function(){return _0x1b71c1;};return _0x54a4();}async function decryptWithECC(_0x2348cd,_0xd5e5d5){const _0x22497f=_0x11a23a;if(!_0x2348cd[_0x22497f(0x15c)]||_0x2348cd[_0x22497f(0x15c)]===0x1){const _0x21a0aa=base64ToArrayBuffer(_0x2348cd[_0x22497f(0x148)]),_0x4747b3=base64ToArrayBuffer(_0x2348cd[_0x22497f(0x1b7)]),_0x5d639d=base64ToArrayBuffer(_0x2348cd['iv']),_0x4b0d62=await importECCPublicKey(_0x4747b3,_0x2348cd[_0x22497f(0x181)]||ECC_CONFIG[_0x22497f(0x16f)]);let _0x47f3a4;if(_0xd5e5d5[_0x22497f(0x12f)])_0x47f3a4=_0xd5e5d5[_0x22497f(0x12f)];else{const _0x3c30d9=base64ToArrayBuffer(_0xd5e5d5['privateKey']);_0x47f3a4=await importECCPrivateKey(_0x3c30d9,_0x2348cd[_0x22497f(0x181)]||ECC_CONFIG[_0x22497f(0x16f)]);}const _0x332875=await window[_0x22497f(0xb1)][_0x22497f(0xaf)][_0x22497f(0x247)]({'name':_0x22497f(0x18d),'public':_0x4b0d62},_0x47f3a4,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x22497f(0xe5)]);return await window[_0x22497f(0xb1)]['subtle'][_0x22497f(0xe5)]({'name':AES_CONFIG[_0x22497f(0x194)],'iv':_0x5d639d,'tagLength':AES_CONFIG[_0x22497f(0x1b0)]},_0x332875,_0x21a0aa);}else{const _0x25b1d6=base64ToArrayBuffer(_0x2348cd['data']),_0x526f58=new Uint8Array(_0x25b1d6);let _0x31493a=0x0;const _0x243741=_0x526f58[_0x31493a++],_0x51ad05=_0x526f58[_0x22497f(0x172)](_0x31493a,_0x31493a+_0x243741);_0x31493a+=_0x243741;const _0x28699e=_0x526f58[_0x31493a]<<0x18|_0x526f58[_0x31493a+0x1]<<0x10|_0x526f58[_0x31493a+0x2]<<0x8|_0x526f58[_0x31493a+0x3];_0x31493a+=0x4;const _0x5afe98=_0x526f58[_0x22497f(0x172)](_0x31493a,_0x31493a+_0x28699e);_0x31493a+=_0x28699e;const _0x1b6f12=_0x526f58[_0x31493a]<<0x18|_0x526f58[_0x31493a+0x1]<<0x10|_0x526f58[_0x31493a+0x2]<<0x8|_0x526f58[_0x31493a+0x3];_0x31493a+=0x4;const _0x2fa031=_0x526f58[_0x22497f(0x172)](_0x31493a,_0x31493a+_0x1b6f12);_0x31493a+=_0x1b6f12;const _0x54983a=_0x526f58[_0x31493a]<<0x18|_0x526f58[_0x31493a+0x1]<<0x10|_0x526f58[_0x31493a+0x2]<<0x8|_0x526f58[_0x31493a+0x3];_0x31493a+=0x4;const _0x2ee3a8=_0x526f58[_0x22497f(0x172)](_0x31493a,_0x31493a+_0x54983a);_0x31493a+=_0x54983a;const _0x346878=_0x526f58[_0x22497f(0x172)](_0x31493a,_0x31493a+AES_CONFIG[_0x22497f(0x11e)]);_0x31493a+=AES_CONFIG['IV_LENGTH'];const _0x67b0e3=_0x526f58[_0x31493a]<<0x18|_0x526f58[_0x31493a+0x1]<<0x10|_0x526f58[_0x31493a+0x2]<<0x8|_0x526f58[_0x31493a+0x3];_0x31493a+=0x4;const _0x5c435b=_0x526f58[_0x22497f(0x172)](_0x31493a,_0x31493a+_0x67b0e3),_0x3509e8=await importECCPublicKey(_0x2ee3a8,_0xd5e5d5[_0x22497f(0x181)]||ECC_CONFIG[_0x22497f(0x16f)]);let _0x2e9739;if(_0xd5e5d5[_0x22497f(0x12f)])_0x2e9739=_0xd5e5d5[_0x22497f(0x12f)];else{const _0x11331b=base64ToArrayBuffer(_0xd5e5d5[_0x22497f(0x13c)]);_0x2e9739=await importECCPrivateKey(_0x11331b,_0xd5e5d5['curve']||ECC_CONFIG[_0x22497f(0x16f)]);}const _0x263e40=await window['crypto'][_0x22497f(0xaf)][_0x22497f(0x1b9)]({'name':'ECDH','public':_0x3509e8},_0x2e9739,0x100),_0x23fb59=await window[_0x22497f(0xb1)][_0x22497f(0xaf)][_0x22497f(0x1a0)]('raw',_0x263e40,{'name':AES_CONFIG[_0x22497f(0x194)],'length':AES_CONFIG['KEY_LENGTH']},![],['decrypt']),_0x197794=await window['crypto']['subtle'][_0x22497f(0x1a0)](_0x22497f(0xff),_0x5afe98,{'name':AES_CONFIG[_0x22497f(0x194)],'length':_0x28699e*0x8},![],[_0x22497f(0xe5)]),_0x4f9093=await window[_0x22497f(0xb1)][_0x22497f(0xaf)][_0x22497f(0xe5)]({'name':AES_CONFIG['MODE'],'iv':_0x51ad05,'tagLength':AES_CONFIG[_0x22497f(0x1b0)]},_0x197794,_0x2fa031),_0xe684ef=new TextDecoder()[_0x22497f(0xe9)](_0x4f9093),_0x381b96=JSON[_0x22497f(0x1ec)](_0xe684ef);if(_0x381b96['k']!==_0xd5e5d5['id'])throw new Error(_0x22497f(0x14f));return{'data':await window[_0x22497f(0xb1)]['subtle'][_0x22497f(0xe5)]({'name':AES_CONFIG[_0x22497f(0x194)],'iv':_0x346878,'tagLength':AES_CONFIG[_0x22497f(0x1b0)]},_0x23fb59,_0x5c435b),'metadata':_0x381b96};}}function reverseString(_0x38120b){const _0x2cd5d0=_0x11a23a;if(typeof _0x38120b!==_0x2cd5d0(0x1ea))return'';return _0x38120b[_0x2cd5d0(0x1cb)]('')['reverse']()[_0x2cd5d0(0x1cd)]('');}function downloadEncryptedFile(){const _0x1a9fc1=_0x11a23a,_0x273593=document[_0x1a9fc1(0x123)]('encryptedOutput')[_0x1a9fc1(0x1f4)];if(!_0x273593){showStatus(_0x1a9fc1(0x239),_0x1a9fc1(0xd2),_0x1a9fc1(0x240));return;}const _0x1c81d2=document[_0x1a9fc1(0x123)](_0x1a9fc1(0xfe))[_0x1a9fc1(0x1ae)](_0x1a9fc1(0x1f0))||generateRandomFileName(0x6)+_0x1a9fc1(0x1ff),_0x4f2c69=new Blob([_0x273593],{'type':'application/octet-stream'});downloadBlob(_0x4f2c69,_0x1c81d2),showStatus(_0x1a9fc1(0x239),'File\x20\x22'+_0x1c81d2+_0x1a9fc1(0x124),_0x1a9fc1(0x23d));}function downloadDecryptedFile(){const _0x3f34b9=_0x11a23a;if(window[_0x3f34b9(0xad)]){const _0xad993d=document['getElementById']('downloadDecryptedBtn')[_0x3f34b9(0x1ae)](_0x3f34b9(0x1f0))||_0x3f34b9(0xed),_0x44ac9e=new Blob([window['decryptedBinaryData']],{'type':_0x3f34b9(0x20d)});downloadBlob(_0x44ac9e,_0xad993d);}else{const _0x62ea15=document[_0x3f34b9(0x123)](_0x3f34b9(0x1fe))['value'];if(!_0x62ea15){showStatus(_0x3f34b9(0xbf),_0x3f34b9(0x17f),_0x3f34b9(0x240));return;}const _0x5a2ee5=document[_0x3f34b9(0x123)](_0x3f34b9(0x128))[_0x3f34b9(0x1ae)](_0x3f34b9(0x1f0))||_0x3f34b9(0x1a6),_0x467f13=new Blob([_0x62ea15],{'type':_0x3f34b9(0x20d)});downloadBlob(_0x467f13,_0x5a2ee5);}showStatus(_0x3f34b9(0xbf),_0x3f34b9(0x11a),_0x3f34b9(0x23d));}function downloadBlob(_0x5336e5,_0x330ce9){const _0x35d39f=_0x11a23a,_0x145a50=URL[_0x35d39f(0xfb)](_0x5336e5),_0x12857e=document['createElement']('a');_0x12857e['href']=_0x145a50,_0x12857e['download']=_0x330ce9,document['body'][_0x35d39f(0xcc)](_0x12857e),_0x12857e[_0x35d39f(0x145)](),document[_0x35d39f(0xb4)][_0x35d39f(0xd5)](_0x12857e),URL[_0x35d39f(0x1a9)](_0x145a50);}function importKey(){const _0x399d65=_0x11a23a,_0x29206e=createKeyFileInput();_0x29206e[_0x399d65(0x145)]();}async function exportKey(_0x8c4bb9,_0x21be1b=![]){const _0x36cb38=_0x11a23a;try{const _0x36bacd=keys[_0x36cb38(0x1e7)](_0x5de7bf=>_0x5de7bf['id']===_0x8c4bb9);if(!_0x36bacd){alert('Key\x20not\x20found');return;}const _0x8eef90=_0x36bacd['type']===_0x36cb38(0xe7)||_0x36bacd[_0x36cb38(0xca)]===_0x36cb38(0xf4)||_0x36bacd['type']===_0x36cb38(0xa5)||_0x36bacd[_0x36cb38(0xca)]==='ecc-p384';let _0x30d825=_0x36bacd,_0x4b9fe8=_0x36cb38(0x228);if(_0x8eef90&&_0x21be1b){let _0x43bd2a='';try{_0x43bd2a=await showPasswordModal('Secure\x20Your\x20Private\x20Key','Please\x20enter\x20a\x20password\x20to\x20protect\x20this\x20private\x20key:',!![]);}catch(_0x338125){return;}if(!_0x43bd2a){if(!confirm(_0x36cb38(0x156)))return;}_0x30d825={'id':_0x36bacd['id'],'name':_0x36bacd[_0x36cb38(0x12b)],'type':_0x36bacd[_0x36cb38(0xca)],'created':_0x36bacd[_0x36cb38(0x162)],'expiry':_0x36bacd[_0x36cb38(0x209)],'privateKey':_0x36bacd[_0x36cb38(0x13c)],'protected':_0x36bacd[_0x36cb38(0x190)],'salt':_0x36bacd[_0x36cb38(0x146)],'iv':_0x36bacd['iv'],'algorithm':_0x36bacd[_0x36cb38(0x1c8)],'hasPrivate':!![],'hasPublic':![],'pairedKeyId':_0x36bacd['id'],'publicKeyHash':_0x36bacd[_0x36cb38(0x1e2)]};if(_0x36bacd[_0x36cb38(0xca)]===_0x36cb38(0xe7)||_0x36bacd['type']==='rsa-4096')_0x30d825[_0x36cb38(0xdf)]=_0x36bacd[_0x36cb38(0xdf)];else(_0x36bacd[_0x36cb38(0xca)]===_0x36cb38(0xa5)||_0x36bacd[_0x36cb38(0xca)]===_0x36cb38(0x95))&&(_0x30d825['curve']=_0x36bacd[_0x36cb38(0x181)]);if(_0x43bd2a){if(_0x36bacd[_0x36cb38(0x190)])try{const _0x220a8e=await showPasswordModal(_0x36cb38(0x1c5),_0x36cb38(0x16e),![]),_0x5b8a9f=await decryptKeyWithPassword(_0x36bacd,_0x220a8e),_0x3095b2=safeMemory[_0x36cb38(0x157)](_0x5b8a9f,!![]);_0x30d825[_0x36cb38(0x13c)]=_0x3095b2['privateKey'],_0x30d825[_0x36cb38(0x190)]=![];}catch(_0x1fb87b){showStatus(_0x36cb38(0x192),'Export\x20cancelled:\x20'+_0x1fb87b['message'],'error');return;}await encryptKeyWithPassword(_0x30d825,_0x43bd2a);}_0x4b9fe8=_0x36cb38(0xe4);}else{if(_0x8eef90&&!_0x21be1b){_0x30d825={'id':_0x36bacd['id'],'name':_0x36bacd[_0x36cb38(0x12b)],'type':_0x36bacd[_0x36cb38(0xca)],'created':_0x36bacd[_0x36cb38(0x162)],'expiry':_0x36bacd['expiry'],'publicKey':_0x36bacd[_0x36cb38(0xdb)],'algorithm':_0x36bacd[_0x36cb38(0x1c8)],'hasPublic':!![],'hasPrivate':![],'pairedKeyId':_0x36bacd['id'],'publicKeyHash':_0x36bacd[_0x36cb38(0x1e2)]};if(_0x36bacd[_0x36cb38(0xca)]==='rsa'||_0x36bacd[_0x36cb38(0xca)]===_0x36cb38(0xf4))_0x30d825[_0x36cb38(0xdf)]=_0x36bacd[_0x36cb38(0xdf)];else(_0x36bacd[_0x36cb38(0xca)]==='ecc'||_0x36bacd['type']==='ecc-p384')&&(_0x30d825['curve']=_0x36bacd[_0x36cb38(0x181)]);}}const _0xef55e2=JSON[_0x36cb38(0x132)](_0x30d825),_0x512a1c=btoa(_0xef55e2),_0x45b05a=new Blob([_0x512a1c],{'type':_0x36cb38(0x20d)}),_0x3b899f=URL[_0x36cb38(0xfb)](_0x45b05a),_0x53160e=document[_0x36cb38(0x187)]('a');_0x53160e[_0x36cb38(0x174)]=_0x3b899f,_0x53160e[_0x36cb38(0xdc)]=''+_0x36bacd[_0x36cb38(0x12b)]['replace'](/[^a-z0-9]/gi,'_')+_0x4b9fe8,document[_0x36cb38(0xb4)][_0x36cb38(0xcc)](_0x53160e),_0x53160e['click'](),document[_0x36cb38(0xb4)]['removeChild'](_0x53160e),URL[_0x36cb38(0x1a9)](_0x3b899f);const _0x2347a6=_0x21be1b?_0x36cb38(0x1f8):_0x8eef90?_0x36cb38(0x1c1):'key';showStatus(_0x36cb38(0x192),_0x36cb38(0xa3)+_0x36bacd[_0x36cb38(0x12b)]+'\x22\x20'+_0x2347a6+_0x36cb38(0x165)+_0x4b9fe8+_0x36cb38(0x222),_0x36cb38(0x23d));}catch(_0x4a7f99){console['error'](_0x36cb38(0x14e),_0x4a7f99),showStatus('keyStatus',_0x36cb38(0x8b)+_0x4a7f99[_0x36cb38(0xaa)],_0x36cb38(0x240));}}async function exportPrivateKey(_0x37d623){const _0x2e1986=_0x11a23a,_0x32c099=keys[_0x2e1986(0x1e7)](_0xc1dd55=>_0xc1dd55['id']===_0x37d623);if(!_0x32c099){alert(_0x2e1986(0x230));return;}if(!_0x32c099[_0x2e1986(0xc5)]){showStatus(_0x2e1986(0x192),_0x2e1986(0xc7),'error');return;}const _0x2f17c9=confirm(_0x2e1986(0xd1)+_0x2e1986(0x19b)+_0x2e1986(0x1a8));_0x2f17c9&&await exportKey(_0x37d623,!![]);}function createKeyFileInput(){const _0x35d4dd=_0x11a23a;let _0xc6cff8=document['getElementById'](_0x35d4dd(0x1d1));return!_0xc6cff8&&(_0xc6cff8=document[_0x35d4dd(0x187)](_0x35d4dd(0x91)),_0xc6cff8[_0x35d4dd(0xca)]=_0x35d4dd(0x185),_0xc6cff8['id']=_0x35d4dd(0x1d1),_0xc6cff8[_0x35d4dd(0xf8)]='.lim,.lem',_0xc6cff8[_0x35d4dd(0x191)]['display']=_0x35d4dd(0xab),document[_0x35d4dd(0xb4)][_0x35d4dd(0xcc)](_0xc6cff8),_0xc6cff8[_0x35d4dd(0x92)]('change',handleKeyFileSelect)),_0xc6cff8;}async function handleKeyFileSelect(_0x468cf2){const _0x4fa1c9=_0x11a23a;try{const _0x15dfbf=_0x468cf2[_0x4fa1c9(0x250)]['files'];if(!_0x15dfbf||_0x15dfbf['length']===0x0)return;setLoading(!![]);const _0x26c426=_0x15dfbf[0x0],_0x45b495=_0x26c426[_0x4fa1c9(0x12b)]['toLowerCase']()[_0x4fa1c9(0x1c4)]('.lem'),_0x2b8601=_0x26c426[_0x4fa1c9(0x12b)][_0x4fa1c9(0x1d4)]()['endsWith'](_0x4fa1c9(0x228)),_0x50e33d=new FileReader();_0x50e33d[_0x4fa1c9(0xd4)]=async function(_0x585a76){const _0x370384=_0x4fa1c9;try{const _0x5b7e76=_0x585a76[_0x370384(0x250)]['result'];let _0x35147d;try{const _0x2e7bb1=atob(_0x5b7e76);_0x35147d=JSON[_0x370384(0x1ec)](_0x2e7bb1);}catch(_0x490744){throw new Error(_0x370384(0xb8));}if(!_0x35147d['id']||!_0x35147d[_0x370384(0x12b)]||!_0x35147d[_0x370384(0xca)]||!_0x35147d[_0x370384(0x162)])throw new Error(_0x370384(0x1ed));if(!validator['isValidKeyName'](_0x35147d[_0x370384(0x12b)]))throw new Error(_0x370384(0x24b));if(_0x35147d[_0x370384(0xca)]===_0x370384(0x205))_0x35147d['hasPublic']=!![],_0x35147d['hasPrivate']=!![];else{_0x35147d[_0x370384(0x12c)]=!!_0x35147d['publicKey'],_0x35147d['hasPrivate']=!!_0x35147d[_0x370384(0x13c)];if(_0x45b495&&!_0x35147d[_0x370384(0xc5)])throw new Error(_0x370384(0x1db));if(_0x2b8601&&!_0x35147d[_0x370384(0x12c)])throw new Error(_0x370384(0x23f));}if(_0x35147d[_0x370384(0xc5)]&&_0x35147d[_0x370384(0x190)]){let _0x588cf3='';try{_0x588cf3=await showPasswordModal(_0x370384(0x168),'This\x20private\x20key\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import\x20it:',![]);}catch(_0x19c2de){throw new Error(_0x370384(0x1ca));}if(!_0x588cf3)throw new Error(_0x370384(0x1ca));_0x35147d[_0x370384(0xda)]=_0x588cf3;}const _0xdfb174=keys['findIndex'](_0x5cec60=>_0x5cec60['id']===_0x35147d['id']);let _0x18b08c=![],_0x3a3b10=-0x1;if(_0xdfb174>=0x0){const _0x4e1495=keys[_0xdfb174];if(_0x35147d[_0x370384(0xc5)]&&!_0x4e1495['hasPrivate']&&_0x4e1495[_0x370384(0x12c)])_0x18b08c=!![],_0x3a3b10=_0xdfb174;else _0x35147d['hasPublic']&&!_0x4e1495[_0x370384(0x12c)]&&_0x4e1495[_0x370384(0xc5)]&&(_0x18b08c=!![],_0x3a3b10=_0xdfb174);}else _0x35147d[_0x370384(0x1e2)]&&(_0x3a3b10=keys[_0x370384(0xfd)](_0x2ffd81=>_0x2ffd81[_0x370384(0x1e2)]===_0x35147d[_0x370384(0x1e2)]&&_0x2ffd81['type']===_0x35147d[_0x370384(0xca)]&&(_0x2ffd81['hasPrivate']&&!_0x2ffd81[_0x370384(0x12c)]&&_0x35147d[_0x370384(0x12c)]||_0x2ffd81[_0x370384(0x12c)]&&!_0x2ffd81[_0x370384(0xc5)]&&_0x35147d[_0x370384(0xc5)])),_0x3a3b10>=0x0&&(_0x18b08c=!![]));if(_0x18b08c&&_0x3a3b10>=0x0){const _0x3c0340=confirm(_0x370384(0x17a)+(_0x35147d['hasPrivate']?_0x370384(0x18b):_0x370384(0x184))+'\x20key\x20part\x20of\x20an\x20existing\x20key.\x20'+'Would\x20you\x20like\x20to\x20merge\x20them\x20into\x20a\x20complete\x20key\x20pair?');if(_0x3c0340){const _0x3da9a1=keys[_0x3a3b10];_0x35147d['hasPrivate']&&!_0x3da9a1[_0x370384(0xc5)]&&(_0x3da9a1[_0x370384(0x13c)]=_0x35147d[_0x370384(0x13c)],_0x3da9a1[_0x370384(0xc5)]=!![],_0x35147d['protected']&&(_0x3da9a1[_0x370384(0x190)]=!![],_0x3da9a1[_0x370384(0x146)]=_0x35147d[_0x370384(0x146)],_0x3da9a1['iv']=_0x35147d['iv'])),_0x35147d['hasPublic']&&!_0x3da9a1[_0x370384(0x12c)]&&(_0x3da9a1[_0x370384(0xdb)]=_0x35147d[_0x370384(0xdb)],_0x3da9a1[_0x370384(0x12c)]=!![],_0x35147d['publicKeyHash']&&(_0x3da9a1['publicKeyHash']=_0x35147d[_0x370384(0x1e2)])),_0x3da9a1[_0x370384(0x137)]=_0x3da9a1['id'],await saveKeys(),showStatus('keyStatus',_0x370384(0xa3)+_0x3da9a1[_0x370384(0x12b)]+'\x22\x20updated\x20with\x20'+(_0x35147d[_0x370384(0xc5)]?_0x370384(0x18b):_0x370384(0x184))+_0x370384(0x188)+determineKeySecurityLevel(_0x3da9a1)[_0x370384(0x13d)](),'success');}else _0x35147d['id']=crypto[_0x370384(0xa8)](),keys['push'](_0x35147d),await saveKeys(),showStatus(_0x370384(0x192),_0x370384(0xa3)+_0x35147d[_0x370384(0x12b)]+_0x370384(0x24e),_0x370384(0x23d));}else{if(_0xdfb174>=0x0){const _0x2c03a7=confirm('A\x20key\x20with\x20name\x20\x22'+_0x35147d[_0x370384(0x12b)]+_0x370384(0x1fd));_0x2c03a7?keys[_0xdfb174]=_0x35147d:(_0x35147d['id']=crypto['randomUUID'](),keys[_0x370384(0x112)](_0x35147d)),await saveKeys(),showStatus(_0x370384(0x192),'Key\x20\x22'+_0x35147d[_0x370384(0x12b)]+'\x22\x20imported\x20successfully',_0x370384(0x23d));}else{keys[_0x370384(0x112)](_0x35147d),await saveKeys();if(_0x35147d[_0x370384(0xca)]===_0x370384(0x205))showStatus(_0x370384(0x192),_0x370384(0xc8)+_0x35147d[_0x370384(0x12b)]+'\x22\x20imported\x20successfully',_0x370384(0x23d));else{if(_0x35147d[_0x370384(0xc5)]&&_0x35147d[_0x370384(0x12c)])showStatus(_0x370384(0x192),'Complete\x20asymmetric\x20key\x20pair\x20\x22'+_0x35147d[_0x370384(0x12b)]+'\x22\x20imported\x20successfully',_0x370384(0x23d));else _0x35147d[_0x370384(0xc5)]?showStatus(_0x370384(0x192),_0x370384(0x150)+_0x35147d[_0x370384(0x12b)]+_0x370384(0x1ac),_0x370384(0x23d)):showStatus(_0x370384(0x192),_0x370384(0x160)+_0x35147d['name']+'\x22\x20imported\x20successfully',_0x370384(0x23d));}}}}catch(_0x255e10){console[_0x370384(0x240)](_0x370384(0xb6),_0x255e10),showStatus(_0x370384(0x192),'Import\x20error:\x20'+_0x255e10[_0x370384(0xaa)],_0x370384(0x240));}finally{setLoading(![]),document[_0x370384(0x123)](_0x370384(0x1d1))[_0x370384(0x1f4)]='';}},_0x50e33d[_0x4fa1c9(0x24f)]=function(){const _0x5a0f5e=_0x4fa1c9;setLoading(![]),showStatus(_0x5a0f5e(0x192),_0x5a0f5e(0x86),'error'),document[_0x5a0f5e(0x123)]('keyFileInput')[_0x5a0f5e(0x1f4)]='';},_0x50e33d['readAsText'](_0x26c426);}catch(_0x4ad256){console['error'](_0x4fa1c9(0xb6),_0x4ad256),showStatus('keyStatus',_0x4fa1c9(0x18e)+_0x4ad256[_0x4fa1c9(0xaa)],_0x4fa1c9(0x240)),setLoading(![]),document['getElementById'](_0x4fa1c9(0x1d1))[_0x4fa1c9(0x1f4)]='';}}async function exportAllKeys(){const _0x166a9c=_0x11a23a;try{if(keys[_0x166a9c(0xdf)]===0x0){showStatus(_0x166a9c(0x192),_0x166a9c(0xb9),_0x166a9c(0x1bb));return;}let _0x31b69e='';try{_0x31b69e=await showPasswordModal(_0x166a9c(0xe2),'Please\x20enter\x20a\x20password\x20to\x20protect\x20your\x20key\x20backup.\x20This\x20is\x20highly\x20recommended\x20for\x20security.',!![]);}catch(_0xe65e79){return;}let _0x556989;if(_0x31b69e){const _0x48dc75=JSON[_0x166a9c(0x132)](keys),_0x30d7ce=new TextEncoder()[_0x166a9c(0x10a)](_0x48dc75),_0x4e8848=window['crypto'][_0x166a9c(0xa0)](new Uint8Array(0x10)),_0x545eb0=await deriveKeyFromPassword(_0x31b69e,_0x4e8848),_0x16cf79=window['crypto'][_0x166a9c(0xa0)](new Uint8Array(AES_CONFIG[_0x166a9c(0x11e)])),_0x55e39a=await encryptWithDerivedKey(_0x545eb0,_0x30d7ce,_0x16cf79);_0x556989=JSON[_0x166a9c(0x132)]({'format':'LemonadeProtectedBackup','salt':arrayBufferToBase64(_0x4e8848),'iv':arrayBufferToBase64(_0x16cf79),'data':arrayBufferToBase64(_0x55e39a)});}else{const _0x17b37a=confirm(_0x166a9c(0x180));if(!_0x17b37a)return;_0x556989=JSON[_0x166a9c(0x132)](keys);}const _0x214085=new Blob([_0x556989],{'type':'application/octet-stream'}),_0xfde9d6=URL[_0x166a9c(0xfb)](_0x214085),_0x178457=document[_0x166a9c(0x187)]('a');_0x178457[_0x166a9c(0x174)]=_0xfde9d6,_0x178457[_0x166a9c(0xdc)]='Lemonade-state.state',document[_0x166a9c(0xb4)][_0x166a9c(0xcc)](_0x178457),_0x178457[_0x166a9c(0x145)](),document[_0x166a9c(0xb4)]['removeChild'](_0x178457),URL['revokeObjectURL'](_0xfde9d6),showStatus(_0x166a9c(0x192),_0x166a9c(0x212),'success');}catch(_0x326cf0){console[_0x166a9c(0x240)]('Export\x20error:',_0x326cf0),showStatus(_0x166a9c(0x192),_0x166a9c(0x8b)+_0x326cf0[_0x166a9c(0xaa)],_0x166a9c(0x240));}}function createStateFileInput(){const _0x2937cb=_0x11a23a;let _0x5bcd74=document[_0x2937cb(0x123)](_0x2937cb(0x254));return!_0x5bcd74&&(_0x5bcd74=document[_0x2937cb(0x187)](_0x2937cb(0x91)),_0x5bcd74['type']=_0x2937cb(0x185),_0x5bcd74['id']=_0x2937cb(0x254),_0x5bcd74[_0x2937cb(0xf8)]=_0x2937cb(0x23c),_0x5bcd74[_0x2937cb(0x191)]['display']=_0x2937cb(0xab),document[_0x2937cb(0xb4)][_0x2937cb(0xcc)](_0x5bcd74),_0x5bcd74[_0x2937cb(0x92)](_0x2937cb(0x258),handleStateFileSelect)),_0x5bcd74;}async function handleStateFileSelect(_0x486e84){const _0xee2274=_0x11a23a;try{const _0x2b92dd=_0x486e84[_0xee2274(0x250)][_0xee2274(0x216)];if(!_0x2b92dd||_0x2b92dd['length']===0x0)return;setLoading(!![]);const _0x5c0693=_0x2b92dd[0x0],_0x3f660b=new FileReader();_0x3f660b['onload']=async function(_0x5156bd){const _0xed9c70=_0xee2274;try{const _0x1e62a0=_0x5156bd[_0xed9c70(0x250)][_0xed9c70(0x20e)];let _0xfb95ef;try{_0xfb95ef=JSON[_0xed9c70(0x1ec)](_0x1e62a0);}catch(_0x271049){throw new Error(_0xed9c70(0xc2));}if(_0xfb95ef['format']===_0xed9c70(0xe0)){let _0x131d24='';try{_0x131d24=await showPasswordModal('Protected\x20State\x20File',_0xed9c70(0x233),![]);}catch(_0x1a7c28){throw new Error(_0xed9c70(0x87));}if(!_0x131d24)throw new Error(_0xed9c70(0x87));const _0x382973=base64ToArrayBuffer(_0xfb95ef[_0xed9c70(0x146)]),_0x451c00=base64ToArrayBuffer(_0xfb95ef['iv']),_0x38905f=base64ToArrayBuffer(_0xfb95ef[_0xed9c70(0x148)]),_0x527ad3=await deriveKeyFromPassword(_0x131d24,_0x382973),_0x5f14ef=await decryptWithDerivedKey(_0x527ad3,_0x38905f,_0x451c00),_0x4fc5d7=new TextDecoder()[_0xed9c70(0xe9)](_0x5f14ef);_0xfb95ef=JSON[_0xed9c70(0x1ec)](_0x4fc5d7);}if(!Array['isArray'](_0xfb95ef))throw new Error(_0xed9c70(0xe8));const _0x35a7f3=confirm('This\x20will\x20import\x20'+_0xfb95ef[_0xed9c70(0xdf)]+'\x20keys\x20into\x20your\x20application.\x20Continue?');if(!_0x35a7f3)return;keys=_0xfb95ef,await saveKeys(),showStatus(_0xed9c70(0x192),_0xed9c70(0x20f)+_0xfb95ef[_0xed9c70(0xdf)]+'\x20keys\x20imported\x20successfully',_0xed9c70(0x23d));}catch(_0x499a22){console[_0xed9c70(0x240)](_0xed9c70(0x207),_0x499a22),showStatus(_0xed9c70(0x192),_0xed9c70(0xbe)+_0x499a22['message'],_0xed9c70(0x240));}finally{setLoading(![]),document[_0xed9c70(0x123)](_0xed9c70(0x254))[_0xed9c70(0x1f4)]='';}},_0x3f660b[_0xee2274(0x24f)]=function(){const _0x5aa636=_0xee2274;setLoading(![]),showStatus(_0x5aa636(0x192),_0x5aa636(0x10d),'error'),document[_0x5aa636(0x123)]('stateFileInput')['value']='';},_0x3f660b['readAsText'](_0x5c0693);}catch(_0x4b6afb){console[_0xee2274(0x240)](_0xee2274(0x207),_0x4b6afb),showStatus('keyStatus',_0xee2274(0xbe)+_0x4b6afb[_0xee2274(0xaa)],'error'),setLoading(![]),document[_0xee2274(0x123)](_0xee2274(0x254))[_0xee2274(0x1f4)]='';}}function importState(){const _0x525837=_0x11a23a,_0x52cfa0=createStateFileInput();_0x52cfa0[_0x525837(0x145)]();}async function secureClipboardCopy(_0x3f4c11){const _0x3810b3=_0x11a23a;try{return await navigator[_0x3810b3(0xfa)][_0x3810b3(0x106)](_0x3f4c11),!![];}catch(_0x316b10){return console[_0x3810b3(0x104)](_0x3810b3(0x15a),_0x316b10),![];}}function deleteKey(_0x7d22b6){const _0x2c6cf1=_0x11a23a,_0x2bdb11=keys[_0x2c6cf1(0x1e7)](_0x5b410d=>_0x5b410d['id']===_0x7d22b6);if(!_0x2bdb11){alert(_0x2c6cf1(0x230));return;}const _0x3dcffb=window[_0x2c6cf1(0xf3)]('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20key\x20\x22'+_0x2bdb11[_0x2c6cf1(0x12b)]+_0x2c6cf1(0x18c));_0x3dcffb&&(keys=keys[_0x2c6cf1(0x16d)](_0x54cd48=>_0x54cd48['id']!==_0x7d22b6),saveKeys(),showStatus(_0x2c6cf1(0x192),'Key\x20\x22'+_0x2bdb11[_0x2c6cf1(0x12b)]+'\x22\x20deleted\x20successfully',_0x2c6cf1(0x23d)));}function xorCipher(_0x38c6cb,_0x5ac5dc){const _0x57ff44=_0x11a23a;if(!_0x5ac5dc)return _0x38c6cb;const _0x79f2cf=new TextEncoder()[_0x57ff44(0x10a)](_0x5ac5dc),_0x26e449=new Uint8Array(_0x38c6cb),_0x4e39ac=new Uint8Array(_0x38c6cb[_0x57ff44(0x151)]);for(let _0x1e031d=0x0;_0x1e031d<_0x26e449[_0x57ff44(0xdf)];_0x1e031d++){_0x4e39ac[_0x1e031d]=_0x26e449[_0x1e031d]^_0x79f2cf[_0x1e031d%_0x79f2cf[_0x57ff44(0xdf)]];}return _0x4e39ac['buffer'];}function showStatus(_0x3d3992,_0xb4b732,_0x171c0b){const _0x4b7dc8=_0x11a23a,_0x9dea60=document[_0x4b7dc8(0x123)](_0x3d3992);_0x9dea60[_0x4b7dc8(0x24a)]=validator['sanitizeHTML'](_0xb4b732),_0x9dea60['className']=_0x4b7dc8(0xdd)+_0x171c0b,setTimeout(()=>{const _0x498742=_0x4b7dc8;_0x9dea60[_0x498742(0x24a)]===validator[_0x498742(0x206)](_0xb4b732)&&(_0x9dea60[_0x498742(0xc9)]=_0x498742(0x139));},0x2710);}let passwordModalCallback=null,passwordModalResolve=null,passwordModalReject=null;function showPasswordModal(_0x22938c,_0x2c94ec,_0x126594=![]){return new Promise((_0x4e3dfd,_0x57ed1f)=>{const _0x40670c=_0x4803,_0x47221c=document['getElementById']('passwordModal'),_0x5c6f7d=document[_0x40670c(0x123)](_0x40670c(0x199)),_0x54dc60=document['getElementById'](_0x40670c(0x1bd)),_0x466b81=document['getElementById'](_0x40670c(0x238)),_0x255bb0=document[_0x40670c(0x123)](_0x40670c(0x1f7)),_0x3ff867=document[_0x40670c(0x123)]('passwordModalFeedback');_0x5c6f7d['textContent']=_0x22938c,_0x54dc60[_0x40670c(0x24a)]=_0x2c94ec,_0x466b81[_0x40670c(0x1f4)]='',_0x255bb0['className']='password-strength',_0x3ff867[_0x40670c(0x24a)]='',_0x255bb0[_0x40670c(0x191)][_0x40670c(0x94)]=_0x126594?'block':_0x40670c(0xab),_0x3ff867[_0x40670c(0x191)]['display']=_0x126594?'block':_0x40670c(0xab),passwordModalResolve=_0x4e3dfd,passwordModalReject=_0x57ed1f,_0x47221c[_0x40670c(0x191)]['display']=_0x40670c(0xbb),setTimeout(()=>{_0x466b81['focus']();},0x64);});}function confirmPasswordModal(){const _0xb50ff1=_0x11a23a,_0x49b4c5=document['getElementById'](_0xb50ff1(0x238)),_0x22534c=_0x49b4c5[_0xb50ff1(0x1f4)],_0x163cf4=document['getElementById'](_0xb50ff1(0x1f7)),_0x533982=document[_0xb50ff1(0x123)](_0xb50ff1(0x21a));_0x163cf4['className']='password-strength',_0x533982[_0xb50ff1(0x24a)]='',document[_0xb50ff1(0x123)](_0xb50ff1(0x8f))['style']['display']=_0xb50ff1(0xab),passwordModalResolve&&(passwordModalResolve(_0x22534c),passwordModalResolve=null,passwordModalReject=null);}function cancelPasswordModal(){const _0x3a049f=_0x11a23a,_0x2ea8aa=document[_0x3a049f(0x123)]('passwordModalInput'),_0x4afe77=document[_0x3a049f(0x123)](_0x3a049f(0x1f7)),_0x56812f=document[_0x3a049f(0x123)](_0x3a049f(0x21a));_0x2ea8aa[_0x3a049f(0x1f4)]='',_0x4afe77[_0x3a049f(0xc9)]='password-strength',_0x56812f[_0x3a049f(0x24a)]='',document[_0x3a049f(0x123)]('passwordModal')['style'][_0x3a049f(0x94)]='none',passwordModalReject&&(passwordModalReject(new Error(_0x3a049f(0x1d3))),passwordModalResolve=null,passwordModalReject=null);}function updateModalPasswordStrength(){const _0x28523d=_0x11a23a,_0x572ed3=document['getElementById'](_0x28523d(0x238))[_0x28523d(0x1f4)],_0x2abf67=validator['measurePasswordStrength'](_0x572ed3),_0x34c6de=document[_0x28523d(0x123)](_0x28523d(0x1f7)),_0x36f3b7=document[_0x28523d(0x123)]('passwordModalFeedback');_0x34c6de['className']=_0x28523d(0x25b),_0x572ed3?(_0x34c6de[_0x28523d(0x210)]['add'](_0x2abf67[_0x28523d(0x18a)]),_0x36f3b7['textContent']=_0x2abf67[_0x28523d(0x154)]):_0x36f3b7[_0x28523d(0x24a)]='';}async function copyToClipboard(_0x587c03,_0x31951e){const _0x38516d=_0x11a23a,_0x2fc773=document[_0x38516d(0x123)](_0x587c03)[_0x38516d(0x1f4)];if(!_0x2fc773){showStatus(_0x31951e,_0x38516d(0x22e),_0x38516d(0x240));return;}const _0xda8082=await secureClipboardCopy(_0x2fc773);if(_0xda8082)showStatus(_0x31951e,_0x38516d(0xe3),_0x38516d(0x23d)),appSettings[_0x38516d(0x1e1)]&&scheduleClipboardClear();else{showStatus(_0x31951e,'Unable\x20to\x20copy\x20automatically.\x20Please\x20select\x20the\x20text\x20and\x20press\x20Ctrl+C\x20(or\x20âŒ˜+C)\x20to\x20copy\x20manually.','warning');const _0x4b55d7=document['getElementById'](_0x587c03);_0x4b55d7[_0x38516d(0x138)](),_0x4b55d7['select']();}}function toggleDarkMode(){const _0x1174e2=_0x11a23a,_0x1f2215=document['getElementById'](_0x1174e2(0x24d))[_0x1174e2(0x24c)];_0x1f2215?document['body'][_0x1174e2(0x210)][_0x1174e2(0x20b)](_0x1174e2(0x8d)):document['body'][_0x1174e2(0x210)][_0x1174e2(0x242)]('dark-mode'),localStorage[_0x1174e2(0x103)]('LemonadeDarkMode',_0x1f2215);}function arrayBufferToBase64(_0x2c5740){const _0x1c3358=_0x11a23a,_0x2f12df=new Uint8Array(_0x2c5740);let _0x10375e='';for(let _0x455440=0x0;_0x455440<_0x2f12df[_0x1c3358(0x151)];_0x455440++){_0x10375e+=String[_0x1c3358(0x178)](_0x2f12df[_0x455440]);}return btoa(_0x10375e);}function base64ToArrayBuffer(_0x233f94){const _0xf2772c=_0x11a23a;try{const _0x165092=atob(_0x233f94),_0x15fec5=new Uint8Array(_0x165092[_0xf2772c(0xdf)]);for(let _0x15dff8=0x0;_0x15dff8<_0x165092[_0xf2772c(0xdf)];_0x15dff8++){_0x15fec5[_0x15dff8]=_0x165092[_0xf2772c(0x1a4)](_0x15dff8);}return _0x15fec5[_0xf2772c(0x93)];}catch(_0x3fbba0){console['error'](_0xf2772c(0xb5),_0x3fbba0);throw new Error('Invalid\x20base64\x20data:\x20'+_0x3fbba0[_0xf2772c(0xaa)]);}}async function encryptData(_0x1f78e6,_0xa3e930){const _0x574443=_0x11a23a;if(_0xa3e930[_0x574443(0xca)]==='aes')return await encryptWithAES(_0x1f78e6,_0xa3e930);else{if(_0xa3e930[_0x574443(0xca)]==='rsa'||_0xa3e930[_0x574443(0xca)]==='rsa-4096')return await encryptWithRSA(_0x1f78e6,_0xa3e930);else{if(_0xa3e930[_0x574443(0xca)]===_0x574443(0xa5)||_0xa3e930[_0x574443(0xca)]===_0x574443(0x95))return await encryptWithECC(_0x1f78e6,_0xa3e930);else throw new Error(_0x574443(0x11b));}}}async function decryptData(_0x53be07,_0x3d5caa){const _0x12df13=_0x11a23a;if(_0x53be07[_0x12df13(0x15c)]===0x2){if(_0x3d5caa[_0x12df13(0xca)]===_0x12df13(0x205))return await decryptWithAES(_0x53be07,_0x3d5caa);else{if(_0x3d5caa[_0x12df13(0xca)]===_0x12df13(0xe7)||_0x3d5caa[_0x12df13(0xca)]===_0x12df13(0xf4))return await decryptWithRSA(_0x53be07,_0x3d5caa);else{if(_0x3d5caa[_0x12df13(0xca)]===_0x12df13(0xa5)||_0x3d5caa[_0x12df13(0xca)]===_0x12df13(0x95))return await decryptWithECC(_0x53be07,_0x3d5caa);}}}if(_0x53be07[_0x12df13(0x1c8)]===AES_CONFIG[_0x12df13(0x194)])return await decryptWithAES(_0x53be07,_0x3d5caa);else{if(_0x53be07[_0x12df13(0x1c8)]===RSA_CONFIG[_0x12df13(0x129)]+'+'+AES_CONFIG[_0x12df13(0x194)]||_0x53be07['algorithm']===_0x12df13(0xa6))return await decryptWithRSA(_0x53be07,_0x3d5caa);else{if(_0x53be07[_0x12df13(0x1c8)]==='ECDH+'+AES_CONFIG['MODE']||_0x53be07[_0x12df13(0x1c8)]===_0x12df13(0x117))return await decryptWithECC(_0x53be07,_0x3d5caa);else throw new Error('Unsupported\x20encryption\x20algorithm:\x20'+_0x53be07[_0x12df13(0x1c8)]);}}}async function deriveKeyFromPassword(_0xccc493,_0x2a2f6e){const _0x1409f6=_0x11a23a,_0x39cf23=new TextEncoder()[_0x1409f6(0x10a)](_0xccc493),_0x5697d0=await window[_0x1409f6(0xb1)][_0x1409f6(0xaf)][_0x1409f6(0x1a0)](_0x1409f6(0xff),_0x39cf23,{'name':_0x1409f6(0x1ba)},![],[_0x1409f6(0x247)]);return window[_0x1409f6(0xb1)][_0x1409f6(0xaf)][_0x1409f6(0x247)]({'name':_0x1409f6(0x1ba),'salt':_0x2a2f6e,'iterations':PBKDF2_CONFIG['ITERATIONS'],'hash':PBKDF2_CONFIG['HASH']},_0x5697d0,{'name':AES_CONFIG[_0x1409f6(0x194)],'length':AES_CONFIG[_0x1409f6(0x130)]},!![],['encrypt',_0x1409f6(0xe5)]);}async function encryptWithDerivedKey(_0x411865,_0xff5c02,_0x198365){const _0x3946c0=_0x11a23a;return window[_0x3946c0(0xb1)][_0x3946c0(0xaf)][_0x3946c0(0x115)]({'name':AES_CONFIG['MODE'],'iv':_0x198365,'tagLength':AES_CONFIG[_0x3946c0(0x1b0)]},_0x411865,_0xff5c02);}async function decryptWithDerivedKey(_0x40b564,_0xfc0cdc,_0x3b9528){const _0x1aa23a=_0x11a23a;return window[_0x1aa23a(0xb1)][_0x1aa23a(0xaf)]['decrypt']({'name':AES_CONFIG['MODE'],'iv':_0x3b9528,'tagLength':AES_CONFIG[_0x1aa23a(0x1b0)]},_0x40b564,_0xfc0cdc);}async function importAESKey(_0x9940b){const _0x130d27=_0x11a23a;return window['crypto'][_0x130d27(0xaf)]['importKey']('raw',_0x9940b,{'name':AES_CONFIG[_0x130d27(0x194)],'length':AES_CONFIG[_0x130d27(0x130)]},![],[_0x130d27(0x115),_0x130d27(0xe5)]);}async function importRSAPublicKey(_0x136665,_0x20efe1){const _0x316c0d=_0x11a23a;return window[_0x316c0d(0xb1)]['subtle'][_0x316c0d(0x1a0)](_0x316c0d(0x1d5),_0x136665,{'name':RSA_CONFIG[_0x316c0d(0x129)],'hash':RSA_CONFIG[_0x316c0d(0x193)]},![],[_0x316c0d(0x115)]);}async function importRSAPrivateKey(_0x68af04,_0x1f47ea){const _0x9a3be6=_0x11a23a;return window[_0x9a3be6(0xb1)][_0x9a3be6(0xaf)][_0x9a3be6(0x1a0)](_0x9a3be6(0x109),_0x68af04,{'name':RSA_CONFIG['ALGORITHM'],'hash':RSA_CONFIG[_0x9a3be6(0x193)]},![],[_0x9a3be6(0xe5)]);}async function importECCPublicKey(_0x67bb51,_0x24d796){const _0x29f2d9=_0x11a23a;return window[_0x29f2d9(0xb1)][_0x29f2d9(0xaf)][_0x29f2d9(0x1a0)](_0x29f2d9(0x1d5),_0x67bb51,{'name':_0x29f2d9(0x18d),'namedCurve':_0x24d796},![],[]);}async function importECCPrivateKey(_0x274533,_0x3fba76){const _0x33d9ee=_0x11a23a;return window[_0x33d9ee(0xb1)][_0x33d9ee(0xaf)]['importKey'](_0x33d9ee(0x109),_0x274533,{'name':_0x33d9ee(0x18d),'namedCurve':_0x3fba76},![],[_0x33d9ee(0x247),_0x33d9ee(0x1b9)]);}async function saveToDatabase(_0x4bb278,_0x469721){return new Promise((_0x35be91,_0x70dd4f)=>{const _0x45862f=_0x4803;if(!db){_0x70dd4f(new Error(_0x45862f(0x1a3)));return;}const _0x1f6197=db[_0x45862f(0x9e)](_0x4bb278,_0x45862f(0x171)),_0x2e9092=_0x1f6197['objectStore'](_0x4bb278),_0x123a73=_0x2e9092[_0x45862f(0x1f2)](_0x469721);_0x123a73[_0x45862f(0x23a)]=()=>_0x35be91(),_0x123a73['onerror']=()=>_0x70dd4f(_0x123a73[_0x45862f(0x240)]);});}async function getFromDatabase(_0x35f719,_0x19f7a6){return new Promise((_0x3206b0,_0x422343)=>{const _0x107d83=_0x4803;if(!db){_0x422343(new Error(_0x107d83(0x1a3)));return;}const _0x54511f=db['transaction'](_0x35f719,_0x107d83(0x136)),_0x40f962=_0x54511f[_0x107d83(0xd3)](_0x35f719),_0x49c151=_0x40f962[_0x107d83(0x1da)](_0x19f7a6);_0x49c151['onsuccess']=()=>_0x3206b0(_0x49c151[_0x107d83(0x20e)]),_0x49c151['onerror']=()=>_0x422343(_0x49c151[_0x107d83(0x240)]);});}async function getAllFromDatabase(_0x70b21e){return new Promise((_0x514715,_0x350139)=>{const _0x4ac521=_0x4803;if(!db){_0x350139(new Error(_0x4ac521(0x1a3)));return;}const _0x761c34=db[_0x4ac521(0x9e)](_0x70b21e,'readonly'),_0x1c075d=_0x761c34['objectStore'](_0x70b21e),_0x1cf7c2=_0x1c075d['getAll']();_0x1cf7c2[_0x4ac521(0x23a)]=()=>_0x514715(_0x1cf7c2[_0x4ac521(0x20e)]),_0x1cf7c2[_0x4ac521(0x24f)]=()=>_0x350139(_0x1cf7c2[_0x4ac521(0x240)]);});}async function clearDatabase(_0x4656a){return new Promise((_0x207381,_0x41cf66)=>{const _0x34b1d3=_0x4803;if(!db){_0x41cf66(new Error(_0x34b1d3(0x1a3)));return;}const _0x454922=db[_0x34b1d3(0x9e)](_0x4656a,_0x34b1d3(0x171)),_0x10789e=_0x454922[_0x34b1d3(0xd3)](_0x4656a),_0x36cc4e=_0x10789e[_0x34b1d3(0x20a)]();_0x36cc4e['onsuccess']=()=>_0x207381(),_0x36cc4e[_0x34b1d3(0x24f)]=()=>_0x41cf66(_0x36cc4e[_0x34b1d3(0x240)]);});}window[_0x11a23a(0x10e)]=exportKey,window[_0x11a23a(0x10b)]=exportPrivateKey,window[_0x11a23a(0x177)]=deleteKey;let deferredPrompt;const installBtn=document[_0x11a23a(0x123)](_0x11a23a(0xfc)),installContainer=document[_0x11a23a(0x123)]('installContainer'),installStatus=document['getElementById'](_0x11a23a(0xf7));installBtn&&(installBtn[_0x11a23a(0x111)]=!![]);window['addEventListener'](_0x11a23a(0xea),_0x109a76=>{const _0x3aca46=_0x11a23a;_0x109a76['preventDefault'](),deferredPrompt=_0x109a76;if(installBtn){installBtn[_0x3aca46(0x111)]=![];const _0x52c8f1=installContainer[_0x3aca46(0x1b1)](_0x3aca46(0x179));_0x52c8f1&&(_0x52c8f1[_0x3aca46(0x191)]['display']=_0x3aca46(0xab)),showStatus(_0x3aca46(0xf7),_0x3aca46(0x21f),_0x3aca46(0x23d));}});installBtn&&installBtn[_0x11a23a(0x92)](_0x11a23a(0x145),async()=>{const _0x4eed1f=_0x11a23a;if(!deferredPrompt){showStatus(_0x4eed1f(0xf7),_0x4eed1f(0x202),_0x4eed1f(0x1bb));return;}deferredPrompt[_0x4eed1f(0x22d)]();const {outcome:_0x194cbe}=await deferredPrompt[_0x4eed1f(0x102)];console[_0x4eed1f(0x104)](_0x4eed1f(0xd0)+_0x194cbe),_0x194cbe==='accepted'?showStatus('installStatus',_0x4eed1f(0x251),_0x4eed1f(0x23d)):showStatus(_0x4eed1f(0xf7),'Installation\x20was\x20canceled',_0x4eed1f(0x1bb)),deferredPrompt=null,installBtn[_0x4eed1f(0x111)]=!![];});window[_0x11a23a(0x92)](_0x11a23a(0x1a2),()=>{const _0x474f98=_0x11a23a;console['log'](_0x474f98(0x17d)),deferredPrompt=null,installBtn&&(installBtn['disabled']=!![]),showStatus(_0x474f98(0xf7),'Lemonade\x20has\x20been\x20installed\x20successfully!',_0x474f98(0x23d));});_0x11a23a(0x118)in navigator&&(window[_0x11a23a(0x22b)]['protocol']===_0x11a23a(0x246)||window[_0x11a23a(0x22b)]['hostname']==='localhost'||window[_0x11a23a(0x22b)]['hostname']===_0x11a23a(0xa7))?window[_0x11a23a(0x92)](_0x11a23a(0x20c),function(){const _0x1ba49=_0x11a23a;navigator[_0x1ba49(0x118)][_0x1ba49(0xce)](_0x1ba49(0xa2))[_0x1ba49(0x113)](function(_0x4eb94c){const _0x4f4e6b=_0x1ba49;console[_0x4f4e6b(0x104)](_0x4f4e6b(0x9c),_0x4eb94c[_0x4f4e6b(0x98)]);})['catch'](function(_0x5ddbbc){const _0x1659e5=_0x1ba49;console['error'](_0x1659e5(0x257),_0x5ddbbc),showStatus(_0x1659e5(0xf7),_0x1659e5(0x23e),_0x1659e5(0x1bb));});}):(console[_0x11a23a(0x104)](_0x11a23a(0xe1)),installStatus&&(window['location'][_0x11a23a(0x1fa)]===_0x11a23a(0x170)?showStatus('installStatus',_0x11a23a(0x259),_0x11a23a(0x1bb)):showStatus('installStatus',_0x11a23a(0xec),_0x11a23a(0x1bb))));window[_0x11a23a(0x223)](_0x11a23a(0x1c2))[_0x11a23a(0x110)]&&(console[_0x11a23a(0x104)](_0x11a23a(0x245)),installStatus&&showStatus(_0x11a23a(0xf7),_0x11a23a(0x12e),_0x11a23a(0x23d)));let encryptFileData=null,encryptFileName='',decryptFileData=null,decryptFileName='';document[_0x11a23a(0x92)]('DOMContentLoaded',function(){const _0x3909bf=_0x11a23a,_0x622f53=document[_0x3909bf(0x123)](_0x3909bf(0x143)),_0x42c12e=document[_0x3909bf(0x123)](_0x3909bf(0xf9)),_0x357b73=document['getElementById'](_0x3909bf(0x1b5)),_0x55871e=document[_0x3909bf(0x123)](_0x3909bf(0x10c)),_0x1a8728=document[_0x3909bf(0x123)](_0x3909bf(0x135)),_0x2a41dc=document[_0x3909bf(0x123)]('decryptFileInput'),_0xd2abbb=document[_0x3909bf(0x123)](_0x3909bf(0x1b4)),_0x3f8a20=document[_0x3909bf(0x123)](_0x3909bf(0x14b)),_0xd4c01c=document[_0x3909bf(0x123)](_0x3909bf(0x1eb)),_0x1a90dd=document[_0x3909bf(0x123)]('removeDecryptFile'),_0x2f290d=document[_0x3909bf(0x123)](_0x3909bf(0xfe)),_0x5373a3=document[_0x3909bf(0x123)](_0x3909bf(0x128));_0x42c12e[_0x3909bf(0x92)](_0x3909bf(0x145),()=>{_0x622f53['click']();}),_0x622f53['addEventListener']('change',_0xccb6f7=>{const _0x633fbf=_0x3909bf;handleEncryptFileSelect(_0xccb6f7[_0x633fbf(0x250)][_0x633fbf(0x216)]);}),_0x1a8728[_0x3909bf(0x92)]('click',()=>{clearEncryptFile();}),_0xd2abbb['addEventListener'](_0x3909bf(0x145),()=>{const _0x4b3047=_0x3909bf;_0x2a41dc[_0x4b3047(0x145)]();}),_0x2a41dc[_0x3909bf(0x92)](_0x3909bf(0x258),_0x528c15=>{const _0x3c1b48=_0x3909bf;handleDecryptFileSelect(_0x528c15['target'][_0x3c1b48(0x216)]);}),_0x1a90dd[_0x3909bf(0x92)](_0x3909bf(0x145),()=>{clearDecryptFile();}),createKeyFileInput(),_0x2f290d[_0x3909bf(0x92)](_0x3909bf(0x145),downloadEncryptedFile),_0x5373a3[_0x3909bf(0x92)](_0x3909bf(0x145),downloadDecryptedFile),document['getElementById'](_0x3909bf(0xd7))[_0x3909bf(0x92)](_0x3909bf(0x145),function(){const _0x53dea4=_0x3909bf;window[_0x53dea4(0xad)]=null;}),document[_0x3909bf(0x123)](_0x3909bf(0x14d))[_0x3909bf(0x92)]('click',confirmPasswordModal),document[_0x3909bf(0x123)](_0x3909bf(0x256))[_0x3909bf(0x92)](_0x3909bf(0x145),cancelPasswordModal),document[_0x3909bf(0x123)](_0x3909bf(0x238))['addEventListener'](_0x3909bf(0x91),updateModalPasswordStrength),document[_0x3909bf(0x123)]('passwordModalInput')[_0x3909bf(0x92)](_0x3909bf(0x1cf),function(_0x17ae70){const _0x4167ab=_0x3909bf;_0x17ae70['key']===_0x4167ab(0x200)&&confirmPasswordModal();}),document[_0x3909bf(0x92)](_0x3909bf(0xf5),function(_0x2f300c){const _0x21c76b=_0x3909bf;_0x2f300c[_0x21c76b(0xef)]===_0x21c76b(0x1bc)&&document[_0x21c76b(0x123)]('passwordModal')['style'][_0x21c76b(0x94)]===_0x21c76b(0xbb)&&cancelPasswordModal();});});function handleEncryptFileSelect(_0x3a3526){const _0x34b61b=_0x11a23a;if(_0x3a3526['length']===0x0)return;const _0x120f53=_0x3a3526[0x0];encryptFileName=_0x120f53['name'];const _0x183b6a=new FileReader();_0x183b6a[_0x34b61b(0xd4)]=function(_0x4873b4){const _0x135301=_0x34b61b;encryptFileData=_0x4873b4['target']['result'],document['getElementById'](_0x135301(0x213))[_0x135301(0x1f4)]=_0x135301(0x25a)+encryptFileName+'\x20('+formatFileSize(_0x120f53[_0x135301(0x214)])+')',document['getElementById']('encryptFileInfo')[_0x135301(0x191)][_0x135301(0x94)]=_0x135301(0xbb),document[_0x135301(0x123)](_0x135301(0x10c))[_0x135301(0x24a)]=encryptFileName;},_0x183b6a[_0x34b61b(0x11f)](_0x120f53);}function handleDecryptFileSelect(_0x542a36){const _0x58043b=_0x11a23a;if(_0x542a36[_0x58043b(0xdf)]===0x0)return;const _0x2729b6=_0x542a36[0x0];decryptFileName=_0x2729b6[_0x58043b(0x12b)];const _0x330194=new FileReader();_0x330194[_0x58043b(0xd4)]=function(_0x11ebef){const _0x1272d8=_0x58043b,_0x11a2d8=_0x11ebef[_0x1272d8(0x250)][_0x1272d8(0x20e)];document[_0x1272d8(0x123)](_0x1272d8(0xa9))[_0x1272d8(0x1f4)]=_0x11a2d8,decryptFileData=null,document[_0x1272d8(0x123)](_0x1272d8(0x14b))[_0x1272d8(0x191)][_0x1272d8(0x94)]=_0x1272d8(0xbb),document[_0x1272d8(0x123)](_0x1272d8(0x1eb))[_0x1272d8(0x24a)]=decryptFileName,showStatus(_0x1272d8(0xbf),'Encrypted\x20file\x20loaded.\x20Select\x20key\x20and\x20enter\x20OBF\x20key\x20if\x20needed.',_0x1272d8(0x23d));},_0x330194[_0x58043b(0x24f)]=function(){const _0x4462c9=_0x58043b;showStatus(_0x4462c9(0xbf),_0x4462c9(0x173),'error');},_0x330194[_0x58043b(0x21d)](_0x2729b6);}function clearEncryptFile(){const _0x195a8d=_0x11a23a;encryptFileData=null,encryptFileName='',document[_0x195a8d(0x123)]('encryptMessage')[_0x195a8d(0x1f4)]='',document['getElementById'](_0x195a8d(0x1b5))[_0x195a8d(0x191)]['display']='none',document[_0x195a8d(0x123)](_0x195a8d(0x143))[_0x195a8d(0x1f4)]='';}function clearDecryptFile(){const _0x59bf95=_0x11a23a;decryptFileData=null,decryptFileName='',document[_0x59bf95(0x123)]('encryptedMessage')[_0x59bf95(0x1f4)]='',document[_0x59bf95(0x123)](_0x59bf95(0x14b))[_0x59bf95(0x191)][_0x59bf95(0x94)]=_0x59bf95(0xab),document[_0x59bf95(0x123)]('decryptFileInput')['value']='';}function formatFileSize(_0x532d68){const _0x431656=_0x11a23a;if(_0x532d68===0x0)return'0\x20Bytes';const _0x5089f8=0x400,_0x3d883b=[_0x431656(0x220),'KB','MB','GB'],_0x1b1c82=Math['floor'](Math['log'](_0x532d68)/Math[_0x431656(0x104)](_0x5089f8));return parseFloat((_0x532d68/Math['pow'](_0x5089f8,_0x1b1c82))['toFixed'](0x2))+'\x20'+_0x3d883b[_0x1b1c82];}function generateRandomFileName(_0x31550d=0x6){const _0x44ad57=_0x11a23a,_0x50ff8d='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let _0x13c06b='';for(let _0x28ccf6=0x0;_0x28ccf6<_0x31550d;_0x28ccf6++){_0x13c06b+=_0x50ff8d[_0x44ad57(0x252)](Math[_0x44ad57(0x88)](Math['random']()*_0x50ff8d['length']));}return _0x13c06b;}
    </script>
<div id="passwordModal" class="modal">
    <div class="modal-content">
        <h3 id="passwordModalTitle">Enter Password</h3>
        <p id="passwordModalMessage">Please enter a password to continue:</p>
        <div class="form-group">
            <input type="password" id="passwordModalInput" placeholder="Enter password">
            <div id="passwordModalStrength" class="password-strength"></div>
            <div id="passwordModalFeedback" class="password-feedback"></div>
        </div>
        <div class="btn-group">
            <button id="passwordModalConfirm" class="btn-primary">Confirm</button>
            <button id="passwordModalCancel" class="btn-secondary">Cancel</button>
        </div>
    </div>
</div>
</body>
</html>
