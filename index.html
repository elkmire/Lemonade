<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';"><meta http-equiv="X-Content-Type-Options" content="nosniff"><meta http-equiv="Referrer-Policy" content="no-referrer"><meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=()"><meta name="theme-color" content="#000000"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lemonade"><link rel="icon" href="icon.svg"><link rel="apple-touch-icon" href="icon.svg"><link rel="manifest" href="manifest.json"><title>LC6</title><style>:root{--bg-color:#ffffff;--text-color:#000000;--title-gradient:linear-gradient(90deg, #000000, #000000);--card-bg:#ffffff;--accent-color:#000000;--border-color:#dddddd;--input-bg:#ffffff;--button-bg:#000000;--button-text:#ffffff;--button-hover:#333333;--success-color:#00cc66;--error-color:#cc3300;--warning-color:#f0ad4e;--cyber-line:rgba(0, 0, 0, 0.15);--cyber-glow:rgba(0, 0, 0, 0.4);--security-high:#00cc66;--security-medium:#f0ad4e;--security-low:#cc3300;--output-bg:#f8f8f8;--output-text:#222222}body.dark-mode{--bg-color:#000000;--text-color:#E0E0E0;--title-gradient:linear-gradient(90deg, #cccccc, #ffffff);--card-bg:#0A0A0A;--accent-color:#007bff;--border-color:#2A2A2A;--input-bg:#101010;--button-bg:#007bff;--button-text:#ffffff;--button-hover:#0056b3;--success-color:#28a745;--error-color:#dc3545;--warning-color:#ffc107;--cyber-line:rgba(0, 123, 255, 0.3);--cyber-glow:rgba(0, 123, 255, 0.1);--security-high:#28a745;--security-medium:#ffc107;--security-low:#dc3545;--output-bg:#050505;--output-text:#E0E0E0}body.dark-mode.theme-punk{--title-gradient:linear-gradient(90deg, #FFFF00, #00FFFF, #FF3131);--accent-color:#FFFF00;--button-bg:#00FFFF;--button-text:#000000;--button-hover:#FF3131;--success-color:#39FF14;--error-color:#FF3131;--warning-color:#FFFF00;--cyber-line:rgba(255, 255, 0, 0.3);--cyber-glow:rgba(255, 255, 0, 0.1);--output-text:#F0F0F0}body.dark-mode.theme-natural{--title-gradient:linear-gradient(90deg, #FF4500, #FFD700);--accent-color:#FF4500;--border-color:#4a2a00;--button-bg:#FF8C00;--button-text:#000000;--button-hover:#FFA500;--success-color:#32CD32;--error-color:#DC143C;--warning-color:#FFD700;--cyber-line:rgba(255, 69, 0, 0.3);--cyber-glow:rgba(255, 69, 0, 0.1);--output-text:#FFF8DC}body.dark-mode.theme-zulu{--title-gradient:linear-gradient(90deg, #FF00FF, #FF1493);--accent-color:#FF00FF;--border-color:#4B0082;--button-bg:#FF1493;--button-text:#FFFFFF;--button-hover:#C71585;--success-color:#00FA9A;--error-color:#FF69B4;--warning-color:#F0E68C;--cyber-line:rgba(255, 0, 255, 0.3);--cyber-glow:rgba(255, 0, 255, 0.1);--output-text:#FFF0F5}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background-color:var(--bg-color);color:var(--text-color);margin:0;padding:0;transition:background-color 0.3s,color 0.3s;line-height:1.6;position:relative;overflow-x:hidden}body::before{display:none}body.dark-mode::before{content:"";display:block;position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;background-color:#000;opacity:1}body.dark-mode::after{content:"";display:block;position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;background:repeating-linear-gradient(0deg,rgb(57 255 20 / .05),rgb(57 255 20 / .05) 1px,transparent 1px,transparent 3px);pointer-events:none}body.dark-mode .app-title{color:var(--accent-color);text-shadow:none;background:none}body.dark-mode .card{border:1px solid var(--accent-color);box-shadow:none;backdrop-filter:none}body.dark-mode button{border:1px solid #fff0;box-shadow:none;text-shadow:none;transition:background-color 0.2s ease,color 0.2s ease,transform 0.1s ease;position:relative;overflow:hidden}body.dark-mode button:hover{background-color:var(--button-hover);color:var(--button-text);box-shadow:none;transform:translateY(-1px)}body.dark-mode button::before{display:none}body.dark-mode input,body.dark-mode textarea,body.dark-mode select{border:1px solid var(--border-color);box-shadow:none;backdrop-filter:none;transition:border-color 0.2s ease}body.dark-mode input:focus,body.dark-mode textarea:focus,body.dark-mode select:focus{border-color:var(--accent-color);box-shadow:none}body.dark-mode .security-badge{text-shadow:none}body.dark-mode .key-item{border:1px solid var(--border-color);background-color:var(--card-bg);box-shadow:none;transition:border-color 0.2s ease}body.dark-mode .key-item:hover{transform:none;border-color:var(--accent-color);box-shadow:none}body.dark-mode .tab-btn.active{background-color:var(--accent-color);color:var(--button-text);border-bottom-color:var(--accent-color);box-shadow:none}body.dark-mode .tab-btn:hover:not(.active){color:var(--accent-color);border-bottom-color:var(--accent-color)}body.dark-mode .slider{background-color:#333;box-shadow:none}body.dark-mode input:checked+.slider{background-color:var(--accent-color)}body.dark-mode .slider:before{box-shadow:none;background-color:#111}body.dark-mode input:checked+.slider:before{background-color:#000}body.dark-mode .status.success,body.dark-mode .status.warning,body.dark-mode .status.error{border-width:1px;border-style:solid}body.dark-mode .status.success{background-color:rgb(57 255 20 / .1);border-color:var(--success-color);color:var(--success-color)}body.dark-mode .status.warning{background-color:rgb(255 255 0 / .1);border-color:var(--warning-color);color:var(--warning-color)}body.dark-mode .status.error{background-color:rgb(255 49 49 / .1);border-color:var(--error-color);color:var(--error-color)}body.dark-mode .spinner{border:3px solid rgb(224 224 224 / .2);border-top-color:var(--accent-color);animation:spin 1s linear infinite}.app-title{font-size:1.8rem;margin:0;color:var(--text-color);background:none}body.dark-mode .app-title{color:var(--accent-color);text-shadow:none}body.dark-mode .app-header::after{background:linear-gradient(90deg,transparent,var(--accent-color),transparent)}body.dark-mode .card::before{background:var(--accent-color);height:2px}body.dark-mode .tab-btn:hover::after{background-color:var(--accent-color)}body.dark-mode input:focus,body.dark-mode textarea:focus,body.dark-mode select:focus{outline:none;border-color:var(--accent-color);box-shadow:0 0 0 2px var(--cyber-glow)}body.dark-mode .btn-secondary{border:1px solid var(--accent-color);color:var(--accent-color);background-color:#fff0}body.dark-mode .btn-secondary:hover{background-color:rgb(57 255 20 / .1);color:#39FF14}body.dark-mode .security-badge{transition:none}body.dark-mode .security-badge.high{background-color:rgb(57 255 20 / .1);color:var(--security-high);border:1px solid var(--security-high);box-shadow:none}body.dark-mode .security-badge.medium{background-color:rgb(255 255 0 / .1);color:var(--security-medium);border:1px solid var(--security-medium);box-shadow:none}body.dark-mode .security-badge.low{background-color:rgb(255 49 49 / .1);color:var(--security-low);border:1px solid var(--security-low);box-shadow:none}body.dark-mode .key-pair-badge.full{background-color:rgb(57 255 20 / .1);color:var(--security-high);border:1px solid var(--security-high);box-shadow:none}body.dark-mode .key-pair-badge.private{background-color:rgb(255 49 49 / .1);color:var(--security-low);border:1px solid var(--security-low);box-shadow:none}body.dark-mode .key-pair-badge.public{background-color:rgb(255 255 0 / .1);color:var(--security-medium);border:1px solid var(--security-medium);box-shadow:none}body.dark-mode .private-key-btn{border:1px solid var(--error-color)!important;color:var(--error-color)!important}body.dark-mode .private-key-btn:hover{background-color:rgb(255 49 49 / .2)!important;color:#FF3131!important}body.dark-mode .modal-content{border:1px solid var(--accent-color);box-shadow:none;background-color:var(--card-bg)}body.dark-mode .btn-primary{background-color:var(--accent-color);color:#000}body.dark-mode .btn-primary:hover{background-color:#4CFF3A}body.dark-mode .btn-zero{background-color:var(--error-color);color:#FFF;border:1px solid red}body.dark-mode .btn-zero:hover{background-color:#F55}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background-color:var(--bg-color);color:var(--text-color);margin:0;padding:0;transition:background-color 0.3s,color 0.3s;line-height:1.6;position:relative;overflow-x:hidden}.container{max-width:600px;margin:0 auto;padding:20px;transition:max-width 0.3s ease-in-out}.app-header{text-align:center;margin-bottom:20px;position:relative}.app-subtitle{font-size:.9rem;margin:0;padding-top:2px;font-style:italic;color:var(--text-color);opacity:.8}.app-header::after{content:'';position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);width:80%;height:2px;background:linear-gradient(90deg,transparent,var(--accent-color),transparent)}.card{background-color:var(--card-bg);border-radius:12px;box-shadow:0 4px 12px rgb(0 0 0 / .1);padding:20px;margin-bottom:20px;border:1px solid var(--border-color);position:relative;overflow:hidden}.card::before{content:'';position:absolute;top:0;left:0;width:100%;height:3px;background:linear-gradient(90deg,#33aaff,#0066cc)}.tabs{display:flex;justify-content:center;margin-bottom:20px;border-bottom:1px solid var(--border-color);overflow-x:auto}.tab-btn{background:none;border:none;padding:10px 20px;font-size:1rem;cursor:pointer;color:var(--text-color);border-bottom:2px solid #fff0;transition:all 0.3s;position:relative;overflow:hidden;white-space:nowrap}.tab-btn.active{border-bottom:2px solid var(--accent-color);color:var(--accent-color)}.tab-btn::after{content:'';position:absolute;bottom:0;left:0;width:0;height:2px;background-color:var(--accent-color);transition:width 0.3s}.tab-btn:hover::after{width:100%}.tab-content{display:none!important}.tab-content.active{display:block!important}.form-group{margin-bottom:15px}label{display:block;margin-bottom:5px;font-weight:500}input,textarea,select{width:100%;padding:12px;border:1px solid var(--border-color);border-radius:8px;background-color:var(--input-bg);color:var(--text-color);font-size:1rem;box-sizing:border-box;transition:border-color 0.3s,box-shadow 0.3s}input:focus,textarea:focus,select:focus{outline:none;border-color:var(--accent-color);box-shadow:0 0 0 2px var(--cyber-glow)}#encryptedOutput,#decryptedOutput{min-height:120px;background-color:var(--output-bg);color:var(--output-text);border-width:1px;border-style:solid;border-color:var(--border-color);font-family:'Consolas','Courier New',monospace;width:100%;resize:vertical;padding:15px;overflow-y:auto}.form-group:has(#encryptedOutput),.form-group:has(#decryptedOutput){width:100%}#encrypt .form-group:nth-of-type(3),#decrypt .form-group:nth-of-type(3){width:100%}textarea{min-height:100px;resize:vertical}button{background-color:var(--button-bg);color:var(--button-text);border:none;border-radius:8px;padding:12px 20px;font-size:1rem;cursor:pointer;transition:background-color 0.3s,transform 0.1s;position:relative;overflow:hidden}button:hover{background-color:var(--button-hover)}button:active{transform:scale(.98)}button::after{display:none}.btn-group{display:flex;gap:10px;margin-top:15px}.btn-secondary{background-color:#fff0;border:1px solid var(--accent-color);color:var(--accent-color)}.btn-secondary:hover{background-color:rgb(0 0 0 / .05)}.status{padding:10px;border-radius:8px;margin-top:15px;display:none}.status.success{background-color:rgb(0 204 102 / .1);color:var(--success-color);border:1px solid var(--success-color);display:block}.status.warning{background-color:rgb(240 173 78 / .1);color:var(--warning-color);border:1px solid var(--warning-color);display:block}.status.error{background-color:rgb(204 51 0 / .1);color:var(--error-color);border:1px solid var(--error-color);display:block}.keys-container{display:flex;flex-direction:column;gap:20px}.keys-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:15px;width:100%}.key-form{display:flex;flex-direction:column;gap:15px}.key-item{background-color:var(--input-bg);border:1px solid var(--border-color);border-radius:8px;padding:15px;display:flex;flex-direction:column;height:100%}.key-item-content{flex:1;display:flex;flex-direction:column}.key-item h3{margin-top:0;margin-bottom:10px}.key-header{text-align:center;margin-bottom:15px}.key-actions{display:flex;flex-wrap:wrap;justify-content:center;gap:8px;margin-top:auto;padding-top:15px;border-top:1px solid var(--border-color)}.key-actions button{flex:1 1 auto;min-width:80px;padding:8px 12px;font-size:.9rem}.key-meta{font-size:.9rem;color:#888;margin-bottom:5px}.key-management-buttons{display:flex;flex-wrap:wrap;gap:10px;margin-top:20px}.key-management-buttons button{flex:1 1 auto;min-width:100px}.btn-zero{background-color:#c30;color:#fff;margin-top:20px;width:100%;font-weight:700;border:1px solid #a20}.btn-zero:hover{background-color:#f30}.loading-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgb(0 0 0 / .7);display:flex;justify-content:center;align-items:center;z-index:1000;display:none}.spinner{width:50px;height:50px;border:5px solid rgb(255 255 255 / .3);border-radius:50%;border-top-color:var(--accent-color);animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.password-strength{height:5px;border-radius:5px;margin-top:5px;transition:all 0.3s}.password-strength.weak{background-color:var(--security-low);width:30%}.password-strength.medium{background-color:var(--security-medium);width:60%}.password-strength.strong{background-color:var(--security-high);width:100%}.password-feedback{font-size:.8rem;margin-top:5px;color:var(--text-color);opacity:.9}.security-badge{display:inline-flex;align-items:center;padding:2px 8px;border-radius:12px;font-size:.8rem;margin-left:8px;font-weight:700}.security-badge.high{background-color:rgb(0 204 102 / .1);color:var(--security-high);border:1px solid var(--security-high)}.security-badge.medium{background-color:rgb(240 173 78 / .1);color:var(--security-medium);border:1px solid var(--security-medium)}.security-badge.low{background-color:rgb(204 51 0 / .1);color:var(--security-low);border:1px solid var(--security-low)}.key-pair-badge{display:inline-flex;align-items:center;padding:2px 8px;border-radius:12px;font-size:.8rem;font-weight:700;margin-top:5px}.key-pair-badge.full{background-color:rgb(0 204 102 / .1);color:var(--security-high);border:1px solid var(--security-high)}.key-pair-badge.private{background-color:rgb(204 51 0 / .1);color:var(--security-low);border:1px solid var(--security-low)}.key-pair-badge.public{background-color:rgb(240 173 78 / .1);color:var(--security-medium);border:1px solid var(--security-medium)}.private-key-btn{border:1px solid var(--error-color)!important;color:var(--error-color)!important}.private-key-btn:hover{background-color:rgb(204 51 0 / .1)!important}.config-toggle{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.config-toggle label{display:inline;margin-bottom:0}.switch{position:relative;display:inline-block;width:50px;height:24px}.switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s;border-radius:24px}.slider:before{position:absolute;content:"";height:16px;width:16px;left:4px;bottom:4px;background-color:#fff;transition:.4s;border-radius:50%}input:checked+.slider{background-color:var(--accent-color)}input:focus+.slider{box-shadow:0 0 1px var(--accent-color)}input:checked+.slider:before{transform:translateX(26px)}.security-info{font-size:.9rem;padding:10px;border-left:3px solid var(--accent-color);background-color:rgb(0 0 0 / .03);margin-bottom:15px}body.dark-mode .security-info{background-color:rgb(57 255 20 / .05);border-left-color:var(--accent-color);color:var(--text-color)}.key-expiry{font-size:.8rem;color:var(--warning-color);margin-top:5px;font-style:italic}#inactivityModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgb(0 0 0 / .8);z-index:1001;justify-content:center;align-items:center}.modal-content{background-color:var(--card-bg);padding:20px;border-radius:12px;max-width:400px;text-align:center;box-shadow:0 5px 15px rgb(0 0 0 / .3);width:90%;position:relative}.timer{font-size:2rem;margin:20px 0;color:var(--warning-color)}#settings{display:none}.settings-section{margin-bottom:20px}.settings-section h3{margin-top:0;border-bottom:1px solid var(--border-color);padding-bottom:5px}.file-info{margin-top:10px;font-size:.9rem;background-color:var(--input-bg);padding:8px;border-radius:4px;display:flex;align-items:center;justify-content:space-between}.file-info-name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.file-icon{margin-right:8px;font-size:1.2rem}.remove-file{cursor:pointer;color:var(--error-color);padding:2px 6px;border-radius:4px;margin-left:8px}.remove-file:hover{background-color:rgb(204 51 0 / .1)}body.dark-mode .remove-file:hover{background-color:rgb(255 49 49 / .2)}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgb(0 0 0 / .7);z-index:1001;justify-content:center;align-items:center}.btn-primary{background-color:var(--accent-color);color:var(--button-text);border:none;border-radius:8px;padding:12px 20px;font-size:1rem;cursor:pointer;transition:background-color 0.3s,transform 0.1s}.btn-primary:hover{background-color:var(--button-hover)}@media (max-width:600px){.container{padding:15px}.card{padding:15px}.app-title{font-size:1.5rem}.btn-group{flex-direction:column}.btn-group button{width:100%}.key-actions button{width:100%;margin-bottom:5px}.tab-btn{padding:10px 10px;font-size:.9rem}.key-actions{flex-direction:column}}@media (max-width:767px){.keys-container{flex-direction:column}.key-form,.keys-list-container{width:100%}}@media (min-width:768px){.container{max-width:750px}.app-title{font-size:2rem}.card{padding:25px}#encryptedOutput,#decryptedOutput{min-height:150px;font-size:1.05rem}.keys-container{flex-direction:row;align-items:flex-start}.key-form{width:40%;position:sticky;top:20px}.keys-list-container{width:60%}.key-item h3{font-size:1.1rem;margin-top:0;margin-bottom:10px;word-break:break-word}}@media (min-width:1024px){.container{max-width:900px}#encryptedOutput,#decryptedOutput{min-height:180px;font-size:1.1rem;padding:18px}#keys .card{display:flex;flex-wrap:wrap;gap:20px}#keys .card>h2,#keys .card>.security-info{width:100%}#keys .card>.form-group,#keys .card>button#generateKeyBtn{width:calc(40% - 10px)}#keys .card>div:has(#keysList){width:calc(60% - 10px);margin-top:0}#keys .card>div:nth-last-child(3){width:calc(60% - 10px);margin-top:0}#keys .card>.btn-group,#keys .card>div:has(#zeroKeysBtn){width:100%}#encrypt .card,#decrypt .card{display:grid;grid-template-columns:1fr 1fr;gap:20px}#encrypt .card>.form-group:first-child,#decrypt .card>.form-group:first-child,#encrypt .card>.form-group:has(#encryptedOutput),#decrypt .card>.form-group:has(#decryptedOutput),#encrypt .card>.form-group:nth-child(3),#decrypt .card>.form-group:nth-child(3){grid-column:1 / span 2}#encrypt .card>button,#decrypt .card>button{grid-column:1 / span 2}#encrypt .card>.btn-group,#decrypt .card>.btn-group{grid-column:1 / span 2}#encrypt .card>#encryptStatus,#decrypt .card>#decryptStatus{grid-column:1 / span 2}}@media (min-width:1200px){.container{max-width:1140px}.keys-grid{grid-template-columns:repeat(auto-fill,minmax(320px,1fr))}}@media (min-width:1440px){.container{max-width:1200px}#encryptedOutput,#decryptedOutput{min-height:220px;font-size:1.15rem;padding:20px}#settings .card{display:grid;grid-template-columns:1fr 1fr;gap:30px}#settings .card>h2{grid-column:1 / span 2}#settings .card>.btn-group{grid-column:1 / span 2;justify-content:center}#settings .card>#settingsStatus{grid-column:1 / span 2}#keysList{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:15px}@media (min-width:1800px){#encrypt .card,#decrypt .card{grid-template-columns:1fr 1fr 1fr}#encrypt .card>.form-group:first-child,#decrypt .card>.form-group:first-child,#encrypt .card>.form-group:has(#encryptedOutput),#decrypt .card>.form-group:has(#decryptedOutput),#encrypt .card>.form-group:nth-child(3),#decrypt .card>.form-group:nth-child(3),#encrypt .card>button,#decrypt .card>button,#encrypt .card>.btn-group,#decrypt .card>.btn-group,#encrypt .card>#encryptStatus,#decrypt .card>#decryptStatus{grid-column:1 / span 3}}}@media (min-width:601px){.btn-group{flex-direction:row}.btn-group button{flex:1}}@media print{body{background-color:#fff;color:#000}body.dark-mode{--bg-color:#ffffff;--text-color:#000000;--card-bg:#ffffff;--border-color:#dddddd;--input-bg:#ffffff;--output-bg:#f8f8f8;--output-text:#222222}body.dark-mode .app-title{background:none;color:#000;text-shadow:none}body.dark-mode .tab-btn.active{color:#000;background:none}body.dark-mode .security-info{background-color:#f0f0f0;border-left-color:#ccc;color:#000}.card{box-shadow:none;border:1px solid #ddd}.btn-group,button,.tabs,.app-subtitle,.key-actions,.key-management-buttons,.config-toggle,#installContainer,.remove-file{display:none!important}.container{max-width:100%;padding:0}#encryptedOutput,#decryptedOutput{border:1px solid #ddd;background-color:#fff;color:#000;min-height:auto}.key-item{page-break-inside:avoid}.keys-grid{grid-template-columns:1fr!important}} </style></head><body><div class="container"><div class="app-header"><h1 class="app-title">LC6</h1><div class="app-subtitle">by elkmire</div></div><div class="tabs"><button class="tab-btn active" data-tab="encrypt">Encrypt</button><button class="tab-btn" data-tab="decrypt">Decrypt</button><button class="tab-btn" data-tab="keys">Key Management</button><button class="tab-btn" data-tab="settings">Settings</button><button class="tab-btn" data-tab="learn">Learn</button></div><div class="tab-content active" id="encrypt"><div class="card"><div class="form-group"><label for="encryptMessage">To Encrypt</label><textarea id="encryptMessage" placeholder="Free-type here or load file for encryption..."></textarea><div style="display: flex; gap: 10px; margin-top: 5px;"><button id="encryptBrowseBtn" class="btn-secondary">Browse Files</button><button id="clearEncryptMessageBtn" class="btn-secondary">Clear</button><input type="file" id="encryptFileInput" style="display: none;"></div><div id="encryptFileInfo" style="display: none;" class="file-info"><span><span class="file-icon">ðŸ“„</span><span id="encryptFileName" class="file-info-name"></span></span><span class="remove-file" id="removeEncryptFile">Ã—</span></div></div><div class="form-group"><label for="encryptionKey">Encryption Key</label><select id="encryptionKey"><option value="">Select a key...</option></select></div><div style="display: flex; gap: 20px; align-items: flex-start;"><div class="form-group" style="flex: 1;"><label for="encryptObfKey">Extra Option</label><input type="text" id="encryptObfKey" placeholder="Optional*"></div><div class="form-group" style="flex-basis: 120px;"><label for="encryptIterations">Iterate</label><input type="number" id="encryptIterations" value="1" min="1" max="10"></div></div><div class="form-group" id="encryptSignGroup" style="display: none;"><div class="config-toggle"><label for="encryptSign" style="cursor: pointer;">Sign Message (Digital Signature)</label><label class="switch"><input type="checkbox" id="encryptSign"><span class="slider"></span></label></div></div><div class="form-group" id="encryptionPasswordGroup" style="display: none;"><label for="encryptionPassword">Key Password</label><input type="password" id="encryptionPassword" placeholder="Enter key password"></div><button id="encryptBtn">Encrypt Data</button><div class="form-group" style="margin-top: 20px;"><label for="encryptedOutput">Encrypted Data</label><textarea id="encryptedOutput" readonly></textarea></div><div class="btn-group"><button id="downloadEncryptedBtn" class="btn-secondary">Download Encrypted File</button><button id="copyEncryptedBtn" class="btn-secondary">Copy to Clipboard</button><button id="clearEncryptBtn" class="btn-secondary">Clear All</button></div><div id="encryptStatus" class="status"></div></div></div><div class="tab-content" id="decrypt"><div class="card"><div class="form-group"><label for="encryptedMessage">To Decrypt</label><textarea id="encryptedMessage" placeholder="Paste the encrypted data here or load encrypted data..."></textarea><div style="display: flex; gap: 10px; margin-top: 5px;"><button id="decryptBrowseBtn" class="btn-secondary">Browse Files</button><button id="clearEncryptedMessageBtn" class="btn-secondary">Clear</button><input type="file" id="decryptFileInput" style="display: none;"></div><div id="decryptFileInfo" style="display: none;" class="file-info"><span><span class="file-icon">ðŸ“„</span><span id="decryptFileName" class="file-info-name"></span></span><span class="remove-file" id="removeDecryptFile">Ã—</span></div></div><div class="form-group"><label for="decryptionKey">Decryption Key</label><select id="decryptionKey"><option value="">Select a key...</option></select></div><div style="display: flex; gap: 20px; align-items: flex-start;"><div class="form-group" style="flex: 1;"><label for="decryptObfKey">Extra Option</label><input type="text" id="decryptObfKey" placeholder="Optional*"></div><div class="form-group" style="flex-basis: 120px;"><label for="decryptIterations">Iterate</label><input type="number" id="decryptIterations" value="1" min="1" max="10"></div></div><div class="form-group" id="decryptVerifyGroup" style="display: none;"><div class="config-toggle"><label for="decryptVerify" style="cursor: pointer;">Verify Signature</label><label class="switch"><input type="checkbox" id="decryptVerify"><span class="slider"></span></label></div></div><div class="form-group" id="decryptionPasswordGroup" style="display: none;"><label for="decryptionPassword">Key Password</label><input type="password" id="decryptionPassword" placeholder="Enter key password"></div><button id="decryptBtn">Decrypt Data</button><div class="form-group" style="margin-top: 20px;"><label for="decryptedOutput">Decrypted Data</label><textarea id="decryptedOutput" readonly></textarea></div><div class="btn-group"><button id="downloadDecryptedBtn" class="btn-secondary">Download Decrypted File</button><button id="copyDecryptedBtn" class="btn-secondary">Copy to Clipboard</button><button id="clearDecryptBtn" class="btn-secondary">Clear All</button></div><div id="decryptStatus" class="status"></div></div></div><div class="tab-content" id="keys"><div class="card"><h2>Key Management</h2><div class="security-info"><strong>Security Note:</strong> All keys are stored locally in your browser's protected storage and never sent to any server. </div><div class="keys-container"><div class="key-form"><div class="form-group"><label for="keyName">Key Name</label><input type="text" id="keyName" placeholder="e.g., enter crypto name"></div><div class="form-group"><label for="keyType">Key Type</label><select id="keyType"><option value="aes">AES-GCM (Symmetric) - 256 bits</option><option value="rsa">RSA-OAEP (Asymmetric) - 2048 bits</option><option value="rsa-4096">RSA-OAEP (Asymmetric) - 4096 bits</option><option value="ecc">ECC (Asymmetric) - P-256</option><option value="ecc-p384">ECC (Asymmetric) - P-384</option><option value="ecc-p521">ECC (Asymmetric) - P-521</option></select></div><div class="form-group"><label for="keyExpiry">Key Expiration (Optional)</label><select id="keyExpiry"><option value="">Never (Not Recommended)</option><option value="30">30 Days</option><option value="90">90 Days</option><option value="180">180 Days</option><option value="365">1 Year</option></select></div><div class="form-group" id="keyPasswordGroup"><label for="keyPassword">Key Password (Recommended)</label><input type="password" id="keyPassword" placeholder="Enter optional password"><div id="passwordStrength" class="password-strength"></div><div id="passwordFeedback" class="password-feedback"></div></div><div class="form-group" id="confirmKeyPasswordGroup"><label for="confirmKeyPassword">Confirm Password</label><input type="password" id="confirmKeyPassword" placeholder="Confirm your password"></div><button id="generateKeyBtn">Generate New Key</button><div class="key-management-buttons"><button id="importKeyBtn" class="btn-secondary">Import Key</button><button id="exportAllKeysBtn" class="btn-secondary">Export State</button><button id="importStateBtn" class="btn-secondary">Import State</button></div><div style="text-align: center; margin-top: 20px;"><button id="zeroKeysBtn" class="btn-zero">ZERO ALL KEYS</button></div><div id="keyStatus" class="status"></div></div><div class="keys-list-container"><h3>Your Keys</h3><div id="keysList" class="keys-grid"></div></div></div></div></div><div class="tab-content" id="settings"><div class="card"><h2>Security Settings</h2><p> (Must SAVE for changes to take effect) <p><div class="settings-section"><h3>Storage Options</h3><div class="config-toggle"><label for="useIndexedDB">Use IndexedDB for key storage (more secure)</label><label class="switch"><input type="checkbox" id="useIndexedDB" checked><span class="slider"></span></label></div><div class="config-toggle"><label for="sessionOnly">Session-only mode (keys aren't saved when browser closes)</label><label class="switch"><input type="checkbox" id="sessionOnly"><span class="slider"></span></label></div></div><div class="settings-section"><h3>Security Parameters</h3><div class="config-toggle"><label for="enforcePwdProtection">Enforce password protection for keys</label><label class="switch"><input type="checkbox" id="enforcePwdProtection"><span class="slider"></span></label></div><div class="config-toggle"><label for="enforceKeyExpiry">Enforce key expiration</label><label class="switch"><input type="checkbox" id="enforceKeyExpiry"><span class="slider"></span></label></div><div class="form-group"><label for="pbkdf2Iterations">PBKDF2 Iterations (higher = more secure but slower)</label><select id="pbkdf2Iterations"><option value="100000">100,000 (Default)</option><option value="200000">200,000</option><option value="300000">300,000</option><option value="500000">500,000</option></select></div></div><div class="settings-section"><h3>Appearance</h3><div class="config-toggle"><label for="darkMode">Dark Mode</label><label class="switch"><input type="checkbox" id="darkMode"><span class="slider"></span></label></div><div id="darkThemeOptions" style="display: none; margin-top: 15px; padding-left: 20px; border-left: 2px solid var(--border-color);"><h4>Extended Themes</h4><div class="config-toggle"><label for="themePunk">Lemon</label><label class="switch"><input type="checkbox" id="themePunk" class="theme-toggle" data-theme="punk"><span class="slider"></span></label></div><div class="config-toggle"><label for="themeNatural">Burnt</label><label class="switch"><input type="checkbox" id="themeNatural" class="theme-toggle" data-theme="natural"><span class="slider"></span></label></div><div class="config-toggle"><label for="themeZulu">Zulu</label><label class="switch"><input type="checkbox" id="themeZulu" class="theme-toggle" data-theme="zulu"><span class="slider"></span></label></div></div></div><div class="settings-section"><h3>Install App</h3><p>Installs PWA (must be Chromium-based browser or Safari for IOS)</p><div id="installContainer"><button id="installBtn" class="btn-secondary">Install Lemonade App</button><p class="install-note" style="margin-top: 8px; font-size: 0.85rem; color: #888;"> (Button will be enabled when installation is available) </p></div><div id="installStatus" class="status"></div></div><div class="btn-group"><button id="saveSettingsBtn">Save Settings</button><button id="resetSettingsBtn" class="btn-secondary">Reset to Defaults</button></div><div id="settingsStatus" class="status"></div></div></div><div class="tab-content" id="learn"><div class="card"><h2>Learn About Lemonade</h2><p>Welcome! This section provides an overview of the powerful cryptographic features available in this application.</p><div class="settings-section"><h3>Core Functionality: Encrypt & Decrypt</h3><p>The <strong>Encrypt</strong> and <strong>Decrypt</strong> tabs are the heart of the application. You can secure your text messages or entire files using state-of-the-art cryptographic algorithms.</p><ul><li><strong>Free-typing or File Loading:</strong> You can either type your message directly or use the "Browse Files" button to load a file for encryption.</li><li><strong>Key Selection:</strong> Choose from your managed keys to perform the operation. The application intelligently shows you the correct keys (public keys for encryption, private keys for decryption).</li><li><strong>Digital Signatures:</strong> When using an asymmetric key (like RSA or ECC), you can "Sign" your message. This proves the message came from you and hasn't been tampered with. The recipient can then "Verify" the signature.</li><li><strong>Extra Option (Obfuscation Key):</strong> This adds an extra layer of simple, password-based obfuscation on top of the strong encryption. It makes the encrypted output look different and can help hide it. It is NOT a substitute for a strong key.</li><li><strong>Iterate:</strong> This number counter (1-10) re-encrypts the data multiple times. The output of one encryption round becomes the input for the next. To successfully decrypt, you must use the exact same iteration count on the Decrypt tab.</li></ul></div><div class="settings-section"><h3>Key Management Tab</h3><p>This is your command center for managing cryptographic keys. All keys are stored securely in your browser and are never sent over the network.</p><ul><li><strong>Generate New Keys:</strong> Create powerful keys with different algorithms: <ul><li><strong>AES-GCM:</strong> A fast and secure symmetric algorithm. The same key is used to encrypt and decrypt. Great for personal data protection.</li><li><strong>RSA-OAEP:</strong> An asymmetric algorithm (public/private key pair). Share your public key with others so they can send you encrypted messages that only you can open with your private key.</li><li><strong>ECC:</strong> A more modern and efficient asymmetric algorithm. It provides the same level of security as RSA but with smaller key sizes.</li></ul></li><li><strong>Key Passwords:</strong> You can (and should!) protect your keys with a password. This encrypts the key itself in your browser's storage, providing a crucial layer of security.</li><li><strong>Import/Export:</strong> You can export individual keys (public or private) or export the entire application state (all your keys) to a backup file. This allows you to move your keys to another device or browser.</li><li><strong>ZERO ALL KEYS:</strong> A powerful, irreversible function to securely delete all keys from your browser. Use with extreme caution.</li></ul></div><div class="settings-section"><h3>Settings Tab</h3><p>Customize the application's behavior to fit your security needs.</p><ul><li><strong>Storage Options:</strong> Choose between more secure IndexedDB or session-only storage (which forgets keys when you close the browser).</li><li><strong>Security Parameters:</strong> Enforce policies like requiring passwords for all keys or mandating key expiration dates. You can also increase the PBKDF2 iterations for stronger password-derived keys.</li><li><strong>Install App:</strong> On compatible browsers, you can install this web app to your device for an experience that feels like a native application.</li></ul></div><div class="security-info"><strong>Your Security is Paramount:</strong> This application is designed to run entirely on your device. Your keys, passwords, and unencrypted data are never sent to any server. All cryptographic operations happen locally in your browser. </div></div></div></div><div class="loading-overlay" id="loadingOverlay"><div class="spinner"></div></div><script>const _0x2c69c4=_0x1b5e;(function(_0x28b172,_0x2a7e46){const _0x1ab937=_0x1b5e,_0x5ef39f=_0x28b172();while(!![]){try{const _0x301571=-parseInt(_0x1ab937(0x2f9))/0x1*(parseInt(_0x1ab937(0x21a))/0x2)+parseInt(_0x1ab937(0x285))/0x3*(-parseInt(_0x1ab937(0x300))/0x4)+parseInt(_0x1ab937(0x256))/0x5*(parseInt(_0x1ab937(0x18e))/0x6)+-parseInt(_0x1ab937(0x142))/0x7+parseInt(_0x1ab937(0x1c8))/0x8+parseInt(_0x1ab937(0x196))/0x9+parseInt(_0x1ab937(0x271))/0xa;if(_0x301571===_0x2a7e46)break;else _0x5ef39f['push'](_0x5ef39f['shift']());}catch(_0x2fdbc5){_0x5ef39f['push'](_0x5ef39f['shift']());}}}(_0xdc69,0xda231));const PBKDF2_CONFIG={'ITERATIONS':0x186a0,'HASH':_0x2c69c4(0x14a)},AES_CONFIG={'KEY_LENGTH':0x100,'MODE':'AES-GCM','IV_LENGTH':0xc,'TAG_LENGTH':0x80},RSA_CONFIG={'KEY_SIZE':0x800,'KEY_SIZE_4096':0x1000,'ALGORITHM':_0x2c69c4(0x1c2),'HASH':'SHA-256'},ECC_CONFIG={'CURVE':_0x2c69c4(0x146),'CURVE_P384':_0x2c69c4(0x2eb),'CURVE_P521':_0x2c69c4(0x293),'ALGORITHM':_0x2c69c4(0x211),'KEY_DERIVATION':_0x2c69c4(0x279),'KDF_HASH':_0x2c69c4(0x14a),'ENC_ALGORITHM':_0x2c69c4(0x303)},SIGN_CONFIG={'RSA_ALGORITHM':_0x2c69c4(0x24a),'ECC_ALGORITHM':_0x2c69c4(0x1e2),'HASH':'SHA-512','SALT_LENGTH':0x20},DB_NAME=_0x2c69c4(0x1c5),DB_VERSION=0x1,KEYS_STORE='keys',SETTINGS_STORE=_0x2c69c4(0x2b3),DEFAULT_SETTINGS={'useIndexedDB':!![],'sessionOnly':![],'enforcePwdProtection':![],'enforceKeyExpiry':![],'pbkdf2Iterations':0x186a0,'theme':null};let db=null,keys=[],appSettings={...DEFAULT_SETTINGS};const tabBtns=document['querySelectorAll'](_0x2c69c4(0x31e)),tabContents=document['querySelectorAll'](_0x2c69c4(0x2b0)),encryptionKeySelect=document['getElementById'](_0x2c69c4(0x18d)),decryptionKeySelect=document[_0x2c69c4(0x19c)](_0x2c69c4(0x140)),keysList=document[_0x2c69c4(0x19c)]('keysList'),loadingOverlay=document[_0x2c69c4(0x19c)](_0x2c69c4(0x22e)),inactivityModal=document[_0x2c69c4(0x19c)](_0x2c69c4(0x1d6)),timeoutTimer=document[_0x2c69c4(0x19c)](_0x2c69c4(0x147)),safeMemory={'sensitiveData':new WeakMap(),'store':function(_0x43a4e0){const _0x402889=_0x2c69c4,_0x309837={'id':crypto['randomUUID']()};return this[_0x402889(0x235)][_0x402889(0x1d9)](_0x309837,_0x43a4e0),_0x309837;},'retrieve':function(_0x4e3b62,_0x39a370=![]){const _0x53291d=_0x2c69c4;if(!this['sensitiveData'][_0x53291d(0x122)](_0x4e3b62))return null;const _0x40b0c7=this['sensitiveData'][_0x53291d(0x1a8)](_0x4e3b62);return _0x39a370&&this[_0x53291d(0x235)][_0x53291d(0x15f)](_0x4e3b62),_0x40b0c7;},'delete':function(_0xda66b4){const _0xf942cd=_0x2c69c4;if(this[_0xf942cd(0x235)]['has'](_0xda66b4))return this[_0xf942cd(0x235)][_0xf942cd(0x15f)](_0xda66b4),!![];return![];},'clearAll':function(){const _0x5dda13=_0x2c69c4;this[_0x5dda13(0x235)]=new WeakMap();if(typeof window['gc']===_0x5dda13(0x321))try{window['gc']();}catch(_0x1b1332){console[_0x5dda13(0x298)](_0x5dda13(0x18f));}}},validator={'sanitizeHTML':function(_0x28ac43){const _0x28cd02=_0x2c69c4,_0x2312b8=document['createElement'](_0x28cd02(0x291));return _0x2312b8[_0x28cd02(0x1f9)]=_0x28ac43,_0x2312b8[_0x28cd02(0x24b)];},'validateInput':function(_0x3e10e9,_0x141be1=![]){const _0x21712b=_0x2c69c4;if(_0x3e10e9===null||_0x3e10e9===undefined)return'';const _0x135948=String(_0x3e10e9);return _0x141be1?_0x135948:this[_0x21712b(0x325)](_0x135948);},'isValidKeyName':function(_0x265926){const _0x2fb1b4=_0x2c69c4;return/^[A-Za-z0-9 ._-]{1,50}$/[_0x2fb1b4(0x2d5)](_0x265926);},'isValidEncryptedMessage':function(_0x32faec){return/^--LM--\s*[A-Za-z0-9+/=]+\s*--EM--$/s['test'](_0x32faec);},'measurePasswordStrength':function(_0xe79045){const _0xb2a2e1=_0x2c69c4;let _0x48963e=0x0;if(!_0xe79045)return{'score':0x0,'feedback':_0xb2a2e1(0x169)};const _0x3536ec=_0xe79045['length'];_0x48963e+=Math['min'](0x5,Math['floor'](_0x3536ec/0x4));if(/[a-z]/[_0xb2a2e1(0x2d5)](_0xe79045))_0x48963e+=0x1;if(/[A-Z]/['test'](_0xe79045))_0x48963e+=0x1;if(/[0-9]/[_0xb2a2e1(0x2d5)](_0xe79045))_0x48963e+=0x1;if(/[^A-Za-z0-9]/[_0xb2a2e1(0x2d5)](_0xe79045))_0x48963e+=0x2;if(/^[a-zA-Z]+$/[_0xb2a2e1(0x2d5)](_0xe79045))_0x48963e-=0x1;if(/^[0-9]+$/[_0xb2a2e1(0x2d5)](_0xe79045))_0x48963e-=0x1;if(/(.)\1{2,}/[_0xb2a2e1(0x2d5)](_0xe79045))_0x48963e-=0x1;let _0x2511e8,_0x3112d6;if(_0x48963e<0x4)_0x2511e8='weak',_0x3112d6=_0xb2a2e1(0x297);else _0x48963e<0x8?(_0x2511e8=_0xb2a2e1(0x1f5),_0x3112d6=_0xb2a2e1(0x1c6)):(_0x2511e8=_0xb2a2e1(0x2c6),_0x3112d6='Strong\x20-\x20Good\x20password!');return{'score':_0x48963e,'strengthCategory':_0x2511e8,'feedback':_0x3112d6};}},escapeRegex=_0x348fbe=>{const _0x524b9c=_0x2c69c4;if(typeof _0x348fbe!==_0x524b9c(0x21b))return'';return _0x348fbe[_0x524b9c(0x20f)](/[.*+?^${}()|[\]\\]/g,'\x5c$&');};document[_0x2c69c4(0x16e)](_0x2c69c4(0x2e9),async()=>{const _0x4ac6bd=_0x2c69c4;document[_0x4ac6bd(0x1b2)](_0x4ac6bd(0x31e))[_0x4ac6bd(0x158)](_0x51ddfa=>{const _0x429645=_0x4ac6bd;_0x51ddfa[_0x429645(0x16e)](_0x429645(0x330),_0x2e84f7=>{const _0x5bbf21=_0x429645;_0x2e84f7[_0x5bbf21(0x2d2)]();const _0x4a36b7=_0x51ddfa['getAttribute']('data-tab');console[_0x5bbf21(0x298)](_0x5bbf21(0x1f8),_0x4a36b7),switchTab(_0x4a36b7);});}),document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x2bf))[_0x4ac6bd(0x16e)](_0x4ac6bd(0x180),handleDarkModeToggle),document[_0x4ac6bd(0x1b2)](_0x4ac6bd(0x130))[_0x4ac6bd(0x158)](_0x1b68d1=>{const _0x22e915=_0x4ac6bd;_0x1b68d1['addEventListener'](_0x22e915(0x180),handleThemeToggle);});const _0x29d961=localStorage['getItem'](_0x4ac6bd(0x195));_0x29d961===_0x4ac6bd(0x1bc)&&(document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x2bf))[_0x4ac6bd(0x151)]=!![],document[_0x4ac6bd(0x212)][_0x4ac6bd(0x306)][_0x4ac6bd(0x333)](_0x4ac6bd(0x178)),applyTheme(appSettings[_0x4ac6bd(0x163)]),document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x209))[_0x4ac6bd(0x24e)]['display']=_0x4ac6bd(0x26f)),document[_0x4ac6bd(0x19c)]('clearEncryptMessageBtn')[_0x4ac6bd(0x16e)]('click',()=>{clearEncryptFile();}),document[_0x4ac6bd(0x19c)]('clearEncryptedMessageBtn')[_0x4ac6bd(0x16e)]('click',()=>{clearDecryptFile();}),await initDatabase(),await loadSettings(),initSettingsUI(),await loadKeys(),document[_0x4ac6bd(0x19c)]('keyPassword')[_0x4ac6bd(0x16e)](_0x4ac6bd(0x29a),updatePasswordStrength),document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x225))[_0x4ac6bd(0x16e)](_0x4ac6bd(0x330),encryptMessage),document[_0x4ac6bd(0x19c)]('decryptBtn')[_0x4ac6bd(0x16e)](_0x4ac6bd(0x330),decryptMessage),document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x24c))[_0x4ac6bd(0x16e)](_0x4ac6bd(0x330),generateKey),document[_0x4ac6bd(0x19c)]('copyEncryptedBtn')['addEventListener'](_0x4ac6bd(0x330),()=>copyToClipboard(_0x4ac6bd(0x27a),_0x4ac6bd(0x167))),document['getElementById'](_0x4ac6bd(0x255))['addEventListener'](_0x4ac6bd(0x330),()=>copyToClipboard(_0x4ac6bd(0x30a),_0x4ac6bd(0x126))),document['getElementById'](_0x4ac6bd(0x1ea))[_0x4ac6bd(0x16e)]('click',()=>{const _0x1c8de0=_0x4ac6bd;document[_0x1c8de0(0x19c)]('encryptMessage')[_0x1c8de0(0x184)]='',document[_0x1c8de0(0x19c)](_0x1c8de0(0x27a))[_0x1c8de0(0x184)]='',document['getElementById'](_0x1c8de0(0x167))[_0x1c8de0(0x156)]=_0x1c8de0(0x1e4),document[_0x1c8de0(0x19c)](_0x1c8de0(0x167))['textContent']='',clearEncryptFile();}),document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x1b4))[_0x4ac6bd(0x16e)](_0x4ac6bd(0x330),()=>{const _0x51af46=_0x4ac6bd;document['getElementById']('encryptedMessage')[_0x51af46(0x184)]='',document[_0x51af46(0x19c)](_0x51af46(0x30a))['value']='',document[_0x51af46(0x19c)](_0x51af46(0x126))['className']='status',document[_0x51af46(0x19c)](_0x51af46(0x126))['textContent']='',clearDecryptFile(),window[_0x51af46(0x246)]=null;}),document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x26d))['addEventListener'](_0x4ac6bd(0x330),importKey),document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x268))[_0x4ac6bd(0x16e)]('click',exportAllKeys),document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x24d))[_0x4ac6bd(0x16e)](_0x4ac6bd(0x330),importState),document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x1ed))[_0x4ac6bd(0x16e)](_0x4ac6bd(0x330),saveSettings),document['getElementById'](_0x4ac6bd(0x2ee))['addEventListener'](_0x4ac6bd(0x330),resetSettings),document[_0x4ac6bd(0x19c)](_0x4ac6bd(0x133))[_0x4ac6bd(0x16e)](_0x4ac6bd(0x330),zeroAllKeys),encryptionKeySelect['addEventListener'](_0x4ac6bd(0x180),handleEncryptionKeyChange),decryptionKeySelect[_0x4ac6bd(0x16e)](_0x4ac6bd(0x180),handleDecryptionKeyChange);});async function initDatabase(){const _0x49798a=_0x2c69c4;if(!window[_0x49798a(0x2d6)]){showStatus(_0x49798a(0x1b6),_0x49798a(0x2e4),_0x49798a(0x273)),appSettings['useIndexedDB']=![];return;}return new Promise((_0xf1c710,_0x512042)=>{const _0x1baf60=_0x49798a,_0x439e28=indexedDB[_0x1baf60(0x339)](DB_NAME,DB_VERSION);_0x439e28[_0x1baf60(0x228)]=function(_0x42cca8){const _0x2daacf=_0x1baf60,_0x4e71da=_0x42cca8[_0x2daacf(0x1d8)][_0x2daacf(0x181)];!_0x4e71da['objectStoreNames']['contains'](KEYS_STORE)&&_0x4e71da[_0x2daacf(0x31c)](KEYS_STORE,{'keyPath':'id'}),!_0x4e71da[_0x2daacf(0x262)][_0x2daacf(0x284)](SETTINGS_STORE)&&_0x4e71da[_0x2daacf(0x31c)](SETTINGS_STORE,{'keyPath':'id'});},_0x439e28[_0x1baf60(0x337)]=function(_0x469d3e){const _0x127467=_0x1baf60;db=_0x469d3e[_0x127467(0x1d8)][_0x127467(0x181)],console[_0x127467(0x298)](_0x127467(0x2c8)),_0xf1c710();},_0x439e28[_0x1baf60(0x23e)]=function(_0x28b56a){const _0x475324=_0x1baf60;console[_0x475324(0x1e9)]('Database\x20error:',_0x28b56a['target'][_0x475324(0x1e9)]),showStatus(_0x475324(0x1b6),_0x475324(0x2a4),'warning'),appSettings[_0x475324(0x190)]=![],_0xf1c710();};});}function switchTab(_0x17cbae){const _0x36100c=_0x2c69c4;console[_0x36100c(0x298)](_0x36100c(0x302),_0x17cbae),tabBtns[_0x36100c(0x158)](_0x15f3e6=>{const _0xd6c16f=_0x36100c;_0x15f3e6[_0xd6c16f(0x32d)]('data-tab')===_0x17cbae?_0x15f3e6[_0xd6c16f(0x306)]['add']('active'):_0x15f3e6[_0xd6c16f(0x306)]['remove']('active');}),document[_0x36100c(0x19c)]('encryptMessage')['value']='',document[_0x36100c(0x19c)](_0x36100c(0x27a))['value']='',document[_0x36100c(0x19c)](_0x36100c(0x167))['className']=_0x36100c(0x1e4),document[_0x36100c(0x19c)](_0x36100c(0x167))['textContent']='',document[_0x36100c(0x19c)](_0x36100c(0x18d))[_0x36100c(0x184)]='',document[_0x36100c(0x19c)]('encryptionPassword')[_0x36100c(0x184)]='',document[_0x36100c(0x19c)]('encryptionPasswordGroup')[_0x36100c(0x24e)]['display']=_0x36100c(0x2a7),document[_0x36100c(0x19c)](_0x36100c(0x232))[_0x36100c(0x184)]='',document[_0x36100c(0x19c)]('encryptSign')[_0x36100c(0x151)]=![],document[_0x36100c(0x19c)](_0x36100c(0x17b))['value']=0x1,document[_0x36100c(0x19c)]('encryptSignGroup')[_0x36100c(0x24e)]['display']=_0x36100c(0x2a7),clearEncryptFile(),document[_0x36100c(0x19c)](_0x36100c(0x243))[_0x36100c(0x184)]='',document[_0x36100c(0x19c)]('decryptedOutput')[_0x36100c(0x184)]='',document[_0x36100c(0x19c)](_0x36100c(0x126))[_0x36100c(0x156)]=_0x36100c(0x1e4),document[_0x36100c(0x19c)](_0x36100c(0x126))['textContent']='',document['getElementById'](_0x36100c(0x140))[_0x36100c(0x184)]='',document[_0x36100c(0x19c)](_0x36100c(0x336))['value']='',document[_0x36100c(0x19c)](_0x36100c(0x2ae))[_0x36100c(0x24e)]['display']=_0x36100c(0x2a7),document['getElementById'](_0x36100c(0x25f))[_0x36100c(0x184)]='',document[_0x36100c(0x19c)](_0x36100c(0x26e))['checked']=![],document[_0x36100c(0x19c)]('decryptIterations')[_0x36100c(0x184)]=0x1,document[_0x36100c(0x19c)](_0x36100c(0x13d))['style'][_0x36100c(0x125)]=_0x36100c(0x2a7),clearDecryptFile(),window[_0x36100c(0x246)]=null,document[_0x36100c(0x19c)](_0x36100c(0x1a3))[_0x36100c(0x306)][_0x36100c(0x16f)]('active'),document[_0x36100c(0x19c)]('decrypt')[_0x36100c(0x306)][_0x36100c(0x16f)](_0x36100c(0x12a)),document[_0x36100c(0x19c)](_0x36100c(0x288))[_0x36100c(0x306)][_0x36100c(0x16f)](_0x36100c(0x12a)),document[_0x36100c(0x19c)](_0x36100c(0x2b3))[_0x36100c(0x306)][_0x36100c(0x16f)]('active'),document['getElementById']('learn')['classList'][_0x36100c(0x16f)](_0x36100c(0x12a)),document[_0x36100c(0x19c)](_0x17cbae)[_0x36100c(0x306)][_0x36100c(0x333)](_0x36100c(0x12a));}function setLoading(_0x115b60){const _0x299e74=_0x2c69c4;loadingOverlay['style'][_0x299e74(0x125)]=_0x115b60?'flex':_0x299e74(0x2a7);}async function loadSettings(){const _0x390ecc=_0x2c69c4;if(appSettings[_0x390ecc(0x190)]&&db)try{const _0x31c7c5=await getFromDatabase(SETTINGS_STORE,_0x390ecc(0x194));_0x31c7c5&&(appSettings={...DEFAULT_SETTINGS,..._0x31c7c5});}catch(_0x3ff647){console[_0x390ecc(0x1e9)](_0x390ecc(0x134),_0x3ff647);try{const _0x195bda=localStorage[_0x390ecc(0x1e7)](_0x390ecc(0x1f0));_0x195bda&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x390ecc(0x2bb)](_0x195bda)});}catch(_0x1f72b9){console[_0x390ecc(0x1e9)](_0x390ecc(0x2a2),_0x1f72b9);}}else try{const _0x4fed9c=localStorage[_0x390ecc(0x1e7)](_0x390ecc(0x1f0));_0x4fed9c&&(appSettings={...DEFAULT_SETTINGS,...JSON['parse'](_0x4fed9c)});}catch(_0x4fe1a0){console['error']('Error\x20loading\x20settings\x20from\x20localStorage:',_0x4fe1a0);}return PBKDF2_CONFIG[_0x390ecc(0x221)]=appSettings['pbkdf2Iterations'],appSettings;}function initSettingsUI(){const _0x4404d3=_0x2c69c4;document['getElementById'](_0x4404d3(0x190))[_0x4404d3(0x151)]=appSettings[_0x4404d3(0x190)],document[_0x4404d3(0x19c)](_0x4404d3(0x173))['checked']=appSettings['sessionOnly'],document['getElementById'](_0x4404d3(0x233))[_0x4404d3(0x151)]=appSettings[_0x4404d3(0x233)],document['getElementById'](_0x4404d3(0x23f))[_0x4404d3(0x151)]=appSettings['enforceKeyExpiry'],document[_0x4404d3(0x19c)](_0x4404d3(0x2bf))[_0x4404d3(0x151)]=localStorage['getItem'](_0x4404d3(0x195))===_0x4404d3(0x1bc),document[_0x4404d3(0x19c)](_0x4404d3(0x1f6))[_0x4404d3(0x184)]=appSettings[_0x4404d3(0x1f6)],applyTheme(appSettings['theme']);}async function saveSettings(){const _0x25a924=_0x2c69c4;try{appSettings[_0x25a924(0x190)]=document[_0x25a924(0x19c)](_0x25a924(0x190))['checked'],appSettings[_0x25a924(0x173)]=document['getElementById'](_0x25a924(0x173))[_0x25a924(0x151)],appSettings[_0x25a924(0x233)]=document[_0x25a924(0x19c)](_0x25a924(0x233))[_0x25a924(0x151)],appSettings[_0x25a924(0x23f)]=document[_0x25a924(0x19c)](_0x25a924(0x23f))['checked'],appSettings[_0x25a924(0x2bf)]=document[_0x25a924(0x19c)](_0x25a924(0x2bf))[_0x25a924(0x151)],appSettings[_0x25a924(0x1f6)]=parseInt(document['getElementById'](_0x25a924(0x1f6))[_0x25a924(0x184)]);const _0x4da96f=document[_0x25a924(0x2cc)](_0x25a924(0x1c0));appSettings[_0x25a924(0x163)]=_0x4da96f?_0x4da96f[_0x25a924(0x2a5)]['theme']:null,handleDarkModeToggle(),PBKDF2_CONFIG['ITERATIONS']=appSettings[_0x25a924(0x1f6)],appSettings['useIndexedDB']&&db?await saveToDatabase(SETTINGS_STORE,{'id':_0x25a924(0x194),...appSettings}):localStorage['setItem']('LemonadeSettings',JSON[_0x25a924(0x28f)](appSettings)),showStatus(_0x25a924(0x12b),_0x25a924(0x192),_0x25a924(0x17e));}catch(_0x34d661){console[_0x25a924(0x1e9)](_0x25a924(0x338),_0x34d661),showStatus(_0x25a924(0x12b),_0x25a924(0x205)+_0x34d661[_0x25a924(0x270)],_0x25a924(0x1e9));}}function resetSettings(){const _0x3f9913=confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20reset\x20all\x20settings\x20to\x20defaults?');if(!_0x3f9913)return;appSettings={...DEFAULT_SETTINGS},initSettingsUI(),saveSettings();}function updatePasswordStrength(){const _0x1b92ad=_0x2c69c4,_0x466d73=document[_0x1b92ad(0x19c)](_0x1b92ad(0x17d))[_0x1b92ad(0x184)],_0x5109a3=validator[_0x1b92ad(0x1b8)](_0x466d73),_0x283c56=document['getElementById'](_0x1b92ad(0x242)),_0x178c5d=document[_0x1b92ad(0x19c)](_0x1b92ad(0x19a));_0x283c56[_0x1b92ad(0x156)]=_0x1b92ad(0x296),_0x466d73?(_0x283c56[_0x1b92ad(0x306)][_0x1b92ad(0x333)](_0x5109a3[_0x1b92ad(0x162)]),_0x178c5d[_0x1b92ad(0x1f9)]=_0x5109a3[_0x1b92ad(0x191)]):_0x178c5d['textContent']='';}async function loadKeys(){const _0x4a2842=_0x2c69c4;try{keys=[];if(appSettings['useIndexedDB']&&db){const _0x6817a7=await getAllFromDatabase(KEYS_STORE);_0x6817a7&&_0x6817a7[_0x4a2842(0x1d4)]>0x0&&(keys=_0x6817a7);}else{const _0x4ed0d3=localStorage[_0x4a2842(0x1e7)](_0x4a2842(0x2ed));_0x4ed0d3&&(keys=JSON[_0x4a2842(0x2bb)](_0x4ed0d3));}checkExpiredKeys(),updateKeysList(),updateKeySelects();}catch(_0x1561ea){console[_0x4a2842(0x1e9)](_0x4a2842(0x2f8),_0x1561ea),showStatus('keyStatus',_0x4a2842(0x23a)+_0x1561ea[_0x4a2842(0x270)],'error');}}async function saveKeys(){const _0x186e0d=_0x2c69c4;try{if(appSettings['sessionOnly'])console['log']('Session-only\x20mode:\x20Keys\x20not\x20saved\x20persistently');else{if(appSettings[_0x186e0d(0x190)]&&db){await clearDatabase(KEYS_STORE);for(const _0x31be5a of keys){await saveToDatabase(KEYS_STORE,_0x31be5a);}}else localStorage[_0x186e0d(0x22a)]('LemonadeKeys',JSON[_0x186e0d(0x28f)](keys));}updateKeysList(),updateKeySelects();}catch(_0x18b9c8){console[_0x186e0d(0x1e9)](_0x186e0d(0x20e),_0x18b9c8),showStatus(_0x186e0d(0x1b6),_0x186e0d(0x2b8)+_0x18b9c8[_0x186e0d(0x270)],_0x186e0d(0x1e9));}}function checkExpiredKeys(){const _0x39ba94=_0x2c69c4,_0x3708ad=new Date(),_0x5ddaf5=[];keys[_0x39ba94(0x158)](_0x3f17ad=>{const _0x422589=_0x39ba94;if(_0x3f17ad['expiry']){const _0x4b49e8=new Date(_0x3f17ad[_0x422589(0x294)]);_0x4b49e8<_0x3708ad&&_0x5ddaf5[_0x422589(0x331)](_0x3f17ad['id']);}}),_0x5ddaf5['length']>0x0&&(keys=keys['filter'](_0xe1b45=>!_0x5ddaf5[_0x39ba94(0x2f5)](_0xe1b45['id'])),saveKeys(),showStatus(_0x39ba94(0x1b6),_0x5ddaf5[_0x39ba94(0x1d4)]+_0x39ba94(0x30b),_0x39ba94(0x273)));}async function generateKey(){const _0x315b9c=_0x2c69c4;try{setLoading(!![]);const _0x4046ca=document[_0x315b9c(0x19c)](_0x315b9c(0x19e))['value'][_0x315b9c(0x14b)](),_0x233e39=document[_0x315b9c(0x19c)](_0x315b9c(0x1e1))[_0x315b9c(0x184)],_0x47c179=document[_0x315b9c(0x19c)]('keyPassword')[_0x315b9c(0x184)],_0x301215=document['getElementById'](_0x315b9c(0x1b9))[_0x315b9c(0x184)],_0x1315ba=document[_0x315b9c(0x19c)](_0x315b9c(0x2da))['value'];if(!_0x4046ca){showStatus(_0x315b9c(0x1b6),_0x315b9c(0x1f1),_0x315b9c(0x1e9));return;}if(!validator['isValidKeyName'](_0x4046ca)){showStatus(_0x315b9c(0x1b6),'Key\x20name\x20can\x20only\x20contain\x20letters,\x20numbers,\x20spaces,\x20and\x20basic\x20punctuation\x20(._-)',_0x315b9c(0x1e9));return;}if(appSettings[_0x315b9c(0x233)]&&!_0x47c179){showStatus(_0x315b9c(0x1b6),_0x315b9c(0x26b),'error');return;}if(_0x47c179){const _0x14ccbb=validator['measurePasswordStrength'](_0x47c179);if(_0x14ccbb[_0x315b9c(0x2b2)]<0x4){showStatus('keyStatus',_0x315b9c(0x2b7)+_0x14ccbb[_0x315b9c(0x191)],_0x315b9c(0x1e9));return;}if(_0x47c179!==_0x301215){showStatus(_0x315b9c(0x1b6),_0x315b9c(0x1c1),_0x315b9c(0x1e9));return;}}if(appSettings[_0x315b9c(0x23f)]&&!_0x1315ba){showStatus(_0x315b9c(0x1b6),_0x315b9c(0x25b),_0x315b9c(0x1e9));return;}const _0x449dda={'id':crypto[_0x315b9c(0x304)](),'name':_0x4046ca,'type':_0x233e39,'created':new Date()[_0x315b9c(0x12f)]()};if(_0x1315ba){const _0x3f1439=parseInt(_0x1315ba),_0x34de81=new Date();_0x34de81[_0x315b9c(0x278)](_0x34de81[_0x315b9c(0x2a0)]()+_0x3f1439),_0x449dda[_0x315b9c(0x294)]=_0x34de81[_0x315b9c(0x12f)]();}const _0x317db6=_0x233e39==='rsa'||_0x233e39===_0x315b9c(0x1a2)||_0x233e39===_0x315b9c(0x2dd)||_0x233e39===_0x315b9c(0x185)||_0x233e39===_0x315b9c(0x2fb);_0x317db6&&(_0x449dda[_0x315b9c(0x2db)]=!![],_0x449dda[_0x315b9c(0x224)]=!![],_0x449dda[_0x315b9c(0x326)]=_0x449dda['id']);if(_0x233e39===_0x315b9c(0x21c))await generateAESKey(_0x449dda,_0x47c179);else{if(_0x233e39===_0x315b9c(0x1fa))await generateRSAKey(_0x449dda,_0x47c179,RSA_CONFIG[_0x315b9c(0x179)]);else{if(_0x233e39===_0x315b9c(0x1a2))await generateRSAKey(_0x449dda,_0x47c179,RSA_CONFIG[_0x315b9c(0x261)]);else{if(_0x233e39==='ecc')await generateECCKey(_0x449dda,_0x47c179,ECC_CONFIG[_0x315b9c(0x148)]);else{if(_0x233e39===_0x315b9c(0x185))await generateECCKey(_0x449dda,_0x47c179,ECC_CONFIG['CURVE_P384']);else _0x233e39===_0x315b9c(0x2fb)&&await generateECCKey(_0x449dda,_0x47c179,ECC_CONFIG['CURVE_P521']);}}}}keys['push'](_0x449dda),await saveKeys(),document['getElementById'](_0x315b9c(0x19e))[_0x315b9c(0x184)]='',document[_0x315b9c(0x19c)](_0x315b9c(0x17d))[_0x315b9c(0x184)]='',document[_0x315b9c(0x19c)](_0x315b9c(0x1b9))[_0x315b9c(0x184)]='',document[_0x315b9c(0x19c)]('passwordStrength')[_0x315b9c(0x156)]=_0x315b9c(0x296),document[_0x315b9c(0x19c)](_0x315b9c(0x19a))[_0x315b9c(0x1f9)]='';const _0x152e51=getKeyTypeDisplay(_0x449dda);showStatus(_0x315b9c(0x1b6),_0x152e51+_0x315b9c(0x1eb)+_0x4046ca+'\x22\x20generated\x20successfully','success');}catch(_0x6cb551){console['error'](_0x315b9c(0x266),_0x6cb551),showStatus(_0x315b9c(0x1b6),_0x315b9c(0x2fd)+_0x6cb551[_0x315b9c(0x270)],_0x315b9c(0x1e9));}finally{setLoading(![]);}}function getPairedKeyIds(_0x1ad194){const _0x350234=_0x2c69c4;if(_0x1ad194[_0x350234(0x326)])return _0x1ad194[_0x350234(0x326)];if(_0x1ad194[_0x350234(0x224)]&&_0x1ad194[_0x350234(0x2db)])return _0x1ad194['id'];if((_0x1ad194[_0x350234(0x281)]===_0x350234(0x1fa)||_0x1ad194[_0x350234(0x281)]===_0x350234(0x1a2)||_0x1ad194[_0x350234(0x281)]===_0x350234(0x2dd)||_0x1ad194[_0x350234(0x281)]==='ecc-p384')&&(_0x1ad194['hasPublic']||_0x1ad194[_0x350234(0x224)])){const _0x4e75d7=keys[_0x350234(0x149)](_0x327fd8=>_0x327fd8['id']!==_0x1ad194['id']&&_0x327fd8[_0x350234(0x281)]===_0x1ad194[_0x350234(0x281)]&&(_0x1ad194['hasPublic']&&_0x327fd8['hasPrivate']||_0x1ad194[_0x350234(0x224)]&&_0x327fd8['hasPublic'])&&(_0x327fd8[_0x350234(0x1bb)]&&_0x1ad194[_0x350234(0x1bb)]&&_0x327fd8['publicKeyHash']===_0x1ad194['publicKeyHash']));if(_0x4e75d7[_0x350234(0x1d4)]>0x0)return _0x4e75d7[0x0]['id'];}return null;}function zeroAllKeys(){const _0x5ef2c5=_0x2c69c4;if(keys['length']===0x0){showStatus(_0x5ef2c5(0x1b6),_0x5ef2c5(0x1f2),_0x5ef2c5(0x273));return;}const _0x230386=confirm(_0x5ef2c5(0x2aa));if(_0x230386){const _0x21e962=keys[_0x5ef2c5(0x1d4)];keys=[],appSettings[_0x5ef2c5(0x190)]&&db?clearDatabase(KEYS_STORE)[_0x5ef2c5(0x2a8)](()=>{const _0x19fc9a=_0x5ef2c5;console['log'](_0x19fc9a(0x33c));})[_0x5ef2c5(0x1ce)](_0x1a2b30=>{const _0x377f5e=_0x5ef2c5;console[_0x377f5e(0x1e9)]('Error\x20clearing\x20keys\x20from\x20database:',_0x1a2b30);}):localStorage['removeItem'](_0x5ef2c5(0x2ed)),updateKeysList(),updateKeySelects(),showStatus(_0x5ef2c5(0x1b6),'All\x20keys\x20('+_0x21e962+_0x5ef2c5(0x290),_0x5ef2c5(0x17e));}else showStatus(_0x5ef2c5(0x1b6),_0x5ef2c5(0x170),'info');}async function generateAESKey(_0x4ee910,_0x5a1347){const _0x3b7b44=_0x2c69c4,_0x584995=await window[_0x3b7b44(0x2bc)][_0x3b7b44(0x230)][_0x3b7b44(0x231)]({'name':AES_CONFIG[_0x3b7b44(0x182)],'length':AES_CONFIG[_0x3b7b44(0x2af)]},!![],[_0x3b7b44(0x1a3),_0x3b7b44(0x32c)]),_0x38e557=await window[_0x3b7b44(0x2bc)][_0x3b7b44(0x230)][_0x3b7b44(0x153)](_0x3b7b44(0x1b0),_0x584995);_0x4ee910[_0x3b7b44(0x31f)]=arrayBufferToBase64(_0x38e557),_0x4ee910[_0x3b7b44(0x2e7)]=AES_CONFIG['MODE'],_0x4ee910[_0x3b7b44(0x1d4)]=AES_CONFIG[_0x3b7b44(0x2af)],_0x5a1347&&await encryptKeyWithPassword(_0x4ee910,_0x5a1347);}async function generateRSAKey(_0x4b70a9,_0x45f046,_0x2bd9d3){const _0x3568e2=_0x2c69c4,_0x2e6570=await window[_0x3568e2(0x2bc)][_0x3568e2(0x230)]['generateKey']({'name':RSA_CONFIG[_0x3568e2(0x1a1)],'modulusLength':_0x2bd9d3,'publicExponent':new Uint8Array([0x1,0x0,0x1]),'hash':RSA_CONFIG[_0x3568e2(0x2d1)]},!![],[_0x3568e2(0x1a3),_0x3568e2(0x32c)]),_0x1a705c=await window[_0x3568e2(0x2bc)][_0x3568e2(0x230)][_0x3568e2(0x153)](_0x3568e2(0x30d),_0x2e6570[_0x3568e2(0x123)]),_0x4daefa=await window[_0x3568e2(0x2bc)][_0x3568e2(0x230)][_0x3568e2(0x153)]('pkcs8',_0x2e6570['privateKey']);_0x4b70a9[_0x3568e2(0x123)]=arrayBufferToBase64(_0x1a705c),_0x4b70a9[_0x3568e2(0x1bd)]=arrayBufferToBase64(_0x4daefa),_0x4b70a9[_0x3568e2(0x2e7)]=RSA_CONFIG[_0x3568e2(0x1a1)],_0x4b70a9[_0x3568e2(0x1d4)]=_0x2bd9d3;const _0x1df975=await window[_0x3568e2(0x2bc)][_0x3568e2(0x230)]['generateKey']({'name':SIGN_CONFIG[_0x3568e2(0x27c)],'modulusLength':_0x2bd9d3,'publicExponent':new Uint8Array([0x1,0x0,0x1]),'hash':SIGN_CONFIG[_0x3568e2(0x2d1)]},!![],[_0x3568e2(0x28d),'verify']),_0xde5046=await window[_0x3568e2(0x2bc)][_0x3568e2(0x230)][_0x3568e2(0x153)](_0x3568e2(0x30d),_0x1df975[_0x3568e2(0x123)]),_0x10e4f3=await window['crypto'][_0x3568e2(0x230)][_0x3568e2(0x153)]('pkcs8',_0x1df975[_0x3568e2(0x1bd)]);_0x4b70a9[_0x3568e2(0x20d)]=arrayBufferToBase64(_0xde5046),_0x4b70a9[_0x3568e2(0x234)]=arrayBufferToBase64(_0x10e4f3),_0x4b70a9['hasSigningPublic']=!![],_0x4b70a9[_0x3568e2(0x1e6)]=!![];const _0x39987e=await computeKeyHash(_0x1a705c);_0x4b70a9[_0x3568e2(0x1bb)]=_0x39987e,_0x45f046&&await encryptKeyWithPassword(_0x4b70a9,_0x45f046);}async function generateECCKey(_0x383c88,_0x1dc287,_0x9b1a3c){const _0x3f81c6=_0x2c69c4,_0x1de994=await window[_0x3f81c6(0x2bc)][_0x3f81c6(0x230)][_0x3f81c6(0x231)]({'name':_0x3f81c6(0x211),'namedCurve':_0x9b1a3c},!![],[_0x3f81c6(0x1de),_0x3f81c6(0x260)]),_0x5ee13e=await window[_0x3f81c6(0x2bc)][_0x3f81c6(0x230)][_0x3f81c6(0x153)](_0x3f81c6(0x30d),_0x1de994['publicKey']),_0x3b55ba=await window[_0x3f81c6(0x2bc)]['subtle'][_0x3f81c6(0x153)]('pkcs8',_0x1de994[_0x3f81c6(0x1bd)]);_0x383c88[_0x3f81c6(0x123)]=arrayBufferToBase64(_0x5ee13e),_0x383c88[_0x3f81c6(0x1bd)]=arrayBufferToBase64(_0x3b55ba),_0x383c88[_0x3f81c6(0x2e7)]=_0x3f81c6(0x211),_0x383c88[_0x3f81c6(0x1ee)]=_0x9b1a3c;const _0x5ceb8b=await window[_0x3f81c6(0x2bc)][_0x3f81c6(0x230)]['generateKey']({'name':SIGN_CONFIG[_0x3f81c6(0x287)],'namedCurve':_0x9b1a3c},!![],[_0x3f81c6(0x28d),_0x3f81c6(0x172)]),_0x110c5=await window['crypto'][_0x3f81c6(0x230)][_0x3f81c6(0x153)](_0x3f81c6(0x30d),_0x5ceb8b[_0x3f81c6(0x123)]),_0x149486=await window[_0x3f81c6(0x2bc)]['subtle'][_0x3f81c6(0x153)](_0x3f81c6(0x14d),_0x5ceb8b[_0x3f81c6(0x1bd)]);_0x383c88[_0x3f81c6(0x20d)]=arrayBufferToBase64(_0x110c5),_0x383c88[_0x3f81c6(0x234)]=arrayBufferToBase64(_0x149486),_0x383c88[_0x3f81c6(0x318)]=!![],_0x383c88[_0x3f81c6(0x1e6)]=!![];const _0x1fdbae=await computeKeyHash(_0x5ee13e);_0x383c88['publicKeyHash']=_0x1fdbae,_0x1dc287&&await encryptKeyWithPassword(_0x383c88,_0x1dc287);}async function computeKeyHash(_0x39dbf4){const _0x346bad=_0x2c69c4,_0x1ee442=await crypto[_0x346bad(0x230)][_0x346bad(0x220)](_0x346bad(0x14a),_0x39dbf4);return arrayBufferToBase64(_0x1ee442);}async function encryptKeyWithPassword(_0x125b02,_0x517ba3){const _0x54a655=_0x2c69c4,_0x200463=window[_0x54a655(0x2bc)]['getRandomValues'](new Uint8Array(0x10));_0x125b02[_0x54a655(0x12c)]=arrayBufferToBase64(_0x200463);const _0x48f994=await deriveKeyFromPassword(_0x517ba3,_0x200463),_0x8754d=window['crypto'][_0x54a655(0x2ca)](new Uint8Array(AES_CONFIG['IV_LENGTH']));_0x125b02['iv']=arrayBufferToBase64(_0x8754d);if(_0x125b02[_0x54a655(0x281)]===_0x54a655(0x21c)){const _0x591a5b=await encryptWithDerivedKey(_0x48f994,base64ToArrayBuffer(_0x125b02['key']),_0x8754d);_0x125b02['key']=arrayBufferToBase64(_0x591a5b),_0x125b02[_0x54a655(0x2dc)]=!![];}else{const _0x18c066=await encryptWithDerivedKey(_0x48f994,base64ToArrayBuffer(_0x125b02['privateKey']),_0x8754d);_0x125b02[_0x54a655(0x1bd)]=arrayBufferToBase64(_0x18c066);if(_0x125b02['signingPrivateKey']){const _0x2ea447=await encryptWithDerivedKey(_0x48f994,base64ToArrayBuffer(_0x125b02[_0x54a655(0x234)]),_0x8754d);_0x125b02[_0x54a655(0x234)]=arrayBufferToBase64(_0x2ea447);}_0x125b02['protected']=!![];}}async function decryptKeyWithPassword(_0x134a62,_0x5df49b){const _0x3858e2=_0x2c69c4;try{if(!_0x134a62||!_0x5df49b)throw new Error('Key\x20data\x20and\x20password\x20are\x20required');if(!_0x134a62[_0x3858e2(0x12c)]||!_0x134a62['iv'])throw new Error(_0x3858e2(0x208));const _0x41a53f=base64ToArrayBuffer(_0x134a62[_0x3858e2(0x12c)]),_0x55da09=await deriveKeyFromPassword(_0x5df49b,_0x41a53f),_0x2268b5=base64ToArrayBuffer(_0x134a62['iv']),_0x390cb2={..._0x134a62};if(_0x134a62[_0x3858e2(0x281)]===_0x3858e2(0x21c)){if(!_0x134a62[_0x3858e2(0x31f)])throw new Error(_0x3858e2(0x276));const _0x3b239c=await decryptWithDerivedKey(_0x55da09,base64ToArrayBuffer(_0x134a62[_0x3858e2(0x31f)]),_0x2268b5);_0x390cb2[_0x3858e2(0x31f)]=arrayBufferToBase64(_0x3b239c),_0x390cb2['_cryptoKey']=await importAESKey(_0x3b239c);}else{if(_0x134a62[_0x3858e2(0x281)]==='rsa'||_0x134a62['type']===_0x3858e2(0x1a2)||_0x134a62['type']===_0x3858e2(0x2dd)||_0x134a62['type']===_0x3858e2(0x185)||_0x134a62[_0x3858e2(0x281)]==='ecc-p521'){if(!_0x134a62[_0x3858e2(0x1bd)])throw new Error(_0x3858e2(0x258));const _0x527172=await decryptWithDerivedKey(_0x55da09,base64ToArrayBuffer(_0x134a62['privateKey']),_0x2268b5);_0x390cb2['privateKey']=arrayBufferToBase64(_0x527172);_0x134a62[_0x3858e2(0x281)][_0x3858e2(0x2f5)](_0x3858e2(0x1fa))?(_0x390cb2[_0x3858e2(0x32a)]=await importRSAPrivateKey(_0x527172,_0x134a62[_0x3858e2(0x1d4)]||RSA_CONFIG[_0x3858e2(0x179)]),_0x134a62[_0x3858e2(0x123)]&&(_0x390cb2[_0x3858e2(0x2e2)]=await importRSAPublicKey(base64ToArrayBuffer(_0x134a62[_0x3858e2(0x123)]),_0x134a62[_0x3858e2(0x1d4)]||RSA_CONFIG[_0x3858e2(0x179)]))):(_0x390cb2['_privateKey']=await importECCPrivateKey(_0x527172,_0x134a62['curve']||ECC_CONFIG[_0x3858e2(0x148)]),_0x134a62[_0x3858e2(0x123)]&&(_0x390cb2[_0x3858e2(0x2e2)]=await importECCPublicKey(base64ToArrayBuffer(_0x134a62[_0x3858e2(0x123)]),_0x134a62[_0x3858e2(0x1ee)]||ECC_CONFIG[_0x3858e2(0x148)])));if(_0x134a62['signingPrivateKey']){const _0x2bb2f3=await decryptWithDerivedKey(_0x55da09,base64ToArrayBuffer(_0x134a62[_0x3858e2(0x234)]),_0x2268b5);_0x390cb2[_0x3858e2(0x234)]=arrayBufferToBase64(_0x2bb2f3);const _0x2cf6ae=_0x134a62['type'][_0x3858e2(0x2f5)](_0x3858e2(0x1fa)),_0x2d6008=_0x2cf6ae?SIGN_CONFIG[_0x3858e2(0x27c)]:SIGN_CONFIG[_0x3858e2(0x287)],_0x92c2b0=_0x2cf6ae?{'name':_0x2d6008,'hash':SIGN_CONFIG['HASH']}:{'name':_0x2d6008,'namedCurve':_0x134a62[_0x3858e2(0x1ee)]||ECC_CONFIG[_0x3858e2(0x148)]};_0x390cb2[_0x3858e2(0x2e3)]=await window['crypto'][_0x3858e2(0x230)][_0x3858e2(0x2ba)]('pkcs8',_0x2bb2f3,_0x92c2b0,![],[_0x3858e2(0x28d)]);}}else throw new Error(_0x3858e2(0x2fe)+_0x134a62[_0x3858e2(0x281)]);}return safeMemory[_0x3858e2(0x328)](_0x390cb2);}catch(_0x1840a2){console[_0x3858e2(0x1e9)](_0x3858e2(0x2a3),_0x1840a2);throw new Error(_0x3858e2(0x2e5));}}function updateKeysList(){const _0x1de042=_0x2c69c4;keysList[_0x1de042(0x24b)]='';if(keys['length']===0x0){keysList[_0x1de042(0x24b)]=_0x1de042(0x1a6);return;}keys[_0x1de042(0x158)](_0x2541c6=>{const _0x139ca7=_0x1de042,_0xc034ac=document[_0x139ca7(0x272)](_0x139ca7(0x291));_0xc034ac[_0x139ca7(0x156)]=_0x139ca7(0x219);const _0x371202=getKeyTypeDisplay(_0x2541c6),_0x12cde6=_0x2541c6['protected']?_0x139ca7(0x1b7):'';let _0x197a76='';if(_0x2541c6[_0x139ca7(0x281)]===_0x139ca7(0x21c))_0x197a76='';else{if(_0x2541c6[_0x139ca7(0x224)]&&_0x2541c6['hasPublic'])_0x197a76='<span\x20class=\x22key-pair-badge\x20full\x22>FULL\x20KEY\x20PAIR</span>';else{if(_0x2541c6[_0x139ca7(0x224)])_0x197a76=_0x139ca7(0x28c);else _0x2541c6[_0x139ca7(0x2db)]&&(_0x197a76=_0x139ca7(0x22f));}}let _0x9ac289='',_0x37ea72=determineKeySecurityLevel(_0x2541c6);_0x9ac289=_0x139ca7(0x301)+_0x37ea72+'\x22>'+_0x37ea72[_0x139ca7(0x1ff)]()+_0x139ca7(0x30c);let _0x56e2ad='';if(_0x2541c6['expiry']){const _0xdb0d71=new Date(_0x2541c6[_0x139ca7(0x294)]),_0xdf0b98=Math[_0x139ca7(0x240)]((_0xdb0d71-new Date())/(0x3e8*0x3c*0x3c*0x18));_0x56e2ad=_0x139ca7(0x2c0)+_0xdf0b98+_0x139ca7(0x253)+_0xdb0d71['toLocaleDateString']()+_0x139ca7(0x289);}let _0x3b0348='';if(_0x2541c6[_0x139ca7(0x281)]===_0x139ca7(0x21c))_0x3b0348+=_0x139ca7(0x31b)+_0x2541c6['id']+_0x139ca7(0x15a);else _0x2541c6['hasPublic']&&(_0x3b0348+='<button\x20class=\x22btn-secondary\x22\x20onclick=\x22exportKey(\x27'+_0x2541c6['id']+_0x139ca7(0x30e));_0x2541c6[_0x139ca7(0x281)]!==_0x139ca7(0x21c)&&_0x2541c6[_0x139ca7(0x224)]&&(_0x3b0348+='<button\x20class=\x22btn-secondary\x20private-key-btn\x22\x20onclick=\x22exportPrivateKey(\x27'+_0x2541c6['id']+_0x139ca7(0x198)),_0x3b0348+=_0x139ca7(0x210)+_0x2541c6['id']+_0x139ca7(0x143),_0xc034ac[_0x139ca7(0x24b)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-item-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>'+validator[_0x139ca7(0x325)](_0x2541c6[_0x139ca7(0x319)])+'\x20('+_0x371202+_0x12cde6+')\x20'+_0x9ac289+_0x139ca7(0x327)+_0x197a76+_0x139ca7(0x1d7)+new Date(_0x2541c6[_0x139ca7(0x18b)])[_0x139ca7(0x280)]()+_0x139ca7(0x28b)+(_0x2541c6[_0x139ca7(0x2e7)]||'')+'\x20'+(_0x2541c6[_0x139ca7(0x1d4)]?_0x2541c6[_0x139ca7(0x1d4)]+'\x20bits':_0x2541c6[_0x139ca7(0x1ee)]||'')+_0x139ca7(0x33b)+_0x56e2ad+_0x139ca7(0x24f)+_0x3b0348+_0x139ca7(0x15d),keysList[_0x139ca7(0x2ef)](_0xc034ac);});}function getKeyTypeDisplay(_0x3e058d){const _0x21ec1a=_0x2c69c4;if(_0x3e058d['type']===_0x21ec1a(0x21c))return'AES';else{if(_0x3e058d[_0x21ec1a(0x281)]===_0x21ec1a(0x1fa))return _0x21ec1a(0x15c);else{if(_0x3e058d[_0x21ec1a(0x281)]===_0x21ec1a(0x1a2))return'RSA-4096';else{if(_0x3e058d['type']===_0x21ec1a(0x2dd))return _0x21ec1a(0x312);else{if(_0x3e058d[_0x21ec1a(0x281)]===_0x21ec1a(0x185))return'ECC-P384';else{if(_0x3e058d[_0x21ec1a(0x281)]===_0x21ec1a(0x2fb))return _0x21ec1a(0x25c);}}}}}return _0x3e058d[_0x21ec1a(0x281)]['toUpperCase']();}function updateKeySelects(){const _0x55b580=_0x2c69c4;encryptionKeySelect[_0x55b580(0x24b)]='<option\x20value=\x22\x22>Select\x20a\x20key...</option>',decryptionKeySelect[_0x55b580(0x24b)]=_0x55b580(0x16a),keys[_0x55b580(0x158)](_0x2d9c85=>{const _0x3e1284=_0x55b580;if(_0x2d9c85[_0x3e1284(0x281)]==='aes'||_0x2d9c85['hasPublic']){const _0x3f1540=document[_0x3e1284(0x272)](_0x3e1284(0x25e));_0x3f1540[_0x3e1284(0x184)]=_0x2d9c85['id'];const _0x281c66=getKeyTypeDisplay(_0x2d9c85),_0x380ab7=_0x2d9c85[_0x3e1284(0x2dc)]?_0x3e1284(0x1b7):'';let _0x7b4fd9='';_0x2d9c85[_0x3e1284(0x281)]!==_0x3e1284(0x21c)&&(_0x7b4fd9=_0x2d9c85[_0x3e1284(0x224)]&&_0x2d9c85[_0x3e1284(0x2db)]?'\x20[Full\x20Pair]':'\x20[Public]'),_0x3f1540[_0x3e1284(0x13f)]=_0x2d9c85['name']+'\x20('+_0x281c66+_0x7b4fd9+_0x380ab7+')',encryptionKeySelect[_0x3e1284(0x2ef)](_0x3f1540);}}),keys[_0x55b580(0x158)](_0x5e680a=>{const _0x3e0bb5=_0x55b580;if(_0x5e680a[_0x3e0bb5(0x281)]===_0x3e0bb5(0x21c)||_0x5e680a['hasPrivate']){const _0x3820ef=document[_0x3e0bb5(0x272)](_0x3e0bb5(0x25e));_0x3820ef['value']=_0x5e680a['id'];const _0x7458bb=getKeyTypeDisplay(_0x5e680a),_0x45de42=_0x5e680a[_0x3e0bb5(0x2dc)]?_0x3e0bb5(0x1b7):'';let _0x12409a='';_0x5e680a[_0x3e0bb5(0x281)]!==_0x3e0bb5(0x21c)&&(_0x12409a=_0x5e680a[_0x3e0bb5(0x224)]&&_0x5e680a[_0x3e0bb5(0x2db)]?_0x3e0bb5(0x2f7):_0x3e0bb5(0x1a5)),_0x3820ef[_0x3e0bb5(0x13f)]=_0x5e680a[_0x3e0bb5(0x319)]+'\x20('+_0x7458bb+_0x12409a+_0x45de42+')',decryptionKeySelect[_0x3e0bb5(0x2ef)](_0x3820ef);}});}function handleEncryptionKeyChange(){const _0x59ed58=_0x2c69c4,_0x397cff=encryptionKeySelect['value'];document['getElementById'](_0x59ed58(0x25d))[_0x59ed58(0x24e)][_0x59ed58(0x125)]='none',document[_0x59ed58(0x19c)](_0x59ed58(0x136))[_0x59ed58(0x151)]=![];if(!_0x397cff){document['getElementById'](_0x59ed58(0x174))['style'][_0x59ed58(0x125)]='none';return;}const _0x1ef9f5=keys['find'](_0x5f3603=>_0x5f3603['id']===_0x397cff);if(!_0x1ef9f5)return;_0x1ef9f5['hasSigningPrivate']&&(document[_0x59ed58(0x19c)](_0x59ed58(0x25d))[_0x59ed58(0x24e)][_0x59ed58(0x125)]='block'),document[_0x59ed58(0x19c)](_0x59ed58(0x174))['style']['display']=_0x1ef9f5[_0x59ed58(0x2dc)]?_0x59ed58(0x26f):_0x59ed58(0x2a7);}function handleDecryptionKeyChange(){const _0x415c67=_0x2c69c4,_0x421450=decryptionKeySelect[_0x415c67(0x184)];document[_0x415c67(0x19c)]('decryptVerifyGroup')[_0x415c67(0x24e)]['display']=_0x415c67(0x2a7),document[_0x415c67(0x19c)](_0x415c67(0x26e))[_0x415c67(0x151)]=![];if(!_0x421450){document[_0x415c67(0x19c)](_0x415c67(0x2ae))[_0x415c67(0x24e)][_0x415c67(0x125)]='none';return;}const _0x391453=keys['find'](_0x22c51e=>_0x22c51e['id']===_0x421450);if(!_0x391453)return;_0x391453[_0x415c67(0x318)]&&(document['getElementById'](_0x415c67(0x13d))[_0x415c67(0x24e)][_0x415c67(0x125)]=_0x415c67(0x26f)),document[_0x415c67(0x19c)](_0x415c67(0x2ae))[_0x415c67(0x24e)][_0x415c67(0x125)]=_0x391453[_0x415c67(0x2dc)]?_0x415c67(0x26f):_0x415c67(0x2a7);}async function encryptMessage(){const _0x53968a=_0x2c69c4;try{let _0x3253c9,_0x357d56='';if(encryptFileData)_0x3253c9=encryptFileData,_0x357d56=generateRandomFileName(0x6)+_0x53968a(0x20b);else{const _0x1476a7=document[_0x53968a(0x19c)](_0x53968a(0x2ac))[_0x53968a(0x184)];if(!_0x1476a7){showStatus('encryptStatus',_0x53968a(0x13a),_0x53968a(0x1e9));return;}_0x3253c9=new TextEncoder()[_0x53968a(0x175)](_0x1476a7);}const _0x54e387=document['getElementById'](_0x53968a(0x18d))['value'],_0x16fd2c=document[_0x53968a(0x19c)]('encryptionPassword')[_0x53968a(0x184)];let _0x18fc86=document[_0x53968a(0x19c)]('encryptObfKey')[_0x53968a(0x184)];const _0x19e369=parseInt(document[_0x53968a(0x19c)]('encryptIterations')[_0x53968a(0x184)],0xa)||0x1;if(!_0x54e387){showStatus(_0x53968a(0x167),_0x53968a(0x2a9),_0x53968a(0x1e9));return;}setLoading(!![]);const _0x365fe8=keys[_0x53968a(0x1cf)](_0x5058c0=>_0x5058c0['id']===_0x54e387);if(!_0x365fe8){showStatus('encryptStatus',_0x53968a(0x160),'error'),setLoading(![]);return;}let _0x1c8f6e=null,_0x34431e=_0x365fe8;if(_0x365fe8[_0x53968a(0x2dc)]){if(!_0x16fd2c){showStatus(_0x53968a(0x167),'Password\x20required\x20for\x20this\x20key','error'),setLoading(![]);return;}try{_0x1c8f6e=await decryptKeyWithPassword(_0x365fe8,_0x16fd2c),_0x34431e=safeMemory[_0x53968a(0x2b5)](_0x1c8f6e);if(!_0x34431e)throw new Error('Failed\x20to\x20retrieve\x20decrypted\x20key\x20from\x20memory.');}catch(_0x51f887){console[_0x53968a(0x1e9)]('[ENCRYPT-UI]\x20Key\x20password\x20error:',_0x51f887),showStatus(_0x53968a(0x167),_0x53968a(0x13b),_0x53968a(0x1e9)),setLoading(![]);return;}}const _0x970331=document['getElementById']('encryptSign')[_0x53968a(0x151)];let _0x43e169=_0x3253c9,_0x517e55='';for(let _0x40483f=0x0;_0x40483f<_0x19e369;_0x40483f++){let _0x58aea4=await encryptData(_0x43e169,_0x34431e,_0x970331);_0x40483f===0x0&&encryptFileData&&(_0x58aea4['fileName']=encryptFileName,_0x58aea4[_0x53968a(0x292)]=encryptFileData[_0x53968a(0x299)],_0x58aea4[_0x53968a(0x2a1)]=!![]);const _0x187abc=createEncryptedMessageString(_0x58aea4,_0x18fc86);_0x517e55=_0x187abc,_0x43e169=new TextEncoder()[_0x53968a(0x175)](_0x517e55);}_0x1c8f6e&&safeMemory[_0x53968a(0x15f)](_0x1c8f6e),document[_0x53968a(0x19c)]('encryptedOutput')[_0x53968a(0x184)]=_0x517e55,document[_0x53968a(0x19c)](_0x53968a(0x2f3))['setAttribute'](_0x53968a(0x1f7),_0x357d56),showStatus(_0x53968a(0x167),_0x53968a(0x137),_0x53968a(0x17e));}catch(_0x323182){console[_0x53968a(0x1e9)]('[ENCRYPT-UI]\x20Encryption\x20error:',{'errorType':_0x323182['constructor'][_0x53968a(0x319)],'errorMessage':_0x323182[_0x53968a(0x270)],'stack':_0x323182[_0x53968a(0x207)]}),showStatus(_0x53968a(0x167),'Encryption\x20failed.\x20Please\x20check\x20your\x20key\x20and\x20message.',_0x53968a(0x1e9));}finally{document[_0x53968a(0x19c)]('encryptionPassword')[_0x53968a(0x184)]='',setLoading(![]);}}async function encryptWithAES(_0x305f45,_0x438c1b){const _0x1141c2=_0x2c69c4;try{const _0x17490c=window[_0x1141c2(0x2bc)][_0x1141c2(0x2ca)](new Uint8Array(AES_CONFIG[_0x1141c2(0x252)]));let _0x2eb178;if(_0x438c1b[_0x1141c2(0x1ab)])_0x2eb178=_0x438c1b[_0x1141c2(0x1ab)];else{const _0x1255fd=base64ToArrayBuffer(_0x438c1b['key']);_0x2eb178=await window[_0x1141c2(0x2bc)][_0x1141c2(0x230)][_0x1141c2(0x2ba)](_0x1141c2(0x1b0),_0x1255fd,{'name':AES_CONFIG[_0x1141c2(0x182)],'length':AES_CONFIG[_0x1141c2(0x2af)]},![],['encrypt']);}const _0x300845=arrayBufferToBase64(_0x305f45),_0x2da0a7=0x10+Math[_0x1141c2(0x19d)](Math[_0x1141c2(0x1fe)]()*0xf1),_0x3dbd63=window[_0x1141c2(0x2bc)][_0x1141c2(0x2ca)](new Uint8Array(_0x2da0a7)),_0x294c51=arrayBufferToBase64(_0x3dbd63[_0x1141c2(0x1ac)]),_0x3f8ef3={'k':_0x438c1b['id'],'t':new Date()[_0x1141c2(0x12f)](),'a':AES_CONFIG['MODE']};encryptFileData&&encryptFileName&&(_0x3f8ef3['f']={'n':encryptFileName,'s':encryptFileData[_0x1141c2(0x299)]});const _0x1b7edd={'msg':_0x300845,'meta':_0x3f8ef3,'pad':_0x294c51},_0x2eedcb=JSON[_0x1141c2(0x28f)](_0x1b7edd),_0x2631f1=new TextEncoder()[_0x1141c2(0x175)](_0x2eedcb),_0x33c92e=await window['crypto'][_0x1141c2(0x230)][_0x1141c2(0x1a3)]({'name':AES_CONFIG[_0x1141c2(0x182)],'iv':_0x17490c,'tagLength':AES_CONFIG[_0x1141c2(0x2d8)]},_0x2eb178,_0x2631f1),_0x2df312=new Uint8Array(_0x17490c[_0x1141c2(0x299)]+_0x33c92e['byteLength']);return _0x2df312[_0x1141c2(0x1d9)](_0x17490c,0x0),_0x2df312[_0x1141c2(0x1d9)](new Uint8Array(_0x33c92e),_0x17490c[_0x1141c2(0x299)]),{'version':0x4,'data':arrayBufferToBase64(_0x2df312[_0x1141c2(0x1ac)])};}catch(_0x4438a7){console[_0x1141c2(0x1e9)](_0x1141c2(0x23c),{'errorType':_0x4438a7[_0x1141c2(0x183)][_0x1141c2(0x319)],'errorMessage':_0x4438a7[_0x1141c2(0x270)],'stack':_0x4438a7[_0x1141c2(0x207)]});throw new Error(_0x1141c2(0x217));}}async function deriveMetadataKey(_0x48b4d5,_0x3281b2){const _0x5bcad7=_0x2c69c4,_0x1d55af=await window[_0x5bcad7(0x2bc)]['subtle'][_0x5bcad7(0x153)](_0x5bcad7(0x1b0),_0x48b4d5),_0x3e0d57=new Uint8Array(_0x1d55af['byteLength']+_0x3281b2['byteLength']);_0x3e0d57['set'](new Uint8Array(_0x1d55af),0x0),_0x3e0d57[_0x5bcad7(0x1d9)](_0x3281b2,_0x1d55af[_0x5bcad7(0x299)]);const _0x170292=await window[_0x5bcad7(0x2bc)]['subtle'][_0x5bcad7(0x2ba)]('raw',_0x3e0d57,{'name':_0x5bcad7(0x279)},![],[_0x5bcad7(0x1de)]);return window[_0x5bcad7(0x2bc)][_0x5bcad7(0x230)][_0x5bcad7(0x1de)]({'name':_0x5bcad7(0x279),'hash':_0x5bcad7(0x14a),'salt':_0x3281b2,'info':new Uint8Array([0x1,0x2,0x3,0x4])},_0x170292,{'name':AES_CONFIG[_0x5bcad7(0x182)],'length':AES_CONFIG[_0x5bcad7(0x2af)]},![],[_0x5bcad7(0x1a3),'decrypt']);}async function encryptWithRSA(_0xb0b7d2,_0x102edc,_0x4a586a){const _0x2c219b=_0x2c69c4,_0x2db04e=await window['crypto']['subtle'][_0x2c219b(0x231)]({'name':AES_CONFIG[_0x2c219b(0x182)],'length':AES_CONFIG[_0x2c219b(0x2af)]},!![],[_0x2c219b(0x1a3)]),_0x3647dd=arrayBufferToBase64(_0xb0b7d2);let _0x233685=null;if(_0x4a586a&&_0x102edc[_0x2c219b(0x1e6)])try{let _0x1f13cc=_0x102edc[_0x2c219b(0x2e3)];!_0x1f13cc&&_0x102edc[_0x2c219b(0x234)]&&(_0x1f13cc=await window[_0x2c219b(0x2bc)]['subtle'][_0x2c219b(0x2ba)](_0x2c219b(0x14d),base64ToArrayBuffer(_0x102edc[_0x2c219b(0x234)]),{'name':SIGN_CONFIG[_0x2c219b(0x27c)],'hash':SIGN_CONFIG[_0x2c219b(0x2d1)]},![],[_0x2c219b(0x28d)]));if(_0x1f13cc){const _0x40e3fb=await window[_0x2c219b(0x2bc)][_0x2c219b(0x230)][_0x2c219b(0x28d)]({'name':SIGN_CONFIG[_0x2c219b(0x27c)],'saltLength':SIGN_CONFIG[_0x2c219b(0x1b5)]},_0x1f13cc,_0xb0b7d2);_0x233685=arrayBufferToBase64(_0x40e3fb);}}catch(_0x448da9){console['error'](_0x2c219b(0x329),_0x448da9);}const _0x4da604=0x10+Math[_0x2c219b(0x19d)](Math['random']()*0xf1),_0x4ee0ac=window[_0x2c219b(0x2bc)]['getRandomValues'](new Uint8Array(_0x4da604)),_0x2220d3=arrayBufferToBase64(_0x4ee0ac['buffer']),_0x2027c4={'k':_0x102edc['id'],'t':new Date()['toISOString'](),'a':RSA_CONFIG['ALGORITHM']+'+'+AES_CONFIG['MODE'],'s':_0x102edc[_0x2c219b(0x1d4)]||RSA_CONFIG['KEY_SIZE']};_0x233685&&(_0x2027c4[_0x2c219b(0x12e)]=_0x233685);encryptFileData&&encryptFileName&&(_0x2027c4['f']={'n':encryptFileName,'s':encryptFileData[_0x2c219b(0x299)]});const _0x12c834={'msg':_0x3647dd,'meta':_0x2027c4,'pad':_0x2220d3},_0xf58616=JSON[_0x2c219b(0x28f)](_0x12c834),_0x1cd2da=new TextEncoder()[_0x2c219b(0x175)](_0xf58616),_0x3a3609=window[_0x2c219b(0x2bc)][_0x2c219b(0x2ca)](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0x2b8c6f=await window[_0x2c219b(0x2bc)]['subtle'][_0x2c219b(0x1a3)]({'name':AES_CONFIG[_0x2c219b(0x182)],'iv':_0x3a3609,'tagLength':AES_CONFIG[_0x2c219b(0x2d8)]},_0x2db04e,_0x1cd2da),_0xd424a6=await window[_0x2c219b(0x2bc)][_0x2c219b(0x230)]['exportKey'](_0x2c219b(0x1b0),_0x2db04e);let _0x47b0a;if(_0x102edc['_publicKey'])_0x47b0a=_0x102edc[_0x2c219b(0x2e2)];else{const _0x4d5658=base64ToArrayBuffer(_0x102edc[_0x2c219b(0x123)]);_0x47b0a=await importRSAPublicKey(_0x4d5658,_0x102edc[_0x2c219b(0x1d4)]||RSA_CONFIG[_0x2c219b(0x179)]);}const _0x304a27=await window['crypto'][_0x2c219b(0x230)][_0x2c219b(0x1a3)]({'name':RSA_CONFIG[_0x2c219b(0x1a1)]},_0x47b0a,_0xd424a6),_0x4e2c45=new Uint8Array(_0x304a27[_0x2c219b(0x299)]+_0x3a3609[_0x2c219b(0x299)]+_0x2b8c6f[_0x2c219b(0x299)]);let _0x1d5f74=0x0;return _0x4e2c45[_0x2c219b(0x1d9)](new Uint8Array(_0x304a27),_0x1d5f74),_0x1d5f74+=_0x304a27[_0x2c219b(0x299)],_0x4e2c45[_0x2c219b(0x1d9)](_0x3a3609,_0x1d5f74),_0x1d5f74+=_0x3a3609['byteLength'],_0x4e2c45[_0x2c219b(0x1d9)](new Uint8Array(_0x2b8c6f),_0x1d5f74),{'version':0x4,'data':arrayBufferToBase64(_0x4e2c45[_0x2c219b(0x1ac)])};}async function encryptWithECC(_0x103d8d,_0x48d039,_0x11cad0){const _0x564f12=_0x2c69c4,_0x4ded92=await window[_0x564f12(0x2bc)][_0x564f12(0x230)]['generateKey']({'name':_0x564f12(0x211),'namedCurve':_0x48d039[_0x564f12(0x1ee)]||ECC_CONFIG[_0x564f12(0x148)]},!![],[_0x564f12(0x1de),_0x564f12(0x260)]),_0x2ab74e=await window['crypto'][_0x564f12(0x230)][_0x564f12(0x153)](_0x564f12(0x30d),_0x4ded92[_0x564f12(0x123)]);let _0x3c1ac3;if(_0x48d039['_publicKey'])_0x3c1ac3=_0x48d039['_publicKey'];else{const _0x4d3741=base64ToArrayBuffer(_0x48d039['publicKey']);_0x3c1ac3=await importECCPublicKey(_0x4d3741,_0x48d039[_0x564f12(0x1ee)]||ECC_CONFIG[_0x564f12(0x148)]);}const _0x230073=await window[_0x564f12(0x2bc)][_0x564f12(0x230)][_0x564f12(0x260)]({'name':'ECDH','public':_0x3c1ac3},_0x4ded92[_0x564f12(0x1bd)],0x100),_0x2e10a3=await window[_0x564f12(0x2bc)][_0x564f12(0x230)][_0x564f12(0x2ba)](_0x564f12(0x1b0),_0x230073,{'name':AES_CONFIG[_0x564f12(0x182)],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x564f12(0x1a3)]),_0x1db73c=arrayBufferToBase64(_0x103d8d);let _0x190c69=null;if(_0x11cad0&&_0x48d039[_0x564f12(0x1e6)])try{let _0x13ff55=_0x48d039['_signingPrivateKey'];!_0x13ff55&&_0x48d039[_0x564f12(0x234)]&&(_0x13ff55=await window[_0x564f12(0x2bc)][_0x564f12(0x230)][_0x564f12(0x2ba)]('pkcs8',base64ToArrayBuffer(_0x48d039[_0x564f12(0x234)]),{'name':SIGN_CONFIG[_0x564f12(0x287)],'namedCurve':_0x48d039['curve']||ECC_CONFIG[_0x564f12(0x148)]},![],['sign']));if(_0x13ff55){const _0x3838ab=await window[_0x564f12(0x2bc)][_0x564f12(0x230)][_0x564f12(0x28d)]({'name':SIGN_CONFIG['ECC_ALGORITHM'],'hash':SIGN_CONFIG['HASH']},_0x13ff55,_0x103d8d);_0x190c69=arrayBufferToBase64(_0x3838ab);}}catch(_0x555c89){console[_0x564f12(0x1e9)](_0x564f12(0x329),_0x555c89);}const _0x12cd67=0x10+Math['floor'](Math[_0x564f12(0x1fe)]()*0xf1),_0x2e48e1=window['crypto'][_0x564f12(0x2ca)](new Uint8Array(_0x12cd67)),_0x3f8735=arrayBufferToBase64(_0x2e48e1[_0x564f12(0x1ac)]),_0x4ea0db={'k':_0x48d039['id'],'t':new Date()[_0x564f12(0x12f)](),'a':_0x564f12(0x32b)+AES_CONFIG[_0x564f12(0x182)],'c':_0x48d039['curve']||ECC_CONFIG[_0x564f12(0x148)]};_0x190c69&&(_0x4ea0db[_0x564f12(0x12e)]=_0x190c69);encryptFileData&&encryptFileName&&(_0x4ea0db['f']={'n':encryptFileName,'s':encryptFileData[_0x564f12(0x299)]});const _0x9adeb={'msg':_0x1db73c,'meta':_0x4ea0db,'pad':_0x3f8735},_0x189803=JSON[_0x564f12(0x28f)](_0x9adeb),_0x534f18=new TextEncoder()[_0x564f12(0x175)](_0x189803),_0xf3c36a=window[_0x564f12(0x2bc)]['getRandomValues'](new Uint8Array(AES_CONFIG[_0x564f12(0x252)])),_0x939479=await window['crypto'][_0x564f12(0x230)][_0x564f12(0x1a3)]({'name':AES_CONFIG[_0x564f12(0x182)],'iv':_0xf3c36a,'tagLength':AES_CONFIG[_0x564f12(0x2d8)]},_0x2e10a3,_0x534f18),_0x44182f=new Uint8Array(_0x2ab74e[_0x564f12(0x299)]+_0xf3c36a['byteLength']+_0x939479[_0x564f12(0x299)]);let _0x5a173a=0x0;return _0x44182f[_0x564f12(0x1d9)](new Uint8Array(_0x2ab74e),_0x5a173a),_0x5a173a+=_0x2ab74e[_0x564f12(0x299)],_0x44182f[_0x564f12(0x1d9)](_0xf3c36a,_0x5a173a),_0x5a173a+=_0xf3c36a[_0x564f12(0x299)],_0x44182f[_0x564f12(0x1d9)](new Uint8Array(_0x939479),_0x5a173a),{'version':0x4,'data':arrayBufferToBase64(_0x44182f['buffer'])};}async function decryptMessage(){const _0x54b272=_0x2c69c4;try{let _0x179ab0,_0x4b006d=document[_0x54b272(0x19c)](_0x54b272(0x243))[_0x54b272(0x184)];const _0x55e638=document[_0x54b272(0x19c)](_0x54b272(0x25f))[_0x54b272(0x184)],_0x121c17=parseInt(document[_0x54b272(0x19c)](_0x54b272(0x259))[_0x54b272(0x184)],0xa)||0x1;if(!_0x4b006d){showStatus(_0x54b272(0x126),_0x54b272(0x17c),_0x54b272(0x1e9));return;}if(!isValidEncryptedMessage(_0x4b006d,_0x55e638)){showStatus(_0x54b272(0x126),_0x54b272(0x21d),_0x54b272(0x1e9));return;}const _0x16a43b=document['getElementById'](_0x54b272(0x140))[_0x54b272(0x184)],_0x12110a=document[_0x54b272(0x19c)]('decryptionPassword')[_0x54b272(0x184)];if(!_0x16a43b){showStatus('decryptStatus',_0x54b272(0x309),'error');return;}setLoading(!![]);const _0x3f7311=keys[_0x54b272(0x1cf)](_0x1eb218=>_0x1eb218['id']===_0x16a43b);if(!_0x3f7311){showStatus(_0x54b272(0x126),_0x54b272(0x21d),'error'),setLoading(![]);return;}let _0x365370=null,_0x327baa=_0x3f7311;if(_0x3f7311[_0x54b272(0x2dc)]){if(!_0x12110a){showStatus(_0x54b272(0x126),'Password\x20required\x20for\x20this\x20key',_0x54b272(0x1e9)),setLoading(![]);return;}try{_0x365370=await decryptKeyWithPassword(_0x3f7311,_0x12110a),_0x327baa=safeMemory['retrieve'](_0x365370);if(!_0x327baa)throw new Error('Failed\x20to\x20retrieve\x20decrypted\x20key\x20from\x20memory.');}catch(_0x54b111){console['error'](_0x54b272(0x1c4),_0x54b111),showStatus('decryptStatus','Decryption\x20failed.\x20Please\x20check\x20your\x20key\x20and\x20message.',_0x54b272(0x1e9)),setLoading(![]);return;}}const _0x821587=document['getElementById'](_0x54b272(0x26e))[_0x54b272(0x151)];let _0x29c86a=_0x4b006d,_0x3859c6,_0x53b863,_0x17ecbf=null;for(let _0x1c2f8c=0x0;_0x1c2f8c<_0x121c17;_0x1c2f8c++){_0x179ab0=parseEncryptedMessage(_0x29c86a,_0x55e638);let _0x43fd1b=await decryptData(_0x179ab0,_0x327baa);_0x43fd1b[_0x54b272(0x222)]?(_0x3859c6=_0x43fd1b[_0x54b272(0x222)],_0x53b863=_0x43fd1b[_0x54b272(0x229)]):(_0x3859c6=_0x43fd1b,_0x53b863=null),_0x1c2f8c<_0x121c17-0x1&&(_0x29c86a=new TextDecoder()[_0x54b272(0x177)](_0x3859c6));}_0x365370&&safeMemory[_0x54b272(0x15f)](_0x365370);let _0x1d2ce1=![],_0x8ebcdf=null,_0x25f854=null;if(!_0x179ab0[_0x54b272(0x14c)]&&_0x179ab0[_0x54b272(0x2a1)]&&_0x179ab0[_0x54b272(0x263)])_0x1d2ce1=!![],_0x8ebcdf=_0x179ab0[_0x54b272(0x263)],_0x25f854=_0x179ab0[_0x54b272(0x292)]||_0x3859c6[_0x54b272(0x299)];else _0x53b863&&_0x53b863['f']&&(_0x1d2ce1=!![],_0x8ebcdf=_0x53b863['f']['n'],_0x25f854=_0x53b863['f']['s']||_0x3859c6['byteLength']);if(_0x1d2ce1)document[_0x54b272(0x19c)]('decryptedOutput')['value']=_0x54b272(0x2f1)+_0x8ebcdf+'\x20('+formatFileSize(_0x25f854)+')',document[_0x54b272(0x19c)](_0x54b272(0x2f4))['setAttribute'](_0x54b272(0x1f7),_0x8ebcdf),document[_0x54b272(0x19c)]('downloadDecryptedBtn')['setAttribute']('data-binary','true'),window['decryptedBinaryData']=_0x3859c6;else{const _0x322db0=new TextDecoder()['decode'](_0x3859c6);document[_0x54b272(0x19c)](_0x54b272(0x30a))['value']=_0x322db0,document[_0x54b272(0x19c)](_0x54b272(0x2f4))['setAttribute'](_0x54b272(0x1f7),'decrypted.txt'),document[_0x54b272(0x19c)]('downloadDecryptedBtn')[_0x54b272(0x2cd)](_0x54b272(0x193),_0x54b272(0x2f2)),window[_0x54b272(0x246)]=null;}let _0x17b6a7=_0x54b272(0x248),_0x498115=_0x54b272(0x17e);if(_0x821587){if(_0x53b863&&_0x53b863[_0x54b272(0x12e)]&&_0x327baa[_0x54b272(0x318)])try{let _0x13d847=_0x327baa[_0x54b272(0x206)];if(!_0x13d847&&_0x327baa[_0x54b272(0x20d)]){const _0x384655=_0x327baa[_0x54b272(0x281)][_0x54b272(0x2f5)](_0x54b272(0x1fa)),_0x7dc023=_0x384655?{'name':SIGN_CONFIG[_0x54b272(0x27c)],'hash':SIGN_CONFIG[_0x54b272(0x2d1)]}:{'name':SIGN_CONFIG[_0x54b272(0x287)],'namedCurve':_0x327baa[_0x54b272(0x1ee)]};_0x13d847=await window['crypto'][_0x54b272(0x230)][_0x54b272(0x2ba)]('spki',base64ToArrayBuffer(_0x327baa[_0x54b272(0x20d)]),_0x7dc023,![],['verify']);}const _0x400905=base64ToArrayBuffer(_0x53b863['sig']),_0x26ea2b=await verifySignature(_0x13d847,_0x400905,_0x3859c6,_0x327baa[_0x54b272(0x281)]);_0x17ecbf=_0x26ea2b;}catch(_0x589f8c){console['error'](_0x54b272(0x314),_0x589f8c),_0x17ecbf=![];}}if(_0x17ecbf===!![])_0x17b6a7+=_0x54b272(0x1aa);else{if(_0x17ecbf===![])_0x17b6a7+='\x20âŒ\x20INVALID\x20SIGNATURE',_0x498115='warning';else _0x821587&&_0x17ecbf===null&&(_0x17b6a7+=_0x54b272(0x18c));}showStatus(_0x54b272(0x126),_0x17b6a7,_0x498115);}catch(_0x411ee9){console[_0x54b272(0x1e9)](_0x54b272(0x244),{'errorType':_0x411ee9['constructor'][_0x54b272(0x319)],'errorMessage':_0x411ee9[_0x54b272(0x270)],'stack':_0x411ee9['stack']}),showStatus(_0x54b272(0x126),_0x54b272(0x21d),_0x54b272(0x1e9));}finally{document['getElementById']('decryptionPassword')[_0x54b272(0x184)]='',setLoading(![]);}}async function decryptWithAES(_0x27f5bf,_0x2fc53a){const _0x9e6d66=_0x2c69c4;try{const _0x5456b8=base64ToArrayBuffer(_0x27f5bf[_0x9e6d66(0x222)]),_0x5a6d89=new Uint8Array(_0x5456b8),_0x2f87e9=_0x5a6d89['slice'](0x0,AES_CONFIG[_0x9e6d66(0x252)]),_0x142496=_0x5a6d89['slice'](AES_CONFIG['IV_LENGTH']);let _0x2347cf;if(_0x2fc53a['_cryptoKey'])_0x2347cf=_0x2fc53a[_0x9e6d66(0x1ab)];else{const _0x54063f=base64ToArrayBuffer(_0x2fc53a[_0x9e6d66(0x31f)]);_0x2347cf=await window['crypto']['subtle']['importKey']('raw',_0x54063f,{'name':AES_CONFIG[_0x9e6d66(0x182)],'length':AES_CONFIG[_0x9e6d66(0x2af)]},![],[_0x9e6d66(0x32c)]);}const _0x28fa8e=await window[_0x9e6d66(0x2bc)][_0x9e6d66(0x230)]['decrypt']({'name':AES_CONFIG[_0x9e6d66(0x182)],'iv':_0x2f87e9,'tagLength':AES_CONFIG[_0x9e6d66(0x2d8)]},_0x2347cf,_0x142496),_0x56e1ae=new TextDecoder()['decode'](_0x28fa8e),_0x12e0bd=JSON[_0x9e6d66(0x2bb)](_0x56e1ae),_0x534a00=base64ToArrayBuffer(_0x12e0bd[_0x9e6d66(0x2b1)]),_0x9711f5=_0x12e0bd[_0x9e6d66(0x265)];if(_0x9711f5['k']!==_0x2fc53a['id'])throw new Error(_0x9e6d66(0x201));return{'data':_0x534a00,'metadata':_0x9711f5};}catch(_0x1c8bc3){console[_0x9e6d66(0x1e9)](_0x9e6d66(0x245),{'errorType':_0x1c8bc3[_0x9e6d66(0x183)][_0x9e6d66(0x319)],'errorMessage':_0x1c8bc3['message'],'stack':_0x1c8bc3[_0x9e6d66(0x207)]});throw new Error(_0x9e6d66(0x21d));}}function isValidEncryptedMessage(_0x39124b,_0xdb2c8a=''){const _0x420867=_0x2c69c4,_0x2c888e=/[A-Za-z0-9+\/\s]{100,}={0,2}/;if(_0x2c888e[_0x420867(0x2d5)](_0x39124b))return!![];const _0x5e68b1='@!',_0x1ff8be='!@',_0x269992=escapeRegex(_0x5e68b1),_0x1cea7a=escapeRegex(_0x1ff8be),_0x2c5cfa=_0x420867(0x317)+_0x269992+_0x420867(0x2d3)+_0x1cea7a+').*$',_0x1fcf8f=new RegExp(_0x2c5cfa);return _0x1fcf8f['test'](_0x39124b);}function createEncryptedMessageString(_0x339309,_0x46d9db=''){const _0x4ad7d6=_0x2c69c4;let _0x14f709=typeof _0x339309[_0x4ad7d6(0x222)]===_0x4ad7d6(0x21b)?_0x339309[_0x4ad7d6(0x222)][_0x4ad7d6(0x14b)]():_0x339309[_0x4ad7d6(0x222)];if(_0x46d9db&&_0x46d9db['trim']()){const _0x3c9cb8=base64ToArrayBuffer(_0x14f709),_0x40a6ce=xorCipher(_0x3c9cb8,_0x46d9db);_0x14f709=arrayBufferToBase64(_0x40a6ce);}return _0x14f709;}function parseEncryptedMessage(_0x4e0fce,_0x2c77f8=''){const _0x59f21a=_0x2c69c4;let _0x43c102=_0x4e0fce[_0x59f21a(0x14b)]()[_0x59f21a(0x20f)](/\s+/g,'');if(!/^[A-Za-z0-9+\/]+={0,2}$/['test'](_0x43c102))throw new Error(_0x59f21a(0x19f));if(_0x2c77f8&&_0x2c77f8[_0x59f21a(0x14b)]())try{const _0x5cc433=base64ToArrayBuffer(_0x43c102),_0xcaa378=xorCipher(_0x5cc433,_0x2c77f8);_0x43c102=arrayBufferToBase64(_0xcaa378);}catch(_0x4d0eca){console[_0x59f21a(0x1e9)](_0x59f21a(0x2cf),_0x4d0eca);throw new Error(_0x59f21a(0x214));}return{'version':0x4,'data':_0x43c102};}function updateEncryptionOutput(_0x2892e9){return createEncryptedMessageString(_0x2892e9);}function generateRandomString(_0x4c0568=0x5){const _0x521623=_0x2c69c4,_0x3b6aa4=_0x521623(0x316);let _0x42a570='';for(let _0x3a2bb3=0x0;_0x3a2bb3<_0x4c0568;_0x3a2bb3++){_0x42a570+=_0x3b6aa4[_0x521623(0x128)](Math[_0x521623(0x19d)](Math[_0x521623(0x1fe)]()*_0x3b6aa4[_0x521623(0x1d4)]));}return _0x42a570;}function determineKeySecurityLevel(_0x1327f2){const _0x490802=_0x2c69c4;let _0x1208ff='low';if(_0x1327f2[_0x490802(0x281)]===_0x490802(0x21c)||_0x1327f2[_0x490802(0x281)]===_0x490802(0x1a2)||_0x1327f2[_0x490802(0x281)]===_0x490802(0x185)||_0x1327f2[_0x490802(0x281)]==='ecc-p521')_0x1208ff='medium';else(_0x1327f2[_0x490802(0x281)]===_0x490802(0x1fa)||_0x1327f2[_0x490802(0x281)]===_0x490802(0x2dd))&&(_0x1208ff=_0x490802(0x2cb));let _0x1880a1=0x0;_0x1327f2[_0x490802(0x2dc)]&&(_0x1880a1+=0x2);_0x1327f2[_0x490802(0x281)]!==_0x490802(0x21c)&&(_0x1327f2[_0x490802(0x2db)]&&_0x1327f2[_0x490802(0x224)]&&(_0x1880a1+=0x1));_0x1327f2['expiry']&&(_0x1880a1+=0x1);let _0x279a75;if(_0x1208ff===_0x490802(0x1f5)){if(_0x1880a1>=0x3)_0x279a75='high';else _0x1880a1>=0x1?_0x279a75='medium':_0x279a75=_0x490802(0x2cb);}else{if(_0x1880a1>=0x4)_0x279a75='high';else _0x1880a1>=0x2?_0x279a75=_0x490802(0x1f5):_0x279a75=_0x490802(0x2cb);}return _0x279a75;}async function decryptWithRSA(_0x49b5dd,_0x180dd0,_0x4a839c){const _0x1260ce=_0x2c69c4;try{const _0x1fa065=base64ToArrayBuffer(_0x49b5dd[_0x1260ce(0x222)]),_0x39c700=new Uint8Array(_0x1fa065),_0x1386b8=_0x180dd0[_0x1260ce(0x1d4)]||RSA_CONFIG[_0x1260ce(0x179)],_0x256389=_0x1386b8/0x8;let _0xfde04b=0x0;const _0x3d49d6=_0x39c700[_0x1260ce(0x135)](_0xfde04b,_0xfde04b+_0x256389);_0xfde04b+=_0x256389;const _0x4ae413=_0x39c700['slice'](_0xfde04b,_0xfde04b+AES_CONFIG['IV_LENGTH']);_0xfde04b+=AES_CONFIG['IV_LENGTH'];const _0xf89d6a=_0x39c700[_0x1260ce(0x135)](_0xfde04b);let _0x6a1f5b;if(_0x180dd0[_0x1260ce(0x32a)])_0x6a1f5b=_0x180dd0[_0x1260ce(0x32a)];else{const _0x105638=base64ToArrayBuffer(_0x180dd0['privateKey']);_0x6a1f5b=await importRSAPrivateKey(_0x105638,_0x1386b8);}const _0x4b53e2=await window['crypto'][_0x1260ce(0x230)][_0x1260ce(0x32c)]({'name':RSA_CONFIG[_0x1260ce(0x1a1)]},_0x6a1f5b,_0x3d49d6),_0x1fbecd=await importAESKey(_0x4b53e2),_0x269143=await window[_0x1260ce(0x2bc)]['subtle'][_0x1260ce(0x32c)]({'name':AES_CONFIG['MODE'],'iv':_0x4ae413,'tagLength':AES_CONFIG[_0x1260ce(0x2d8)]},_0x1fbecd,_0xf89d6a),_0x5785f0=new TextDecoder()[_0x1260ce(0x177)](_0x269143),_0x169492=JSON[_0x1260ce(0x2bb)](_0x5785f0),_0xdf4e19=base64ToArrayBuffer(_0x169492[_0x1260ce(0x2b1)]),_0x32f30b=_0x169492[_0x1260ce(0x265)];if(_0x32f30b['k']!==_0x180dd0['id'])throw new Error(_0x1260ce(0x201));return{'data':_0xdf4e19,'metadata':_0x32f30b};}catch(_0x34e783){console[_0x1260ce(0x1e9)](_0x1260ce(0x2f6),{'errorType':_0x34e783[_0x1260ce(0x183)][_0x1260ce(0x319)],'errorMessage':_0x34e783['message'],'stack':_0x34e783['stack']});throw new Error(_0x1260ce(0x21d));}}async function decryptWithECC(_0x51972d,_0x32f881){const _0x29d00e=_0x2c69c4;try{const _0x8781c8=base64ToArrayBuffer(_0x51972d['data']),_0x1472a9=new Uint8Array(_0x8781c8),_0x588239=_0x32f881['curve']||ECC_CONFIG['CURVE'];let _0x5ecbba;if(_0x588239===_0x29d00e(0x146))_0x5ecbba=0x5b;else{if(_0x588239==='P-384')_0x5ecbba=0x78;else{if(_0x588239===_0x29d00e(0x293))_0x5ecbba=0x9e;else throw new Error(_0x29d00e(0x1ef)+_0x588239);}}let _0x1c1112=0x0;const _0x34ff85=_0x1472a9['slice'](_0x1c1112,_0x1c1112+_0x5ecbba);_0x1c1112+=_0x5ecbba;const _0x20b603=_0x1472a9[_0x29d00e(0x135)](_0x1c1112,_0x1c1112+AES_CONFIG[_0x29d00e(0x252)]);_0x1c1112+=AES_CONFIG[_0x29d00e(0x252)];const _0x341ca4=_0x1472a9[_0x29d00e(0x135)](_0x1c1112),_0x2460f0=await importECCPublicKey(_0x34ff85,_0x588239);let _0x130a5b;if(_0x32f881['_privateKey'])_0x130a5b=_0x32f881['_privateKey'];else{const _0x530175=base64ToArrayBuffer(_0x32f881[_0x29d00e(0x1bd)]);_0x130a5b=await importECCPrivateKey(_0x530175,_0x588239);}const _0x52401b=await window[_0x29d00e(0x2bc)][_0x29d00e(0x230)][_0x29d00e(0x260)]({'name':_0x29d00e(0x211),'public':_0x2460f0},_0x130a5b,0x100),_0x512bb6=await window['crypto'][_0x29d00e(0x230)][_0x29d00e(0x2ba)](_0x29d00e(0x1b0),_0x52401b,{'name':AES_CONFIG[_0x29d00e(0x182)],'length':AES_CONFIG[_0x29d00e(0x2af)]},![],[_0x29d00e(0x32c)]),_0x45b4a1=await window[_0x29d00e(0x2bc)][_0x29d00e(0x230)][_0x29d00e(0x32c)]({'name':AES_CONFIG['MODE'],'iv':_0x20b603,'tagLength':AES_CONFIG[_0x29d00e(0x2d8)]},_0x512bb6,_0x341ca4),_0x3a50ce=new TextDecoder()[_0x29d00e(0x177)](_0x45b4a1),_0x4b2001=JSON['parse'](_0x3a50ce),_0x4dbd47=base64ToArrayBuffer(_0x4b2001[_0x29d00e(0x2b1)]),_0x1d325c=_0x4b2001[_0x29d00e(0x265)];if(_0x1d325c['k']!==_0x32f881['id'])throw new Error(_0x29d00e(0x201));return{'data':_0x4dbd47,'metadata':_0x1d325c};}catch(_0x1df887){console[_0x29d00e(0x1e9)](_0x29d00e(0x27e),{'errorType':_0x1df887['constructor'][_0x29d00e(0x319)],'errorMessage':_0x1df887[_0x29d00e(0x270)],'stack':_0x1df887[_0x29d00e(0x207)]});throw new Error(_0x29d00e(0x21d));}}function reverseString(_0x4c73c5){const _0x3ee6ed=_0x2c69c4;if(typeof _0x4c73c5!==_0x3ee6ed(0x21b))return'';return _0x4c73c5['split']('')[_0x3ee6ed(0x131)]()[_0x3ee6ed(0x27d)]('');}async function verifySignature(_0x52b4df,_0x388989,_0x196e3b,_0x3a10f3){const _0x44e1ce=_0x2c69c4,_0xce11e6=_0x3a10f3[_0x44e1ce(0x2f5)](_0x44e1ce(0x1fa)),_0x4d24bf=_0xce11e6?{'name':SIGN_CONFIG[_0x44e1ce(0x27c)],'saltLength':SIGN_CONFIG[_0x44e1ce(0x1b5)]}:{'name':SIGN_CONFIG[_0x44e1ce(0x287)],'hash':SIGN_CONFIG[_0x44e1ce(0x2d1)]};return await window['crypto'][_0x44e1ce(0x230)][_0x44e1ce(0x172)](_0x4d24bf,_0x52b4df,_0x388989,_0x196e3b);}const ENABLE_COMPRESSION=![];async function compressData(_0x823c6e){const _0x5a604e=_0x2c69c4;try{if(!ENABLE_COMPRESSION)return console['log'](_0x5a604e(0x2d4)),_0x823c6e;if(typeof CompressionStream===_0x5a604e(0x16c))return console['warn'](_0x5a604e(0x286)),_0x823c6e;const _0x247e90=new ReadableStream({'start'(_0x1fb6eb){const _0x3d28f8=_0x5a604e;_0x1fb6eb[_0x3d28f8(0x32e)](new Uint8Array(_0x823c6e)),_0x1fb6eb['close']();}}),_0x5eb0f3=_0x247e90[_0x5a604e(0x1b1)](new CompressionStream(_0x5a604e(0x14e))),_0x1d97a6=_0x5eb0f3[_0x5a604e(0x332)](),_0x1fcfb9=[];while(!![]){const {done:_0x1ae7d8,value:_0x248cfa}=await _0x1d97a6[_0x5a604e(0x32f)]();if(_0x1ae7d8)break;_0x1fcfb9[_0x5a604e(0x331)](_0x248cfa);}const _0x1f1a1f=_0x1fcfb9['reduce']((_0x405e82,_0x5086df)=>_0x405e82+_0x5086df[_0x5a604e(0x1d4)],0x0),_0x53ab5d=new Uint8Array(_0x1f1a1f);let _0x27a8e5=0x0;for(const _0x108ad9 of _0x1fcfb9){_0x53ab5d[_0x5a604e(0x1d9)](_0x108ad9,_0x27a8e5),_0x27a8e5+=_0x108ad9['length'];}const _0x138113=new Uint8Array(_0x823c6e);return console[_0x5a604e(0x298)](_0x5a604e(0x1ba),Array[_0x5a604e(0x127)](_0x138113['slice'](0x0,0x4))[_0x5a604e(0x335)](_0x276ad7=>'0x'+_0x276ad7['toString'](0x10))[_0x5a604e(0x27d)]('\x20')),console['log'](_0x5a604e(0x2ff),Array[_0x5a604e(0x127)](_0x53ab5d[_0x5a604e(0x135)](0x0,0x4))['map'](_0x96e214=>'0x'+_0x96e214[_0x5a604e(0x144)](0x10))['join']('\x20')),console['log'](_0x5a604e(0x1e8),_0x138113[_0x5a604e(0x1d4)],_0x5a604e(0x23b),_0x53ab5d['length']),_0x53ab5d[_0x5a604e(0x1ac)];}catch(_0x111b44){return console[_0x5a604e(0x1e9)](_0x5a604e(0x1e3),_0x111b44),_0x823c6e;}}async function decompressData(_0x57c31e){const _0x15adb2=_0x2c69c4;try{if(typeof DecompressionStream===_0x15adb2(0x16c))return console[_0x15adb2(0x188)]('DecompressionStream\x20not\x20supported,\x20returning\x20data\x20as-is'),_0x57c31e;const _0x436f41=new Uint8Array(_0x57c31e);console[_0x15adb2(0x298)](_0x15adb2(0x2c2),Array[_0x15adb2(0x127)](_0x436f41[_0x15adb2(0x135)](0x0,0x4))[_0x15adb2(0x335)](_0x6b0b32=>'0x'+_0x6b0b32['toString'](0x10))['join']('\x20'));if(_0x436f41[_0x15adb2(0x1d4)]<0x2||_0x436f41[0x0]!==0x1f||_0x436f41[0x1]!==0x8b)return console[_0x15adb2(0x298)](_0x15adb2(0x1a9)),_0x57c31e;const _0x405c7b=new ReadableStream({'start'(_0x4d7545){const _0x5f17de=_0x15adb2;_0x4d7545[_0x5f17de(0x32e)](new Uint8Array(_0x57c31e)),_0x4d7545[_0x5f17de(0x277)]();}}),_0x384501=_0x405c7b['pipeThrough'](new DecompressionStream('gzip')),_0x466f72=_0x384501['getReader'](),_0xec045a=[];while(!![]){const {done:_0x192381,value:_0x3c9f93}=await _0x466f72['read']();if(_0x192381)break;_0xec045a[_0x15adb2(0x331)](_0x3c9f93);}const _0x53fc66=_0xec045a[_0x15adb2(0x14f)]((_0x37a2ef,_0x38f5fe)=>_0x37a2ef+_0x38f5fe['length'],0x0),_0x3ec46f=new Uint8Array(_0x53fc66);let _0x32eee0=0x0;for(const _0xb2303d of _0xec045a){_0x3ec46f[_0x15adb2(0x1d9)](_0xb2303d,_0x32eee0),_0x32eee0+=_0xb2303d[_0x15adb2(0x1d4)];}return console[_0x15adb2(0x298)](_0x15adb2(0x2e6),Array[_0x15adb2(0x127)](_0x3ec46f[_0x15adb2(0x135)](0x0,0x4))[_0x15adb2(0x335)](_0x424a78=>'0x'+_0x424a78[_0x15adb2(0x144)](0x10))['join']('\x20')),console[_0x15adb2(0x298)](_0x15adb2(0x28e),_0x3ec46f[_0x15adb2(0x1d4)],'bytes'),_0x3ec46f['buffer'];}catch(_0x53e2d9){return console[_0x15adb2(0x1e9)](_0x15adb2(0x1da),_0x53e2d9),console[_0x15adb2(0x1e9)]('Returning\x20compressed\x20data\x20as-is'),_0x57c31e;}}function downloadEncryptedFile(){const _0x6e7435=_0x2c69c4,_0x34dc02=document['getElementById'](_0x6e7435(0x27a))['value'];if(!_0x34dc02){showStatus(_0x6e7435(0x167),'No\x20encrypted\x20data\x20to\x20download','error');return;}const _0xf7fb4f=document[_0x6e7435(0x19c)](_0x6e7435(0x2f3))[_0x6e7435(0x32d)](_0x6e7435(0x1f7))||generateRandomFileName(0x6)+_0x6e7435(0x20b),_0x146e6b=new Blob([_0x34dc02],{'type':'application/octet-stream'});downloadBlob(_0x146e6b,_0xf7fb4f),showStatus(_0x6e7435(0x167),_0x6e7435(0x2e0)+_0xf7fb4f+'\x22\x20downloaded\x20successfully','success');}function downloadDecryptedFile(){const _0x59f2fd=_0x2c69c4;if(window[_0x59f2fd(0x246)]){const _0x134cc0=document[_0x59f2fd(0x19c)]('downloadDecryptedBtn')[_0x59f2fd(0x32d)]('data-filename')||_0x59f2fd(0x215),_0x1b8fd2=new Blob([window[_0x59f2fd(0x246)]],{'type':'application/octet-stream'});downloadBlob(_0x1b8fd2,_0x134cc0);}else{const _0x1cb882=document[_0x59f2fd(0x19c)](_0x59f2fd(0x30a))[_0x59f2fd(0x184)];if(!_0x1cb882){showStatus('decryptStatus',_0x59f2fd(0x1d3),'error');return;}const _0x1fa584=document[_0x59f2fd(0x19c)](_0x59f2fd(0x2f4))[_0x59f2fd(0x32d)]('data-filename')||_0x59f2fd(0x2d0),_0x5aafa1=new Blob([_0x1cb882],{'type':_0x59f2fd(0x2b9)});downloadBlob(_0x5aafa1,_0x1fa584);}showStatus(_0x59f2fd(0x126),_0x59f2fd(0x203),'success');}function downloadBlob(_0x577528,_0x2ceb18){const _0xe50c61=_0x2c69c4,_0x2ea294=URL[_0xe50c61(0x251)](_0x577528),_0x3acb14=document[_0xe50c61(0x272)]('a');_0x3acb14[_0xe50c61(0x311)]=_0x2ea294,_0x3acb14[_0xe50c61(0x1d2)]=_0x2ceb18,document[_0xe50c61(0x212)][_0xe50c61(0x2ef)](_0x3acb14),_0x3acb14[_0xe50c61(0x330)](),document[_0xe50c61(0x212)][_0xe50c61(0x1a7)](_0x3acb14),URL[_0xe50c61(0x165)](_0x2ea294);}function importKey(){const _0xa7cb98=_0x2c69c4,_0x5f3a4f=createKeyFileInput();_0x5f3a4f[_0xa7cb98(0x330)]();}async function exportKey(_0x420e2c,_0x362d5f=![]){const _0x2e99f5=_0x2c69c4;try{const _0x4c87cd=keys[_0x2e99f5(0x1cf)](_0x5e7e08=>_0x5e7e08['id']===_0x420e2c);if(!_0x4c87cd){alert(_0x2e99f5(0x160));return;}const _0x3ac371=_0x4c87cd[_0x2e99f5(0x281)]===_0x2e99f5(0x1fa)||_0x4c87cd['type']===_0x2e99f5(0x1a2)||_0x4c87cd[_0x2e99f5(0x281)]===_0x2e99f5(0x2dd)||_0x4c87cd[_0x2e99f5(0x281)]===_0x2e99f5(0x185)||_0x4c87cd[_0x2e99f5(0x281)]==='ecc-p521';let _0x1821a1=_0x4c87cd,_0x16f64e=_0x2e99f5(0x31d);if(_0x3ac371&&_0x362d5f){let _0x4ad00d='';try{_0x4ad00d=await showPasswordModal(_0x2e99f5(0x254),'Please\x20enter\x20a\x20password\x20to\x20protect\x20this\x20private\x20key:',!![]);}catch(_0x18d321){return;}if(!_0x4ad00d){if(!confirm(_0x2e99f5(0x1db)))return;}_0x1821a1={'id':_0x4c87cd['id'],'name':_0x4c87cd[_0x2e99f5(0x319)],'type':_0x4c87cd['type'],'created':_0x4c87cd[_0x2e99f5(0x18b)],'expiry':_0x4c87cd[_0x2e99f5(0x294)],'privateKey':_0x4c87cd[_0x2e99f5(0x1bd)],'protected':_0x4c87cd['protected'],'salt':_0x4c87cd[_0x2e99f5(0x12c)],'iv':_0x4c87cd['iv'],'algorithm':_0x4c87cd[_0x2e99f5(0x2e7)],'hasPrivate':!![],'hasPublic':![],'pairedKeyId':_0x4c87cd['id'],'publicKeyHash':_0x4c87cd[_0x2e99f5(0x1bb)]};if(_0x4c87cd['type']===_0x2e99f5(0x1fa)||_0x4c87cd[_0x2e99f5(0x281)]===_0x2e99f5(0x1a2))_0x1821a1[_0x2e99f5(0x1d4)]=_0x4c87cd[_0x2e99f5(0x1d4)];else(_0x4c87cd[_0x2e99f5(0x281)]===_0x2e99f5(0x2dd)||_0x4c87cd['type']===_0x2e99f5(0x185)||_0x4c87cd[_0x2e99f5(0x281)]===_0x2e99f5(0x2fb))&&(_0x1821a1[_0x2e99f5(0x1ee)]=_0x4c87cd['curve']);if(_0x4ad00d){if(_0x4c87cd[_0x2e99f5(0x2dc)])try{const _0x413454=await showPasswordModal('Enter\x20Current\x20Password','Enter\x20the\x20current\x20key\x20password\x20to\x20continue:',![]),_0x31a070=await decryptKeyWithPassword(_0x4c87cd,_0x413454),_0x19e64d=safeMemory[_0x2e99f5(0x2b5)](_0x31a070,!![]);_0x1821a1[_0x2e99f5(0x1bd)]=_0x19e64d['privateKey'],_0x1821a1[_0x2e99f5(0x2dc)]=![];}catch(_0x184d10){showStatus(_0x2e99f5(0x1b6),_0x2e99f5(0x283)+_0x184d10['message'],_0x2e99f5(0x1e9));return;}await encryptKeyWithPassword(_0x1821a1,_0x4ad00d);}_0x16f64e=_0x2e99f5(0x16d);}else{if(_0x3ac371&&!_0x362d5f){_0x1821a1={'id':_0x4c87cd['id'],'name':_0x4c87cd[_0x2e99f5(0x319)],'type':_0x4c87cd['type'],'created':_0x4c87cd['created'],'expiry':_0x4c87cd[_0x2e99f5(0x294)],'publicKey':_0x4c87cd['publicKey'],'algorithm':_0x4c87cd[_0x2e99f5(0x2e7)],'hasPublic':!![],'hasPrivate':![],'pairedKeyId':_0x4c87cd['id'],'publicKeyHash':_0x4c87cd[_0x2e99f5(0x1bb)]};if(_0x4c87cd['type']===_0x2e99f5(0x1fa)||_0x4c87cd[_0x2e99f5(0x281)]===_0x2e99f5(0x1a2))_0x1821a1[_0x2e99f5(0x1d4)]=_0x4c87cd[_0x2e99f5(0x1d4)];else(_0x4c87cd[_0x2e99f5(0x281)]==='ecc'||_0x4c87cd[_0x2e99f5(0x281)]==='ecc-p384'||_0x4c87cd[_0x2e99f5(0x281)]===_0x2e99f5(0x2fb))&&(_0x1821a1[_0x2e99f5(0x1ee)]=_0x4c87cd['curve']);}}const _0x132b92=JSON[_0x2e99f5(0x28f)](_0x1821a1),_0x396f4e=btoa(_0x132b92),_0x30abcd=new Blob([_0x396f4e],{'type':_0x2e99f5(0x2b9)}),_0x449f09=URL[_0x2e99f5(0x251)](_0x30abcd),_0x1d6f1f=document['createElement']('a');_0x1d6f1f[_0x2e99f5(0x311)]=_0x449f09,_0x1d6f1f[_0x2e99f5(0x1d2)]=''+_0x4c87cd[_0x2e99f5(0x319)]['replace'](/[^a-z0-9]/gi,'_')+_0x16f64e,document[_0x2e99f5(0x212)][_0x2e99f5(0x2ef)](_0x1d6f1f),_0x1d6f1f[_0x2e99f5(0x330)](),document[_0x2e99f5(0x212)][_0x2e99f5(0x1a7)](_0x1d6f1f),URL[_0x2e99f5(0x165)](_0x449f09);const _0x9f787c=_0x362d5f?_0x2e99f5(0x250):_0x3ac371?_0x2e99f5(0x267):_0x2e99f5(0x31f);showStatus(_0x2e99f5(0x1b6),_0x2e99f5(0x1cd)+_0x4c87cd[_0x2e99f5(0x319)]+'\x22\x20'+_0x9f787c+'\x20exported\x20as\x20'+_0x16f64e+_0x2e99f5(0x18a),_0x2e99f5(0x17e));}catch(_0x3d8289){console['error'](_0x2e99f5(0x295),_0x3d8289),showStatus('keyStatus',_0x2e99f5(0x1c3)+_0x3d8289[_0x2e99f5(0x270)],'error');}}async function exportPrivateKey(_0x4d6c02){const _0x18ac10=_0x2c69c4,_0x47d1e1=keys[_0x18ac10(0x1cf)](_0x4abace=>_0x4abace['id']===_0x4d6c02);if(!_0x47d1e1){alert('Key\x20not\x20found');return;}if(!_0x47d1e1['hasPrivate']){showStatus(_0x18ac10(0x1b6),'This\x20key\x20does\x20not\x20have\x20a\x20private\x20key\x20component\x20to\x20export',_0x18ac10(0x1e9));return;}const _0x57f7f3=confirm('WARNING:\x20Exporting\x20a\x20private\x20key\x20is\x20a\x20security\x20risk.\x20'+_0x18ac10(0x2bd)+_0x18ac10(0x189));_0x57f7f3&&await exportKey(_0x4d6c02,!![]);}function createKeyFileInput(){const _0x214256=_0x2c69c4;let _0x36343c=document[_0x214256(0x19c)](_0x214256(0x1ec));return!_0x36343c&&(_0x36343c=document[_0x214256(0x272)](_0x214256(0x29a)),_0x36343c[_0x214256(0x281)]=_0x214256(0x313),_0x36343c['id']=_0x214256(0x1ec),_0x36343c['accept']=_0x214256(0x157),_0x36343c[_0x214256(0x24e)][_0x214256(0x125)]=_0x214256(0x2a7),document[_0x214256(0x212)][_0x214256(0x2ef)](_0x36343c),_0x36343c[_0x214256(0x16e)](_0x214256(0x180),handleKeyFileSelect)),_0x36343c;}async function handleKeyFileSelect(_0x2db667){const _0x17347e=_0x2c69c4;try{const _0x5767f5=_0x2db667['target']['files'];if(!_0x5767f5||_0x5767f5[_0x17347e(0x1d4)]===0x0)return;setLoading(!![]);const _0x402f3f=_0x5767f5[0x0],_0x952753=_0x402f3f[_0x17347e(0x319)][_0x17347e(0x1e5)]()[_0x17347e(0x310)](_0x17347e(0x16d)),_0x190eb4=_0x402f3f['name'][_0x17347e(0x1e5)]()[_0x17347e(0x310)]('.lim'),_0x429679=new FileReader();_0x429679['onload']=async function(_0xeea2b){const _0x5ce277=_0x17347e;try{const _0x34072e=_0xeea2b[_0x5ce277(0x1d8)][_0x5ce277(0x181)];let _0x157811;try{const _0x3023ca=atob(_0x34072e);_0x157811=JSON['parse'](_0x3023ca);}catch(_0x199af2){throw new Error(_0x5ce277(0x1a4));}if(!_0x157811['id']||!_0x157811['name']||!_0x157811[_0x5ce277(0x281)]||!_0x157811[_0x5ce277(0x18b)])throw new Error('Missing\x20required\x20key\x20properties');if(!validator[_0x5ce277(0x2d9)](_0x157811[_0x5ce277(0x319)]))throw new Error(_0x5ce277(0x2f0));if(_0x157811['type']===_0x5ce277(0x21c))_0x157811['hasPublic']=!![],_0x157811[_0x5ce277(0x224)]=!![];else{_0x157811['hasPublic']=!!_0x157811['publicKey'],_0x157811[_0x5ce277(0x224)]=!!_0x157811['privateKey'];if(_0x952753&&!_0x157811[_0x5ce277(0x224)])throw new Error('This\x20.lem\x20file\x20does\x20not\x20contain\x20a\x20private\x20key');if(_0x190eb4&&!_0x157811['hasPublic'])throw new Error(_0x5ce277(0x29b));}if(_0x157811[_0x5ce277(0x224)]&&_0x157811[_0x5ce277(0x2dc)]){let _0x523341='';try{_0x523341=await showPasswordModal(_0x5ce277(0x213),'This\x20private\x20key\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import\x20it:',![]);}catch(_0x39ccba){throw new Error(_0x5ce277(0x264));}if(!_0x523341)throw new Error(_0x5ce277(0x264));_0x157811[_0x5ce277(0x315)]=_0x523341;}const _0x146dfe=keys['findIndex'](_0x41e39c=>_0x41e39c['id']===_0x157811['id']);let _0x436e19=![],_0x1a9088=-0x1;if(_0x146dfe>=0x0){const _0x1ca14d=keys[_0x146dfe];if(_0x157811['hasPrivate']&&!_0x1ca14d[_0x5ce277(0x224)]&&_0x1ca14d[_0x5ce277(0x2db)])_0x436e19=!![],_0x1a9088=_0x146dfe;else _0x157811['hasPublic']&&!_0x1ca14d['hasPublic']&&_0x1ca14d['hasPrivate']&&(_0x436e19=!![],_0x1a9088=_0x146dfe);}else _0x157811[_0x5ce277(0x1bb)]&&(_0x1a9088=keys[_0x5ce277(0x159)](_0x503682=>_0x503682[_0x5ce277(0x1bb)]===_0x157811[_0x5ce277(0x1bb)]&&_0x503682['type']===_0x157811[_0x5ce277(0x281)]&&(_0x503682[_0x5ce277(0x224)]&&!_0x503682['hasPublic']&&_0x157811['hasPublic']||_0x503682[_0x5ce277(0x2db)]&&!_0x503682[_0x5ce277(0x224)]&&_0x157811[_0x5ce277(0x224)])),_0x1a9088>=0x0&&(_0x436e19=!![]));if(_0x436e19&&_0x1a9088>=0x0){const _0x4e0ccb=confirm('This\x20appears\x20to\x20be\x20the\x20'+(_0x157811[_0x5ce277(0x224)]?_0x5ce277(0x12d):'public')+_0x5ce277(0x166)+_0x5ce277(0x323));if(_0x4e0ccb){const _0x1762fe=keys[_0x1a9088];_0x157811['hasPrivate']&&!_0x1762fe[_0x5ce277(0x224)]&&(_0x1762fe['privateKey']=_0x157811[_0x5ce277(0x1bd)],_0x1762fe[_0x5ce277(0x224)]=!![],_0x157811[_0x5ce277(0x2dc)]&&(_0x1762fe[_0x5ce277(0x2dc)]=!![],_0x1762fe[_0x5ce277(0x12c)]=_0x157811[_0x5ce277(0x12c)],_0x1762fe['iv']=_0x157811['iv'])),_0x157811[_0x5ce277(0x2db)]&&!_0x1762fe[_0x5ce277(0x2db)]&&(_0x1762fe[_0x5ce277(0x123)]=_0x157811[_0x5ce277(0x123)],_0x1762fe[_0x5ce277(0x2db)]=!![],_0x157811[_0x5ce277(0x1bb)]&&(_0x1762fe[_0x5ce277(0x1bb)]=_0x157811[_0x5ce277(0x1bb)])),_0x1762fe[_0x5ce277(0x326)]=_0x1762fe['id'],await saveKeys(),showStatus(_0x5ce277(0x1b6),_0x5ce277(0x1cd)+_0x1762fe[_0x5ce277(0x319)]+_0x5ce277(0x247)+(_0x157811[_0x5ce277(0x224)]?_0x5ce277(0x12d):_0x5ce277(0x2b4))+_0x5ce277(0x1c7)+determineKeySecurityLevel(_0x1762fe)[_0x5ce277(0x1ff)](),_0x5ce277(0x17e));}else _0x157811['id']=crypto[_0x5ce277(0x304)](),keys[_0x5ce277(0x331)](_0x157811),await saveKeys(),showStatus('keyStatus','Key\x20\x22'+_0x157811['name']+_0x5ce277(0x164),_0x5ce277(0x17e));}else{if(_0x146dfe>=0x0){const _0x213c04=confirm(_0x5ce277(0x1e0)+_0x157811[_0x5ce277(0x319)]+_0x5ce277(0x199));_0x213c04?keys[_0x146dfe]=_0x157811:(_0x157811['id']=crypto[_0x5ce277(0x304)](),keys[_0x5ce277(0x331)](_0x157811)),await saveKeys(),showStatus(_0x5ce277(0x1b6),_0x5ce277(0x1cd)+_0x157811[_0x5ce277(0x319)]+_0x5ce277(0x1fc),_0x5ce277(0x17e));}else{keys['push'](_0x157811),await saveKeys();if(_0x157811[_0x5ce277(0x281)]===_0x5ce277(0x21c))showStatus(_0x5ce277(0x1b6),_0x5ce277(0x2be)+_0x157811[_0x5ce277(0x319)]+'\x22\x20imported\x20successfully',_0x5ce277(0x17e));else{if(_0x157811[_0x5ce277(0x224)]&&_0x157811[_0x5ce277(0x2db)])showStatus('keyStatus',_0x5ce277(0x16b)+_0x157811[_0x5ce277(0x319)]+_0x5ce277(0x1fc),_0x5ce277(0x17e));else _0x157811[_0x5ce277(0x224)]?showStatus(_0x5ce277(0x1b6),'Private\x20key\x20\x22'+_0x157811[_0x5ce277(0x319)]+'\x22\x20imported\x20successfully',_0x5ce277(0x17e)):showStatus(_0x5ce277(0x1b6),'Public\x20key\x20\x22'+_0x157811[_0x5ce277(0x319)]+_0x5ce277(0x1fc),_0x5ce277(0x17e));}}}}catch(_0x5d3842){console[_0x5ce277(0x1e9)](_0x5ce277(0x1c9),_0x5d3842),showStatus(_0x5ce277(0x1b6),_0x5ce277(0x1dd)+_0x5d3842[_0x5ce277(0x270)],_0x5ce277(0x1e9));}finally{setLoading(![]),document[_0x5ce277(0x19c)](_0x5ce277(0x1ec))[_0x5ce277(0x184)]='';}},_0x429679[_0x17347e(0x23e)]=function(){const _0x4668d0=_0x17347e;setLoading(![]),showStatus('keyStatus',_0x4668d0(0x187),_0x4668d0(0x1e9)),document[_0x4668d0(0x19c)](_0x4668d0(0x1ec))[_0x4668d0(0x184)]='';},_0x429679['readAsText'](_0x402f3f);}catch(_0x1901fb){console[_0x17347e(0x1e9)](_0x17347e(0x1c9),_0x1901fb),showStatus(_0x17347e(0x1b6),_0x17347e(0x1dd)+_0x1901fb[_0x17347e(0x270)],_0x17347e(0x1e9)),setLoading(![]),document['getElementById']('keyFileInput')[_0x17347e(0x184)]='';}}async function exportAllKeys(){const _0x53945e=_0x2c69c4;try{if(keys[_0x53945e(0x1d4)]===0x0){showStatus(_0x53945e(0x1b6),'No\x20keys\x20available\x20to\x20export',_0x53945e(0x273));return;}let _0x3d721b='';try{_0x3d721b=await showPasswordModal(_0x53945e(0x138),'Please\x20enter\x20a\x20password\x20to\x20protect\x20your\x20key\x20backup.\x20This\x20is\x20highly\x20recommended\x20for\x20security.',!![]);}catch(_0x1e4a66){return;}let _0x3c8a73;if(_0x3d721b){const _0x5033dc=JSON[_0x53945e(0x28f)](keys),_0x593308=new TextEncoder()['encode'](_0x5033dc),_0x4d3591=window[_0x53945e(0x2bc)][_0x53945e(0x2ca)](new Uint8Array(0x10)),_0x539e79=await deriveKeyFromPassword(_0x3d721b,_0x4d3591),_0x6dd5b8=window[_0x53945e(0x2bc)]['getRandomValues'](new Uint8Array(AES_CONFIG[_0x53945e(0x252)])),_0x16ea38=await encryptWithDerivedKey(_0x539e79,_0x593308,_0x6dd5b8);_0x3c8a73=JSON[_0x53945e(0x28f)]({'format':'LemonadeProtectedBackup','salt':arrayBufferToBase64(_0x4d3591),'iv':arrayBufferToBase64(_0x6dd5b8),'data':arrayBufferToBase64(_0x16ea38)});}else{const _0x2bc726=confirm(_0x53945e(0x30f));if(!_0x2bc726)return;_0x3c8a73=JSON[_0x53945e(0x28f)](keys);}const _0x56f1da=new Blob([_0x3c8a73],{'type':'application/octet-stream'}),_0xcbda22=URL[_0x53945e(0x251)](_0x56f1da),_0x3a3234=document['createElement']('a');_0x3a3234[_0x53945e(0x311)]=_0xcbda22,_0x3a3234[_0x53945e(0x1d2)]=_0x53945e(0x237),document[_0x53945e(0x212)]['appendChild'](_0x3a3234),_0x3a3234[_0x53945e(0x330)](),document['body'][_0x53945e(0x1a7)](_0x3a3234),URL['revokeObjectURL'](_0xcbda22),showStatus('keyStatus',_0x53945e(0x216),_0x53945e(0x17e));}catch(_0x17e119){console[_0x53945e(0x1e9)](_0x53945e(0x295),_0x17e119),showStatus(_0x53945e(0x1b6),_0x53945e(0x1c3)+_0x17e119[_0x53945e(0x270)],_0x53945e(0x1e9));}}function createStateFileInput(){const _0x33d373=_0x2c69c4;let _0x45d286=document[_0x33d373(0x19c)](_0x33d373(0x218));return!_0x45d286&&(_0x45d286=document[_0x33d373(0x272)]('input'),_0x45d286[_0x33d373(0x281)]=_0x33d373(0x313),_0x45d286['id']=_0x33d373(0x218),_0x45d286[_0x33d373(0x17a)]=_0x33d373(0x129),_0x45d286[_0x33d373(0x24e)][_0x33d373(0x125)]=_0x33d373(0x2a7),document['body'][_0x33d373(0x2ef)](_0x45d286),_0x45d286[_0x33d373(0x16e)](_0x33d373(0x180),handleStateFileSelect)),_0x45d286;}async function handleStateFileSelect(_0x2fdc7e){const _0x1d1fb9=_0x2c69c4;try{const _0x786552=_0x2fdc7e['target']['files'];if(!_0x786552||_0x786552[_0x1d1fb9(0x1d4)]===0x0)return;setLoading(!![]);const _0xa83d3b=_0x786552[0x0],_0x27d33f=new FileReader();_0x27d33f['onload']=async function(_0x11af1b){const _0x3998ad=_0x1d1fb9;try{const _0x141bea=_0x11af1b[_0x3998ad(0x1d8)][_0x3998ad(0x181)];let _0x43a02c;try{_0x43a02c=JSON[_0x3998ad(0x2bb)](_0x141bea);}catch(_0x5321de){throw new Error(_0x3998ad(0x2e8));}if(_0x43a02c['format']===_0x3998ad(0x322)){let _0x28b346='';try{_0x28b346=await showPasswordModal(_0x3998ad(0x1ad),_0x3998ad(0x257),![]);}catch(_0xbded8d){throw new Error(_0x3998ad(0x1f3));}if(!_0x28b346)throw new Error('Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20state\x20file');const _0x3c00fb=base64ToArrayBuffer(_0x43a02c[_0x3998ad(0x12c)]),_0x43e8af=base64ToArrayBuffer(_0x43a02c['iv']),_0xbd5993=base64ToArrayBuffer(_0x43a02c[_0x3998ad(0x222)]),_0x470978=await deriveKeyFromPassword(_0x28b346,_0x3c00fb),_0x3e3c76=await decryptWithDerivedKey(_0x470978,_0xbd5993,_0x43e8af),_0x235826=new TextDecoder()[_0x3998ad(0x177)](_0x3e3c76);_0x43a02c=JSON[_0x3998ad(0x2bb)](_0x235826);}if(!Array[_0x3998ad(0x141)](_0x43a02c))throw new Error(_0x3998ad(0x27b));const _0x1cb1a1=confirm(_0x3998ad(0x2d7)+_0x43a02c[_0x3998ad(0x1d4)]+_0x3998ad(0x20a));if(!_0x1cb1a1)return;keys=_0x43a02c,await saveKeys(),showStatus(_0x3998ad(0x1b6),_0x3998ad(0x2de)+_0x43a02c[_0x3998ad(0x1d4)]+_0x3998ad(0x1bf),_0x3998ad(0x17e));}catch(_0x3e2c8e){console['error'](_0x3998ad(0x15e),_0x3e2c8e),showStatus(_0x3998ad(0x1b6),_0x3998ad(0x21f)+_0x3e2c8e[_0x3998ad(0x270)],'error');}finally{setLoading(![]),document[_0x3998ad(0x19c)]('stateFileInput')['value']='';}},_0x27d33f['onerror']=function(){const _0x39181a=_0x1d1fb9;setLoading(![]),showStatus(_0x39181a(0x1b6),_0x39181a(0x1ca),'error'),document[_0x39181a(0x19c)](_0x39181a(0x218))[_0x39181a(0x184)]='';},_0x27d33f[_0x1d1fb9(0x1fb)](_0xa83d3b);}catch(_0x41746d){console[_0x1d1fb9(0x1e9)](_0x1d1fb9(0x15e),_0x41746d),showStatus(_0x1d1fb9(0x1b6),_0x1d1fb9(0x21f)+_0x41746d[_0x1d1fb9(0x270)],_0x1d1fb9(0x1e9)),setLoading(![]),document[_0x1d1fb9(0x19c)](_0x1d1fb9(0x218))['value']='';}}function importState(){const _0x386d1f=_0x2c69c4,_0x5000d8=createStateFileInput();_0x5000d8[_0x386d1f(0x330)]();}async function secureClipboardCopy(_0x584d96){const _0x462013=_0x2c69c4;try{return await navigator[_0x462013(0x171)][_0x462013(0x2fa)](_0x584d96),!![];}catch(_0x3159cf){return console['log'](_0x462013(0x1f4),_0x3159cf),![];}}function deleteKey(_0x4a2276){const _0x2bccbe=_0x2c69c4,_0x3c6944=keys[_0x2bccbe(0x1cf)](_0x1b46da=>_0x1b46da['id']===_0x4a2276);if(!_0x3c6944){alert(_0x2bccbe(0x160));return;}const _0xc9f546=window[_0x2bccbe(0x25a)](_0x2bccbe(0x132)+_0x3c6944[_0x2bccbe(0x319)]+_0x2bccbe(0x15b));_0xc9f546&&(keys=keys[_0x2bccbe(0x149)](_0x255c0b=>_0x255c0b['id']!==_0x4a2276),saveKeys(),showStatus('keyStatus',_0x2bccbe(0x1cd)+_0x3c6944[_0x2bccbe(0x319)]+_0x2bccbe(0x154),_0x2bccbe(0x17e)));}function xorCipher(_0x432827,_0x59d514){const _0x472733=_0x2c69c4;if(!_0x59d514)return _0x432827;const _0x11c957=new TextEncoder()[_0x472733(0x175)](_0x59d514),_0x14f6a5=new Uint8Array(_0x432827),_0x230497=new Uint8Array(_0x432827[_0x472733(0x299)]);for(let _0x1f4289=0x0;_0x1f4289<_0x14f6a5[_0x472733(0x1d4)];_0x1f4289++){_0x230497[_0x1f4289]=_0x14f6a5[_0x1f4289]^_0x11c957[_0x1f4289%_0x11c957[_0x472733(0x1d4)]];}return _0x230497['buffer'];}function showStatus(_0x1d86fd,_0x360ed7,_0x1c14b1){const _0xa49e41=_0x2c69c4,_0x3e6fb2=document[_0xa49e41(0x19c)](_0x1d86fd);_0x3e6fb2['textContent']=validator[_0xa49e41(0x325)](_0x360ed7),_0x3e6fb2[_0xa49e41(0x156)]='status\x20'+_0x1c14b1,setTimeout(()=>{const _0x49a4d3=_0xa49e41;_0x3e6fb2['textContent']===validator[_0x49a4d3(0x325)](_0x360ed7)&&(_0x3e6fb2[_0x49a4d3(0x156)]=_0x49a4d3(0x1e4));},0x2710);}let passwordModalCallback=null,passwordModalResolve=null,passwordModalReject=null;function showPasswordModal(_0x2777f1,_0x52764d,_0x18422d=![]){return new Promise((_0x43712a,_0x11606d)=>{const _0x3b354f=_0x1b5e,_0x1b1681=document[_0x3b354f(0x19c)](_0x3b354f(0x1fd)),_0x521310=document['getElementById'](_0x3b354f(0x176)),_0x39adfb=document[_0x3b354f(0x19c)]('passwordModalMessage'),_0x53e64c=document['getElementById'](_0x3b354f(0x28a)),_0x128f19=document[_0x3b354f(0x19c)]('passwordModalStrength'),_0x1e302a=document['getElementById']('passwordModalFeedback');_0x521310[_0x3b354f(0x1f9)]=_0x2777f1,_0x39adfb[_0x3b354f(0x1f9)]=_0x52764d,_0x53e64c[_0x3b354f(0x184)]='',_0x128f19['className']='password-strength',_0x1e302a[_0x3b354f(0x1f9)]='',_0x128f19[_0x3b354f(0x24e)]['display']=_0x18422d?_0x3b354f(0x26f):_0x3b354f(0x2a7),_0x1e302a[_0x3b354f(0x24e)][_0x3b354f(0x125)]=_0x18422d?_0x3b354f(0x26f):'none',passwordModalResolve=_0x43712a,passwordModalReject=_0x11606d,_0x1b1681[_0x3b354f(0x24e)]['display']='flex',setTimeout(()=>{_0x53e64c['focus']();},0x64);});}function confirmPasswordModal(){const _0x4e94ed=_0x2c69c4,_0x5c8172=document['getElementById']('passwordModalInput'),_0x748069=_0x5c8172[_0x4e94ed(0x184)],_0x155f7d=document[_0x4e94ed(0x19c)](_0x4e94ed(0x29d)),_0x4ad135=document[_0x4e94ed(0x19c)](_0x4e94ed(0x2fc));_0x155f7d['className']=_0x4e94ed(0x296),_0x4ad135[_0x4e94ed(0x1f9)]='',document[_0x4e94ed(0x19c)](_0x4e94ed(0x1fd))[_0x4e94ed(0x24e)][_0x4e94ed(0x125)]=_0x4e94ed(0x2a7),passwordModalResolve&&(passwordModalResolve(_0x748069),passwordModalResolve=null,passwordModalReject=null);}function cancelPasswordModal(){const _0x26ee8d=_0x2c69c4,_0x2df750=document[_0x26ee8d(0x19c)](_0x26ee8d(0x28a)),_0x3b2258=document[_0x26ee8d(0x19c)](_0x26ee8d(0x29d)),_0x3f97ee=document[_0x26ee8d(0x19c)](_0x26ee8d(0x2fc));_0x2df750[_0x26ee8d(0x184)]='',_0x3b2258[_0x26ee8d(0x156)]=_0x26ee8d(0x296),_0x3f97ee[_0x26ee8d(0x1f9)]='',document[_0x26ee8d(0x19c)](_0x26ee8d(0x1fd))[_0x26ee8d(0x24e)][_0x26ee8d(0x125)]=_0x26ee8d(0x2a7),passwordModalReject&&(passwordModalReject(new Error(_0x26ee8d(0x150))),passwordModalResolve=null,passwordModalReject=null);}function updateModalPasswordStrength(){const _0x576715=_0x2c69c4,_0x2d31a6=document[_0x576715(0x19c)]('passwordModalInput')[_0x576715(0x184)],_0x406cd9=validator[_0x576715(0x1b8)](_0x2d31a6),_0x56426a=document['getElementById'](_0x576715(0x29d)),_0x4f1bbc=document[_0x576715(0x19c)](_0x576715(0x2fc));_0x56426a['className']=_0x576715(0x296),_0x2d31a6?(_0x56426a[_0x576715(0x306)][_0x576715(0x333)](_0x406cd9[_0x576715(0x162)]),_0x4f1bbc[_0x576715(0x1f9)]=_0x406cd9['feedback']):_0x4f1bbc[_0x576715(0x1f9)]='';}async function copyToClipboard(_0x3f026f,_0xc98a11){const _0x5661c6=_0x2c69c4,_0x194e3a=document[_0x5661c6(0x19c)](_0x3f026f)[_0x5661c6(0x184)];if(!_0x194e3a){showStatus(_0xc98a11,_0x5661c6(0x155),_0x5661c6(0x1e9));return;}const _0x1de209=await secureClipboardCopy(_0x194e3a);if(_0x1de209)showStatus(_0xc98a11,_0x5661c6(0x26a),_0x5661c6(0x17e)),appSettings[_0x5661c6(0x168)]&&scheduleClipboardClear();else{showStatus(_0xc98a11,_0x5661c6(0x202),'warning');const _0x5750ca=document['getElementById'](_0x3f026f);_0x5750ca[_0x5661c6(0x320)](),_0x5750ca[_0x5661c6(0x139)]();}}function handleDarkModeToggle(){const _0x25403a=_0x2c69c4,_0xb9adcd=document[_0x25403a(0x19c)](_0x25403a(0x2bf))[_0x25403a(0x151)],_0x1c514e=document['getElementById'](_0x25403a(0x209));_0xb9adcd?(_0x1c514e[_0x25403a(0x24e)][_0x25403a(0x125)]='block',applyTheme(appSettings[_0x25403a(0x163)])):(_0x1c514e['style'][_0x25403a(0x125)]=_0x25403a(0x2a7),document[_0x25403a(0x212)][_0x25403a(0x156)]='',document[_0x25403a(0x1b2)](_0x25403a(0x130))[_0x25403a(0x158)](_0x113afc=>_0x113afc[_0x25403a(0x151)]=![])),localStorage[_0x25403a(0x22a)](_0x25403a(0x195),_0xb9adcd);}function handleThemeToggle(_0x4c90e0){const _0x3977d3=_0x2c69c4,_0x24f8ab=_0x4c90e0['target'],_0x523c12=document['querySelectorAll']('.theme-toggle');_0x523c12[_0x3977d3(0x158)](_0xded304=>{_0xded304!==_0x24f8ab&&(_0xded304['checked']=![]);});const _0x3d1e35=_0x24f8ab[_0x3977d3(0x151)]?_0x24f8ab[_0x3977d3(0x2a5)][_0x3977d3(0x163)]:null;appSettings[_0x3977d3(0x163)]=_0x3d1e35,applyTheme(_0x3d1e35);}function applyTheme(_0x38f420){const _0x8047ad=_0x2c69c4,_0x5592bc=document['getElementById'](_0x8047ad(0x2bf))[_0x8047ad(0x151)];_0x5592bc&&(document[_0x8047ad(0x212)][_0x8047ad(0x156)]=_0x8047ad(0x178),_0x38f420&&document['body']['classList']['add'](_0x8047ad(0x22c)+_0x38f420)),document[_0x8047ad(0x1b2)]('.theme-toggle')[_0x8047ad(0x158)](_0x1f41cf=>{const _0x3bd54d=_0x8047ad;_0x1f41cf['checked']=_0x1f41cf['dataset'][_0x3bd54d(0x163)]===_0x38f420;});}function arrayBufferToBase64(_0x375748){const _0x2952de=_0x2c69c4,_0x1fabda=new Uint8Array(_0x375748);let _0x502a8e='';for(let _0x5aab65=0x0;_0x5aab65<_0x1fabda['byteLength'];_0x5aab65++){_0x502a8e+=String[_0x2952de(0x2a6)](_0x1fabda[_0x5aab65]);}return btoa(_0x502a8e);}function base64ToArrayBuffer(_0xdb712b){const _0x45c7dd=_0x2c69c4;try{const _0x467c8f=atob(_0xdb712b),_0x549168=new Uint8Array(_0x467c8f[_0x45c7dd(0x1d4)]);for(let _0x224e2b=0x0;_0x224e2b<_0x467c8f[_0x45c7dd(0x1d4)];_0x224e2b++){_0x549168[_0x224e2b]=_0x467c8f[_0x45c7dd(0x17f)](_0x224e2b);}return _0x549168[_0x45c7dd(0x1ac)];}catch(_0x5cd435){console[_0x45c7dd(0x1e9)]('[BASE64]\x20Decoding\x20error:',_0x5cd435);throw new Error(_0x45c7dd(0x214));}}async function encryptData(_0x5cf300,_0x29072a,_0x31da95){const _0x1737f7=_0x2c69c4;if(_0x29072a[_0x1737f7(0x281)]===_0x1737f7(0x21c))return await encryptWithAES(_0x5cf300,_0x29072a);else{if(_0x29072a[_0x1737f7(0x281)]===_0x1737f7(0x1fa)||_0x29072a[_0x1737f7(0x281)]==='rsa-4096')return await encryptWithRSA(_0x5cf300,_0x29072a,_0x31da95);else{if(_0x29072a[_0x1737f7(0x281)]==='ecc'||_0x29072a[_0x1737f7(0x281)]===_0x1737f7(0x185)||_0x29072a[_0x1737f7(0x281)]===_0x1737f7(0x2fb))return await encryptWithECC(_0x5cf300,_0x29072a,_0x31da95);else throw new Error(_0x1737f7(0x29e));}}}async function decryptData(_0x125a53,_0x519046){const _0x3ea277=_0x2c69c4;if(_0x125a53[_0x3ea277(0x14c)]>=0x2){if(_0x519046[_0x3ea277(0x281)]===_0x3ea277(0x21c))return await decryptWithAES(_0x125a53,_0x519046);else{if(_0x519046[_0x3ea277(0x281)]==='rsa'||_0x519046['type']==='rsa-4096')return await decryptWithRSA(_0x125a53,_0x519046);else{if(_0x519046['type']==='ecc'||_0x519046[_0x3ea277(0x281)]===_0x3ea277(0x185)||_0x519046[_0x3ea277(0x281)]===_0x3ea277(0x2fb))return await decryptWithECC(_0x125a53,_0x519046);}}}if(_0x125a53[_0x3ea277(0x2e7)]===AES_CONFIG['MODE'])return await decryptWithAES(_0x125a53,_0x519046);else{if(_0x125a53[_0x3ea277(0x2e7)]===RSA_CONFIG[_0x3ea277(0x1a1)]+'+'+AES_CONFIG[_0x3ea277(0x182)]||_0x125a53[_0x3ea277(0x2e7)]===_0x3ea277(0x227))return await decryptWithRSA(_0x125a53,_0x519046);else{if(_0x125a53[_0x3ea277(0x2e7)]===_0x3ea277(0x32b)+AES_CONFIG[_0x3ea277(0x182)]||_0x125a53[_0x3ea277(0x2e7)]===_0x3ea277(0x1b3))return await decryptWithECC(_0x125a53,_0x519046);else throw new Error(_0x3ea277(0x2ea)+_0x125a53[_0x3ea277(0x2e7)]);}}}async function deriveKeyFromPassword(_0x2b6e4a,_0x598a40){const _0xdbb4bf=_0x2c69c4,_0x146e0d=new TextEncoder()[_0xdbb4bf(0x175)](_0x2b6e4a),_0x477686=await window['crypto'][_0xdbb4bf(0x230)]['importKey'](_0xdbb4bf(0x1b0),_0x146e0d,{'name':'PBKDF2'},![],['deriveKey']);return window[_0xdbb4bf(0x2bc)]['subtle']['deriveKey']({'name':_0xdbb4bf(0x186),'salt':_0x598a40,'iterations':PBKDF2_CONFIG[_0xdbb4bf(0x221)],'hash':PBKDF2_CONFIG[_0xdbb4bf(0x2d1)]},_0x477686,{'name':AES_CONFIG[_0xdbb4bf(0x182)],'length':AES_CONFIG['KEY_LENGTH']},!![],['encrypt',_0xdbb4bf(0x32c)]);}async function encryptWithDerivedKey(_0x3f461f,_0x6dda13,_0x58310a){const _0x469829=_0x2c69c4;return window[_0x469829(0x2bc)]['subtle'][_0x469829(0x1a3)]({'name':AES_CONFIG[_0x469829(0x182)],'iv':_0x58310a,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x3f461f,_0x6dda13);}function _0xdc69(){const _0x3d7577=['meta','Error\x20generating\x20key:','public\x20key','exportAllKeysBtn','exportPrivateKey','Copied\x20to\x20clipboard','Password\x20protection\x20is\x20required\x20by\x20your\x20security\x20settings','PWA\x20installation\x20requires\x20HTTPS.\x20You\x20are\x20viewing\x20this\x20file\x20locally.','importKeyBtn','decryptVerify','block','message','19661650HKTfgX','createElement','warning','passwordModalConfirm','encryptBrowseBtn','Missing\x20encrypted\x20key\x20data','close','setDate','HKDF','encryptedOutput','Invalid\x20state\x20data\x20format','RSA_ALGORITHM','join','[DECRYPT-ECC]\x20Technical\x20error\x20details:','files','toLocaleString','type','readwrite','Export\x20cancelled:\x20','contains','3449595FkZNFS','CompressionStream\x20not\x20supported,\x20returning\x20uncompressed\x20data','ECC_ALGORITHM','keys',')</div>','passwordModalInput','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Algorithm:\x20','<span\x20class=\x22key-pair-badge\x20private\x22>PRIVATE\x20KEY</span>','sign','Decompressed\x20size:','stringify',')\x20have\x20been\x20permanently\x20deleted','div','fileSize','P-521','expiry','Export\x20error:','password-strength','Weak\x20-\x20Use\x20a\x20longer\x20password\x20with\x20numbers\x20and\x20special\x20characters','log','byteLength','input','This\x20.lim\x20file\x20does\x20not\x20contain\x20a\x20public\x20key','App\x20is\x20already\x20running\x20in\x20standalone\x20mode\x20(installed)','passwordModalStrength','Unsupported\x20key\x20type','put','getDate','isFile','Error\x20loading\x20settings\x20from\x20localStorage:','Decryption\x20error:','Database\x20initialization\x20failed.\x20Using\x20less\x20secure\x20localStorage\x20instead.','dataset','fromCharCode','none','then','Please\x20select\x20an\x20encryption\x20key','WARNING:\x20This\x20will\x20permanently\x20delete\x20ALL\x20your\x20encryption\x20keys.\x20This\x20action\x20CANNOT\x20be\x20undone.\x0a\x0aAre\x20you\x20absolutely\x20sure\x20you\x20want\x20to\x20continue?','transaction','encryptMessage','decryptBrowseBtn','decryptionPasswordGroup','KEY_LENGTH','.tab-content','msg','score','settings','public','retrieve','accepted','Please\x20use\x20a\x20stronger\x20password:\x20','Error\x20saving\x20keys:\x20','application/octet-stream','importKey','parse','crypto','Only\x20export\x20private\x20keys\x20if\x20you\x20absolutely\x20need\x20to\x20use\x20them\x20on\x20another\x20device.\x20','Symmetric\x20key\x20\x22','darkMode','<div\x20class=\x22key-expiry\x22>Expires\x20in\x20','size','Decompression\x20attempt\x20-\x20first\x204\x20bytes:','toFixed','Installation\x20not\x20available\x20in\x20this\x20browser\x20or\x20app\x20is\x20already\x20installed','Service\x20Worker\x20registered\x20with\x20scope:','strong','installStatus','Database\x20initialized\x20successfully','pow','getRandomValues','low','querySelector','setAttribute','Escape','[PARSE]\x20Extra\x20password\x20processing\x20error:','decrypted.txt','HASH','preventDefault',')[\x5cs\x5cS]+?(','Compression\x20disabled,\x20returning\x20uncompressed\x20data','test','indexedDB','This\x20will\x20import\x20','TAG_LENGTH','isValidKeyName','keyExpiry','hasPublic','protected','ecc','Application\x20state\x20with\x20','keydown','File\x20\x22','(display-mode:\x20standalone)','_publicKey','_signingPrivateKey','Your\x20browser\x20doesn\x27t\x20support\x20secure\x20storage.\x20Using\x20less\x20secure\x20localStorage\x20instead.','Incorrect\x20password\x20or\x20corrupted\x20private\x20key','Decompression\x20successful!\x20Output\x20first\x204\x20bytes:','algorithm','Invalid\x20state\x20file\x20format','DOMContentLoaded','Unsupported\x20encryption\x20algorithm:\x20','P-384','sw.js','LemonadeKeys','resetSettingsBtn','appendChild','Invalid\x20key\x20name\x20format','File:\x20','false','downloadEncryptedBtn','downloadDecryptedBtn','includes','[DECRYPT-RSA]\x20Technical\x20error\x20details:','\x20[Full\x20Pair]','Error\x20loading\x20keys:','1392959qExqRM','writeText','ecc-p521','passwordModalFeedback','Error\x20generating\x20key:\x20','Unsupported\x20key\x20type:\x20','Compression:\x20output\x20first\x204\x20bytes:','4cYuNBJ','<span\x20class=\x22security-badge\x20','Switching\x20to\x20tab:','AES-GCM','randomUUID','Your\x20browser\x20does\x20not\x20support\x20PWA\x20installation\x20features.','classList','clear','installBtn','Please\x20select\x20a\x20decryption\x20key','decryptedOutput','\x20expired\x20key(s)\x20removed\x20for\x20security','</span>','spki','\x27)\x22>Export\x20Public</button>','WARNING:\x20Exporting\x20keys\x20without\x20a\x20password\x20is\x20not\x20secure.\x20Anyone\x20with\x20access\x20to\x20this\x20file\x20will\x20be\x20able\x20to\x20use\x20your\x20keys.\x20Continue\x20anyway?','endsWith','href','ECC-P256','file','Verification\x20failed:','_importPassword','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','^.*?(','hasSigningPublic','name','Unable\x20to\x20read\x20the\x20file.','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22exportKey(\x27','createObjectStore','.lim','.tab-btn','key','focus','function','LemonadeProtectedBackup','Would\x20you\x20like\x20to\x20merge\x20them\x20into\x20a\x20complete\x20key\x20pair?','Lemonade\x20has\x20been\x20installed\x20successfully!','sanitizeHTML','pairedKeyId','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','store','Signing\x20failed:','_privateKey','ECDH+','decrypt','getAttribute','enqueue','read','click','push','getReader','add','onload','map','decryptionPassword','onsuccess','Error\x20saving\x20settings:','open','objectStore','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','All\x20keys\x20cleared\x20from\x20database','has','publicKey','encryptFileInput','display','decryptStatus','from','charAt','.state,application/octet-stream','active','settingsStatus','salt','private','sig','toISOString','.theme-toggle','reverse','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20key\x20\x22','zeroKeysBtn','Error\x20loading\x20settings\x20from\x20database:','slice','encryptSign','Message\x20encrypted\x20successfully','Secure\x20Your\x20Key\x20Backup','select','Please\x20enter\x20a\x20message\x20or\x20add\x20a\x20file\x20to\x20encrypt','Failed\x20to\x20unlock\x20key.\x20Please\x20check\x20your\x20password.','getAll','decryptVerifyGroup','encryptFileName','text','decryptionKey','isArray','7598479IZsrdb','\x27)\x22>Delete</button>','toString','passwordModalCancel','P-256','timeoutTimer','CURVE','filter','SHA-256','trim','version','pkcs8','gzip','reduce','Password\x20entry\x20cancelled','checked','removeEncryptFile','exportKey','\x22\x20deleted\x20successfully','Nothing\x20to\x20copy','className','.lim,.lem','forEach','findIndex','\x27)\x22>Export</button>','\x22?\x20This\x20action\x20cannot\x20be\x20undone.','RSA-2048','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','State\x20import\x20error:','delete','Key\x20not\x20found','readonly','strengthCategory','theme','\x22\x20imported\x20as\x20separate\x20key','revokeObjectURL','\x20key\x20part\x20of\x20an\x20existing\x20key.\x20','encryptStatus','clearClipboard','Password\x20is\x20required','<option\x20value=\x22\x22>Select\x20a\x20key...</option>','Complete\x20asymmetric\x20key\x20pair\x20\x22','undefined','.lem','addEventListener','remove','Key\x20deletion\x20canceled','clipboard','verify','sessionOnly','encryptionPasswordGroup','encode','passwordModalTitle','decode','dark-mode','KEY_SIZE','accept','encryptIterations','Please\x20enter\x20an\x20encrypted\x20message\x20or\x20add\x20an\x20encrypted\x20file','keyPassword','success','charCodeAt','change','result','MODE','constructor','value','ecc-p384','PBKDF2','Error\x20reading\x20the\x20key\x20file','warn','Do\x20you\x20want\x20to\x20continue?','\x20file','created','\x20(No\x20signature\x20found\x20to\x20verify)','encryptionKey','66obCXzZ','Manual\x20garbage\x20collection\x20not\x20available','useIndexedDB','feedback','Settings\x20saved\x20successfully','data-binary','app-settings','LemonadeDarkMode','4088637ScIsMr','Service\x20Worker\x20registration\x20failed:','\x27)\x22>Private\x20Key</button>','\x22\x20already\x20exists.\x20Overwrite?','passwordFeedback','encryptFileInfo','getElementById','floor','keyName','Invalid\x20encrypted\x20message\x20format.\x20Expected\x20Base64\x20data.','.install-note','ALGORITHM','rsa-4096','encrypt','Invalid\x20key\x20file\x20format','\x20[Private]','<p>No\x20keys\x20available.\x20Generate\x20or\x20import\x20a\x20key\x20to\x20get\x20started.</p>','removeChild','get','Data\x20does\x20not\x20appear\x20to\x20be\x20GZIP\x20compressed\x20(no\x20magic\x20bytes\x200x1f\x200x8b),\x20returning\x20as-is','\x20âœ…\x20VALID\x20SIGNATURE','_cryptoKey','buffer','Protected\x20State\x20File','appinstalled','User\x20response\x20to\x20install\x20prompt:\x20','raw','pipeThrough','querySelectorAll','ECDH+AES-GCM','clearDecryptBtn','SALT_LENGTH','keyStatus','\x20ðŸ”’','measurePasswordStrength','confirmKeyPassword','Compression:\x20input\x20first\x204\x20bytes:','publicKeyHash','true','privateKey','load','\x20keys\x20imported\x20successfully','.theme-toggle:checked','Passwords\x20do\x20not\x20match','RSA-OAEP','Export\x20error:\x20','[DECRYPT-UI]\x20Key\x20password\x20error:','LemonadeSecureDB','Medium\x20-\x20Add\x20more\x20variety\x20or\x20length\x20for\x20better\x20security','\x20key\x20part.\x20Security\x20level:\x20','8668792PwlWNn','Import\x20error:','Error\x20reading\x20the\x20state\x20file','flex','matches','Key\x20\x22','catch','find','disabled','decryptFileInfo','download','No\x20decrypted\x20data\x20to\x20download','length','location','inactivityModal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Created:\x20','target','set','Decompression\x20FAILED:','Warning:\x20Exporting\x20a\x20private\x20key\x20without\x20password\x20protection\x20is\x20a\x20security\x20risk.\x20Continue\x20anyway?','protocol','Import\x20error:\x20','deriveKey','serviceWorker','A\x20key\x20with\x20name\x20\x22','keyType','ECDSA','Compression\x20error:','status','toLowerCase','hasSigningPrivate','getItem','Compression:\x20input\x20length:','error','clearEncryptBtn','\x20key\x20\x22','keyFileInput','saveSettingsBtn','curve','Unsupported\x20ECC\x20curve:\x20','LemonadeSettings','Please\x20enter\x20a\x20key\x20name','No\x20keys\x20to\x20delete','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20state\x20file','Modern\x20clipboard\x20API\x20failed:','medium','pbkdf2Iterations','data-filename','Tab\x20button\x20clicked:','textContent','rsa','readAsText','\x22\x20imported\x20successfully','passwordModal','random','toUpperCase','installContainer','Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message','Unable\x20to\x20copy\x20automatically.\x20Please\x20select\x20the\x20text\x20and\x20press\x20Ctrl+C\x20(or\x20âŒ˜+C)\x20to\x20copy\x20manually.','File\x20downloaded\x20successfully','keypress','Error\x20saving\x20settings:\x20','_signingPublicKey','stack','Key\x20is\x20missing\x20salt\x20or\x20IV\x20data','darkThemeOptions','\x20keys\x20into\x20your\x20application.\x20Continue?','.lmn','hostname','signingPublicKey','Error\x20saving\x20keys:','replace','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22deleteKey(\x27','ECDH','body','Protected\x20Private\x20Key','Invalid\x20encrypted\x20message\x20format','decrypted_file','Application\x20state\x20exported\x20successfully','Encryption\x20failed.\x20Please\x20check\x20your\x20key\x20and\x20message.','stateFileInput','key-item','2oUsinx','string','aes','Decryption\x20failed.\x20Please\x20check\x20your\x20key\x20and\x20message.','decryptFileName','State\x20import\x20error:\x20','digest','ITERATIONS','data','readAsArrayBuffer','hasPrivate','encryptBtn','https:','RSA-OAEP+AES-GCM','onupgradeneeded','metadata','setItem','0\x20Bytes','theme-','removeDecryptFile','loadingOverlay','<span\x20class=\x22key-pair-badge\x20public\x22>PUBLIC\x20KEY</span>','subtle','generateKey','encryptObfKey','enforcePwdProtection','signingPrivateKey','sensitiveData','Encrypted\x20file\x20loaded.\x20Select\x20key\x20and\x20enter\x20OBF\x20key\x20if\x20needed.','Lemonade-state.state','deleteKey','Database\x20not\x20initialized','Error\x20loading\x20keys:\x20','output\x20length:','[ENCRYPT-AES]\x20Technical\x20error\x20details:','register','onerror','enforceKeyExpiry','ceil','Service\x20Workers\x20not\x20supported\x20or\x20not\x20in\x20secure\x20context','passwordStrength','encryptedMessage','[DECRYPT-UI]\x20Decryption\x20error:','[DECRYPT-AES]\x20Technical\x20error\x20details:','decryptedBinaryData','\x22\x20updated\x20with\x20','Message\x20decrypted\x20successfully','127.0.0.1','RSA-PSS','innerHTML','generateKeyBtn','importStateBtn','style','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','private\x20key','createObjectURL','IV_LENGTH','\x20days\x20(','Secure\x20Your\x20Private\x20Key','copyDecryptedBtn','462615ughtLL','This\x20state\x20file\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import:','Missing\x20encrypted\x20private\x20key\x20data','decryptIterations','confirm','Key\x20expiration\x20is\x20required\x20by\x20your\x20security\x20settings','ECC-P521','encryptSignGroup','option','decryptObfKey','deriveBits','KEY_SIZE_4096','objectStoreNames','fileName','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20private\x20key'];_0xdc69=function(){return _0x3d7577;};return _0xdc69();}async function decryptWithDerivedKey(_0x1df1f0,_0xe7ab20,_0x1bb919){const _0x49f4b0=_0x2c69c4;return window[_0x49f4b0(0x2bc)][_0x49f4b0(0x230)][_0x49f4b0(0x32c)]({'name':AES_CONFIG['MODE'],'iv':_0x1bb919,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x1df1f0,_0xe7ab20);}async function importAESKey(_0x5d4640){const _0x35e37d=_0x2c69c4;return window[_0x35e37d(0x2bc)][_0x35e37d(0x230)]['importKey'](_0x35e37d(0x1b0),_0x5d4640,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG[_0x35e37d(0x2af)]},![],[_0x35e37d(0x1a3),_0x35e37d(0x32c)]);}async function importRSAPublicKey(_0xc5406d,_0xd14b2d){const _0x5b558b=_0x2c69c4;return window[_0x5b558b(0x2bc)][_0x5b558b(0x230)][_0x5b558b(0x2ba)]('spki',_0xc5406d,{'name':RSA_CONFIG[_0x5b558b(0x1a1)],'hash':RSA_CONFIG[_0x5b558b(0x2d1)]},![],[_0x5b558b(0x1a3)]);}async function importRSAPrivateKey(_0x287d13,_0x5aa9ed){const _0xc6ad83=_0x2c69c4;return window[_0xc6ad83(0x2bc)]['subtle'][_0xc6ad83(0x2ba)]('pkcs8',_0x287d13,{'name':RSA_CONFIG[_0xc6ad83(0x1a1)],'hash':RSA_CONFIG[_0xc6ad83(0x2d1)]},![],[_0xc6ad83(0x32c)]);}async function importECCPublicKey(_0x5b5508,_0xbadb34){const _0x45786f=_0x2c69c4;return window['crypto'][_0x45786f(0x230)][_0x45786f(0x2ba)](_0x45786f(0x30d),_0x5b5508,{'name':'ECDH','namedCurve':_0xbadb34},![],[]);}async function importECCPrivateKey(_0x302315,_0x2730f0){const _0x155ebc=_0x2c69c4;return window[_0x155ebc(0x2bc)][_0x155ebc(0x230)][_0x155ebc(0x2ba)](_0x155ebc(0x14d),_0x302315,{'name':_0x155ebc(0x211),'namedCurve':_0x2730f0},![],[_0x155ebc(0x1de),_0x155ebc(0x260)]);}async function saveToDatabase(_0x2c5a42,_0x5b62c1){return new Promise((_0x1c9c26,_0x40a425)=>{const _0x4b9f41=_0x1b5e;if(!db){_0x40a425(new Error(_0x4b9f41(0x239)));return;}const _0x5b4bf9=db[_0x4b9f41(0x2ab)](_0x2c5a42,_0x4b9f41(0x282)),_0x4d589d=_0x5b4bf9[_0x4b9f41(0x33a)](_0x2c5a42),_0x2293dd=_0x4d589d[_0x4b9f41(0x29f)](_0x5b62c1);_0x2293dd[_0x4b9f41(0x337)]=()=>_0x1c9c26(),_0x2293dd['onerror']=()=>_0x40a425(_0x2293dd[_0x4b9f41(0x1e9)]);});}async function getFromDatabase(_0x4636cb,_0xac14dc){return new Promise((_0x27b393,_0x5dce90)=>{const _0x247388=_0x1b5e;if(!db){_0x5dce90(new Error('Database\x20not\x20initialized'));return;}const _0xd5eab8=db[_0x247388(0x2ab)](_0x4636cb,_0x247388(0x161)),_0x5619b5=_0xd5eab8[_0x247388(0x33a)](_0x4636cb),_0x365942=_0x5619b5[_0x247388(0x1a8)](_0xac14dc);_0x365942[_0x247388(0x337)]=()=>_0x27b393(_0x365942[_0x247388(0x181)]),_0x365942[_0x247388(0x23e)]=()=>_0x5dce90(_0x365942[_0x247388(0x1e9)]);});}async function getAllFromDatabase(_0x552b2a){return new Promise((_0x3dfb5e,_0x28935b)=>{const _0xa574e7=_0x1b5e;if(!db){_0x28935b(new Error(_0xa574e7(0x239)));return;}const _0x3c87eb=db[_0xa574e7(0x2ab)](_0x552b2a,_0xa574e7(0x161)),_0x196361=_0x3c87eb['objectStore'](_0x552b2a),_0xd7c719=_0x196361[_0xa574e7(0x13c)]();_0xd7c719[_0xa574e7(0x337)]=()=>_0x3dfb5e(_0xd7c719[_0xa574e7(0x181)]),_0xd7c719[_0xa574e7(0x23e)]=()=>_0x28935b(_0xd7c719[_0xa574e7(0x1e9)]);});}async function clearDatabase(_0x541cee){return new Promise((_0x4f3eb8,_0x4e2774)=>{const _0x9777da=_0x1b5e;if(!db){_0x4e2774(new Error(_0x9777da(0x239)));return;}const _0x160c68=db['transaction'](_0x541cee,_0x9777da(0x282)),_0x4e704b=_0x160c68[_0x9777da(0x33a)](_0x541cee),_0x17da61=_0x4e704b[_0x9777da(0x307)]();_0x17da61[_0x9777da(0x337)]=()=>_0x4f3eb8(),_0x17da61[_0x9777da(0x23e)]=()=>_0x4e2774(_0x17da61[_0x9777da(0x1e9)]);});}window[_0x2c69c4(0x153)]=exportKey,window[_0x2c69c4(0x269)]=exportPrivateKey,window[_0x2c69c4(0x238)]=deleteKey;let deferredPrompt;const installBtn=document[_0x2c69c4(0x19c)](_0x2c69c4(0x308)),installContainer=document[_0x2c69c4(0x19c)](_0x2c69c4(0x200)),installStatus=document[_0x2c69c4(0x19c)](_0x2c69c4(0x2c7));installBtn&&(installBtn['disabled']=!![]);window['addEventListener']('beforeinstallprompt',_0x261026=>{const _0x13e00d=_0x2c69c4;_0x261026[_0x13e00d(0x2d2)](),deferredPrompt=_0x261026;if(installBtn){installBtn['disabled']=![];const _0x3cf6d8=installContainer[_0x13e00d(0x2cc)](_0x13e00d(0x1a0));_0x3cf6d8&&(_0x3cf6d8['style']['display']=_0x13e00d(0x2a7)),showStatus(_0x13e00d(0x2c7),'Installation\x20is\x20now\x20available!',_0x13e00d(0x17e));}});installBtn&&installBtn[_0x2c69c4(0x16e)]('click',async()=>{const _0x5e251d=_0x2c69c4;if(!deferredPrompt){showStatus(_0x5e251d(0x2c7),_0x5e251d(0x2c4),'warning');return;}deferredPrompt['prompt']();const {outcome:_0x47e71d}=await deferredPrompt['userChoice'];console[_0x5e251d(0x298)](_0x5e251d(0x1af)+_0x47e71d),_0x47e71d===_0x5e251d(0x2b6)?showStatus(_0x5e251d(0x2c7),_0x5e251d(0x324),_0x5e251d(0x17e)):showStatus('installStatus','Installation\x20was\x20canceled',_0x5e251d(0x273)),deferredPrompt=null,installBtn[_0x5e251d(0x1d0)]=!![];});window[_0x2c69c4(0x16e)](_0x2c69c4(0x1ae),()=>{const _0x54f100=_0x2c69c4;console['log']('Lemonade\x20was\x20installed'),deferredPrompt=null,installBtn&&(installBtn[_0x54f100(0x1d0)]=!![]),showStatus(_0x54f100(0x2c7),_0x54f100(0x324),_0x54f100(0x17e));});_0x2c69c4(0x1df)in navigator&&(window[_0x2c69c4(0x1d5)][_0x2c69c4(0x1dc)]===_0x2c69c4(0x226)||window[_0x2c69c4(0x1d5)]['hostname']==='localhost'||window[_0x2c69c4(0x1d5)][_0x2c69c4(0x20c)]===_0x2c69c4(0x249))?window[_0x2c69c4(0x16e)](_0x2c69c4(0x1be),function(){const _0x427d35=_0x2c69c4;navigator[_0x427d35(0x1df)][_0x427d35(0x23d)](_0x427d35(0x2ec))['then'](function(_0x219e08){const _0x288488=_0x427d35;console[_0x288488(0x298)](_0x288488(0x2c5),_0x219e08['scope']);})['catch'](function(_0x446f35){const _0xa999a7=_0x427d35;console[_0xa999a7(0x1e9)](_0xa999a7(0x197),_0x446f35),showStatus(_0xa999a7(0x2c7),'Service\x20Worker\x20registration\x20failed.\x20PWA\x20features\x20unavailable.',_0xa999a7(0x273));});}):(console[_0x2c69c4(0x298)](_0x2c69c4(0x241)),installStatus&&(window[_0x2c69c4(0x1d5)][_0x2c69c4(0x1dc)]==='file:'?showStatus(_0x2c69c4(0x2c7),_0x2c69c4(0x26c),_0x2c69c4(0x273)):showStatus('installStatus',_0x2c69c4(0x305),_0x2c69c4(0x273))));window['matchMedia'](_0x2c69c4(0x2e1))[_0x2c69c4(0x1cc)]&&(console['log'](_0x2c69c4(0x29c)),installStatus&&showStatus(_0x2c69c4(0x2c7),'Lemonade\x20is\x20running\x20as\x20an\x20installed\x20app','success'));let encryptFileData=null,encryptFileName='',decryptFileData=null,decryptFileName='';function _0x1b5e(_0x2b3865,_0x43878e){const _0xdc6943=_0xdc69();return _0x1b5e=function(_0x1b5e4f,_0x114a03){_0x1b5e4f=_0x1b5e4f-0x122;let _0x5772bf=_0xdc6943[_0x1b5e4f];return _0x5772bf;},_0x1b5e(_0x2b3865,_0x43878e);}document[_0x2c69c4(0x16e)](_0x2c69c4(0x2e9),function(){const _0x53c32e=_0x2c69c4,_0x1d64d0=document[_0x53c32e(0x19c)]('encryptFileInput'),_0x222685=document['getElementById'](_0x53c32e(0x275)),_0x3a8a8e=document[_0x53c32e(0x19c)](_0x53c32e(0x19b)),_0x4ec01d=document[_0x53c32e(0x19c)](_0x53c32e(0x13e)),_0x220109=document[_0x53c32e(0x19c)](_0x53c32e(0x152)),_0x3e7234=document['getElementById']('decryptFileInput'),_0x102581=document[_0x53c32e(0x19c)](_0x53c32e(0x2ad)),_0x2ebaf9=document[_0x53c32e(0x19c)]('decryptFileInfo'),_0x4f91f7=document['getElementById'](_0x53c32e(0x21e)),_0x31d6ef=document[_0x53c32e(0x19c)](_0x53c32e(0x22d)),_0x393413=document[_0x53c32e(0x19c)](_0x53c32e(0x2f3)),_0x58f4e2=document[_0x53c32e(0x19c)](_0x53c32e(0x2f4));_0x222685[_0x53c32e(0x16e)](_0x53c32e(0x330),()=>{const _0x50cdc4=_0x53c32e;_0x1d64d0[_0x50cdc4(0x330)]();}),_0x1d64d0['addEventListener'](_0x53c32e(0x180),_0x42551a=>{const _0x110da8=_0x53c32e;handleEncryptFileSelect(_0x42551a[_0x110da8(0x1d8)]['files']);}),_0x220109[_0x53c32e(0x16e)](_0x53c32e(0x330),()=>{clearEncryptFile();}),_0x102581[_0x53c32e(0x16e)](_0x53c32e(0x330),()=>{const _0x53c8a9=_0x53c32e;_0x3e7234[_0x53c8a9(0x330)]();}),_0x3e7234['addEventListener'](_0x53c32e(0x180),_0x1e30b1=>{const _0x4386d3=_0x53c32e;handleDecryptFileSelect(_0x1e30b1[_0x4386d3(0x1d8)][_0x4386d3(0x27f)]);}),_0x31d6ef[_0x53c32e(0x16e)](_0x53c32e(0x330),()=>{clearDecryptFile();}),createKeyFileInput(),_0x393413['addEventListener']('click',downloadEncryptedFile),_0x58f4e2[_0x53c32e(0x16e)](_0x53c32e(0x330),downloadDecryptedFile),document['getElementById'](_0x53c32e(0x225))[_0x53c32e(0x16e)](_0x53c32e(0x330),function(){const _0x2434a0=_0x53c32e;window[_0x2434a0(0x246)]=null;}),document['getElementById'](_0x53c32e(0x274))[_0x53c32e(0x16e)](_0x53c32e(0x330),confirmPasswordModal),document['getElementById'](_0x53c32e(0x145))[_0x53c32e(0x16e)](_0x53c32e(0x330),cancelPasswordModal),document[_0x53c32e(0x19c)](_0x53c32e(0x28a))[_0x53c32e(0x16e)](_0x53c32e(0x29a),updateModalPasswordStrength),document[_0x53c32e(0x19c)](_0x53c32e(0x28a))['addEventListener'](_0x53c32e(0x204),function(_0x46fc18){const _0x4d00fb=_0x53c32e;_0x46fc18[_0x4d00fb(0x31f)]==='Enter'&&confirmPasswordModal();}),document[_0x53c32e(0x16e)](_0x53c32e(0x2df),function(_0x117d71){const _0x158716=_0x53c32e;_0x117d71[_0x158716(0x31f)]===_0x158716(0x2ce)&&document['getElementById'](_0x158716(0x1fd))[_0x158716(0x24e)][_0x158716(0x125)]===_0x158716(0x1cb)&&cancelPasswordModal();});});function handleEncryptFileSelect(_0x3eed21){const _0x5a20d0=_0x2c69c4;if(_0x3eed21[_0x5a20d0(0x1d4)]===0x0)return;const _0x319eab=_0x3eed21[0x0];encryptFileName=_0x319eab[_0x5a20d0(0x319)];const _0xd43f07=new FileReader();_0xd43f07[_0x5a20d0(0x334)]=function(_0x4347a9){const _0x56e0ce=_0x5a20d0;encryptFileData=_0x4347a9[_0x56e0ce(0x1d8)][_0x56e0ce(0x181)],document[_0x56e0ce(0x19c)](_0x56e0ce(0x2ac))['value']='File:\x20'+encryptFileName+'\x20('+formatFileSize(_0x319eab[_0x56e0ce(0x2c1)])+')',document['getElementById']('encryptFileInfo')[_0x56e0ce(0x24e)][_0x56e0ce(0x125)]=_0x56e0ce(0x1cb),document[_0x56e0ce(0x19c)](_0x56e0ce(0x13e))[_0x56e0ce(0x1f9)]=encryptFileName;},_0xd43f07[_0x5a20d0(0x223)](_0x319eab);}function handleDecryptFileSelect(_0x179568){const _0x2bbf75=_0x2c69c4;if(_0x179568[_0x2bbf75(0x1d4)]===0x0)return;const _0x20ef83=_0x179568[0x0];decryptFileName=_0x20ef83['name'];const _0x4c26b1=new FileReader();_0x4c26b1[_0x2bbf75(0x334)]=function(_0x2a862c){const _0x435aa7=_0x2bbf75,_0x19605b=_0x2a862c[_0x435aa7(0x1d8)][_0x435aa7(0x181)];document[_0x435aa7(0x19c)]('encryptedMessage')['value']=_0x19605b,decryptFileData=null,document[_0x435aa7(0x19c)](_0x435aa7(0x1d1))['style']['display']='flex',document[_0x435aa7(0x19c)](_0x435aa7(0x21e))[_0x435aa7(0x1f9)]=decryptFileName,showStatus(_0x435aa7(0x126),_0x435aa7(0x236),_0x435aa7(0x17e));},_0x4c26b1[_0x2bbf75(0x23e)]=function(){const _0x271864=_0x2bbf75;showStatus(_0x271864(0x126),_0x271864(0x31a),_0x271864(0x1e9));},_0x4c26b1[_0x2bbf75(0x1fb)](_0x20ef83);}function clearEncryptFile(){const _0x767993=_0x2c69c4;encryptFileData=null,encryptFileName='',document[_0x767993(0x19c)](_0x767993(0x2ac))[_0x767993(0x184)]='',document[_0x767993(0x19c)](_0x767993(0x19b))[_0x767993(0x24e)][_0x767993(0x125)]=_0x767993(0x2a7),document[_0x767993(0x19c)](_0x767993(0x124))[_0x767993(0x184)]='';}function clearDecryptFile(){const _0x209cde=_0x2c69c4;decryptFileData=null,decryptFileName='',document[_0x209cde(0x19c)](_0x209cde(0x243))['value']='',document['getElementById'](_0x209cde(0x1d1))[_0x209cde(0x24e)]['display']=_0x209cde(0x2a7),document[_0x209cde(0x19c)]('decryptFileInput')[_0x209cde(0x184)]='';}function formatFileSize(_0x467638){const _0x4fc1de=_0x2c69c4;if(_0x467638===0x0)return _0x4fc1de(0x22b);const _0x6636b6=0x400,_0x3d34ed=['Bytes','KB','MB','GB'],_0x531320=Math['floor'](Math[_0x4fc1de(0x298)](_0x467638)/Math[_0x4fc1de(0x298)](_0x6636b6));return parseFloat((_0x467638/Math[_0x4fc1de(0x2c9)](_0x6636b6,_0x531320))[_0x4fc1de(0x2c3)](0x2))+'\x20'+_0x3d34ed[_0x531320];}function generateRandomFileName(_0x2bea1d=0x6){const _0x369c46=_0x2c69c4,_0x5b6e40=_0x369c46(0x316);let _0x573bdb='';for(let _0xa3f402=0x0;_0xa3f402<_0x2bea1d;_0xa3f402++){_0x573bdb+=_0x5b6e40['charAt'](Math['floor'](Math['random']()*_0x5b6e40[_0x369c46(0x1d4)]));}return _0x573bdb;} </script><div id="passwordModal" class="modal"><div class="modal-content"><h3 id="passwordModalTitle">Enter Password</h3><p id="passwordModalMessage">Please enter a password to continue:</p><div class="form-group"><input type="password" id="passwordModalInput" placeholder="Enter password"><div id="passwordModalStrength" class="password-strength"></div><div id="passwordModalFeedback" class="password-feedback"></div></div><div class="btn-group"><button id="passwordModalConfirm" class="btn-primary">Confirm</button><button id="passwordModalCancel" class="btn-secondary">Cancel</button></div></div></div></body></html>
