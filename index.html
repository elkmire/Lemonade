<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';"><meta http-equiv="X-Content-Type-Options" content="nosniff"><meta http-equiv="Referrer-Policy" content="no-referrer"><meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=()"><meta name="theme-color" content="#000000"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lemonade"><link rel="icon" href="icon.svg"><link rel="apple-touch-icon" href="icon.svg"><link rel="manifest" href="manifest.json"><title>Lemonade</title><style>:root{--bg-color:#ffffff;--text-color:#000000;--title-gradient:linear-gradient(90deg,#000000,#000000);--card-bg:#ffffff;--accent-color:#000000;--border-color:#dddddd;--input-bg:#ffffff;--button-bg:#000000;--button-text:#ffffff;--button-hover:#333333;--success-color:#00cc66;--error-color:#cc3300;--warning-color:#f0ad4e;--cyber-line:rgba(0,0,0,0.15);--cyber-glow:rgba(0,0,0,0.4);--security-high:#00cc66;--security-medium:#f0ad4e;--security-low:#cc3300;--output-bg:#f8f8f8;--output-text:#222222}body.dark-mode{--bg-color:#000000;--text-color:#E0E0E0;--title-gradient:linear-gradient(90deg,#39FF14,#FF00FF,#00FFFF);--card-bg:#0A0A0A;--accent-color:#39FF14;--border-color:#2A2A2A;--input-bg:#101010;--button-bg:#00FFFF;--button-text:#000000;--button-hover:#FF00FF;--success-color:#39FF14;--error-color:#FF3131;--warning-color:#FFFF00;--cyber-line:rgba(57,255,20,0.3);--cyber-glow:rgba(57,255,20,0.1);--security-high:#39FF14;--security-medium:#FFFF00;--security-low:#FF3131;--output-bg:#050505;--output-text:#B2F2BB}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background-color:var(--bg-color);color:var(--text-color);margin:0;padding:0;transition:background-color 0.3s,color 0.3s;line-height:1.6;position:relative;overflow-x:hidden}body::before{display:none}body.dark-mode::before{content:"";display:block;position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;background-color:#000000;opacity:1}body.dark-mode::after{content:"";display:block;position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;background:repeating-linear-gradient(0deg,rgba(57,255,20,0.05),rgba(57,255,20,0.05) 1px,transparent 1px,transparent 3px);pointer-events:none}body.dark-mode .app-title{color:var(--accent-color);text-shadow:none;background:none}body.dark-mode .card{border:1px solid var(--accent-color);box-shadow:none;backdrop-filter:none}body.dark-mode button{border:1px solid transparent;box-shadow:none;text-shadow:none;transition:background-color 0.2s ease,color 0.2s ease,transform 0.1s ease;position:relative;overflow:hidden}body.dark-mode button:hover{background-color:var(--button-hover);color:var(--button-text);box-shadow:none;transform:translateY(-1px)}body.dark-mode button::before{display:none}body.dark-mode input,body.dark-mode textarea,body.dark-mode select{border:1px solid var(--border-color);box-shadow:none;backdrop-filter:none;transition:border-color 0.2s ease}body.dark-mode input:focus,body.dark-mode textarea:focus,body.dark-mode select:focus{border-color:var(--accent-color);box-shadow:none}body.dark-mode .security-badge{text-shadow:none}body.dark-mode .key-item{border:1px solid var(--border-color);background-color:var(--card-bg);box-shadow:none;transition:border-color 0.2s ease}body.dark-mode .key-item:hover{transform:none;border-color:var(--accent-color);box-shadow:none}body.dark-mode .tab-btn.active{background-color:var(--accent-color);color:var(--button-text);border-bottom-color:var(--accent-color);box-shadow:none}body.dark-mode .tab-btn:hover:not(.active){color:var(--accent-color);border-bottom-color:var(--accent-color)}body.dark-mode .slider{background-color:#333;box-shadow:none}body.dark-mode input:checked+.slider{background-color:var(--accent-color)}body.dark-mode .slider:before{box-shadow:none;background-color:#111}body.dark-mode input:checked+.slider:before{background-color:#000}body.dark-mode .status.success,body.dark-mode .status.warning,body.dark-mode .status.error{border-width:1px;border-style:solid}body.dark-mode .status.success{background-color:rgba(57,255,20,0.1);border-color:var(--success-color);color:var(--success-color)}body.dark-mode .status.warning{background-color:rgba(255,255,0,0.1);border-color:var(--warning-color);color:var(--warning-color)}body.dark-mode .status.error{background-color:rgba(255,49,49,0.1);border-color:var(--error-color);color:var(--error-color)}body.dark-mode .spinner{border:3px solid rgba(224,224,224,0.2);border-top-color:var(--accent-color);animation:spin 1s linear infinite}.app-title{font-size:1.8rem;margin:0;color:var(--text-color);background:none}body.dark-mode .app-title{color:var(--accent-color);text-shadow:none}body.dark-mode .app-header::after{background:linear-gradient(90deg,transparent,var(--accent-color),transparent)}body.dark-mode .card::before{background:var(--accent-color);height:2px}body.dark-mode .tab-btn:hover::after{background-color:var(--accent-color)}body.dark-mode input:focus,body.dark-mode textarea:focus,body.dark-mode select:focus{outline:none;border-color:var(--accent-color);box-shadow:0 0 0 2px var(--cyber-glow)}body.dark-mode .btn-secondary{border:1px solid var(--accent-color);color:var(--accent-color);background-color:transparent}body.dark-mode .btn-secondary:hover{background-color:rgba(57,255,20,0.1);color:#39FF14}body.dark-mode .security-badge{transition:none}body.dark-mode .security-badge.high{background-color:rgba(57,255,20,0.1);color:var(--security-high);border:1px solid var(--security-high);box-shadow:none}body.dark-mode .security-badge.medium{background-color:rgba(255,255,0,0.1);color:var(--security-medium);border:1px solid var(--security-medium);box-shadow:none}body.dark-mode .security-badge.low{background-color:rgba(255,49,49,0.1);color:var(--security-low);border:1px solid var(--security-low);box-shadow:none}body.dark-mode .key-pair-badge.full{background-color:rgba(57,255,20,0.1);color:var(--security-high);border:1px solid var(--security-high);box-shadow:none}body.dark-mode .key-pair-badge.private{background-color:rgba(255,49,49,0.1);color:var(--security-low);border:1px solid var(--security-low);box-shadow:none}body.dark-mode .key-pair-badge.public{background-color:rgba(255,255,0,0.1);color:var(--security-medium);border:1px solid var(--security-medium);box-shadow:none}body.dark-mode .private-key-btn{border:1px solid var(--error-color) !important;color:var(--error-color) !important}body.dark-mode .private-key-btn:hover{background-color:rgba(255,49,49,0.2) !important;color:#FF3131 !important}body.dark-mode .modal-content{border:1px solid var(--accent-color);box-shadow:none;background-color:var(--card-bg)}body.dark-mode .btn-primary{background-color:var(--accent-color);color:#000000}body.dark-mode .btn-primary:hover{background-color:#4CFF3A}body.dark-mode .btn-zero{background-color:var(--error-color);color:#FFFFFF;border:1px solid #FF0000}body.dark-mode .btn-zero:hover{background-color:#FF5555}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background-color:var(--bg-color);color:var(--text-color);margin:0;padding:0;transition:background-color 0.3s,color 0.3s;line-height:1.6;position:relative;overflow-x:hidden}.container{max-width:600px;margin:0 auto;padding:20px;transition:max-width 0.3s ease-in-out}.app-header{text-align:center;margin-bottom:20px;position:relative}.app-subtitle{font-size:0.9rem;margin:0;padding-top:2px;font-style:italic;color:var(--text-color);opacity:0.8}.app-header::after{content:'';position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);width:80%;height:2px;background:linear-gradient(90deg,transparent,var(--accent-color),transparent)}.card{background-color:var(--card-bg);border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.1);padding:20px;margin-bottom:20px;border:1px solid var(--border-color);position:relative;overflow:hidden}.card::before{content:'';position:absolute;top:0;left:0;width:100%;height:3px;background:linear-gradient(90deg,#33aaff,#0066cc)}.tabs{display:flex;justify-content:center;margin-bottom:20px;border-bottom:1px solid var(--border-color);overflow-x:auto}.tab-btn{background:none;border:none;padding:10px 20px;font-size:1rem;cursor:pointer;color:var(--text-color);border-bottom:2px solid transparent;transition:all 0.3s;position:relative;overflow:hidden;white-space:nowrap}.tab-btn.active{border-bottom:2px solid var(--accent-color);color:var(--accent-color)}.tab-btn::after{content:'';position:absolute;bottom:0;left:0;width:0;height:2px;background-color:var(--accent-color);transition:width 0.3s}.tab-btn:hover::after{width:100%}.tab-content{display:none !important}.tab-content.active{display:block !important}.form-group{margin-bottom:15px}label{display:block;margin-bottom:5px;font-weight:500}input,textarea,select{width:100%;padding:12px;border:1px solid var(--border-color);border-radius:8px;background-color:var(--input-bg);color:var(--text-color);font-size:1rem;box-sizing:border-box;transition:border-color 0.3s,box-shadow 0.3s}input:focus,textarea:focus,select:focus{outline:none;border-color:var(--accent-color);box-shadow:0 0 0 2px var(--cyber-glow)}#encryptedOutput,#decryptedOutput{min-height:120px;background-color:var(--output-bg);color:var(--output-text);border-width:1px;border-style:solid;border-color:var(--border-color);font-family:'Consolas','Courier New',monospace;width:100%;resize:vertical;padding:15px;overflow-y:auto}.form-group:has(#encryptedOutput),.form-group:has(#decryptedOutput){width:100%}#encrypt .form-group:nth-of-type(3),#decrypt .form-group:nth-of-type(3){width:100%}textarea{min-height:100px;resize:vertical}button{background-color:var(--button-bg);color:var(--button-text);border:none;border-radius:8px;padding:12px 20px;font-size:1rem;cursor:pointer;transition:background-color 0.3s,transform 0.1s;position:relative;overflow:hidden}button:hover{background-color:var(--button-hover)}button:active{transform:scale(0.98)}button::after{display:none}.btn-group{display:flex;gap:10px;margin-top:15px}.btn-secondary{background-color:transparent;border:1px solid var(--accent-color);color:var(--accent-color)}.btn-secondary:hover{background-color:rgba(0,0,0,0.05)}.status{padding:10px;border-radius:8px;margin-top:15px;display:none}.status.success{background-color:rgba(0,204,102,0.1);color:var(--success-color);border:1px solid var(--success-color);display:block}.status.warning{background-color:rgba(240,173,78,0.1);color:var(--warning-color);border:1px solid var(--warning-color);display:block}.status.error{background-color:rgba(204,51,0,0.1);color:var(--error-color);border:1px solid var(--error-color);display:block}.keys-container{display:flex;flex-direction:column;gap:20px}.keys-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:15px;width:100%}.key-form{display:flex;flex-direction:column;gap:15px}.key-item{background-color:var(--input-bg);border:1px solid var(--border-color);border-radius:8px;padding:15px;display:flex;flex-direction:column;height:100%}.key-item-content{flex:1;display:flex;flex-direction:column}.key-item h3{margin-top:0;margin-bottom:10px}.key-header{text-align:center;margin-bottom:15px}.key-actions{display:flex;flex-wrap:wrap;justify-content:center;gap:8px;margin-top:auto;padding-top:15px;border-top:1px solid var(--border-color)}.key-actions button{flex:1 1 auto;min-width:80px;padding:8px 12px;font-size:0.9rem}.key-meta{font-size:0.9rem;color:#888;margin-bottom:5px}.key-management-buttons{display:flex;flex-wrap:wrap;gap:10px;margin-top:20px}.key-management-buttons button{flex:1 1 auto;min-width:100px}.btn-zero{background-color:#cc3300;color:white;margin-top:20px;width:100%;font-weight:bold;border:1px solid #aa2200}.btn-zero:hover{background-color:#ff3300}.loading-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);display:flex;justify-content:center;align-items:center;z-index:1000;display:none}.spinner{width:50px;height:50px;border:5px solid rgba(255,255,255,0.3);border-radius:50%;border-top-color:var(--accent-color);animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.password-strength{height:5px;border-radius:5px;margin-top:5px;transition:all 0.3s}.password-strength.weak{background-color:var(--security-low);width:30%}.password-strength.medium{background-color:var(--security-medium);width:60%}.password-strength.strong{background-color:var(--security-high);width:100%}.password-feedback{font-size:0.8rem;margin-top:5px;color:var(--text-color);opacity:0.9}.security-badge{display:inline-flex;align-items:center;padding:2px 8px;border-radius:12px;font-size:0.8rem;margin-left:8px;font-weight:bold}.security-badge.high{background-color:rgba(0,204,102,0.1);color:var(--security-high);border:1px solid var(--security-high)}.security-badge.medium{background-color:rgba(240,173,78,0.1);color:var(--security-medium);border:1px solid var(--security-medium)}.security-badge.low{background-color:rgba(204,51,0,0.1);color:var(--security-low);border:1px solid var(--security-low)}.key-pair-badge{display:inline-flex;align-items:center;padding:2px 8px;border-radius:12px;font-size:0.8rem;font-weight:bold;margin-top:5px}.key-pair-badge.full{background-color:rgba(0,204,102,0.1);color:var(--security-high);border:1px solid var(--security-high)}.key-pair-badge.private{background-color:rgba(204,51,0,0.1);color:var(--security-low);border:1px solid var(--security-low)}.key-pair-badge.public{background-color:rgba(240,173,78,0.1);color:var(--security-medium);border:1px solid var(--security-medium)}.private-key-btn{border:1px solid var(--error-color) !important;color:var(--error-color) !important}.private-key-btn:hover{background-color:rgba(204,51,0,0.1) !important}.config-toggle{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.config-toggle label{display:inline;margin-bottom:0}.switch{position:relative;display:inline-block;width:50px;height:24px}.switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s;border-radius:24px}.slider:before{position:absolute;content:"";height:16px;width:16px;left:4px;bottom:4px;background-color:white;transition:.4s;border-radius:50%}input:checked+.slider{background-color:var(--accent-color)}input:focus+.slider{box-shadow:0 0 1px var(--accent-color)}input:checked+.slider:before{transform:translateX(26px)}.security-info{font-size:0.9rem;padding:10px;border-left:3px solid var(--accent-color);background-color:rgba(0,0,0,0.03);margin-bottom:15px}body.dark-mode .security-info{background-color:rgba(57,255,20,0.05);border-left-color:var(--accent-color);color:var(--text-color)}.key-expiry{font-size:0.8rem;color:var(--warning-color);margin-top:5px;font-style:italic}#inactivityModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.8);z-index:1001;justify-content:center;align-items:center}.modal-content{background-color:var(--card-bg);padding:20px;border-radius:12px;max-width:400px;text-align:center;box-shadow:0 5px 15px rgba(0,0,0,0.3);width:90%;position:relative}.timer{font-size:2rem;margin:20px 0;color:var(--warning-color)}#settings{display:none}.settings-section{margin-bottom:20px}.settings-section h3{margin-top:0;border-bottom:1px solid var(--border-color);padding-bottom:5px}.file-info{margin-top:10px;font-size:0.9rem;background-color:var(--input-bg);padding:8px;border-radius:4px;display:flex;align-items:center;justify-content:space-between}.file-info-name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.file-icon{margin-right:8px;font-size:1.2rem}.remove-file{cursor:pointer;color:var(--error-color);padding:2px 6px;border-radius:4px;margin-left:8px}.remove-file:hover{background-color:rgba(204,51,0,0.1)}body.dark-mode .remove-file:hover{background-color:rgba(255,49,49,0.2)}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);z-index:1001;justify-content:center;align-items:center}.btn-primary{background-color:var(--accent-color);color:var(--button-text);border:none;border-radius:8px;padding:12px 20px;font-size:1rem;cursor:pointer;transition:background-color 0.3s,transform 0.1s}.btn-primary:hover{background-color:var(--button-hover)}@media (max-width:600px){.container{padding:15px}.card{padding:15px}.app-title{font-size:1.5rem}.btn-group{flex-direction:column}.btn-group button{width:100%}.key-actions button{width:100%;margin-bottom:5px}.tab-btn{padding:10px 10px;font-size:0.9rem}.key-actions{flex-direction:column}}@media (max-width:767px){.keys-container{flex-direction:column}.key-form,.keys-list-container{width:100%}}@media (min-width:768px){.container{max-width:750px}.app-title{font-size:2rem}.card{padding:25px}#encryptedOutput,#decryptedOutput{min-height:150px;font-size:1.05rem}.keys-container{flex-direction:row;align-items:flex-start}.key-form{width:40%;position:sticky;top:20px}.keys-list-container{width:60%}.key-item h3{font-size:1.1rem;margin-top:0;margin-bottom:10px;word-break:break-word}}@media (min-width:1024px){.container{max-width:900px}#encryptedOutput,#decryptedOutput{min-height:180px;font-size:1.1rem;padding:18px}#keys .card{display:flex;flex-wrap:wrap;gap:20px}#keys .card>h2,#keys .card>.security-info{width:100%}#keys .card>.form-group,#keys .card>button#generateKeyBtn{width:calc(40% - 10px)}#keys .card>div:has(#keysList){width:calc(60% - 10px);margin-top:0}#keys .card>div:nth-last-child(3){width:calc(60% - 10px);margin-top:0}#keys .card>.btn-group,#keys .card>div:has(#zeroKeysBtn){width:100%}#encrypt .card,#decrypt .card{display:grid;grid-template-columns:1fr 1fr;gap:20px}#encrypt .card>.form-group:first-child,#decrypt .card>.form-group:first-child,#encrypt .card>.form-group:has(#encryptedOutput),#decrypt .card>.form-group:has(#decryptedOutput),#encrypt .card>.form-group:nth-child(3),#decrypt .card>.form-group:nth-child(3){grid-column:1 / span 2}#encrypt .card>button,#decrypt .card>button{grid-column:1 / span 2}#encrypt .card>.btn-group,#decrypt .card>.btn-group{grid-column:1 / span 2}#encrypt .card>#encryptStatus,#decrypt .card>#decryptStatus{grid-column:1 / span 2}}@media (min-width:1200px){.container{max-width:1140px}.keys-grid{grid-template-columns:repeat(auto-fill,minmax(320px,1fr))}}@media (min-width:1440px){.container{max-width:1200px}#encryptedOutput,#decryptedOutput{min-height:220px;font-size:1.15rem;padding:20px}#settings .card{display:grid;grid-template-columns:1fr 1fr;gap:30px}#settings .card>h2{grid-column:1 / span 2}#settings .card>.btn-group{grid-column:1 / span 2;justify-content:center}#settings .card>#settingsStatus{grid-column:1 / span 2}#keysList{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:15px}@media (min-width:1800px){#encrypt .card,#decrypt .card{grid-template-columns:1fr 1fr 1fr}#encrypt .card>.form-group:first-child,#decrypt .card>.form-group:first-child,#encrypt .card>.form-group:has(#encryptedOutput),#decrypt .card>.form-group:has(#decryptedOutput),#encrypt .card>.form-group:nth-child(3),#decrypt .card>.form-group:nth-child(3),#encrypt .card>button,#decrypt .card>button,#encrypt .card>.btn-group,#decrypt .card>.btn-group,#encrypt .card>#encryptStatus,#decrypt .card>#decryptStatus{grid-column:1 / span 3}}}@media (min-width:601px){.btn-group{flex-direction:row}.btn-group button{flex:1}}@media print{body{background-color:white;color:black}body.dark-mode{--bg-color:#ffffff;--text-color:#000000;--card-bg:#ffffff;--border-color:#dddddd;--input-bg:#ffffff;--output-bg:#f8f8f8;--output-text:#222222}body.dark-mode .app-title{background:none;color:#000000;text-shadow:none}body.dark-mode .tab-btn.active{color:#000000;background:none}body.dark-mode .security-info{background-color:#f0f0f0;border-left-color:#ccc;color:#000}.card{box-shadow:none;border:1px solid #ddd}.btn-group,button,.tabs,.app-subtitle,.key-actions,.key-management-buttons,.config-toggle,#installContainer,.remove-file{display:none !important}.container{max-width:100%;padding:0}#encryptedOutput,#decryptedOutput{border:1px solid #ddd;background-color:white;color:black;min-height:auto}.key-item{page-break-inside:avoid}.keys-grid{grid-template-columns:1fr !important}}</style></head><body><div class="container"><div class="app-header"><h1 class="app-title">LC5</h1><div class="app-subtitle">by elkmire</div><p>Secure MSG.FILE option</p></div><div class="tabs"><button class="tab-btn active" data-tab="encrypt">Encrypt</button><button class="tab-btn" data-tab="decrypt">Decrypt</button><button class="tab-btn" data-tab="keys">Key Management</button><button class="tab-btn" data-tab="settings">Settings</button></div><div class="tab-content active" id="encrypt"><div class="card"><div class="form-group"><label for="encryptMessage">To Encrypt</label><textarea id="encryptMessage" placeholder="Free-type here or load file for encryption..."></textarea><div style="display: flex; gap: 10px; margin-top: 5px;"><button id="encryptBrowseBtn" class="btn-secondary">Browse Files</button><button id="clearEncryptMessageBtn" class="btn-secondary">Clear</button><input type="file" id="encryptFileInput" style="display: none;"></div><div id="encryptFileInfo" style="display: none;" class="file-info"><span><span class="file-icon">ðŸ“„</span><span id="encryptFileName" class="file-info-name"></span></span><span class="remove-file" id="removeEncryptFile">Ã—</span></div></div><div class="form-group"><label for="encryptionKey">Encryption Key</label><select id="encryptionKey"><option value="">Select a key...</option></select></div><div class="form-group"><label for="encryptObfKey">OBF Key</label><input type="text" id="encryptObfKey" placeholder="Optional*"></div><div class="form-group" id="encryptionPasswordGroup" style="display: none;"><label for="encryptionPassword">Key Password</label><input type="password" id="encryptionPassword" placeholder="Enter key password"></div><button id="encryptBtn">Encrypt Data</button><div class="form-group" style="margin-top: 20px;"><label for="encryptedOutput">Encrypted Data</label><textarea id="encryptedOutput" readonly></textarea></div><div class="btn-group"><button id="downloadEncryptedBtn" class="btn-secondary">Download Encrypted File</button><button id="copyEncryptedBtn" class="btn-secondary">Copy to Clipboard</button><button id="clearEncryptBtn" class="btn-secondary">Clear All</button></div><div id="encryptStatus" class="status"></div></div></div><div class="tab-content" id="decrypt"><div class="card"><div class="form-group"><label for="encryptedMessage">To Decrypt</label><textarea id="encryptedMessage" placeholder="Paste the encrypted data here or load encrypted data..."></textarea><div style="display: flex; gap: 10px; margin-top: 5px;"><button id="decryptBrowseBtn" class="btn-secondary">Browse Files</button><button id="clearEncryptedMessageBtn" class="btn-secondary">Clear</button><input type="file" id="decryptFileInput" style="display: none;"></div><div id="decryptFileInfo" style="display: none;" class="file-info"><span><span class="file-icon">ðŸ“„</span><span id="decryptFileName" class="file-info-name"></span></span><span class="remove-file" id="removeDecryptFile">Ã—</span></div></div><div class="form-group"><label for="decryptionKey">Decryption Key</label><select id="decryptionKey"><option value="">Select a key...</option></select></div><div class="form-group"><label for="decryptObfKey">OBF Key</label><input type="text" id="decryptObfKey" placeholder="Optional*"></div><div class="form-group" id="decryptionPasswordGroup" style="display: none;"><label for="decryptionPassword">Key Password</label><input type="password" id="decryptionPassword" placeholder="Enter key password"></div><button id="decryptBtn">Decrypt Data</button><div class="form-group" style="margin-top: 20px;"><label for="decryptedOutput">Decrypted Data</label><textarea id="decryptedOutput" readonly></textarea></div><div class="btn-group"><button id="downloadDecryptedBtn" class="btn-secondary">Download Decrypted File</button><button id="copyDecryptedBtn" class="btn-secondary">Copy to Clipboard</button><button id="clearDecryptBtn" class="btn-secondary">Clear All</button></div><div id="decryptStatus" class="status"></div></div></div><div class="tab-content" id="keys"><div class="card"><h2>Key Management</h2><div class="security-info"><strong>Security Note:</strong> All keys are stored locally in your browser's protected storage and never sent to any server.</div><div class="keys-container"><div class="key-form"><div class="form-group"><label for="keyName">Key Name</label><input type="text" id="keyName" placeholder="e.g., enter crypto name"></div><div class="form-group"><label for="keyType">Key Type</label><select id="keyType"><option value="aes">AES-GCM (Symmetric) - 256 bits</option><option value="rsa">RSA-OAEP (Asymmetric) - 2048 bits</option><option value="rsa-4096">RSA-OAEP (Asymmetric) - 4096 bits</option><option value="ecc">ECC (Asymmetric) - P-256</option><option value="ecc-p384">ECC (Asymmetric) - P-384</option></select></div><div class="form-group"><label for="keyExpiry">Key Expiration (Optional)</label><select id="keyExpiry"><option value="">Never (Not Recommended)</option><option value="30">30 Days</option><option value="90">90 Days</option><option value="180">180 Days</option><option value="365">1 Year</option></select></div><div class="form-group" id="keyPasswordGroup"><label for="keyPassword">Key Password (Recommended)</label><input type="password" id="keyPassword" placeholder="Enter optional password"><div id="passwordStrength" class="password-strength"></div><div id="passwordFeedback" class="password-feedback"></div></div><div class="form-group" id="confirmKeyPasswordGroup"><label for="confirmKeyPassword">Confirm Password</label><input type="password" id="confirmKeyPassword" placeholder="Confirm your password"></div><button id="generateKeyBtn">Generate New Key</button><div class="key-management-buttons"><button id="importKeyBtn" class="btn-secondary">Import Key</button><button id="exportAllKeysBtn" class="btn-secondary">Export State</button><button id="importStateBtn" class="btn-secondary">Import State</button></div><div style="text-align: center; margin-top: 20px;"><button id="zeroKeysBtn" class="btn-zero">ZERO ALL KEYS</button></div><div id="keyStatus" class="status"></div></div><div class="keys-list-container"><h3>Your Keys</h3><div id="keysList" class="keys-grid"></div></div></div></div></div><div class="tab-content" id="settings"><div class="card"><h2>Security Settings</h2><p> (Must SAVE for changes to take effect) <p><div class="settings-section"><h3>Storage Options</h3><div class="config-toggle"><label for="useIndexedDB">Use IndexedDB for key storage (more secure)</label><label class="switch"><input type="checkbox" id="useIndexedDB" checked><span class="slider"></span></label></div><div class="config-toggle"><label for="sessionOnly">Session-only mode (keys aren't saved when browser closes)</label><label class="switch"><input type="checkbox" id="sessionOnly"><span class="slider"></span></label></div></div><div class="settings-section"><h3>Security Parameters</h3><div class="config-toggle"><label for="enforcePwdProtection">Enforce password protection for keys</label><label class="switch"><input type="checkbox" id="enforcePwdProtection"><span class="slider"></span></label></div><div class="config-toggle"><label for="enforceKeyExpiry">Enforce key expiration</label><label class="switch"><input type="checkbox" id="enforceKeyExpiry"><span class="slider"></span></label></div><div class="form-group"><label for="pbkdf2Iterations">PBKDF2 Iterations (higher = more secure but slower)</label><select id="pbkdf2Iterations"><option value="100000">100,000 (Default)</option><option value="200000">200,000</option><option value="300000">300,000</option><option value="500000">500,000</option></select></div></div><div class="settings-section"><h3>Appearance</h3><div class="config-toggle"><label for="darkMode">Dark Mode</label><label class="switch"><input type="checkbox" id="darkMode"><span class="slider"></span></label></div></div><div class="settings-section"><h3>Install App</h3><p>Installs PWA (must be Chromium-based browser or Safari for IOS)</p><div id="installContainer"><button id="installBtn" class="btn-secondary">Install Lemonade App</button><p class="install-note" style="margin-top: 8px; font-size: 0.85rem; color: #888;">(Button will be enabled when installation is available)</p></div><div id="installStatus" class="status"></div></div><div class="btn-group"><button id="saveSettingsBtn">Save Settings</button><button id="resetSettingsBtn" class="btn-secondary">Reset to Defaults</button></div><div id="settingsStatus" class="status"></div></div></div></div><div class="loading-overlay" id="loadingOverlay"><div class="spinner"></div></div><script>
   const _0x558412=_0xb415;(function(_0x52c5f6,_0x3f2c5c){const _0x437bcc=_0xb415,_0x259e28=_0x52c5f6();while(!![]){try{const _0x541261=-parseInt(_0x437bcc(0x13d))/0x1*(-parseInt(_0x437bcc(0x169))/0x2)+-parseInt(_0x437bcc(0x219))/0x3+-parseInt(_0x437bcc(0x208))/0x4+parseInt(_0x437bcc(0x1cd))/0x5*(-parseInt(_0x437bcc(0x15a))/0x6)+parseInt(_0x437bcc(0x256))/0x7+parseInt(_0x437bcc(0xc8))/0x8*(-parseInt(_0x437bcc(0x24d))/0x9)+parseInt(_0x437bcc(0xe3))/0xa*(parseInt(_0x437bcc(0x242))/0xb);if(_0x541261===_0x3f2c5c)break;else _0x259e28['push'](_0x259e28['shift']());}catch(_0x43386a){_0x259e28['push'](_0x259e28['shift']());}}}(_0x5390,0x1fffe));const PBKDF2_CONFIG={'ITERATIONS':0x186a0,'HASH':'SHA-256'},AES_CONFIG={'KEY_LENGTH':0x100,'MODE':'AES-GCM','IV_LENGTH':0xc,'TAG_LENGTH':0x80},RSA_CONFIG={'KEY_SIZE':0x800,'KEY_SIZE_4096':0x1000,'ALGORITHM':_0x558412(0x177),'HASH':_0x558412(0x154)},ECC_CONFIG={'CURVE':_0x558412(0x1a7),'CURVE_P384':_0x558412(0x22a),'ALGORITHM':_0x558412(0xec),'KEY_DERIVATION':_0x558412(0xdb),'KDF_HASH':_0x558412(0x154),'ENC_ALGORITHM':_0x558412(0x108)},SECURE_DELIMITER=_0x558412(0x1dc),DB_NAME=_0x558412(0x120),DB_VERSION=0x1,KEYS_STORE=_0x558412(0x1a5),SETTINGS_STORE=_0x558412(0x1fd),DEFAULT_SETTINGS={'useIndexedDB':!![],'sessionOnly':![],'enforcePwdProtection':![],'enforceKeyExpiry':![],'pbkdf2Iterations':0x186a0};let db=null,keys=[],appSettings={...DEFAULT_SETTINGS};const tabBtns=document[_0x558412(0x1d2)](_0x558412(0x8f)),tabContents=document[_0x558412(0x1d2)]('.tab-content'),encryptionKeySelect=document['getElementById'](_0x558412(0x1c1)),decryptionKeySelect=document['getElementById'](_0x558412(0x213)),keysList=document[_0x558412(0x16b)](_0x558412(0x185)),loadingOverlay=document[_0x558412(0x16b)](_0x558412(0x237)),inactivityModal=document[_0x558412(0x16b)](_0x558412(0x188)),timeoutTimer=document[_0x558412(0x16b)](_0x558412(0x22b)),safeMemory={'sensitiveData':new WeakMap(),'store':function(_0x2dc98c){const _0x2fabd6=_0x558412,_0x6813c3={'id':crypto['randomUUID']()};return this[_0x2fabd6(0xc3)]['set'](_0x6813c3,_0x2dc98c),_0x6813c3;},'retrieve':function(_0x11336c,_0x1d334e=![]){const _0x26a939=_0x558412;if(!this[_0x26a939(0xc3)]['has'](_0x11336c))return null;const _0x5898a1=this[_0x26a939(0xc3)][_0x26a939(0x1da)](_0x11336c);return _0x1d334e&&this[_0x26a939(0xc3)][_0x26a939(0x230)](_0x11336c),_0x5898a1;},'delete':function(_0x10fc55){const _0x1bc92b=_0x558412;if(this[_0x1bc92b(0xc3)][_0x1bc92b(0x19e)](_0x10fc55))return this[_0x1bc92b(0xc3)][_0x1bc92b(0x230)](_0x10fc55),!![];return![];},'clearAll':function(){const _0x322637=_0x558412;this[_0x322637(0xc3)]=new WeakMap();if(typeof window['gc']===_0x322637(0x17a))try{window['gc']();}catch(_0x4fa89e){console[_0x322637(0x184)](_0x322637(0xce));}}},validator={'sanitizeHTML':function(_0x392647){const _0x1dd189=_0x558412,_0x34a0a0=document[_0x1dd189(0x19d)](_0x1dd189(0x1d4));return _0x34a0a0[_0x1dd189(0xe9)]=_0x392647,_0x34a0a0[_0x1dd189(0x193)];},'validateInput':function(_0x4a5d8b,_0x1efba9=![]){const _0x283e45=_0x558412;if(_0x4a5d8b===null||_0x4a5d8b===undefined)return'';const _0x3bcc8e=String(_0x4a5d8b);return _0x1efba9?_0x3bcc8e:this[_0x283e45(0x204)](_0x3bcc8e);},'isValidKeyName':function(_0x2c88d8){const _0x1237d3=_0x558412;return/^[A-Za-z0-9 ._-]{1,50}$/[_0x1237d3(0x12c)](_0x2c88d8);},'isValidEncryptedMessage':function(_0x44f696){const _0x33ec54=_0x558412;return/^--LM--\s*[A-Za-z0-9+/=]+\s*--EM--$/s[_0x33ec54(0x12c)](_0x44f696);},'measurePasswordStrength':function(_0x4d4500){const _0x5b1d06=_0x558412;let _0x17c1a3=0x0;if(!_0x4d4500)return{'score':0x0,'feedback':_0x5b1d06(0x180)};const _0x17e0ac=_0x4d4500['length'];_0x17c1a3+=Math[_0x5b1d06(0x110)](0x5,Math[_0x5b1d06(0x1fa)](_0x17e0ac/0x4));if(/[a-z]/['test'](_0x4d4500))_0x17c1a3+=0x1;if(/[A-Z]/[_0x5b1d06(0x12c)](_0x4d4500))_0x17c1a3+=0x1;if(/[0-9]/[_0x5b1d06(0x12c)](_0x4d4500))_0x17c1a3+=0x1;if(/[^A-Za-z0-9]/[_0x5b1d06(0x12c)](_0x4d4500))_0x17c1a3+=0x2;if(/^[a-zA-Z]+$/['test'](_0x4d4500))_0x17c1a3-=0x1;if(/^[0-9]+$/['test'](_0x4d4500))_0x17c1a3-=0x1;if(/(.)\1{2,}/[_0x5b1d06(0x12c)](_0x4d4500))_0x17c1a3-=0x1;let _0x10a190,_0xb1d1c3;if(_0x17c1a3<0x4)_0x10a190='weak',_0xb1d1c3='Weak\x20-\x20Use\x20a\x20longer\x20password\x20with\x20numbers\x20and\x20special\x20characters';else _0x17c1a3<0x8?(_0x10a190=_0x5b1d06(0xcc),_0xb1d1c3=_0x5b1d06(0x132)):(_0x10a190='strong',_0xb1d1c3=_0x5b1d06(0x196));return{'score':_0x17c1a3,'strengthCategory':_0x10a190,'feedback':_0xb1d1c3};}},escapeRegex=_0x1211c3=>{const _0x171c37=_0x558412;if(typeof _0x1211c3!==_0x171c37(0xeb))return'';return _0x1211c3['replace'](/[.*+?^${}()|[\]\\]/g,_0x171c37(0x187));};document[_0x558412(0x214)]('DOMContentLoaded',async()=>{const _0x1461ac=_0x558412;document[_0x1461ac(0x1d2)](_0x1461ac(0x8f))[_0x1461ac(0x227)](_0x1fcab0=>{const _0x4b635d=_0x1461ac;_0x1fcab0[_0x4b635d(0x214)](_0x4b635d(0x8e),_0x58116e=>{const _0x17fb3a=_0x4b635d;_0x58116e[_0x17fb3a(0x101)]();const _0x5cac32=_0x1fcab0[_0x17fb3a(0x245)](_0x17fb3a(0x1e6));console[_0x17fb3a(0x184)](_0x17fb3a(0x209),_0x5cac32),switchTab(_0x5cac32);});}),document[_0x1461ac(0x16b)](_0x1461ac(0xdf))[_0x1461ac(0x214)](_0x1461ac(0x1a1),toggleDarkMode);const _0x505bf0=localStorage[_0x1461ac(0xf5)](_0x1461ac(0x14c));_0x505bf0===_0x1461ac(0x1b5)&&(document[_0x1461ac(0x16b)](_0x1461ac(0xdf))[_0x1461ac(0xba)]=!![],document[_0x1461ac(0x134)][_0x1461ac(0xea)]['add']('dark-mode')),document['getElementById']('clearEncryptMessageBtn')[_0x1461ac(0x214)](_0x1461ac(0x8e),()=>{clearEncryptFile();}),document[_0x1461ac(0x16b)](_0x1461ac(0x210))[_0x1461ac(0x214)]('click',()=>{clearDecryptFile();}),await initDatabase(),await loadSettings(),initSettingsUI(),await loadKeys(),document['getElementById'](_0x1461ac(0xf4))['addEventListener'](_0x1461ac(0x172),updatePasswordStrength),document[_0x1461ac(0x16b)](_0x1461ac(0x1ae))[_0x1461ac(0x214)](_0x1461ac(0x8e),encryptMessage),document['getElementById']('decryptBtn')[_0x1461ac(0x214)](_0x1461ac(0x8e),decryptMessage),document['getElementById']('generateKeyBtn')['addEventListener'](_0x1461ac(0x8e),generateKey),document['getElementById']('copyEncryptedBtn')[_0x1461ac(0x214)](_0x1461ac(0x8e),()=>copyToClipboard(_0x1461ac(0xff),_0x1461ac(0x24c))),document[_0x1461ac(0x16b)](_0x1461ac(0x14d))[_0x1461ac(0x214)](_0x1461ac(0x8e),()=>copyToClipboard(_0x1461ac(0x1a9),'decryptStatus')),document[_0x1461ac(0x16b)](_0x1461ac(0x152))[_0x1461ac(0x214)]('click',()=>{const _0x5b4a2e=_0x1461ac;document[_0x5b4a2e(0x16b)]('encryptMessage')[_0x5b4a2e(0x1f4)]='',document['getElementById']('encryptedOutput')['value']='',document['getElementById'](_0x5b4a2e(0x24c))[_0x5b4a2e(0x222)]=_0x5b4a2e(0x1b8),document[_0x5b4a2e(0x16b)](_0x5b4a2e(0x24c))[_0x5b4a2e(0xe9)]='',clearEncryptFile();}),document[_0x1461ac(0x16b)](_0x1461ac(0x1c8))['addEventListener']('click',()=>{const _0x3138c5=_0x1461ac;document[_0x3138c5(0x16b)](_0x3138c5(0x17e))[_0x3138c5(0x1f4)]='',document[_0x3138c5(0x16b)]('decryptedOutput')[_0x3138c5(0x1f4)]='',document[_0x3138c5(0x16b)](_0x3138c5(0xe4))[_0x3138c5(0x222)]=_0x3138c5(0x1b8),document[_0x3138c5(0x16b)](_0x3138c5(0xe4))[_0x3138c5(0xe9)]='',clearDecryptFile(),window[_0x3138c5(0x19f)]=null;}),document[_0x1461ac(0x16b)](_0x1461ac(0x190))['addEventListener'](_0x1461ac(0x8e),importKey),document[_0x1461ac(0x16b)](_0x1461ac(0x1e5))['addEventListener']('click',exportAllKeys),document[_0x1461ac(0x16b)](_0x1461ac(0x13a))[_0x1461ac(0x214)](_0x1461ac(0x8e),importState),document[_0x1461ac(0x16b)](_0x1461ac(0x16c))[_0x1461ac(0x214)](_0x1461ac(0x8e),saveSettings),document['getElementById'](_0x1461ac(0x1ba))['addEventListener'](_0x1461ac(0x8e),resetSettings),document[_0x1461ac(0x16b)](_0x1461ac(0x137))['addEventListener'](_0x1461ac(0x8e),zeroAllKeys),encryptionKeySelect[_0x1461ac(0x214)](_0x1461ac(0x1a1),handleEncryptionKeyChange),decryptionKeySelect['addEventListener']('change',handleDecryptionKeyChange);});async function initDatabase(){const _0x489786=_0x558412;if(!window['indexedDB']){showStatus(_0x489786(0x25f),'Your\x20browser\x20doesn\x27t\x20support\x20secure\x20storage.\x20Using\x20less\x20secure\x20localStorage\x20instead.',_0x489786(0x220)),appSettings['useIndexedDB']=![];return;}return new Promise((_0x2b6023,_0x554559)=>{const _0x12f9b0=_0x489786,_0x8da0f2=indexedDB[_0x12f9b0(0x9b)](DB_NAME,DB_VERSION);_0x8da0f2['onupgradeneeded']=function(_0x4054e6){const _0x19df2c=_0x12f9b0,_0x8d795a=_0x4054e6[_0x19df2c(0x1b1)][_0x19df2c(0x157)];!_0x8d795a[_0x19df2c(0x25a)][_0x19df2c(0x21f)](KEYS_STORE)&&_0x8d795a[_0x19df2c(0x240)](KEYS_STORE,{'keyPath':'id'}),!_0x8d795a[_0x19df2c(0x25a)]['contains'](SETTINGS_STORE)&&_0x8d795a[_0x19df2c(0x240)](SETTINGS_STORE,{'keyPath':'id'});},_0x8da0f2[_0x12f9b0(0x255)]=function(_0x3eff4b){const _0x1a1243=_0x12f9b0;db=_0x3eff4b[_0x1a1243(0x1b1)]['result'],console[_0x1a1243(0x184)](_0x1a1243(0x14b)),_0x2b6023();},_0x8da0f2[_0x12f9b0(0x217)]=function(_0x353e93){const _0x2eea7c=_0x12f9b0;console[_0x2eea7c(0x182)](_0x2eea7c(0x1dd),_0x353e93['target'][_0x2eea7c(0x182)]),showStatus(_0x2eea7c(0x25f),_0x2eea7c(0x211),'warning'),appSettings['useIndexedDB']=![],_0x2b6023();};});}function switchTab(_0xfea4b3){const _0x84354d=_0x558412;console[_0x84354d(0x184)](_0x84354d(0x16a),_0xfea4b3),tabBtns[_0x84354d(0x227)](_0x5d4d59=>{const _0x10a333=_0x84354d;_0x5d4d59[_0x10a333(0x245)](_0x10a333(0x1e6))===_0xfea4b3?_0x5d4d59[_0x10a333(0xea)][_0x10a333(0x179)](_0x10a333(0x1ea)):_0x5d4d59[_0x10a333(0xea)]['remove'](_0x10a333(0x1ea));}),document[_0x84354d(0x16b)](_0x84354d(0x1d7))[_0x84354d(0x1f4)]='',document['getElementById'](_0x84354d(0xff))['value']='',document[_0x84354d(0x16b)](_0x84354d(0x24c))['className']='status',document['getElementById'](_0x84354d(0x24c))['textContent']='',document['getElementById'](_0x84354d(0x1c1))[_0x84354d(0x1f4)]='',document['getElementById']('encryptionPassword')[_0x84354d(0x1f4)]='',document[_0x84354d(0x16b)](_0x84354d(0xf8))[_0x84354d(0x1ca)][_0x84354d(0x236)]=_0x84354d(0xa0),clearEncryptFile(),document[_0x84354d(0x16b)](_0x84354d(0x17e))[_0x84354d(0x1f4)]='',document[_0x84354d(0x16b)]('decryptedOutput')[_0x84354d(0x1f4)]='',document[_0x84354d(0x16b)](_0x84354d(0xe4))[_0x84354d(0x222)]=_0x84354d(0x1b8),document[_0x84354d(0x16b)](_0x84354d(0xe4))[_0x84354d(0xe9)]='',document['getElementById'](_0x84354d(0x213))['value']='',document['getElementById']('decryptionPassword')[_0x84354d(0x1f4)]='',document[_0x84354d(0x16b)](_0x84354d(0x11d))['style']['display']=_0x84354d(0xa0),clearDecryptFile(),window[_0x84354d(0x19f)]=null,document[_0x84354d(0x16b)]('encrypt')[_0x84354d(0xea)]['remove'](_0x84354d(0x1ea)),document[_0x84354d(0x16b)](_0x84354d(0x125))[_0x84354d(0xea)][_0x84354d(0xf2)](_0x84354d(0x1ea)),document['getElementById'](_0x84354d(0x1a5))['classList'][_0x84354d(0xf2)](_0x84354d(0x1ea)),document['getElementById'](_0x84354d(0x1fd))[_0x84354d(0xea)][_0x84354d(0xf2)](_0x84354d(0x1ea)),document[_0x84354d(0x16b)](_0xfea4b3)[_0x84354d(0xea)][_0x84354d(0x179)]('active');}function setLoading(_0x39c18f){const _0x566e9d=_0x558412;loadingOverlay[_0x566e9d(0x1ca)][_0x566e9d(0x236)]=_0x39c18f?'flex':_0x566e9d(0xa0);}async function loadSettings(){const _0x25b5d7=_0x558412;if(appSettings['useIndexedDB']&&db)try{const _0x3905f2=await getFromDatabase(SETTINGS_STORE,_0x25b5d7(0x21c));_0x3905f2&&(appSettings={...DEFAULT_SETTINGS,..._0x3905f2});}catch(_0x4d4f06){console[_0x25b5d7(0x182)](_0x25b5d7(0xcf),_0x4d4f06);try{const _0x27dfe9=localStorage['getItem'](_0x25b5d7(0x23c));_0x27dfe9&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x25b5d7(0xfa)](_0x27dfe9)});}catch(_0x356367){console['error']('Error\x20loading\x20settings\x20from\x20localStorage:',_0x356367);}}else try{const _0x1578a0=localStorage[_0x25b5d7(0xf5)](_0x25b5d7(0x23c));_0x1578a0&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x25b5d7(0xfa)](_0x1578a0)});}catch(_0x512934){console[_0x25b5d7(0x182)](_0x25b5d7(0xc1),_0x512934);}return PBKDF2_CONFIG[_0x25b5d7(0xa7)]=appSettings[_0x25b5d7(0x1f0)],appSettings;}function initSettingsUI(){const _0x24a0ce=_0x558412;document[_0x24a0ce(0x16b)](_0x24a0ce(0x122))[_0x24a0ce(0xba)]=appSettings['useIndexedDB'],document['getElementById'](_0x24a0ce(0x163))[_0x24a0ce(0xba)]=appSettings[_0x24a0ce(0x163)],document[_0x24a0ce(0x16b)](_0x24a0ce(0x151))[_0x24a0ce(0xba)]=appSettings[_0x24a0ce(0x151)],document[_0x24a0ce(0x16b)](_0x24a0ce(0x17c))[_0x24a0ce(0xba)]=appSettings['enforceKeyExpiry'],document[_0x24a0ce(0x16b)](_0x24a0ce(0x1f0))['value']=appSettings[_0x24a0ce(0x1f0)];}async function saveSettings(){const _0x3e7ea4=_0x558412;try{appSettings[_0x3e7ea4(0x122)]=document[_0x3e7ea4(0x16b)]('useIndexedDB')[_0x3e7ea4(0xba)],appSettings[_0x3e7ea4(0x163)]=document[_0x3e7ea4(0x16b)](_0x3e7ea4(0x163))['checked'],appSettings['enforcePwdProtection']=document[_0x3e7ea4(0x16b)](_0x3e7ea4(0x151))[_0x3e7ea4(0xba)],appSettings[_0x3e7ea4(0x17c)]=document[_0x3e7ea4(0x16b)](_0x3e7ea4(0x17c))[_0x3e7ea4(0xba)],appSettings['pbkdf2Iterations']=parseInt(document[_0x3e7ea4(0x16b)](_0x3e7ea4(0x1f0))['value']),PBKDF2_CONFIG[_0x3e7ea4(0xa7)]=appSettings[_0x3e7ea4(0x1f0)],appSettings['useIndexedDB']&&db?await saveToDatabase(SETTINGS_STORE,{'id':_0x3e7ea4(0x21c),...appSettings}):localStorage[_0x3e7ea4(0x244)](_0x3e7ea4(0x23c),JSON[_0x3e7ea4(0x19a)](appSettings)),showStatus(_0x3e7ea4(0xab),_0x3e7ea4(0x149),_0x3e7ea4(0x105));}catch(_0x27d5a0){console['error'](_0x3e7ea4(0x20b),_0x27d5a0),showStatus(_0x3e7ea4(0xab),'Error\x20saving\x20settings:\x20'+_0x27d5a0['message'],_0x3e7ea4(0x182));}}function resetSettings(){const _0x41e0c2=confirm('Are\x20you\x20sure\x20you\x20want\x20to\x20reset\x20all\x20settings\x20to\x20defaults?');if(!_0x41e0c2)return;appSettings={...DEFAULT_SETTINGS},initSettingsUI(),saveSettings();}function updatePasswordStrength(){const _0x68beab=_0x558412,_0x3abeee=document['getElementById'](_0x68beab(0xf4))[_0x68beab(0x1f4)],_0x408176=validator[_0x68beab(0x216)](_0x3abeee),_0x58c001=document[_0x68beab(0x16b)](_0x68beab(0x1be)),_0x56faf7=document['getElementById'](_0x68beab(0x141));_0x58c001[_0x68beab(0x222)]=_0x68beab(0x17d),_0x3abeee?(_0x58c001[_0x68beab(0xea)][_0x68beab(0x179)](_0x408176[_0x68beab(0x22f)]),_0x56faf7[_0x68beab(0xe9)]=_0x408176[_0x68beab(0xd0)]):_0x56faf7[_0x68beab(0xe9)]='';}async function loadKeys(){const _0x2c53fc=_0x558412;try{keys=[];if(appSettings['useIndexedDB']&&db){const _0x21b296=await getAllFromDatabase(KEYS_STORE);_0x21b296&&_0x21b296[_0x2c53fc(0x18c)]>0x0&&(keys=_0x21b296);}else{const _0x1515a7=localStorage[_0x2c53fc(0xf5)](_0x2c53fc(0x262));_0x1515a7&&(keys=JSON[_0x2c53fc(0xfa)](_0x1515a7));}checkExpiredKeys(),updateKeysList(),updateKeySelects();}catch(_0x5b94cc){console[_0x2c53fc(0x182)](_0x2c53fc(0x1ab),_0x5b94cc),showStatus(_0x2c53fc(0x25f),_0x2c53fc(0x9c)+_0x5b94cc[_0x2c53fc(0x1ee)],'error');}}async function saveKeys(){const _0x7f2e66=_0x558412;try{if(appSettings[_0x7f2e66(0x163)])console[_0x7f2e66(0x184)](_0x7f2e66(0xd4));else{if(appSettings['useIndexedDB']&&db){await clearDatabase(KEYS_STORE);for(const _0x4f53ac of keys){await saveToDatabase(KEYS_STORE,_0x4f53ac);}}else localStorage['setItem'](_0x7f2e66(0x262),JSON[_0x7f2e66(0x19a)](keys));}updateKeysList(),updateKeySelects();}catch(_0x2b2e15){console[_0x7f2e66(0x182)]('Error\x20saving\x20keys:',_0x2b2e15),showStatus('keyStatus',_0x7f2e66(0x165)+_0x2b2e15[_0x7f2e66(0x1ee)],_0x7f2e66(0x182));}}function checkExpiredKeys(){const _0x1ddd8d=_0x558412,_0x5022cd=new Date(),_0xb5c982=[];keys[_0x1ddd8d(0x227)](_0x38aaf3=>{const _0x243c19=_0x1ddd8d;if(_0x38aaf3['expiry']){const _0x7dbb47=new Date(_0x38aaf3[_0x243c19(0x14a)]);_0x7dbb47<_0x5022cd&&_0xb5c982[_0x243c19(0x1e9)](_0x38aaf3['id']);}}),_0xb5c982[_0x1ddd8d(0x18c)]>0x0&&(keys=keys[_0x1ddd8d(0xed)](_0x3b88cf=>!_0xb5c982[_0x1ddd8d(0x106)](_0x3b88cf['id'])),saveKeys(),showStatus(_0x1ddd8d(0x25f),_0xb5c982['length']+_0x1ddd8d(0x112),_0x1ddd8d(0x220)));}async function generateKey(){const _0x100414=_0x558412;try{setLoading(!![]);const _0x5e14ed=document['getElementById'](_0x100414(0x1ac))[_0x100414(0x1f4)][_0x100414(0x1f7)](),_0x339f1a=document[_0x100414(0x16b)]('keyType')['value'],_0x375341=document[_0x100414(0x16b)](_0x100414(0xf4))['value'],_0x3bd93b=document[_0x100414(0x16b)](_0x100414(0x1e1))[_0x100414(0x1f4)],_0x56573b=document[_0x100414(0x16b)](_0x100414(0x1aa))[_0x100414(0x1f4)];if(!_0x5e14ed){showStatus('keyStatus',_0x100414(0x170),_0x100414(0x182));return;}if(!validator[_0x100414(0x16d)](_0x5e14ed)){showStatus(_0x100414(0x25f),_0x100414(0x8b),'error');return;}if(appSettings[_0x100414(0x151)]&&!_0x375341){showStatus(_0x100414(0x25f),_0x100414(0xb9),'error');return;}if(_0x375341){const _0x5c04ea=validator[_0x100414(0x216)](_0x375341);if(_0x5c04ea[_0x100414(0xdd)]<0x4){showStatus(_0x100414(0x25f),_0x100414(0xfd)+_0x5c04ea[_0x100414(0xd0)],_0x100414(0x182));return;}if(_0x375341!==_0x3bd93b){showStatus(_0x100414(0x25f),_0x100414(0x115),_0x100414(0x182));return;}}if(appSettings[_0x100414(0x17c)]&&!_0x56573b){showStatus('keyStatus',_0x100414(0x226),_0x100414(0x182));return;}const _0x17ba5a={'id':crypto['randomUUID'](),'name':_0x5e14ed,'type':_0x339f1a,'created':new Date()[_0x100414(0x249)]()};if(_0x56573b){const _0x3634a8=parseInt(_0x56573b),_0x3e2e4d=new Date();_0x3e2e4d[_0x100414(0xef)](_0x3e2e4d['getDate']()+_0x3634a8),_0x17ba5a[_0x100414(0x14a)]=_0x3e2e4d[_0x100414(0x249)]();}const _0x2f2062=_0x339f1a===_0x100414(0x228)||_0x339f1a===_0x100414(0x10d)||_0x339f1a===_0x100414(0x1cc)||_0x339f1a===_0x100414(0x15d);_0x2f2062&&(_0x17ba5a[_0x100414(0x131)]=!![],_0x17ba5a['hasPrivate']=!![],_0x17ba5a[_0x100414(0x17b)]=_0x17ba5a['id']);if(_0x339f1a===_0x100414(0xb8))await generateAESKey(_0x17ba5a,_0x375341);else{if(_0x339f1a===_0x100414(0x228))await generateRSAKey(_0x17ba5a,_0x375341,RSA_CONFIG[_0x100414(0x103)]);else{if(_0x339f1a==='rsa-4096')await generateRSAKey(_0x17ba5a,_0x375341,RSA_CONFIG[_0x100414(0x21e)]);else{if(_0x339f1a===_0x100414(0x1cc))await generateECCKey(_0x17ba5a,_0x375341,ECC_CONFIG[_0x100414(0x197)]);else _0x339f1a==='ecc-p384'&&await generateECCKey(_0x17ba5a,_0x375341,ECC_CONFIG[_0x100414(0xb2)]);}}}keys['push'](_0x17ba5a),await saveKeys(),document[_0x100414(0x16b)](_0x100414(0x1ac))[_0x100414(0x1f4)]='',document[_0x100414(0x16b)](_0x100414(0xf4))['value']='',document[_0x100414(0x16b)](_0x100414(0x1e1))[_0x100414(0x1f4)]='',document[_0x100414(0x16b)]('passwordStrength')[_0x100414(0x222)]='password-strength',document[_0x100414(0x16b)]('passwordFeedback')['textContent']='';const _0x5bd2b7=getKeyTypeDisplay(_0x17ba5a);showStatus('keyStatus',_0x5bd2b7+'\x20key\x20\x22'+_0x5e14ed+'\x22\x20generated\x20successfully','success');}catch(_0x3496d7){console[_0x100414(0x182)](_0x100414(0xa1),_0x3496d7),showStatus(_0x100414(0x25f),'Error\x20generating\x20key:\x20'+_0x3496d7[_0x100414(0x1ee)],_0x100414(0x182));}finally{setLoading(![]);}}function getPairedKeyIds(_0x2c311c){const _0x1a6a7c=_0x558412;if(_0x2c311c[_0x1a6a7c(0x17b)])return _0x2c311c[_0x1a6a7c(0x17b)];if(_0x2c311c[_0x1a6a7c(0x8d)]&&_0x2c311c[_0x1a6a7c(0x131)])return _0x2c311c['id'];if((_0x2c311c['type']==='rsa'||_0x2c311c[_0x1a6a7c(0x142)]===_0x1a6a7c(0x10d)||_0x2c311c[_0x1a6a7c(0x142)]==='ecc'||_0x2c311c[_0x1a6a7c(0x142)]==='ecc-p384')&&(_0x2c311c[_0x1a6a7c(0x131)]||_0x2c311c[_0x1a6a7c(0x8d)])){const _0x4453bc=keys[_0x1a6a7c(0xed)](_0x1882cf=>_0x1882cf['id']!==_0x2c311c['id']&&_0x1882cf[_0x1a6a7c(0x142)]===_0x2c311c['type']&&(_0x2c311c[_0x1a6a7c(0x131)]&&_0x1882cf[_0x1a6a7c(0x8d)]||_0x2c311c[_0x1a6a7c(0x8d)]&&_0x1882cf['hasPublic'])&&(_0x1882cf[_0x1a6a7c(0x144)]&&_0x2c311c['publicKeyHash']&&_0x1882cf[_0x1a6a7c(0x144)]===_0x2c311c[_0x1a6a7c(0x144)]));if(_0x4453bc[_0x1a6a7c(0x18c)]>0x0)return _0x4453bc[0x0]['id'];}return null;}function zeroAllKeys(){const _0x2c6e3a=_0x558412;if(keys[_0x2c6e3a(0x18c)]===0x0){showStatus('keyStatus',_0x2c6e3a(0x205),_0x2c6e3a(0x220));return;}const _0xe30a16=confirm(_0x2c6e3a(0x181));if(_0xe30a16){const _0x30af08=keys[_0x2c6e3a(0x18c)];keys=[],appSettings[_0x2c6e3a(0x122)]&&db?clearDatabase(KEYS_STORE)[_0x2c6e3a(0x10a)](()=>{const _0x2c63e4=_0x2c6e3a;console[_0x2c63e4(0x184)](_0x2c63e4(0x99));})[_0x2c6e3a(0x238)](_0x33a0e9=>{const _0x118b7c=_0x2c6e3a;console[_0x118b7c(0x182)](_0x118b7c(0xfe),_0x33a0e9);}):localStorage[_0x2c6e3a(0x19b)]('LemonadeKeys'),updateKeysList(),updateKeySelects(),showStatus(_0x2c6e3a(0x25f),'All\x20keys\x20('+_0x30af08+_0x2c6e3a(0xad),_0x2c6e3a(0x105));}else showStatus(_0x2c6e3a(0x25f),_0x2c6e3a(0x1d8),_0x2c6e3a(0xd9));}async function generateAESKey(_0x527288,_0x16b7f6){const _0x9f4e10=_0x558412,_0x416290=await window[_0x9f4e10(0x261)][_0x9f4e10(0x98)][_0x9f4e10(0x12f)]({'name':AES_CONFIG[_0x9f4e10(0x21d)],'length':AES_CONFIG['KEY_LENGTH']},!![],[_0x9f4e10(0x1ec),'decrypt']),_0x538026=await window[_0x9f4e10(0x261)][_0x9f4e10(0x98)][_0x9f4e10(0x1c5)](_0x9f4e10(0x257),_0x416290);_0x527288['key']=arrayBufferToBase64(_0x538026),_0x527288['algorithm']=AES_CONFIG[_0x9f4e10(0x21d)],_0x527288[_0x9f4e10(0x18c)]=AES_CONFIG[_0x9f4e10(0xae)],_0x16b7f6&&await encryptKeyWithPassword(_0x527288,_0x16b7f6);}async function generateRSAKey(_0x491ace,_0x4d8b26,_0x571d99){const _0xf1bf9f=_0x558412,_0x250acd=await window[_0xf1bf9f(0x261)][_0xf1bf9f(0x98)][_0xf1bf9f(0x12f)]({'name':RSA_CONFIG[_0xf1bf9f(0x243)],'modulusLength':_0x571d99,'publicExponent':new Uint8Array([0x1,0x0,0x1]),'hash':RSA_CONFIG[_0xf1bf9f(0xf3)]},!![],[_0xf1bf9f(0x1ec),_0xf1bf9f(0x125)]),_0x288c29=await window[_0xf1bf9f(0x261)]['subtle'][_0xf1bf9f(0x1c5)]('spki',_0x250acd[_0xf1bf9f(0x254)]),_0xe8c0ce=await window[_0xf1bf9f(0x261)]['subtle'][_0xf1bf9f(0x1c5)](_0xf1bf9f(0xd5),_0x250acd[_0xf1bf9f(0x113)]);_0x491ace[_0xf1bf9f(0x254)]=arrayBufferToBase64(_0x288c29),_0x491ace[_0xf1bf9f(0x113)]=arrayBufferToBase64(_0xe8c0ce),_0x491ace[_0xf1bf9f(0x1f9)]=RSA_CONFIG[_0xf1bf9f(0x243)],_0x491ace[_0xf1bf9f(0x18c)]=_0x571d99;const _0x17ad1e=await computeKeyHash(_0x288c29);_0x491ace['publicKeyHash']=_0x17ad1e,_0x4d8b26&&await encryptKeyWithPassword(_0x491ace,_0x4d8b26);}async function generateECCKey(_0x16a69c,_0xd74d65,_0xba77c){const _0x44172b=_0x558412,_0x3167f5=await window[_0x44172b(0x261)][_0x44172b(0x98)][_0x44172b(0x12f)]({'name':_0x44172b(0xec),'namedCurve':_0xba77c},!![],['deriveKey',_0x44172b(0x94)]),_0x3f066f=await window[_0x44172b(0x261)][_0x44172b(0x98)][_0x44172b(0x1c5)](_0x44172b(0x15f),_0x3167f5[_0x44172b(0x254)]),_0x4bba8c=await window[_0x44172b(0x261)]['subtle'][_0x44172b(0x1c5)](_0x44172b(0xd5),_0x3167f5['privateKey']);_0x16a69c[_0x44172b(0x254)]=arrayBufferToBase64(_0x3f066f),_0x16a69c['privateKey']=arrayBufferToBase64(_0x4bba8c),_0x16a69c[_0x44172b(0x1f9)]=_0x44172b(0xec),_0x16a69c['curve']=_0xba77c;const _0x4f3241=await computeKeyHash(_0x3f066f);_0x16a69c['publicKeyHash']=_0x4f3241,_0xd74d65&&await encryptKeyWithPassword(_0x16a69c,_0xd74d65);}async function computeKeyHash(_0x4e4286){const _0x31f4f3=_0x558412,_0xb5caf8=await crypto['subtle'][_0x31f4f3(0x140)]('SHA-256',_0x4e4286);return arrayBufferToBase64(_0xb5caf8);}async function encryptKeyWithPassword(_0x4aeda8,_0x373202){const _0x3f4ced=_0x558412,_0x41eb8f=window[_0x3f4ced(0x261)]['getRandomValues'](new Uint8Array(0x10));_0x4aeda8[_0x3f4ced(0x1d5)]=arrayBufferToBase64(_0x41eb8f);const _0xfb650c=await deriveKeyFromPassword(_0x373202,_0x41eb8f),_0x9390d8=window[_0x3f4ced(0x261)]['getRandomValues'](new Uint8Array(AES_CONFIG['IV_LENGTH']));_0x4aeda8['iv']=arrayBufferToBase64(_0x9390d8);if(_0x4aeda8[_0x3f4ced(0x142)]==='aes'){const _0x4f222c=await encryptWithDerivedKey(_0xfb650c,base64ToArrayBuffer(_0x4aeda8[_0x3f4ced(0x109)]),_0x9390d8);_0x4aeda8[_0x3f4ced(0x109)]=arrayBufferToBase64(_0x4f222c),_0x4aeda8[_0x3f4ced(0x1e8)]=!![];}else{const _0x19adc8=await encryptWithDerivedKey(_0xfb650c,base64ToArrayBuffer(_0x4aeda8[_0x3f4ced(0x113)]),_0x9390d8);_0x4aeda8[_0x3f4ced(0x113)]=arrayBufferToBase64(_0x19adc8),_0x4aeda8['protected']=!![];}}async function decryptKeyWithPassword(_0x5b509a,_0x3a6895){const _0x3b421e=_0x558412;try{if(!_0x5b509a||!_0x3a6895)throw new Error('Key\x20data\x20and\x20password\x20are\x20required');if(!_0x5b509a[_0x3b421e(0x1d5)]||!_0x5b509a['iv'])throw new Error('Key\x20is\x20missing\x20salt\x20or\x20IV\x20data');const _0x57ef47=base64ToArrayBuffer(_0x5b509a[_0x3b421e(0x1d5)]),_0x2a114f=await deriveKeyFromPassword(_0x3a6895,_0x57ef47),_0x26aab9=base64ToArrayBuffer(_0x5b509a['iv']),_0x1fcf58={..._0x5b509a};if(_0x5b509a['type']==='aes'){if(!_0x5b509a[_0x3b421e(0x109)])throw new Error(_0x3b421e(0x128));const _0x152deb=await decryptWithDerivedKey(_0x2a114f,base64ToArrayBuffer(_0x5b509a[_0x3b421e(0x109)]),_0x26aab9);_0x1fcf58[_0x3b421e(0x109)]=arrayBufferToBase64(_0x152deb),_0x1fcf58['_cryptoKey']=await importAESKey(_0x152deb);}else{if(_0x5b509a['type']===_0x3b421e(0x228)||_0x5b509a[_0x3b421e(0x142)]===_0x3b421e(0x10d)){if(!_0x5b509a[_0x3b421e(0x113)])throw new Error(_0x3b421e(0x263));const _0x5cdc4c=await decryptWithDerivedKey(_0x2a114f,base64ToArrayBuffer(_0x5b509a[_0x3b421e(0x113)]),_0x26aab9);_0x1fcf58[_0x3b421e(0x113)]=arrayBufferToBase64(_0x5cdc4c),_0x1fcf58[_0x3b421e(0x1a4)]=await importRSAPrivateKey(_0x5cdc4c,_0x5b509a[_0x3b421e(0x18c)]||RSA_CONFIG[_0x3b421e(0x103)]),_0x5b509a[_0x3b421e(0x254)]&&(_0x1fcf58[_0x3b421e(0x258)]=await importRSAPublicKey(base64ToArrayBuffer(_0x5b509a[_0x3b421e(0x254)]),_0x5b509a[_0x3b421e(0x18c)]||RSA_CONFIG[_0x3b421e(0x103)]));}else{if(_0x5b509a[_0x3b421e(0x142)]===_0x3b421e(0x1cc)||_0x5b509a[_0x3b421e(0x142)]===_0x3b421e(0x15d)){if(!_0x5b509a[_0x3b421e(0x113)])throw new Error(_0x3b421e(0x263));const _0x4de8ad=await decryptWithDerivedKey(_0x2a114f,base64ToArrayBuffer(_0x5b509a[_0x3b421e(0x113)]),_0x26aab9);_0x1fcf58[_0x3b421e(0x113)]=arrayBufferToBase64(_0x4de8ad),_0x1fcf58[_0x3b421e(0x1a4)]=await importECCPrivateKey(_0x4de8ad,_0x5b509a[_0x3b421e(0x22e)]||ECC_CONFIG[_0x3b421e(0x197)]),_0x5b509a[_0x3b421e(0x254)]&&(_0x1fcf58[_0x3b421e(0x258)]=await importECCPublicKey(base64ToArrayBuffer(_0x5b509a['publicKey']),_0x5b509a[_0x3b421e(0x22e)]||ECC_CONFIG[_0x3b421e(0x197)]));}else throw new Error(_0x3b421e(0x155)+_0x5b509a['type']);}}return safeMemory[_0x3b421e(0x11c)](_0x1fcf58);}catch(_0x3d002a){console[_0x3b421e(0x182)](_0x3b421e(0x156),_0x3d002a);throw new Error(_0x3b421e(0x232));}}function updateKeysList(){const _0x226a7f=_0x558412;keysList[_0x226a7f(0x193)]='';if(keys[_0x226a7f(0x18c)]===0x0){keysList[_0x226a7f(0x193)]=_0x226a7f(0xfc);return;}keys[_0x226a7f(0x227)](_0x3b52d2=>{const _0x369129=_0x226a7f,_0x5c2a5e=document[_0x369129(0x19d)](_0x369129(0x1d4));_0x5c2a5e[_0x369129(0x222)]=_0x369129(0xf7);const _0xe89252=getKeyTypeDisplay(_0x3b52d2),_0xdc42e7=_0x3b52d2[_0x369129(0x1e8)]?_0x369129(0x189):'';let _0x33c2ea='';if(_0x3b52d2['type']===_0x369129(0xb8))_0x33c2ea='';else{if(_0x3b52d2[_0x369129(0x8d)]&&_0x3b52d2['hasPublic'])_0x33c2ea=_0x369129(0x23a);else{if(_0x3b52d2['hasPrivate'])_0x33c2ea=_0x369129(0x1e0);else _0x3b52d2[_0x369129(0x131)]&&(_0x33c2ea='<span\x20class=\x22key-pair-badge\x20public\x22>PUBLIC\x20KEY</span>');}}let _0x195a43='',_0x5f5978=determineKeySecurityLevel(_0x3b52d2);_0x195a43=_0x369129(0x13b)+_0x5f5978+'\x22>'+_0x5f5978['toUpperCase']()+'</span>';let _0x3951de='';if(_0x3b52d2[_0x369129(0x14a)]){const _0x276337=new Date(_0x3b52d2[_0x369129(0x14a)]),_0x32d416=Math[_0x369129(0x1d1)]((_0x276337-new Date())/(0x3e8*0x3c*0x3c*0x18));_0x3951de='<div\x20class=\x22key-expiry\x22>Expires\x20in\x20'+_0x32d416+_0x369129(0xa5)+_0x276337[_0x369129(0x231)]()+_0x369129(0x160);}let _0x2deb8d='';if(_0x3b52d2[_0x369129(0x142)]===_0x369129(0xb8))_0x2deb8d+=_0x369129(0xa8)+_0x3b52d2['id']+_0x369129(0x248);else _0x3b52d2[_0x369129(0x131)]&&(_0x2deb8d+=_0x369129(0xa8)+_0x3b52d2['id']+'\x27)\x22>Export\x20Public</button>');_0x3b52d2[_0x369129(0x142)]!==_0x369129(0xb8)&&_0x3b52d2[_0x369129(0x8d)]&&(_0x2deb8d+=_0x369129(0x14e)+_0x3b52d2['id']+_0x369129(0x218)),_0x2deb8d+=_0x369129(0x173)+_0x3b52d2['id']+_0x369129(0x1d0),_0x5c2a5e[_0x369129(0x193)]=_0x369129(0xa9)+validator[_0x369129(0x204)](_0x3b52d2[_0x369129(0xe7)])+'\x20('+_0xe89252+_0xdc42e7+')\x20'+_0x195a43+_0x369129(0x18a)+_0x33c2ea+_0x369129(0x1e3)+new Date(_0x3b52d2[_0x369129(0x1b0)])[_0x369129(0x89)]()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Algorithm:\x20'+(_0x3b52d2[_0x369129(0x1f9)]||'')+'\x20'+(_0x3b52d2[_0x369129(0x18c)]?_0x3b52d2['length']+'\x20bits':_0x3b52d2[_0x369129(0x22e)]||'')+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3951de+_0x369129(0x186)+_0x2deb8d+_0x369129(0x93),keysList[_0x369129(0x198)](_0x5c2a5e);});}function getKeyTypeDisplay(_0x13f06b){const _0x395801=_0x558412;if(_0x13f06b[_0x395801(0x142)]===_0x395801(0xb8))return _0x395801(0x10c);else{if(_0x13f06b[_0x395801(0x142)]===_0x395801(0x228))return _0x395801(0x123);else{if(_0x13f06b[_0x395801(0x142)]===_0x395801(0x10d))return _0x395801(0x16f);else{if(_0x13f06b[_0x395801(0x142)]==='ecc')return _0x395801(0x23f);else{if(_0x13f06b[_0x395801(0x142)]==='ecc-p384')return'ECC-P384';}}}}return _0x13f06b[_0x395801(0x142)]['toUpperCase']();}function updateKeySelects(){const _0xd0dabc=_0x558412;encryptionKeySelect['innerHTML']=_0xd0dabc(0x1b6),decryptionKeySelect[_0xd0dabc(0x193)]=_0xd0dabc(0x1b6),keys[_0xd0dabc(0x227)](_0x1afbe8=>{const _0x51ff6a=_0xd0dabc;if(_0x1afbe8[_0x51ff6a(0x142)]==='aes'||_0x1afbe8[_0x51ff6a(0x131)]){const _0x416511=document[_0x51ff6a(0x19d)]('option');_0x416511[_0x51ff6a(0x1f4)]=_0x1afbe8['id'];const _0x5a89dc=getKeyTypeDisplay(_0x1afbe8),_0x503c92=_0x1afbe8[_0x51ff6a(0x1e8)]?_0x51ff6a(0x189):'';let _0x4cdf09='';_0x1afbe8['type']!==_0x51ff6a(0xb8)&&(_0x4cdf09=_0x1afbe8[_0x51ff6a(0x8d)]&&_0x1afbe8[_0x51ff6a(0x131)]?_0x51ff6a(0x1c4):'\x20[Public]'),_0x416511['text']=_0x1afbe8[_0x51ff6a(0xe7)]+'\x20('+_0x5a89dc+_0x4cdf09+_0x503c92+')',encryptionKeySelect[_0x51ff6a(0x198)](_0x416511);}}),keys[_0xd0dabc(0x227)](_0xf5ce50=>{const _0x27b697=_0xd0dabc;if(_0xf5ce50[_0x27b697(0x142)]===_0x27b697(0xb8)||_0xf5ce50['hasPrivate']){const _0x30778a=document[_0x27b697(0x19d)]('option');_0x30778a[_0x27b697(0x1f4)]=_0xf5ce50['id'];const _0xbf748b=getKeyTypeDisplay(_0xf5ce50),_0xc81ca6=_0xf5ce50[_0x27b697(0x1e8)]?_0x27b697(0x189):'';let _0x5afced='';_0xf5ce50['type']!=='aes'&&(_0x5afced=_0xf5ce50[_0x27b697(0x8d)]&&_0xf5ce50[_0x27b697(0x131)]?'\x20[Full\x20Pair]':_0x27b697(0x13c)),_0x30778a[_0x27b697(0x11b)]=_0xf5ce50[_0x27b697(0xe7)]+'\x20('+_0xbf748b+_0x5afced+_0xc81ca6+')',decryptionKeySelect[_0x27b697(0x198)](_0x30778a);}});}function handleEncryptionKeyChange(){const _0x20d731=_0x558412,_0x3cfe0a=encryptionKeySelect[_0x20d731(0x1f4)];if(!_0x3cfe0a){document[_0x20d731(0x16b)](_0x20d731(0xf8))[_0x20d731(0x1ca)][_0x20d731(0x236)]=_0x20d731(0xa0);return;}const _0x1335c0=keys['find'](_0x191b2e=>_0x191b2e['id']===_0x3cfe0a);if(!_0x1335c0)return;document[_0x20d731(0x16b)](_0x20d731(0xf8))[_0x20d731(0x1ca)][_0x20d731(0x236)]=_0x1335c0[_0x20d731(0x1e8)]?'block':'none';}function handleDecryptionKeyChange(){const _0x3bd3e1=_0x558412,_0x624002=decryptionKeySelect[_0x3bd3e1(0x1f4)];if(!_0x624002){document[_0x3bd3e1(0x16b)](_0x3bd3e1(0x11d))[_0x3bd3e1(0x1ca)][_0x3bd3e1(0x236)]=_0x3bd3e1(0xa0);return;}const _0x14f448=keys[_0x3bd3e1(0x246)](_0x2fda24=>_0x2fda24['id']===_0x624002);if(!_0x14f448)return;document[_0x3bd3e1(0x16b)](_0x3bd3e1(0x11d))['style'][_0x3bd3e1(0x236)]=_0x14f448[_0x3bd3e1(0x1e8)]?_0x3bd3e1(0x1bb):_0x3bd3e1(0xa0);}async function encryptMessage(){const _0x932b72=_0x558412;try{let _0x33109c,_0x426f37='';if(encryptFileData)_0x33109c=encryptFileData,_0x426f37=generateRandomFileName(0x6)+_0x932b72(0x20e);else{const _0x2e02a4=document[_0x932b72(0x16b)](_0x932b72(0x1d7))[_0x932b72(0x1f4)];if(!_0x2e02a4){showStatus('encryptStatus',_0x932b72(0x1c6),_0x932b72(0x182));return;}_0x33109c=new TextEncoder()['encode'](_0x2e02a4);}const _0x3527dd=document[_0x932b72(0x16b)]('encryptionKey')[_0x932b72(0x1f4)],_0x3430c3=document[_0x932b72(0x16b)](_0x932b72(0x20c))[_0x932b72(0x1f4)];let _0x4ac2fb=document[_0x932b72(0x16b)](_0x932b72(0x164))[_0x932b72(0x1f4)];_0x4ac2fb&&(_0x33109c=xorCipher(_0x33109c,_0x4ac2fb));if(!_0x3527dd){showStatus('encryptStatus',_0x932b72(0xf1),_0x932b72(0x182));return;}setLoading(!![]);const _0x17a663=keys[_0x932b72(0x246)](_0x5658d3=>_0x5658d3['id']===_0x3527dd);if(!_0x17a663){showStatus(_0x932b72(0x24c),_0x932b72(0x148),_0x932b72(0x182)),setLoading(![]);return;}let _0x59dd15=null,_0x37f6ea=_0x17a663;if(_0x17a663[_0x932b72(0x1e8)]){if(!_0x3430c3){showStatus('encryptStatus',_0x932b72(0x1fc),_0x932b72(0x182)),setLoading(![]);return;}try{_0x59dd15=await decryptKeyWithPassword(_0x17a663,_0x3430c3),_0x37f6ea=safeMemory[_0x932b72(0x23e)](_0x59dd15);if(!_0x37f6ea)throw new Error(_0x932b72(0x114));}catch(_0x34e549){showStatus(_0x932b72(0x24c),_0x932b72(0x1a3)+_0x34e549[_0x932b72(0x1ee)],_0x932b72(0x182)),setLoading(![]);return;}}let _0x3791d9=await encryptData(_0x33109c,_0x37f6ea);_0x59dd15&&safeMemory[_0x932b72(0x230)](_0x59dd15);encryptFileData&&(_0x3791d9[_0x932b72(0x215)]=encryptFileName,_0x3791d9['fileSize']=encryptFileData[_0x932b72(0x1ef)],_0x3791d9[_0x932b72(0x18d)]=!![]);const _0x12c2c7=createEncryptedMessageString(_0x3791d9,_0x4ac2fb);document['getElementById'](_0x932b72(0xff))['value']=_0x12c2c7,document[_0x932b72(0x16b)](_0x932b72(0x9a))[_0x932b72(0xc5)](_0x932b72(0x158),_0x426f37),showStatus(_0x932b72(0x24c),'Message\x20encrypted\x20successfully','success');}catch(_0x5008fc){console['error'](_0x932b72(0x1a8),_0x5008fc),showStatus(_0x932b72(0x24c),'Encryption\x20error:\x20'+_0x5008fc['message'],_0x932b72(0x182));}finally{document['getElementById'](_0x932b72(0x20c))[_0x932b72(0x1f4)]='',setLoading(![]);}}async function encryptWithAES(_0xfdaa23,_0x412075){const _0x550d9f=_0x558412;try{const _0xeaac=window[_0x550d9f(0x261)][_0x550d9f(0x24a)](new Uint8Array(AES_CONFIG[_0x550d9f(0x20d)]));let _0x2f4835;if(_0x412075[_0x550d9f(0xbe)])_0x2f4835=_0x412075[_0x550d9f(0xbe)];else{const _0x49ba07=base64ToArrayBuffer(_0x412075[_0x550d9f(0x109)]);_0x2f4835=await window[_0x550d9f(0x261)][_0x550d9f(0x98)]['importKey'](_0x550d9f(0x257),_0x49ba07,{'name':AES_CONFIG[_0x550d9f(0x21d)],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x550d9f(0x1ec)]);}const _0x596214=await window['crypto']['subtle'][_0x550d9f(0x1ec)]({'name':AES_CONFIG[_0x550d9f(0x21d)],'iv':_0xeaac,'tagLength':AES_CONFIG[_0x550d9f(0x102)]},_0x2f4835,_0xfdaa23),_0x472607={'k':_0x412075['id'],'t':new Date()[_0x550d9f(0x249)](),'a':AES_CONFIG[_0x550d9f(0x21d)]};encryptFileData&&encryptFileName&&(_0x472607['f']={'n':encryptFileName,'s':encryptFileData[_0x550d9f(0x1ef)]});const _0x665a64=new TextEncoder()['encode'](JSON[_0x550d9f(0x19a)](_0x472607)),_0x5f5833=window[_0x550d9f(0x261)][_0x550d9f(0x24a)](new Uint8Array(AES_CONFIG[_0x550d9f(0x20d)])),_0x38dfd2=await window[_0x550d9f(0x261)][_0x550d9f(0x98)][_0x550d9f(0x12f)]({'name':AES_CONFIG['MODE'],'length':AES_CONFIG[_0x550d9f(0xae)]},!![],[_0x550d9f(0x1ec)]),_0x277724=await window[_0x550d9f(0x261)][_0x550d9f(0x98)][_0x550d9f(0x1ec)]({'name':AES_CONFIG[_0x550d9f(0x21d)],'iv':_0x5f5833,'tagLength':AES_CONFIG[_0x550d9f(0x102)]},_0x38dfd2,_0x665a64),_0xcc092e=await window[_0x550d9f(0x261)][_0x550d9f(0x98)]['exportKey'](_0x550d9f(0x257),_0x38dfd2),_0x470b0e=0x3,_0x220609=0x1+_0x5f5833['byteLength']+0x4+_0xcc092e[_0x550d9f(0x1ef)]+0x4+_0x277724[_0x550d9f(0x1ef)]+_0xeaac[_0x550d9f(0x1ef)]+0x4+_0x596214[_0x550d9f(0x1ef)],_0x50cf3d=new Uint8Array(_0x220609);let _0x2a764b=0x0;_0x50cf3d[_0x2a764b++]=_0x470b0e,_0x50cf3d[_0x550d9f(0x9e)](_0x5f5833,_0x2a764b),_0x2a764b+=_0x5f5833[_0x550d9f(0x1ef)];const _0x2a8dd3=_0xcc092e[_0x550d9f(0x1ef)];_0x50cf3d[_0x2a764b++]=_0x2a8dd3>>0x18&0xff,_0x50cf3d[_0x2a764b++]=_0x2a8dd3>>0x10&0xff,_0x50cf3d[_0x2a764b++]=_0x2a8dd3>>0x8&0xff,_0x50cf3d[_0x2a764b++]=_0x2a8dd3&0xff,_0x50cf3d['set'](new Uint8Array(_0xcc092e),_0x2a764b),_0x2a764b+=_0xcc092e['byteLength'];const _0x1e53a8=_0x277724[_0x550d9f(0x1ef)];_0x50cf3d[_0x2a764b++]=_0x1e53a8>>0x18&0xff,_0x50cf3d[_0x2a764b++]=_0x1e53a8>>0x10&0xff,_0x50cf3d[_0x2a764b++]=_0x1e53a8>>0x8&0xff,_0x50cf3d[_0x2a764b++]=_0x1e53a8&0xff,_0x50cf3d[_0x550d9f(0x9e)](new Uint8Array(_0x277724),_0x2a764b),_0x2a764b+=_0x277724[_0x550d9f(0x1ef)],_0x50cf3d[_0x550d9f(0x9e)](_0xeaac,_0x2a764b),_0x2a764b+=_0xeaac[_0x550d9f(0x1ef)];const _0x377500=_0x596214['byteLength'];return _0x50cf3d[_0x2a764b++]=_0x377500>>0x18&0xff,_0x50cf3d[_0x2a764b++]=_0x377500>>0x10&0xff,_0x50cf3d[_0x2a764b++]=_0x377500>>0x8&0xff,_0x50cf3d[_0x2a764b++]=_0x377500&0xff,_0x50cf3d[_0x550d9f(0x9e)](new Uint8Array(_0x596214),_0x2a764b),{'version':0x3,'data':arrayBufferToBase64(_0x50cf3d[_0x550d9f(0x168)])};}catch(_0x2f3a21){console[_0x550d9f(0x182)](_0x550d9f(0xd1),_0x2f3a21);throw new Error(_0x550d9f(0xb4)+_0x2f3a21['message']);}}async function deriveMetadataKey(_0xa34e2e,_0x176929){const _0x725a41=_0x558412,_0x4b1dea=await window['crypto'][_0x725a41(0x98)][_0x725a41(0x1c5)](_0x725a41(0x257),_0xa34e2e),_0xe12d8=new Uint8Array(_0x4b1dea[_0x725a41(0x1ef)]+_0x176929[_0x725a41(0x1ef)]);_0xe12d8[_0x725a41(0x9e)](new Uint8Array(_0x4b1dea),0x0),_0xe12d8['set'](_0x176929,_0x4b1dea[_0x725a41(0x1ef)]);const _0x81d39a=await window[_0x725a41(0x261)][_0x725a41(0x98)]['importKey'](_0x725a41(0x257),_0xe12d8,{'name':'HKDF'},![],[_0x725a41(0x19c)]);return window[_0x725a41(0x261)][_0x725a41(0x98)][_0x725a41(0x19c)]({'name':_0x725a41(0xdb),'hash':'SHA-256','salt':_0x176929,'info':new Uint8Array([0x1,0x2,0x3,0x4])},_0x81d39a,{'name':AES_CONFIG[_0x725a41(0x21d)],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x725a41(0x1ec),_0x725a41(0x125)]);}async function encryptWithRSA(_0x3df8f3,_0x23934a){const _0x36a079=_0x558412,_0x3ca70c=await window[_0x36a079(0x261)][_0x36a079(0x98)][_0x36a079(0x12f)]({'name':AES_CONFIG[_0x36a079(0x21d)],'length':AES_CONFIG['KEY_LENGTH']},!![],[_0x36a079(0x1ec),_0x36a079(0x125)]),_0x10ca03=window['crypto']['getRandomValues'](new Uint8Array(AES_CONFIG[_0x36a079(0x20d)])),_0x496a51=await window[_0x36a079(0x261)][_0x36a079(0x98)][_0x36a079(0x1ec)]({'name':AES_CONFIG[_0x36a079(0x21d)],'iv':_0x10ca03,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x3ca70c,_0x3df8f3),_0x3111f7=await window['crypto'][_0x36a079(0x98)][_0x36a079(0x1c5)](_0x36a079(0x257),_0x3ca70c);let _0x26f811;if(_0x23934a['_publicKey'])_0x26f811=_0x23934a[_0x36a079(0x258)];else{const _0x5da2f5=base64ToArrayBuffer(_0x23934a[_0x36a079(0x254)]);_0x26f811=await importRSAPublicKey(_0x5da2f5,_0x23934a[_0x36a079(0x18c)]||RSA_CONFIG[_0x36a079(0x103)]);}const _0x3bcf82=await window['crypto'][_0x36a079(0x98)][_0x36a079(0x1ec)]({'name':RSA_CONFIG[_0x36a079(0x243)]},_0x26f811,_0x3111f7),_0x211602={'a':RSA_CONFIG[_0x36a079(0x243)]+'+'+AES_CONFIG[_0x36a079(0x21d)],'k':_0x23934a['id'],'t':new Date()['toISOString'](),'s':_0x23934a[_0x36a079(0x18c)]||RSA_CONFIG['KEY_SIZE']};encryptFileData&&encryptFileName&&(_0x211602['f']={'n':encryptFileName,'s':encryptFileData['byteLength']});const _0x3b182b=new TextEncoder()[_0x36a079(0x107)](JSON[_0x36a079(0x19a)](_0x211602)),_0x261e79=await window[_0x36a079(0x261)]['subtle'][_0x36a079(0x12f)]({'name':AES_CONFIG[_0x36a079(0x21d)],'length':AES_CONFIG[_0x36a079(0xae)]},!![],['encrypt',_0x36a079(0x125)]),_0x1ac1d3=window[_0x36a079(0x261)][_0x36a079(0x24a)](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0xc12352=await window['crypto']['subtle'][_0x36a079(0x1ec)]({'name':AES_CONFIG[_0x36a079(0x21d)],'iv':_0x1ac1d3,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x261e79,_0x3b182b),_0x99870b=await window[_0x36a079(0x261)][_0x36a079(0x98)][_0x36a079(0x1c5)]('raw',_0x261e79),_0x3b6ac1=Math['floor'](Math[_0x36a079(0x1c0)]()*0x40)+0x1,_0x2b400b=window[_0x36a079(0x261)][_0x36a079(0x24a)](new Uint8Array(_0x3b6ac1)),_0xfb750d=new Uint8Array(0x1+_0x1ac1d3['byteLength']+0x4+_0x99870b[_0x36a079(0x1ef)]+0x4+_0xc12352[_0x36a079(0x1ef)]+0x4+_0x3bcf82[_0x36a079(0x1ef)]+_0x10ca03[_0x36a079(0x1ef)]+0x4+_0x496a51[_0x36a079(0x1ef)]+0x1+_0x2b400b[_0x36a079(0x1ef)]);let _0x3099aa=0x0;_0xfb750d[_0x3099aa++]=_0x1ac1d3[_0x36a079(0x1ef)],_0xfb750d['set'](_0x1ac1d3,_0x3099aa),_0x3099aa+=_0x1ac1d3['byteLength'];const _0x2a392a=_0x99870b[_0x36a079(0x1ef)];_0xfb750d[_0x3099aa++]=_0x2a392a>>0x18&0xff,_0xfb750d[_0x3099aa++]=_0x2a392a>>0x10&0xff,_0xfb750d[_0x3099aa++]=_0x2a392a>>0x8&0xff,_0xfb750d[_0x3099aa++]=_0x2a392a&0xff,_0xfb750d[_0x36a079(0x9e)](new Uint8Array(_0x99870b),_0x3099aa),_0x3099aa+=_0x99870b[_0x36a079(0x1ef)];const _0x28faa6=_0xc12352[_0x36a079(0x1ef)];_0xfb750d[_0x3099aa++]=_0x28faa6>>0x18&0xff,_0xfb750d[_0x3099aa++]=_0x28faa6>>0x10&0xff,_0xfb750d[_0x3099aa++]=_0x28faa6>>0x8&0xff,_0xfb750d[_0x3099aa++]=_0x28faa6&0xff,_0xfb750d['set'](new Uint8Array(_0xc12352),_0x3099aa),_0x3099aa+=_0xc12352[_0x36a079(0x1ef)];const _0xe32f1a=_0x3bcf82[_0x36a079(0x1ef)];_0xfb750d[_0x3099aa++]=_0xe32f1a>>0x18&0xff,_0xfb750d[_0x3099aa++]=_0xe32f1a>>0x10&0xff,_0xfb750d[_0x3099aa++]=_0xe32f1a>>0x8&0xff,_0xfb750d[_0x3099aa++]=_0xe32f1a&0xff,_0xfb750d[_0x36a079(0x9e)](new Uint8Array(_0x3bcf82),_0x3099aa),_0x3099aa+=_0x3bcf82['byteLength'],_0xfb750d[_0x36a079(0x9e)](_0x10ca03,_0x3099aa),_0x3099aa+=_0x10ca03[_0x36a079(0x1ef)];const _0x10168e=_0x496a51[_0x36a079(0x1ef)];return _0xfb750d[_0x3099aa++]=_0x10168e>>0x18&0xff,_0xfb750d[_0x3099aa++]=_0x10168e>>0x10&0xff,_0xfb750d[_0x3099aa++]=_0x10168e>>0x8&0xff,_0xfb750d[_0x3099aa++]=_0x10168e&0xff,_0xfb750d[_0x36a079(0x9e)](new Uint8Array(_0x496a51),_0x3099aa),_0x3099aa+=_0x496a51[_0x36a079(0x1ef)],_0xfb750d[_0x3099aa++]=_0x2b400b['byteLength'],_0xfb750d[_0x36a079(0x9e)](_0x2b400b,_0x3099aa),{'version':0x2,'data':arrayBufferToBase64(_0xfb750d[_0x36a079(0x168)])};}async function encryptWithECC(_0x2d1f6e,_0x41b844){const _0x3363d5=_0x558412,_0x42908d=await window[_0x3363d5(0x261)][_0x3363d5(0x98)][_0x3363d5(0x12f)]({'name':_0x3363d5(0xec),'namedCurve':_0x41b844[_0x3363d5(0x22e)]||ECC_CONFIG[_0x3363d5(0x197)]},!![],[_0x3363d5(0x19c),_0x3363d5(0x94)]),_0x4936b7=await window[_0x3363d5(0x261)]['subtle'][_0x3363d5(0x1c5)](_0x3363d5(0x15f),_0x42908d['publicKey']);let _0x4ee8b1;if(_0x41b844['_publicKey'])_0x4ee8b1=_0x41b844['_publicKey'];else{const _0x5dd3a3=base64ToArrayBuffer(_0x41b844[_0x3363d5(0x254)]);_0x4ee8b1=await importECCPublicKey(_0x5dd3a3,_0x41b844['curve']||ECC_CONFIG['CURVE']);}const _0x116de3=window['crypto']['getRandomValues'](new Uint8Array(AES_CONFIG[_0x3363d5(0x20d)])),_0x4ed43c=await window[_0x3363d5(0x261)][_0x3363d5(0x98)][_0x3363d5(0x94)]({'name':_0x3363d5(0xec),'public':_0x4ee8b1},_0x42908d[_0x3363d5(0x113)],0x100),_0x5b50f2=await window[_0x3363d5(0x261)]['subtle'][_0x3363d5(0xb7)](_0x3363d5(0x257),_0x4ed43c,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG[_0x3363d5(0xae)]},![],[_0x3363d5(0x1ec)]),_0x453c8c=await window[_0x3363d5(0x261)][_0x3363d5(0x98)][_0x3363d5(0x1ec)]({'name':AES_CONFIG[_0x3363d5(0x21d)],'iv':_0x116de3,'tagLength':AES_CONFIG[_0x3363d5(0x102)]},_0x5b50f2,_0x2d1f6e),_0x1f7d1c={'a':_0x3363d5(0x12d)+AES_CONFIG['MODE'],'k':_0x41b844['id'],'t':new Date()[_0x3363d5(0x249)](),'c':_0x41b844[_0x3363d5(0x22e)]||ECC_CONFIG[_0x3363d5(0x197)]};encryptFileData&&encryptFileName&&(_0x1f7d1c['f']={'n':encryptFileName,'s':encryptFileData[_0x3363d5(0x1ef)]});const _0x5d540c=new TextEncoder()['encode'](JSON['stringify'](_0x1f7d1c)),_0x49c2e5=await window[_0x3363d5(0x261)][_0x3363d5(0x98)][_0x3363d5(0x12f)]({'name':AES_CONFIG[_0x3363d5(0x21d)],'length':AES_CONFIG[_0x3363d5(0xae)]},!![],[_0x3363d5(0x1ec),_0x3363d5(0x125)]),_0x46339f=window[_0x3363d5(0x261)][_0x3363d5(0x24a)](new Uint8Array(AES_CONFIG[_0x3363d5(0x20d)])),_0xedf07f=await window[_0x3363d5(0x261)][_0x3363d5(0x98)]['encrypt']({'name':AES_CONFIG[_0x3363d5(0x21d)],'iv':_0x46339f,'tagLength':AES_CONFIG[_0x3363d5(0x102)]},_0x49c2e5,_0x5d540c),_0x37feb4=await window['crypto'][_0x3363d5(0x98)]['exportKey'](_0x3363d5(0x257),_0x49c2e5),_0x1b5381=Math[_0x3363d5(0x1fa)](Math['random']()*0x40)+0x1,_0x36fd21=window[_0x3363d5(0x261)][_0x3363d5(0x24a)](new Uint8Array(_0x1b5381)),_0x2658aa=new Uint8Array(0x1+_0x46339f[_0x3363d5(0x1ef)]+0x4+_0x37feb4[_0x3363d5(0x1ef)]+0x4+_0xedf07f['byteLength']+0x4+_0x4936b7[_0x3363d5(0x1ef)]+_0x116de3[_0x3363d5(0x1ef)]+0x4+_0x453c8c[_0x3363d5(0x1ef)]+0x1+_0x36fd21['byteLength']);let _0x52374e=0x0;_0x2658aa[_0x52374e++]=_0x46339f[_0x3363d5(0x1ef)],_0x2658aa[_0x3363d5(0x9e)](_0x46339f,_0x52374e),_0x52374e+=_0x46339f[_0x3363d5(0x1ef)];const _0x38b7ea=_0x37feb4[_0x3363d5(0x1ef)];_0x2658aa[_0x52374e++]=_0x38b7ea>>0x18&0xff,_0x2658aa[_0x52374e++]=_0x38b7ea>>0x10&0xff,_0x2658aa[_0x52374e++]=_0x38b7ea>>0x8&0xff,_0x2658aa[_0x52374e++]=_0x38b7ea&0xff,_0x2658aa[_0x3363d5(0x9e)](new Uint8Array(_0x37feb4),_0x52374e),_0x52374e+=_0x37feb4[_0x3363d5(0x1ef)];const _0x3fce33=_0xedf07f[_0x3363d5(0x1ef)];_0x2658aa[_0x52374e++]=_0x3fce33>>0x18&0xff,_0x2658aa[_0x52374e++]=_0x3fce33>>0x10&0xff,_0x2658aa[_0x52374e++]=_0x3fce33>>0x8&0xff,_0x2658aa[_0x52374e++]=_0x3fce33&0xff,_0x2658aa[_0x3363d5(0x9e)](new Uint8Array(_0xedf07f),_0x52374e),_0x52374e+=_0xedf07f[_0x3363d5(0x1ef)];const _0x15f71f=_0x4936b7[_0x3363d5(0x1ef)];_0x2658aa[_0x52374e++]=_0x15f71f>>0x18&0xff,_0x2658aa[_0x52374e++]=_0x15f71f>>0x10&0xff,_0x2658aa[_0x52374e++]=_0x15f71f>>0x8&0xff,_0x2658aa[_0x52374e++]=_0x15f71f&0xff,_0x2658aa[_0x3363d5(0x9e)](new Uint8Array(_0x4936b7),_0x52374e),_0x52374e+=_0x4936b7[_0x3363d5(0x1ef)],_0x2658aa[_0x3363d5(0x9e)](_0x116de3,_0x52374e),_0x52374e+=_0x116de3[_0x3363d5(0x1ef)];const _0x52c11e=_0x453c8c['byteLength'];return _0x2658aa[_0x52374e++]=_0x52c11e>>0x18&0xff,_0x2658aa[_0x52374e++]=_0x52c11e>>0x10&0xff,_0x2658aa[_0x52374e++]=_0x52c11e>>0x8&0xff,_0x2658aa[_0x52374e++]=_0x52c11e&0xff,_0x2658aa[_0x3363d5(0x9e)](new Uint8Array(_0x453c8c),_0x52374e),_0x52374e+=_0x453c8c[_0x3363d5(0x1ef)],_0x2658aa[_0x52374e++]=_0x36fd21[_0x3363d5(0x1ef)],_0x2658aa[_0x3363d5(0x9e)](_0x36fd21,_0x52374e),{'version':0x2,'data':arrayBufferToBase64(_0x2658aa[_0x3363d5(0x168)])};}async function decryptMessage(){const _0x2df73d=_0x558412;try{let _0x592326;const _0x459405=document[_0x2df73d(0x16b)](_0x2df73d(0x17e))[_0x2df73d(0x1f4)],_0x3b3afa=document[_0x2df73d(0x16b)]('decryptObfKey')[_0x2df73d(0x1f4)];if(!_0x459405){showStatus('decryptStatus',_0x2df73d(0x96),_0x2df73d(0x182));return;}if(!isValidEncryptedMessage(_0x459405,_0x3b3afa)){showStatus(_0x2df73d(0xe4),_0x2df73d(0x175),_0x2df73d(0x182));return;}try{_0x592326=parseEncryptedMessage(_0x459405,_0x3b3afa);}catch(_0x12a5b6){showStatus(_0x2df73d(0xe4),_0x2df73d(0x104)+_0x12a5b6[_0x2df73d(0x1ee)],_0x2df73d(0x182));return;}const _0x5a1fe0=document[_0x2df73d(0x16b)](_0x2df73d(0x213))[_0x2df73d(0x1f4)],_0x21a00e=document[_0x2df73d(0x16b)](_0x2df73d(0xdc))[_0x2df73d(0x1f4)];if(!_0x5a1fe0){showStatus(_0x2df73d(0xe4),_0x2df73d(0x247),_0x2df73d(0x182));return;}setLoading(!![]);const _0x48a760=keys[_0x2df73d(0x246)](_0xa89cab=>_0xa89cab['id']===_0x5a1fe0);if(!_0x48a760){showStatus(_0x2df73d(0xe4),'Key\x20not\x20found',_0x2df73d(0x182)),setLoading(![]);return;}let _0x1f99ad=null,_0x213e33=_0x48a760;if(_0x48a760[_0x2df73d(0x1e8)]){if(!_0x21a00e){showStatus(_0x2df73d(0xe4),_0x2df73d(0x1fc),_0x2df73d(0x182)),setLoading(![]);return;}try{_0x1f99ad=await decryptKeyWithPassword(_0x48a760,_0x21a00e),_0x213e33=safeMemory[_0x2df73d(0x23e)](_0x1f99ad);if(!_0x213e33)throw new Error('Failed\x20to\x20retrieve\x20decrypted\x20key\x20from\x20memory.');}catch(_0x108d65){showStatus(_0x2df73d(0xe4),_0x2df73d(0x1a3)+_0x108d65[_0x2df73d(0x1ee)],_0x2df73d(0x182)),setLoading(![]);return;}}let _0x51c910=await decryptData(_0x592326,_0x213e33),_0x1a09ba,_0x3013eb;_0x51c910[_0x2df73d(0x150)]?(_0x1a09ba=_0x51c910['data'],_0x3013eb=_0x51c910[_0x2df73d(0x225)]):(_0x1a09ba=_0x51c910,_0x3013eb=null);_0x1f99ad&&safeMemory['delete'](_0x1f99ad);_0x3b3afa&&(_0x1a09ba=xorCipher(_0x1a09ba,_0x3b3afa));let _0x4906e1=![],_0x18eb51=null,_0x16da5a=null;if(!_0x592326[_0x2df73d(0x203)]&&_0x592326[_0x2df73d(0x18d)]&&_0x592326[_0x2df73d(0x215)])_0x4906e1=!![],_0x18eb51=_0x592326[_0x2df73d(0x215)],_0x16da5a=_0x592326[_0x2df73d(0x229)]||_0x1a09ba[_0x2df73d(0x1ef)];else _0x3013eb&&_0x3013eb['f']&&(_0x4906e1=!![],_0x18eb51=_0x3013eb['f']['n'],_0x16da5a=_0x3013eb['f']['s']||_0x1a09ba[_0x2df73d(0x1ef)]);if(_0x4906e1)document[_0x2df73d(0x16b)](_0x2df73d(0x1a9))[_0x2df73d(0x1f4)]=_0x2df73d(0x9d)+_0x18eb51+'\x20('+formatFileSize(_0x16da5a)+')',document[_0x2df73d(0x16b)](_0x2df73d(0x1ed))[_0x2df73d(0xc5)](_0x2df73d(0x158),_0x18eb51),document['getElementById'](_0x2df73d(0x1ed))[_0x2df73d(0xc5)](_0x2df73d(0x1f6),_0x2df73d(0x1b5)),window['decryptedBinaryData']=_0x1a09ba;else{const _0x5b7835=new TextDecoder()['decode'](_0x1a09ba);document[_0x2df73d(0x16b)](_0x2df73d(0x1a9))['value']=_0x5b7835,document[_0x2df73d(0x16b)]('downloadDecryptedBtn')[_0x2df73d(0xc5)](_0x2df73d(0x158),_0x2df73d(0x192)),document[_0x2df73d(0x16b)](_0x2df73d(0x1ed))[_0x2df73d(0xc5)](_0x2df73d(0x1f6),_0x2df73d(0x18b)),window['decryptedBinaryData']=null;}showStatus(_0x2df73d(0xe4),'Message\x20decrypted\x20successfully',_0x2df73d(0x105));}catch(_0x35df18){console['error'](_0x2df73d(0x156),_0x35df18),showStatus(_0x2df73d(0xe4),_0x2df73d(0xca)+_0x35df18[_0x2df73d(0x1ee)],_0x2df73d(0x182));}finally{document['getElementById'](_0x2df73d(0xdc))[_0x2df73d(0x1f4)]='',setLoading(![]);}}async function decryptWithAES(_0x1af7a5,_0x1c3a10){const _0x88ed2f=_0x558412;try{const _0x5229b7=base64ToArrayBuffer(_0x1af7a5['data']),_0x230c71=new Uint8Array(_0x5229b7);let _0x2e6148=0x0;const _0x3c334d=_0x230c71[_0x2e6148++];if(_0x3c334d!==0x3)throw new Error(_0x88ed2f(0x18e));const _0x5787e4=_0x230c71['slice'](_0x2e6148,_0x2e6148+AES_CONFIG[_0x88ed2f(0x20d)]);_0x2e6148+=AES_CONFIG[_0x88ed2f(0x20d)];const _0x50e0c8=_0x230c71[_0x2e6148]<<0x18|_0x230c71[_0x2e6148+0x1]<<0x10|_0x230c71[_0x2e6148+0x2]<<0x8|_0x230c71[_0x2e6148+0x3];_0x2e6148+=0x4;const _0x4866db=_0x230c71['slice'](_0x2e6148,_0x2e6148+_0x50e0c8);_0x2e6148+=_0x50e0c8;const _0x142859=_0x230c71[_0x2e6148]<<0x18|_0x230c71[_0x2e6148+0x1]<<0x10|_0x230c71[_0x2e6148+0x2]<<0x8|_0x230c71[_0x2e6148+0x3];_0x2e6148+=0x4;const _0x148fa0=_0x230c71['slice'](_0x2e6148,_0x2e6148+_0x142859);_0x2e6148+=_0x142859;const _0x59fe15=_0x230c71[_0x88ed2f(0x1eb)](_0x2e6148,_0x2e6148+AES_CONFIG[_0x88ed2f(0x20d)]);_0x2e6148+=AES_CONFIG['IV_LENGTH'];const _0x211b0d=_0x230c71[_0x2e6148]<<0x18|_0x230c71[_0x2e6148+0x1]<<0x10|_0x230c71[_0x2e6148+0x2]<<0x8|_0x230c71[_0x2e6148+0x3];_0x2e6148+=0x4;const _0x52a7c3=_0x230c71[_0x88ed2f(0x1eb)](_0x2e6148,_0x2e6148+_0x211b0d),_0x591705=await window[_0x88ed2f(0x261)][_0x88ed2f(0x98)][_0x88ed2f(0xb7)](_0x88ed2f(0x257),_0x4866db,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG[_0x88ed2f(0xae)]},![],[_0x88ed2f(0x125)]),_0x3d981e=await window[_0x88ed2f(0x261)][_0x88ed2f(0x98)][_0x88ed2f(0x125)]({'name':AES_CONFIG['MODE'],'iv':_0x5787e4,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x591705,_0x148fa0),_0x4010a2=new TextDecoder()[_0x88ed2f(0x1ff)](_0x3d981e),_0x4064a8=JSON[_0x88ed2f(0xfa)](_0x4010a2);if(_0x4064a8['k']!==_0x1c3a10['id'])throw new Error(_0x88ed2f(0x139));let _0x589fb5;if(_0x1c3a10['_cryptoKey'])_0x589fb5=_0x1c3a10[_0x88ed2f(0xbe)];else{const _0x535780=base64ToArrayBuffer(_0x1c3a10[_0x88ed2f(0x109)]);_0x589fb5=await window[_0x88ed2f(0x261)]['subtle']['importKey'](_0x88ed2f(0x257),_0x535780,{'name':AES_CONFIG[_0x88ed2f(0x21d)],'length':AES_CONFIG[_0x88ed2f(0xae)]},![],[_0x88ed2f(0x125)]);}return{'data':await window['crypto'][_0x88ed2f(0x98)][_0x88ed2f(0x125)]({'name':AES_CONFIG[_0x88ed2f(0x21d)],'iv':_0x59fe15,'tagLength':AES_CONFIG[_0x88ed2f(0x102)]},_0x589fb5,_0x52a7c3),'metadata':_0x4064a8};}catch(_0x537361){console['error']('AES\x20Decryption\x20error:',_0x537361);if(_0x537361 instanceof DOMException)throw new Error(_0x88ed2f(0x11f)+_0x537361[_0x88ed2f(0xe7)]+'\x20-\x20'+(_0x537361[_0x88ed2f(0x1ee)]||'Unknown\x20WebCrypto\x20error'));else throw new Error(_0x88ed2f(0x11f)+_0x537361[_0x88ed2f(0x1ee)]);}}function isValidEncryptedMessage(_0xf6b015,_0x1bd161=''){const _0xdc96f=_0x558412;let _0x368f45=SECURE_DELIMITER,_0x52bb6e=reverseString(SECURE_DELIMITER);const _0x145c52='@!',_0x5ec51b='!@',_0x52d930=escapeRegex(_0x368f45),_0x3f3ba1=escapeRegex(_0x52bb6e),_0x1a8586=escapeRegex(_0x145c52),_0x133eba=escapeRegex(_0x5ec51b),_0x28eb9d='^.*?('+_0x52d930+'|'+_0x1a8586+_0xdc96f(0x1db)+_0x3f3ba1+'|'+_0x133eba+_0xdc96f(0x21a),_0x37ec96=new RegExp(_0x28eb9d);return _0x37ec96[_0xdc96f(0x12c)](_0xf6b015);}function createEncryptedMessageString(_0x519253,_0x3a6da6=''){const _0x2b73e2=_0x558412,_0x39788d=SECURE_DELIMITER,_0x485627=reverseString(SECURE_DELIMITER),_0x4ca2cf=generateRandomString(0x20+Math['floor'](Math[_0x2b73e2(0x1c0)]()*0x21)),_0x3ef211=generateRandomString(0x20+Math[_0x2b73e2(0x1fa)](Math[_0x2b73e2(0x1c0)]()*0x21)),_0x2f9540=typeof _0x519253[_0x2b73e2(0x150)]===_0x2b73e2(0xeb)?_0x519253['data']['replace'](/[\r\n\s]*(.*?)[\r\n\s]*$/s,'$1'):_0x519253[_0x2b73e2(0x150)];return _0x4ca2cf+_0x39788d+_0x2f9540+_0x485627+_0x3ef211;}function parseEncryptedMessage(_0xa1d016,_0x25c23a=''){const _0x1a2cf7=_0x558412,_0x45543e=SECURE_DELIMITER,_0x436d82=reverseString(SECURE_DELIMITER),_0x39274e='@!',_0x37b267='!@',_0x240770=escapeRegex(_0x45543e),_0x40be12=escapeRegex(_0x436d82),_0x29247c=escapeRegex(_0x39274e),_0x234269=escapeRegex(_0x37b267),_0x28360e=_0x1a2cf7(0x97)+_0x240770+'|'+_0x29247c+_0x1a2cf7(0x20f)+_0x40be12+'|'+_0x234269+_0x1a2cf7(0x21a),_0x1ebd31=new RegExp(_0x28360e),_0x4e2e2f=_0xa1d016[_0x1a2cf7(0x126)](_0x1ebd31);if(!_0x4e2e2f||!_0x4e2e2f[0x2])throw new Error(_0x1a2cf7(0x250));const _0x27b467=_0x4e2e2f[0x2]['trim']();return{'version':0x2,'data':_0x27b467};}function updateEncryptionOutput(_0x18b564){return createEncryptedMessageString(_0x18b564);}function generateRandomString(_0x548d8b=0x5){const _0x2a486a=_0x558412,_0xe2f270=_0x2a486a(0xfb);let _0x2c23e9='';for(let _0x441d47=0x0;_0x441d47<_0x548d8b;_0x441d47++){_0x2c23e9+=_0xe2f270[_0x2a486a(0xe8)](Math['floor'](Math[_0x2a486a(0x1c0)]()*_0xe2f270[_0x2a486a(0x18c)]));}return _0x2c23e9;}function determineKeySecurityLevel(_0x30582d){const _0x16701c=_0x558412;let _0xccf079=_0x16701c(0x92);if(_0x30582d[_0x16701c(0x142)]===_0x16701c(0xb8)||_0x30582d['type']===_0x16701c(0x10d)||_0x30582d['type']===_0x16701c(0x15d))_0xccf079=_0x16701c(0xcc);else(_0x30582d['type']===_0x16701c(0x228)||_0x30582d['type']===_0x16701c(0x1cc))&&(_0xccf079=_0x16701c(0x92));let _0x416ead=0x0;_0x30582d[_0x16701c(0x1e8)]&&(_0x416ead+=0x2);_0x30582d['type']!==_0x16701c(0xb8)&&(_0x30582d['hasPublic']&&_0x30582d['hasPrivate']&&(_0x416ead+=0x1));_0x30582d['expiry']&&(_0x416ead+=0x1);let _0x5f26e8;if(_0xccf079==='medium'){if(_0x416ead>=0x3)_0x5f26e8=_0x16701c(0x23b);else _0x416ead>=0x1?_0x5f26e8=_0x16701c(0xcc):_0x5f26e8=_0x16701c(0x92);}else{if(_0x416ead>=0x4)_0x5f26e8=_0x16701c(0x23b);else _0x416ead>=0x2?_0x5f26e8=_0x16701c(0xcc):_0x5f26e8=_0x16701c(0x92);}return _0x5f26e8;}async function decryptWithRSA(_0x23e21d,_0x3935a6){const _0x5c9fe3=_0x558412;if(!_0x23e21d['version']||_0x23e21d[_0x5c9fe3(0x203)]===0x1){const _0xef958b=base64ToArrayBuffer(_0x23e21d[_0x5c9fe3(0x150)]),_0x586a9c=base64ToArrayBuffer(_0x23e21d[_0x5c9fe3(0x133)]),_0x224ea4=base64ToArrayBuffer(_0x23e21d['iv']);let _0xd1275b;if(_0x3935a6[_0x5c9fe3(0x1a4)])_0xd1275b=_0x3935a6[_0x5c9fe3(0x1a4)];else{const _0x471f55=base64ToArrayBuffer(_0x3935a6['privateKey']);_0xd1275b=await importRSAPrivateKey(_0x471f55,_0x23e21d[_0x5c9fe3(0x171)]||_0x3935a6[_0x5c9fe3(0x18c)]||RSA_CONFIG[_0x5c9fe3(0x103)]);}const _0x4c5c5c=await window[_0x5c9fe3(0x261)][_0x5c9fe3(0x98)][_0x5c9fe3(0x125)]({'name':RSA_CONFIG[_0x5c9fe3(0x243)]},_0xd1275b,_0x586a9c),_0x11df39=await importAESKey(_0x4c5c5c);return await window[_0x5c9fe3(0x261)][_0x5c9fe3(0x98)][_0x5c9fe3(0x125)]({'name':AES_CONFIG['MODE'],'iv':_0x224ea4,'tagLength':AES_CONFIG[_0x5c9fe3(0x102)]},_0x11df39,_0xef958b);}else{const _0x2e5329=base64ToArrayBuffer(_0x23e21d[_0x5c9fe3(0x150)]),_0x46afb4=new Uint8Array(_0x2e5329);let _0x180c5e=0x0;const _0x1c22d3=_0x46afb4[_0x180c5e++],_0x29a34b=_0x46afb4[_0x5c9fe3(0x1eb)](_0x180c5e,_0x180c5e+_0x1c22d3);_0x180c5e+=_0x1c22d3;const _0x94177d=_0x46afb4[_0x180c5e]<<0x18|_0x46afb4[_0x180c5e+0x1]<<0x10|_0x46afb4[_0x180c5e+0x2]<<0x8|_0x46afb4[_0x180c5e+0x3];_0x180c5e+=0x4;const _0x10e1cd=_0x46afb4[_0x5c9fe3(0x1eb)](_0x180c5e,_0x180c5e+_0x94177d);_0x180c5e+=_0x94177d;const _0x516220=_0x46afb4[_0x180c5e]<<0x18|_0x46afb4[_0x180c5e+0x1]<<0x10|_0x46afb4[_0x180c5e+0x2]<<0x8|_0x46afb4[_0x180c5e+0x3];_0x180c5e+=0x4;const _0x562138=_0x46afb4['slice'](_0x180c5e,_0x180c5e+_0x516220);_0x180c5e+=_0x516220;const _0x16a462=_0x46afb4[_0x180c5e]<<0x18|_0x46afb4[_0x180c5e+0x1]<<0x10|_0x46afb4[_0x180c5e+0x2]<<0x8|_0x46afb4[_0x180c5e+0x3];_0x180c5e+=0x4;const _0x272c2c=_0x46afb4[_0x5c9fe3(0x1eb)](_0x180c5e,_0x180c5e+_0x16a462);_0x180c5e+=_0x16a462;const _0x5b4e1b=_0x46afb4[_0x5c9fe3(0x1eb)](_0x180c5e,_0x180c5e+AES_CONFIG['IV_LENGTH']);_0x180c5e+=AES_CONFIG['IV_LENGTH'];const _0x1e50ae=_0x46afb4[_0x180c5e]<<0x18|_0x46afb4[_0x180c5e+0x1]<<0x10|_0x46afb4[_0x180c5e+0x2]<<0x8|_0x46afb4[_0x180c5e+0x3];_0x180c5e+=0x4;const _0x53933c=_0x46afb4[_0x5c9fe3(0x1eb)](_0x180c5e,_0x180c5e+_0x1e50ae);let _0x17a910;if(_0x3935a6['_privateKey'])_0x17a910=_0x3935a6['_privateKey'];else{const _0x51c05c=base64ToArrayBuffer(_0x3935a6[_0x5c9fe3(0x113)]);_0x17a910=await importRSAPrivateKey(_0x51c05c,_0x3935a6['length']||RSA_CONFIG[_0x5c9fe3(0x103)]);}const _0x2585f7=await window[_0x5c9fe3(0x261)][_0x5c9fe3(0x98)]['decrypt']({'name':RSA_CONFIG[_0x5c9fe3(0x243)]},_0x17a910,_0x272c2c),_0x568c02=await window[_0x5c9fe3(0x261)][_0x5c9fe3(0x98)][_0x5c9fe3(0xb7)](_0x5c9fe3(0x257),_0x10e1cd,{'name':AES_CONFIG[_0x5c9fe3(0x21d)],'length':_0x94177d*0x8},![],[_0x5c9fe3(0x125)]),_0x503bbf=await window[_0x5c9fe3(0x261)][_0x5c9fe3(0x98)]['decrypt']({'name':AES_CONFIG[_0x5c9fe3(0x21d)],'iv':_0x29a34b,'tagLength':AES_CONFIG[_0x5c9fe3(0x102)]},_0x568c02,_0x562138),_0x22a5b9=new TextDecoder()[_0x5c9fe3(0x1ff)](_0x503bbf),_0x151a93=JSON[_0x5c9fe3(0xfa)](_0x22a5b9);if(_0x151a93['k']!==_0x3935a6['id'])throw new Error('Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message');const _0x383c13=await importAESKey(_0x2585f7);return{'data':await window[_0x5c9fe3(0x261)][_0x5c9fe3(0x98)][_0x5c9fe3(0x125)]({'name':AES_CONFIG[_0x5c9fe3(0x21d)],'iv':_0x5b4e1b,'tagLength':AES_CONFIG[_0x5c9fe3(0x102)]},_0x383c13,_0x53933c),'metadata':_0x151a93};}}async function decryptWithECC(_0x154da0,_0x598277){const _0x5bda66=_0x558412;if(!_0x154da0['version']||_0x154da0[_0x5bda66(0x203)]===0x1){const _0x164919=base64ToArrayBuffer(_0x154da0[_0x5bda66(0x150)]),_0x4188aa=base64ToArrayBuffer(_0x154da0['ephemeralPublicKey']),_0x512e19=base64ToArrayBuffer(_0x154da0['iv']),_0x4094e1=await importECCPublicKey(_0x4188aa,_0x154da0['curve']||ECC_CONFIG[_0x5bda66(0x197)]);let _0x42b2af;if(_0x598277[_0x5bda66(0x1a4)])_0x42b2af=_0x598277[_0x5bda66(0x1a4)];else{const _0x5f0b20=base64ToArrayBuffer(_0x598277[_0x5bda66(0x113)]);_0x42b2af=await importECCPrivateKey(_0x5f0b20,_0x154da0[_0x5bda66(0x22e)]||ECC_CONFIG[_0x5bda66(0x197)]);}const _0x556c4c=await window[_0x5bda66(0x261)][_0x5bda66(0x98)][_0x5bda66(0x19c)]({'name':_0x5bda66(0xec),'public':_0x4094e1},_0x42b2af,{'name':AES_CONFIG[_0x5bda66(0x21d)],'length':AES_CONFIG[_0x5bda66(0xae)]},![],['decrypt']);return await window[_0x5bda66(0x261)]['subtle']['decrypt']({'name':AES_CONFIG[_0x5bda66(0x21d)],'iv':_0x512e19,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x556c4c,_0x164919);}else{const _0x467dcc=base64ToArrayBuffer(_0x154da0[_0x5bda66(0x150)]),_0xc6a5bf=new Uint8Array(_0x467dcc);let _0x2fe7cb=0x0;const _0xfe0679=_0xc6a5bf[_0x2fe7cb++],_0x4dcf4b=_0xc6a5bf[_0x5bda66(0x1eb)](_0x2fe7cb,_0x2fe7cb+_0xfe0679);_0x2fe7cb+=_0xfe0679;const _0x4a326f=_0xc6a5bf[_0x2fe7cb]<<0x18|_0xc6a5bf[_0x2fe7cb+0x1]<<0x10|_0xc6a5bf[_0x2fe7cb+0x2]<<0x8|_0xc6a5bf[_0x2fe7cb+0x3];_0x2fe7cb+=0x4;const _0x2b6287=_0xc6a5bf[_0x5bda66(0x1eb)](_0x2fe7cb,_0x2fe7cb+_0x4a326f);_0x2fe7cb+=_0x4a326f;const _0x36994e=_0xc6a5bf[_0x2fe7cb]<<0x18|_0xc6a5bf[_0x2fe7cb+0x1]<<0x10|_0xc6a5bf[_0x2fe7cb+0x2]<<0x8|_0xc6a5bf[_0x2fe7cb+0x3];_0x2fe7cb+=0x4;const _0x5ad32b=_0xc6a5bf[_0x5bda66(0x1eb)](_0x2fe7cb,_0x2fe7cb+_0x36994e);_0x2fe7cb+=_0x36994e;const _0x7a8b8a=_0xc6a5bf[_0x2fe7cb]<<0x18|_0xc6a5bf[_0x2fe7cb+0x1]<<0x10|_0xc6a5bf[_0x2fe7cb+0x2]<<0x8|_0xc6a5bf[_0x2fe7cb+0x3];_0x2fe7cb+=0x4;const _0x28ebaf=_0xc6a5bf[_0x5bda66(0x1eb)](_0x2fe7cb,_0x2fe7cb+_0x7a8b8a);_0x2fe7cb+=_0x7a8b8a;const _0x409b8f=_0xc6a5bf[_0x5bda66(0x1eb)](_0x2fe7cb,_0x2fe7cb+AES_CONFIG[_0x5bda66(0x20d)]);_0x2fe7cb+=AES_CONFIG[_0x5bda66(0x20d)];const _0x2e8304=_0xc6a5bf[_0x2fe7cb]<<0x18|_0xc6a5bf[_0x2fe7cb+0x1]<<0x10|_0xc6a5bf[_0x2fe7cb+0x2]<<0x8|_0xc6a5bf[_0x2fe7cb+0x3];_0x2fe7cb+=0x4;const _0x21312c=_0xc6a5bf['slice'](_0x2fe7cb,_0x2fe7cb+_0x2e8304),_0x5c2f78=await importECCPublicKey(_0x28ebaf,_0x598277[_0x5bda66(0x22e)]||ECC_CONFIG[_0x5bda66(0x197)]);let _0x76e848;if(_0x598277['_privateKey'])_0x76e848=_0x598277['_privateKey'];else{const _0x6b79db=base64ToArrayBuffer(_0x598277[_0x5bda66(0x113)]);_0x76e848=await importECCPrivateKey(_0x6b79db,_0x598277[_0x5bda66(0x22e)]||ECC_CONFIG['CURVE']);}const _0x33e60d=await window[_0x5bda66(0x261)][_0x5bda66(0x98)][_0x5bda66(0x94)]({'name':_0x5bda66(0xec),'public':_0x5c2f78},_0x76e848,0x100),_0x35bfde=await window[_0x5bda66(0x261)][_0x5bda66(0x98)][_0x5bda66(0xb7)]('raw',_0x33e60d,{'name':AES_CONFIG[_0x5bda66(0x21d)],'length':AES_CONFIG['KEY_LENGTH']},![],['decrypt']),_0x25d62d=await window[_0x5bda66(0x261)]['subtle']['importKey'](_0x5bda66(0x257),_0x2b6287,{'name':AES_CONFIG['MODE'],'length':_0x4a326f*0x8},![],[_0x5bda66(0x125)]),_0x2efaf6=await window[_0x5bda66(0x261)]['subtle'][_0x5bda66(0x125)]({'name':AES_CONFIG[_0x5bda66(0x21d)],'iv':_0x4dcf4b,'tagLength':AES_CONFIG[_0x5bda66(0x102)]},_0x25d62d,_0x5ad32b),_0x521322=new TextDecoder()[_0x5bda66(0x1ff)](_0x2efaf6),_0x50e734=JSON['parse'](_0x521322);if(_0x50e734['k']!==_0x598277['id'])throw new Error(_0x5bda66(0x139));return{'data':await window['crypto'][_0x5bda66(0x98)][_0x5bda66(0x125)]({'name':AES_CONFIG[_0x5bda66(0x21d)],'iv':_0x409b8f,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x35bfde,_0x21312c),'metadata':_0x50e734};}}function reverseString(_0x4134c4){const _0x3e1738=_0x558412;if(typeof _0x4134c4!==_0x3e1738(0xeb))return'';return _0x4134c4['split']('')['reverse']()['join']('');}function downloadEncryptedFile(){const _0x4d2459=_0x558412,_0x369957=document[_0x4d2459(0x16b)]('encryptedOutput')[_0x4d2459(0x1f4)];if(!_0x369957){showStatus(_0x4d2459(0x24c),_0x4d2459(0x24b),_0x4d2459(0x182));return;}const _0x3b3903=document[_0x4d2459(0x16b)](_0x4d2459(0x9a))[_0x4d2459(0x245)](_0x4d2459(0x158))||generateRandomFileName(0x6)+_0x4d2459(0x20e),_0x1f7af5=new Blob([_0x369957],{'type':_0x4d2459(0x1f2)});downloadBlob(_0x1f7af5,_0x3b3903),showStatus(_0x4d2459(0x24c),'File\x20\x22'+_0x3b3903+'\x22\x20downloaded\x20successfully',_0x4d2459(0x105));}function downloadDecryptedFile(){const _0x10f331=_0x558412;if(window[_0x10f331(0x19f)]){const _0x1112bf=document[_0x10f331(0x16b)](_0x10f331(0x1ed))[_0x10f331(0x245)]('data-filename')||_0x10f331(0x12a),_0x1465bb=new Blob([window['decryptedBinaryData']],{'type':_0x10f331(0x1f2)});downloadBlob(_0x1465bb,_0x1112bf);}else{const _0x28051a=document[_0x10f331(0x16b)]('decryptedOutput')[_0x10f331(0x1f4)];if(!_0x28051a){showStatus(_0x10f331(0xe4),_0x10f331(0x138),_0x10f331(0x182));return;}const _0x1ad3b1=document[_0x10f331(0x16b)](_0x10f331(0x1ed))[_0x10f331(0x245)]('data-filename')||_0x10f331(0x192),_0x120c4d=new Blob([_0x28051a],{'type':_0x10f331(0x1f2)});downloadBlob(_0x120c4d,_0x1ad3b1);}showStatus(_0x10f331(0xe4),'File\x20downloaded\x20successfully',_0x10f331(0x105));}function downloadBlob(_0x1cdee2,_0x1b8e58){const _0x267ab6=_0x558412,_0x4c963f=URL[_0x267ab6(0x12e)](_0x1cdee2),_0x3a19c1=document[_0x267ab6(0x19d)]('a');_0x3a19c1[_0x267ab6(0x1b2)]=_0x4c963f,_0x3a19c1['download']=_0x1b8e58,document[_0x267ab6(0x134)]['appendChild'](_0x3a19c1),_0x3a19c1[_0x267ab6(0x8e)](),document[_0x267ab6(0x134)][_0x267ab6(0xac)](_0x3a19c1),URL[_0x267ab6(0x24e)](_0x4c963f);}function importKey(){const _0x524e8c=_0x558412,_0xde4982=createKeyFileInput();_0xde4982[_0x524e8c(0x8e)]();}function _0xb415(_0x26322a,_0x170c82){const _0x539083=_0x5390();return _0xb415=function(_0xb41509,_0x9a25f6){_0xb41509=_0xb41509-0x88;let _0x4b8e71=_0x539083[_0xb41509];return _0x4b8e71;},_0xb415(_0x26322a,_0x170c82);}async function exportKey(_0x5bbe77,_0x367783=![]){const _0x895e25=_0x558412;try{const _0x8f9bc6=keys['find'](_0x5055fa=>_0x5055fa['id']===_0x5bbe77);if(!_0x8f9bc6){alert(_0x895e25(0x148));return;}const _0x59244f=_0x8f9bc6[_0x895e25(0x142)]===_0x895e25(0x228)||_0x8f9bc6[_0x895e25(0x142)]==='rsa-4096'||_0x8f9bc6[_0x895e25(0x142)]===_0x895e25(0x1cc)||_0x8f9bc6[_0x895e25(0x142)]==='ecc-p384';let _0x4f5a0a=_0x8f9bc6,_0x4c3c62=_0x895e25(0xe2);if(_0x59244f&&_0x367783){let _0x1f4ef5='';try{_0x1f4ef5=await showPasswordModal('Secure\x20Your\x20Private\x20Key',_0x895e25(0x88),!![]);}catch(_0x13d333){return;}if(!_0x1f4ef5){if(!confirm(_0x895e25(0x202)))return;}_0x4f5a0a={'id':_0x8f9bc6['id'],'name':_0x8f9bc6['name'],'type':_0x8f9bc6['type'],'created':_0x8f9bc6[_0x895e25(0x1b0)],'expiry':_0x8f9bc6[_0x895e25(0x14a)],'privateKey':_0x8f9bc6[_0x895e25(0x113)],'protected':_0x8f9bc6['protected'],'salt':_0x8f9bc6[_0x895e25(0x1d5)],'iv':_0x8f9bc6['iv'],'algorithm':_0x8f9bc6[_0x895e25(0x1f9)],'hasPrivate':!![],'hasPublic':![],'pairedKeyId':_0x8f9bc6['id'],'publicKeyHash':_0x8f9bc6['publicKeyHash']};if(_0x8f9bc6[_0x895e25(0x142)]==='rsa'||_0x8f9bc6[_0x895e25(0x142)]===_0x895e25(0x10d))_0x4f5a0a['length']=_0x8f9bc6['length'];else(_0x8f9bc6[_0x895e25(0x142)]==='ecc'||_0x8f9bc6['type']===_0x895e25(0x15d))&&(_0x4f5a0a[_0x895e25(0x22e)]=_0x8f9bc6['curve']);if(_0x1f4ef5){if(_0x8f9bc6[_0x895e25(0x1e8)])try{const _0x47d971=await showPasswordModal('Enter\x20Current\x20Password',_0x895e25(0x176),![]),_0x2f4fc9=await decryptKeyWithPassword(_0x8f9bc6,_0x47d971),_0x1855b7=safeMemory[_0x895e25(0x23e)](_0x2f4fc9,!![]);_0x4f5a0a[_0x895e25(0x113)]=_0x1855b7['privateKey'],_0x4f5a0a[_0x895e25(0x1e8)]=![];}catch(_0x3ad08d){showStatus('keyStatus',_0x895e25(0x195)+_0x3ad08d[_0x895e25(0x1ee)],_0x895e25(0x182));return;}await encryptKeyWithPassword(_0x4f5a0a,_0x1f4ef5);}_0x4c3c62=_0x895e25(0x1de);}else{if(_0x59244f&&!_0x367783){_0x4f5a0a={'id':_0x8f9bc6['id'],'name':_0x8f9bc6[_0x895e25(0xe7)],'type':_0x8f9bc6['type'],'created':_0x8f9bc6[_0x895e25(0x1b0)],'expiry':_0x8f9bc6[_0x895e25(0x14a)],'publicKey':_0x8f9bc6[_0x895e25(0x254)],'algorithm':_0x8f9bc6[_0x895e25(0x1f9)],'hasPublic':!![],'hasPrivate':![],'pairedKeyId':_0x8f9bc6['id'],'publicKeyHash':_0x8f9bc6[_0x895e25(0x144)]};if(_0x8f9bc6[_0x895e25(0x142)]==='rsa'||_0x8f9bc6[_0x895e25(0x142)]==='rsa-4096')_0x4f5a0a[_0x895e25(0x18c)]=_0x8f9bc6[_0x895e25(0x18c)];else(_0x8f9bc6[_0x895e25(0x142)]==='ecc'||_0x8f9bc6[_0x895e25(0x142)]===_0x895e25(0x15d))&&(_0x4f5a0a[_0x895e25(0x22e)]=_0x8f9bc6[_0x895e25(0x22e)]);}}const _0x5a6ae8=JSON[_0x895e25(0x19a)](_0x4f5a0a),_0x6ec98=btoa(_0x5a6ae8),_0xe7bed=new Blob([_0x6ec98],{'type':'application/octet-stream'}),_0x23c043=URL[_0x895e25(0x12e)](_0xe7bed),_0x2cfb3e=document['createElement']('a');_0x2cfb3e[_0x895e25(0x1b2)]=_0x23c043,_0x2cfb3e[_0x895e25(0x119)]=''+_0x8f9bc6['name'][_0x895e25(0x12b)](/[^a-z0-9]/gi,'_')+_0x4c3c62,document[_0x895e25(0x134)][_0x895e25(0x198)](_0x2cfb3e),_0x2cfb3e[_0x895e25(0x8e)](),document['body'][_0x895e25(0xac)](_0x2cfb3e),URL[_0x895e25(0x24e)](_0x23c043);const _0x3aad0a=_0x367783?'private\x20key':_0x59244f?'public\x20key':'key';showStatus(_0x895e25(0x25f),'Key\x20\x22'+_0x8f9bc6[_0x895e25(0xe7)]+'\x22\x20'+_0x3aad0a+_0x895e25(0x21b)+_0x4c3c62+'\x20file',_0x895e25(0x105));}catch(_0x1773aa){console[_0x895e25(0x182)]('Export\x20error:',_0x1773aa),showStatus(_0x895e25(0x25f),_0x895e25(0x235)+_0x1773aa[_0x895e25(0x1ee)],'error');}}async function exportPrivateKey(_0x4449d0){const _0xad1b6=_0x558412,_0x432c94=keys['find'](_0x2e3cb2=>_0x2e3cb2['id']===_0x4449d0);if(!_0x432c94){alert(_0xad1b6(0x148));return;}if(!_0x432c94[_0xad1b6(0x8d)]){showStatus('keyStatus','This\x20key\x20does\x20not\x20have\x20a\x20private\x20key\x20component\x20to\x20export',_0xad1b6(0x182));return;}const _0x217e82=confirm('WARNING:\x20Exporting\x20a\x20private\x20key\x20is\x20a\x20security\x20risk.\x20'+_0xad1b6(0x15e)+_0xad1b6(0xc2));_0x217e82&&await exportKey(_0x4449d0,!![]);}function createKeyFileInput(){const _0x505bb1=_0x558412;let _0x10c6fc=document['getElementById']('keyFileInput');return!_0x10c6fc&&(_0x10c6fc=document[_0x505bb1(0x19d)](_0x505bb1(0x172)),_0x10c6fc[_0x505bb1(0x142)]='file',_0x10c6fc['id']='keyFileInput',_0x10c6fc[_0x505bb1(0x1e2)]=_0x505bb1(0xee),_0x10c6fc[_0x505bb1(0x1ca)][_0x505bb1(0x236)]='none',document[_0x505bb1(0x134)][_0x505bb1(0x198)](_0x10c6fc),_0x10c6fc[_0x505bb1(0x214)](_0x505bb1(0x1a1),handleKeyFileSelect)),_0x10c6fc;}async function handleKeyFileSelect(_0x468c18){const _0x4af2bf=_0x558412;try{const _0x48c35b=_0x468c18[_0x4af2bf(0x1b1)]['files'];if(!_0x48c35b||_0x48c35b['length']===0x0)return;setLoading(!![]);const _0x2ad028=_0x48c35b[0x0],_0x38a680=_0x2ad028[_0x4af2bf(0xe7)][_0x4af2bf(0x223)]()[_0x4af2bf(0x143)](_0x4af2bf(0x1de)),_0x21ddd2=_0x2ad028[_0x4af2bf(0xe7)][_0x4af2bf(0x223)]()[_0x4af2bf(0x143)](_0x4af2bf(0xe2)),_0x53f013=new FileReader();_0x53f013['onload']=async function(_0xddd03c){const _0x5510d0=_0x4af2bf;try{const _0x45c772=_0xddd03c[_0x5510d0(0x1b1)][_0x5510d0(0x157)];let _0x2be1cc;try{const _0x18ec39=atob(_0x45c772);_0x2be1cc=JSON[_0x5510d0(0xfa)](_0x18ec39);}catch(_0x2580ac){throw new Error(_0x5510d0(0x15c));}if(!_0x2be1cc['id']||!_0x2be1cc[_0x5510d0(0xe7)]||!_0x2be1cc[_0x5510d0(0x142)]||!_0x2be1cc[_0x5510d0(0x1b0)])throw new Error(_0x5510d0(0x253));if(!validator[_0x5510d0(0x16d)](_0x2be1cc[_0x5510d0(0xe7)]))throw new Error('Invalid\x20key\x20name\x20format');if(_0x2be1cc['type']==='aes')_0x2be1cc['hasPublic']=!![],_0x2be1cc['hasPrivate']=!![];else{_0x2be1cc[_0x5510d0(0x131)]=!!_0x2be1cc[_0x5510d0(0x254)],_0x2be1cc['hasPrivate']=!!_0x2be1cc[_0x5510d0(0x113)];if(_0x38a680&&!_0x2be1cc['hasPrivate'])throw new Error(_0x5510d0(0x191));if(_0x21ddd2&&!_0x2be1cc['hasPublic'])throw new Error(_0x5510d0(0x174));}if(_0x2be1cc[_0x5510d0(0x8d)]&&_0x2be1cc[_0x5510d0(0x1e8)]){let _0x227d1c='';try{_0x227d1c=await showPasswordModal(_0x5510d0(0x1ad),_0x5510d0(0xaa),![]);}catch(_0x5b14cc){throw new Error(_0x5510d0(0x145));}if(!_0x227d1c)throw new Error(_0x5510d0(0x145));_0x2be1cc[_0x5510d0(0xde)]=_0x227d1c;}const _0x1c92e3=keys[_0x5510d0(0x13f)](_0x5e9a14=>_0x5e9a14['id']===_0x2be1cc['id']);let _0x461075=![],_0x5ddf11=-0x1;if(_0x1c92e3>=0x0){const _0xe1dcda=keys[_0x1c92e3];if(_0x2be1cc[_0x5510d0(0x8d)]&&!_0xe1dcda['hasPrivate']&&_0xe1dcda[_0x5510d0(0x131)])_0x461075=!![],_0x5ddf11=_0x1c92e3;else _0x2be1cc[_0x5510d0(0x131)]&&!_0xe1dcda['hasPublic']&&_0xe1dcda['hasPrivate']&&(_0x461075=!![],_0x5ddf11=_0x1c92e3);}else _0x2be1cc[_0x5510d0(0x144)]&&(_0x5ddf11=keys[_0x5510d0(0x13f)](_0x32ce00=>_0x32ce00[_0x5510d0(0x144)]===_0x2be1cc['publicKeyHash']&&_0x32ce00[_0x5510d0(0x142)]===_0x2be1cc[_0x5510d0(0x142)]&&(_0x32ce00[_0x5510d0(0x8d)]&&!_0x32ce00['hasPublic']&&_0x2be1cc[_0x5510d0(0x131)]||_0x32ce00[_0x5510d0(0x131)]&&!_0x32ce00['hasPrivate']&&_0x2be1cc[_0x5510d0(0x8d)])),_0x5ddf11>=0x0&&(_0x461075=!![]));if(_0x461075&&_0x5ddf11>=0x0){const _0x5c59f5=confirm(_0x5510d0(0xbb)+(_0x2be1cc[_0x5510d0(0x8d)]?'private':_0x5510d0(0x11e))+'\x20key\x20part\x20of\x20an\x20existing\x20key.\x20'+_0x5510d0(0x166));if(_0x5c59f5){const _0x661fd=keys[_0x5ddf11];_0x2be1cc[_0x5510d0(0x8d)]&&!_0x661fd[_0x5510d0(0x8d)]&&(_0x661fd[_0x5510d0(0x113)]=_0x2be1cc[_0x5510d0(0x113)],_0x661fd[_0x5510d0(0x8d)]=!![],_0x2be1cc[_0x5510d0(0x1e8)]&&(_0x661fd[_0x5510d0(0x1e8)]=!![],_0x661fd[_0x5510d0(0x1d5)]=_0x2be1cc[_0x5510d0(0x1d5)],_0x661fd['iv']=_0x2be1cc['iv'])),_0x2be1cc[_0x5510d0(0x131)]&&!_0x661fd[_0x5510d0(0x131)]&&(_0x661fd['publicKey']=_0x2be1cc[_0x5510d0(0x254)],_0x661fd['hasPublic']=!![],_0x2be1cc[_0x5510d0(0x144)]&&(_0x661fd[_0x5510d0(0x144)]=_0x2be1cc[_0x5510d0(0x144)])),_0x661fd['pairedKeyId']=_0x661fd['id'],await saveKeys(),showStatus(_0x5510d0(0x25f),_0x5510d0(0x199)+_0x661fd[_0x5510d0(0xe7)]+_0x5510d0(0x259)+(_0x2be1cc[_0x5510d0(0x8d)]?'private':'public')+'\x20key\x20part.\x20Security\x20level:\x20'+determineKeySecurityLevel(_0x661fd)['toUpperCase'](),_0x5510d0(0x105));}else _0x2be1cc['id']=crypto[_0x5510d0(0xb5)](),keys[_0x5510d0(0x1e9)](_0x2be1cc),await saveKeys(),showStatus('keyStatus',_0x5510d0(0x199)+_0x2be1cc[_0x5510d0(0xe7)]+_0x5510d0(0x1b9),'success');}else{if(_0x1c92e3>=0x0){const _0x5abcd1=confirm(_0x5510d0(0xd3)+_0x2be1cc[_0x5510d0(0xe7)]+_0x5510d0(0x90));_0x5abcd1?keys[_0x1c92e3]=_0x2be1cc:(_0x2be1cc['id']=crypto[_0x5510d0(0xb5)](),keys['push'](_0x2be1cc)),await saveKeys(),showStatus(_0x5510d0(0x25f),_0x5510d0(0x199)+_0x2be1cc[_0x5510d0(0xe7)]+'\x22\x20imported\x20successfully',_0x5510d0(0x105));}else{keys[_0x5510d0(0x1e9)](_0x2be1cc),await saveKeys();if(_0x2be1cc[_0x5510d0(0x142)]===_0x5510d0(0xb8))showStatus('keyStatus',_0x5510d0(0x1d6)+_0x2be1cc[_0x5510d0(0xe7)]+_0x5510d0(0x183),_0x5510d0(0x105));else{if(_0x2be1cc[_0x5510d0(0x8d)]&&_0x2be1cc[_0x5510d0(0x131)])showStatus(_0x5510d0(0x25f),_0x5510d0(0xcb)+_0x2be1cc['name']+_0x5510d0(0x183),'success');else _0x2be1cc[_0x5510d0(0x8d)]?showStatus(_0x5510d0(0x25f),_0x5510d0(0x241)+_0x2be1cc[_0x5510d0(0xe7)]+_0x5510d0(0x183),_0x5510d0(0x105)):showStatus(_0x5510d0(0x25f),_0x5510d0(0xc7)+_0x2be1cc[_0x5510d0(0xe7)]+_0x5510d0(0x183),_0x5510d0(0x105));}}}}catch(_0x38fe9c){console['error'](_0x5510d0(0xc0),_0x38fe9c),showStatus('keyStatus',_0x5510d0(0x1c7)+_0x38fe9c['message'],_0x5510d0(0x182));}finally{setLoading(![]),document[_0x5510d0(0x16b)]('keyFileInput')[_0x5510d0(0x1f4)]='';}},_0x53f013[_0x4af2bf(0x217)]=function(){const _0x30d405=_0x4af2bf;setLoading(![]),showStatus(_0x30d405(0x25f),_0x30d405(0x15b),_0x30d405(0x182)),document[_0x30d405(0x16b)](_0x30d405(0x159))[_0x30d405(0x1f4)]='';},_0x53f013['readAsText'](_0x2ad028);}catch(_0x41cc06){console[_0x4af2bf(0x182)](_0x4af2bf(0xc0),_0x41cc06),showStatus(_0x4af2bf(0x25f),_0x4af2bf(0x1c7)+_0x41cc06[_0x4af2bf(0x1ee)],_0x4af2bf(0x182)),setLoading(![]),document[_0x4af2bf(0x16b)]('keyFileInput')[_0x4af2bf(0x1f4)]='';}}async function exportAllKeys(){const _0x31b450=_0x558412;try{if(keys['length']===0x0){showStatus('keyStatus','No\x20keys\x20available\x20to\x20export',_0x31b450(0x220));return;}let _0x27f03e='';try{_0x27f03e=await showPasswordModal(_0x31b450(0x130),_0x31b450(0x1ce),!![]);}catch(_0x439e01){return;}let _0x248804;if(_0x27f03e){const _0x1bcbdf=JSON[_0x31b450(0x19a)](keys),_0x5d5386=new TextEncoder()[_0x31b450(0x107)](_0x1bcbdf),_0x285be9=window[_0x31b450(0x261)][_0x31b450(0x24a)](new Uint8Array(0x10)),_0x563f68=await deriveKeyFromPassword(_0x27f03e,_0x285be9),_0x433723=window['crypto']['getRandomValues'](new Uint8Array(AES_CONFIG[_0x31b450(0x20d)])),_0x16d3c3=await encryptWithDerivedKey(_0x563f68,_0x5d5386,_0x433723);_0x248804=JSON[_0x31b450(0x19a)]({'format':'LemonadeProtectedBackup','salt':arrayBufferToBase64(_0x285be9),'iv':arrayBufferToBase64(_0x433723),'data':arrayBufferToBase64(_0x16d3c3)});}else{const _0x31d395=confirm(_0x31b450(0xa3));if(!_0x31d395)return;_0x248804=JSON[_0x31b450(0x19a)](keys);}const _0x2c142b=new Blob([_0x248804],{'type':_0x31b450(0x1f2)}),_0x29503c=URL['createObjectURL'](_0x2c142b),_0xf27bfd=document['createElement']('a');_0xf27bfd[_0x31b450(0x1b2)]=_0x29503c,_0xf27bfd['download']=_0x31b450(0xe0),document[_0x31b450(0x134)][_0x31b450(0x198)](_0xf27bfd),_0xf27bfd['click'](),document['body'][_0x31b450(0xac)](_0xf27bfd),URL[_0x31b450(0x24e)](_0x29503c),showStatus('keyStatus',_0x31b450(0xc4),_0x31b450(0x105));}catch(_0x4a6a4){console[_0x31b450(0x182)](_0x31b450(0x127),_0x4a6a4),showStatus(_0x31b450(0x25f),_0x31b450(0x235)+_0x4a6a4[_0x31b450(0x1ee)],_0x31b450(0x182));}}function createStateFileInput(){const _0x1b148e=_0x558412;let _0x302b9f=document[_0x1b148e(0x16b)](_0x1b148e(0x25b));return!_0x302b9f&&(_0x302b9f=document[_0x1b148e(0x19d)](_0x1b148e(0x172)),_0x302b9f['type']=_0x1b148e(0xc6),_0x302b9f['id']='stateFileInput',_0x302b9f[_0x1b148e(0x1e2)]='.state,application/octet-stream',_0x302b9f['style'][_0x1b148e(0x236)]='none',document['body']['appendChild'](_0x302b9f),_0x302b9f['addEventListener'](_0x1b148e(0x1a1),handleStateFileSelect)),_0x302b9f;}async function handleStateFileSelect(_0x2f0436){const _0x3108ca=_0x558412;try{const _0x15b899=_0x2f0436[_0x3108ca(0x1b1)][_0x3108ca(0x1d9)];if(!_0x15b899||_0x15b899['length']===0x0)return;setLoading(!![]);const _0x33b998=_0x15b899[0x0],_0x555188=new FileReader();_0x555188[_0x3108ca(0x10b)]=async function(_0x569044){const _0xcedb29=_0x3108ca;try{const _0xb81d1e=_0x569044[_0xcedb29(0x1b1)][_0xcedb29(0x157)];let _0x3b4327;try{_0x3b4327=JSON[_0xcedb29(0xfa)](_0xb81d1e);}catch(_0x480864){throw new Error(_0xcedb29(0x10f));}if(_0x3b4327[_0xcedb29(0x1fb)]===_0xcedb29(0xd8)){let _0x178281='';try{_0x178281=await showPasswordModal(_0xcedb29(0x1fe),_0xcedb29(0x22c),![]);}catch(_0x204535){throw new Error(_0xcedb29(0x1f5));}if(!_0x178281)throw new Error(_0xcedb29(0x1f5));const _0x14f61f=base64ToArrayBuffer(_0x3b4327[_0xcedb29(0x1d5)]),_0x4f811f=base64ToArrayBuffer(_0x3b4327['iv']),_0x38e4bf=base64ToArrayBuffer(_0x3b4327['data']),_0x4c4baf=await deriveKeyFromPassword(_0x178281,_0x14f61f),_0x140c14=await decryptWithDerivedKey(_0x4c4baf,_0x38e4bf,_0x4f811f),_0x1665e0=new TextDecoder()[_0xcedb29(0x1ff)](_0x140c14);_0x3b4327=JSON['parse'](_0x1665e0);}if(!Array[_0xcedb29(0x1f8)](_0x3b4327))throw new Error(_0xcedb29(0x161));const _0x5d7f34=confirm(_0xcedb29(0x25d)+_0x3b4327[_0xcedb29(0x18c)]+_0xcedb29(0x17f));if(!_0x5d7f34)return;keys=_0x3b4327,await saveKeys(),showStatus(_0xcedb29(0x25f),_0xcedb29(0xaf)+_0x3b4327[_0xcedb29(0x18c)]+_0xcedb29(0xf6),'success');}catch(_0xf98b85){console[_0xcedb29(0x182)](_0xcedb29(0xd2),_0xf98b85),showStatus(_0xcedb29(0x25f),_0xcedb29(0x252)+_0xf98b85[_0xcedb29(0x1ee)],_0xcedb29(0x182));}finally{setLoading(![]),document['getElementById']('stateFileInput')[_0xcedb29(0x1f4)]='';}},_0x555188[_0x3108ca(0x217)]=function(){const _0x3ff9d2=_0x3108ca;setLoading(![]),showStatus(_0x3ff9d2(0x25f),_0x3ff9d2(0x1df),_0x3ff9d2(0x182)),document['getElementById'](_0x3ff9d2(0x25b))[_0x3ff9d2(0x1f4)]='';},_0x555188[_0x3108ca(0x1c9)](_0x33b998);}catch(_0x3935eb){console[_0x3108ca(0x182)](_0x3108ca(0xd2),_0x3935eb),showStatus('keyStatus',_0x3108ca(0x252)+_0x3935eb[_0x3108ca(0x1ee)],_0x3108ca(0x182)),setLoading(![]),document[_0x3108ca(0x16b)]('stateFileInput')[_0x3108ca(0x1f4)]='';}}function importState(){const _0x4785f8=_0x558412,_0x581376=createStateFileInput();_0x581376[_0x4785f8(0x8e)]();}async function secureClipboardCopy(_0x487498){const _0x232759=_0x558412;try{return await navigator['clipboard'][_0x232759(0x1e4)](_0x487498),!![];}catch(_0x153ef6){return console['log'](_0x232759(0x116),_0x153ef6),![];}}function deleteKey(_0x241525){const _0x247879=_0x558412,_0x318912=keys[_0x247879(0x246)](_0x31010d=>_0x31010d['id']===_0x241525);if(!_0x318912){alert(_0x247879(0x148));return;}const _0x5bb6d1=window[_0x247879(0x212)]('Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20key\x20\x22'+_0x318912['name']+_0x247879(0x207));_0x5bb6d1&&(keys=keys[_0x247879(0xed)](_0x4adf41=>_0x4adf41['id']!==_0x241525),saveKeys(),showStatus(_0x247879(0x25f),_0x247879(0x199)+_0x318912['name']+'\x22\x20deleted\x20successfully','success'));}function _0x5390(){const _0x479aaa=[')\x20have\x20been\x20permanently\x20deleted','KEY_LENGTH','Application\x20state\x20with\x20','encryptFileInfo','protocol','CURVE_P384','decryptFileName','Encryption\x20failed:\x20','randomUUID','Encrypted\x20file\x20loaded.\x20Select\x20key\x20and\x20enter\x20OBF\x20key\x20if\x20needed.','importKey','aes','Password\x20protection\x20is\x20required\x20by\x20your\x20security\x20settings','checked','This\x20appears\x20to\x20be\x20the\x20','PBKDF2','clear','_cryptoKey','DOMContentLoaded','Import\x20error:','Error\x20loading\x20settings\x20from\x20localStorage:','Do\x20you\x20want\x20to\x20continue?','sensitiveData','Application\x20state\x20exported\x20successfully','setAttribute','file','Public\x20key\x20\x22','997456WgQZqw','file:','Decryption\x20error:\x20','Complete\x20asymmetric\x20key\x20pair\x20\x22','medium','removeDecryptFile','Manual\x20garbage\x20collection\x20not\x20available','Error\x20loading\x20settings\x20from\x20database:','feedback','AES\x20encryption\x20error:','State\x20import\x20error:','A\x20key\x20with\x20name\x20\x22','Session-only\x20mode:\x20Keys\x20not\x20saved\x20persistently','pkcs8','transaction','readwrite','LemonadeProtectedBackup','info','passwordModalFeedback','HKDF','decryptionPassword','score','_importPassword','darkMode','Lemonade-state.state','Copied\x20to\x20clipboard','.lim','860QEOaSn','decryptStatus','installStatus','passwordModalMessage','name','charAt','textContent','classList','string','ECDH','filter','.lim,.lem','setDate','userChoice','Please\x20select\x20an\x20encryption\x20key','remove','HASH','keyPassword','getItem','\x20keys\x20imported\x20successfully','key-item','encryptionPasswordGroup','Lemonade\x20was\x20installed','parse','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789','<p>No\x20keys\x20available.\x20Generate\x20or\x20import\x20a\x20key\x20to\x20get\x20started.</p>','Please\x20use\x20a\x20stronger\x20password:\x20','Error\x20clearing\x20keys\x20from\x20database:','encryptedOutput','passwordModal','preventDefault','TAG_LENGTH','KEY_SIZE','Invalid\x20encrypted\x20message\x20data:\x20','success','includes','encode','AES-GCM','key','then','onload','AES','rsa-4096','encryptBrowseBtn','Invalid\x20state\x20file\x20format','min','Unsupported\x20encryption\x20algorithm:\x20','\x20expired\x20key(s)\x20removed\x20for\x20security','privateKey','Failed\x20to\x20retrieve\x20decrypted\x20key\x20from\x20memory.','Passwords\x20do\x20not\x20match','Modern\x20clipboard\x20API\x20failed:','hostname','decryptFileInfo','download','encryptFileInput','text','store','decryptionPasswordGroup','public','Decryption\x20failed:\x20','LemonadeSecureDB','Escape','useIndexedDB','RSA-2048','scope','decrypt','match','Export\x20error:','Missing\x20encrypted\x20key\x20data','keypress','decrypted_file','replace','test','ECDH+','createObjectURL','generateKey','Secure\x20Your\x20Key\x20Backup','hasPublic','Medium\x20-\x20Add\x20more\x20variety\x20or\x20length\x20for\x20better\x20security','encryptedKey','body','location','Database\x20not\x20initialized','zeroKeysBtn','No\x20decrypted\x20data\x20to\x20download','Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message','importStateBtn','<span\x20class=\x22security-badge\x20','\x20[Private]','3281YzJtzC','installContainer','findIndex','digest','passwordFeedback','type','endsWith','publicKeyHash','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20private\x20key','prompt','appinstalled','Key\x20not\x20found','Settings\x20saved\x20successfully','expiry','Database\x20initialized\x20successfully','LemonadeDarkMode','copyDecryptedBtn','<button\x20class=\x22btn-secondary\x20private-key-btn\x22\x20onclick=\x22exportPrivateKey(\x27','size','data','enforcePwdProtection','clearEncryptBtn','ECDH+AES-GCM','SHA-256','Unsupported\x20key\x20type:\x20','Decryption\x20error:','result','data-filename','keyFileInput','6Hqgmgf','Error\x20reading\x20the\x20key\x20file','Invalid\x20key\x20file\x20format','ecc-p384','Only\x20export\x20private\x20keys\x20if\x20you\x20absolutely\x20need\x20to\x20use\x20them\x20on\x20another\x20device.\x20','spki',')</div>','Invalid\x20state\x20data\x20format','Installation\x20is\x20now\x20available!','sessionOnly','encryptObfKey','Error\x20saving\x20keys:\x20','Would\x20you\x20like\x20to\x20merge\x20them\x20into\x20a\x20complete\x20key\x20pair?','https:','buffer','22ByGoHT','Switching\x20to\x20tab:','getElementById','saveSettingsBtn','isValidKeyName','matchMedia','RSA-4096','Please\x20enter\x20a\x20key\x20name','keySize','input','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22deleteKey(\x27','This\x20.lim\x20file\x20does\x20not\x20contain\x20a\x20public\x20key','Invalid\x20encrypted\x20message\x20format\x20or\x20OBF\x20Key\x20mismatch','Enter\x20the\x20current\x20key\x20password\x20to\x20continue:','RSA-OAEP','Unable\x20to\x20copy\x20automatically.\x20Please\x20select\x20the\x20text\x20and\x20press\x20Ctrl+C\x20(or\x20âŒ˜+C)\x20to\x20copy\x20manually.','add','function','pairedKeyId','enforceKeyExpiry','password-strength','encryptedMessage','\x20keys\x20into\x20your\x20application.\x20Continue?','Password\x20is\x20required','WARNING:\x20This\x20will\x20permanently\x20delete\x20ALL\x20your\x20encryption\x20keys.\x20This\x20action\x20CANNOT\x20be\x20undone.\x0a\x0aAre\x20you\x20absolutely\x20sure\x20you\x20want\x20to\x20continue?','error','\x22\x20imported\x20successfully','log','keysList','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x5c$&','inactivityModal','\x20ðŸ”’','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','false','length','isFile','Unsupported\x20data\x20format\x20version','127.0.0.1','importKeyBtn','This\x20.lem\x20file\x20does\x20not\x20contain\x20a\x20private\x20key','decrypted.txt','innerHTML','objectStore','Export\x20cancelled:\x20','Strong\x20-\x20Good\x20password!','CURVE','appendChild','Key\x20\x22','stringify','removeItem','deriveKey','createElement','has','decryptedBinaryData','matches','change','disabled','Failed\x20to\x20decrypt\x20key:\x20','_privateKey','keys','Service\x20Worker\x20registration\x20failed:','P-256','Encryption\x20error:','decryptedOutput','keyExpiry','Error\x20loading\x20keys:','keyName','Protected\x20Private\x20Key','encryptBtn','readonly','created','target','href','Lemonade\x20has\x20been\x20installed\x20successfully!','put','true','<option\x20value=\x22\x22>Select\x20a\x20key...</option>','Installation\x20not\x20available\x20in\x20this\x20browser\x20or\x20app\x20is\x20already\x20installed','status','\x22\x20imported\x20as\x20separate\x20key','resetSettingsBtn','block','deleteKey','flex','passwordStrength','beforeinstallprompt','random','encryptionKey','Service\x20Worker\x20registration\x20failed.\x20PWA\x20features\x20unavailable.','PWA\x20installation\x20requires\x20HTTPS.\x20You\x20are\x20viewing\x20this\x20file\x20locally.','\x20[Full\x20Pair]','exportKey','Please\x20enter\x20a\x20message\x20or\x20add\x20a\x20file\x20to\x20encrypt','Import\x20error:\x20','clearDecryptBtn','readAsText','style','charCodeAt','ecc','33055KivFDp','Please\x20enter\x20a\x20password\x20to\x20protect\x20your\x20key\x20backup.\x20This\x20is\x20highly\x20recommended\x20for\x20security.','Installation\x20was\x20canceled','\x27)\x22>Delete</button>','ceil','querySelectorAll','toFixed','div','salt','Symmetric\x20key\x20\x22','encryptMessage','Key\x20deletion\x20canceled','files','get',')[\x5cs\x5cS]+?(','c1a9f5d3-c2a8-4c6f-8b1e-3e4d5a6b7c8d','Database\x20error:','.lem','Error\x20reading\x20the\x20state\x20file','<span\x20class=\x22key-pair-badge\x20private\x22>PRIVATE\x20KEY</span>','confirmKeyPassword','accept','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Created:\x20','writeText','exportAllKeysBtn','data-tab','.install-note','protected','push','active','slice','encrypt','downloadDecryptedBtn','message','byteLength','pbkdf2Iterations','passwordModalStrength','application/octet-stream','installBtn','value','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20state\x20file','data-binary','trim','isArray','algorithm','floor','format','Password\x20required\x20for\x20this\x20key','settings','Protected\x20State\x20File','decode','encryptFileName','passwordModalInput','Warning:\x20Exporting\x20a\x20private\x20key\x20without\x20password\x20protection\x20is\x20a\x20security\x20risk.\x20Continue\x20anyway?','version','sanitizeHTML','No\x20keys\x20to\x20delete','decryptBrowseBtn','\x22?\x20This\x20action\x20cannot\x20be\x20undone.','428244BPEqXZ','Tab\x20button\x20clicked:','Unable\x20to\x20read\x20the\x20file.','Error\x20saving\x20settings:','encryptionPassword','IV_LENGTH','.lmn',')([\x5cs\x5cS]+?)(','clearEncryptedMessageBtn','Database\x20initialization\x20failed.\x20Using\x20less\x20secure\x20localStorage\x20instead.','confirm','decryptionKey','addEventListener','fileName','measurePasswordStrength','onerror','\x27)\x22>Private\x20Key</button>','560148QSabBc',').*$','\x20exported\x20as\x20','app-settings','MODE','KEY_SIZE_4096','contains','warning','exportPrivateKey','className','toLowerCase','clearClipboard','metadata','Key\x20expiration\x20is\x20required\x20by\x20your\x20security\x20settings','forEach','rsa','fileSize','P-384','timeoutTimer','This\x20state\x20file\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import:','passwordModalConfirm','curve','strengthCategory','delete','toLocaleDateString','Incorrect\x20password\x20or\x20corrupted\x20private\x20key','load','pow','Export\x20error:\x20','display','loadingOverlay','catch','accepted','<span\x20class=\x22key-pair-badge\x20full\x22>FULL\x20KEY\x20PAIR</span>','high','LemonadeSettings','removeEncryptFile','retrieve','ECC-P256','createObjectStore','Private\x20key\x20\x22','46211ZCQgNQ','ALGORITHM','setItem','getAttribute','find','Please\x20select\x20a\x20decryption\x20key','\x27)\x22>Export</button>','toISOString','getRandomValues','No\x20encrypted\x20data\x20to\x20download','encryptStatus','9Ddtple','revokeObjectURL','serviceWorker','Invalid\x20encrypted\x20message\x20format.\x20Could\x20not\x20find\x20valid\x20delimiters.','Invalid\x20base64\x20data:\x20','State\x20import\x20error:\x20','Missing\x20required\x20key\x20properties','publicKey','onsuccess','1111341GIDoUu','raw','_publicKey','\x22\x20updated\x20with\x20','objectStoreNames','stateFileInput','0\x20Bytes','This\x20will\x20import\x20','fromCharCode','keyStatus','Nothing\x20to\x20copy','crypto','LemonadeKeys','Missing\x20encrypted\x20private\x20key\x20data','Please\x20enter\x20a\x20password\x20to\x20protect\x20this\x20private\x20key:','toLocaleString','Enter','Key\x20name\x20can\x20only\x20contain\x20letters,\x20numbers,\x20spaces,\x20and\x20basic\x20punctuation\x20(._-)','(display-mode:\x20standalone)','hasPrivate','click','.tab-btn','\x22\x20already\x20exists.\x20Overwrite?','focus','low','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','deriveBits','dark-mode','Please\x20enter\x20an\x20encrypted\x20message\x20or\x20add\x20an\x20encrypted\x20file','^.*?(','subtle','All\x20keys\x20cleared\x20from\x20database','downloadEncryptedBtn','open','Error\x20loading\x20keys:\x20','File:\x20','set','decryptFileInput','none','Error\x20generating\x20key:','passwordModalTitle','WARNING:\x20Exporting\x20keys\x20without\x20a\x20password\x20is\x20not\x20secure.\x20Anyone\x20with\x20access\x20to\x20this\x20file\x20will\x20be\x20able\x20to\x20use\x20your\x20keys.\x20Continue\x20anyway?','RSA-OAEP+AES-GCM','\x20days\x20(','sw.js','ITERATIONS','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22exportKey(\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-item-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','This\x20private\x20key\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import\x20it:','settingsStatus','removeChild'];_0x5390=function(){return _0x479aaa;};return _0x5390();}function xorCipher(_0x333e77,_0x2ff01c){const _0x5c9745=_0x558412;if(!_0x2ff01c)return _0x333e77;const _0x4fc7b6=new TextEncoder()[_0x5c9745(0x107)](_0x2ff01c),_0x2f5cd2=new Uint8Array(_0x333e77),_0x429ef2=new Uint8Array(_0x333e77['byteLength']);for(let _0x112555=0x0;_0x112555<_0x2f5cd2[_0x5c9745(0x18c)];_0x112555++){_0x429ef2[_0x112555]=_0x2f5cd2[_0x112555]^_0x4fc7b6[_0x112555%_0x4fc7b6[_0x5c9745(0x18c)]];}return _0x429ef2['buffer'];}function showStatus(_0x206bc6,_0x212040,_0x31d72f){const _0x4443d9=_0x558412,_0x1c12e4=document[_0x4443d9(0x16b)](_0x206bc6);_0x1c12e4[_0x4443d9(0xe9)]=validator[_0x4443d9(0x204)](_0x212040),_0x1c12e4[_0x4443d9(0x222)]='status\x20'+_0x31d72f,setTimeout(()=>{const _0x206cdf=_0x4443d9;_0x1c12e4[_0x206cdf(0xe9)]===validator[_0x206cdf(0x204)](_0x212040)&&(_0x1c12e4[_0x206cdf(0x222)]='status');},0x2710);}let passwordModalCallback=null,passwordModalResolve=null,passwordModalReject=null;function showPasswordModal(_0x317a43,_0x5f3b51,_0x2a54f1=![]){return new Promise((_0x388124,_0x30f49f)=>{const _0x121c7e=_0xb415,_0x39c567=document[_0x121c7e(0x16b)](_0x121c7e(0x100)),_0x16031a=document['getElementById'](_0x121c7e(0xa2)),_0x3a8330=document['getElementById'](_0x121c7e(0xe6)),_0x182a6c=document[_0x121c7e(0x16b)](_0x121c7e(0x201)),_0x769d23=document[_0x121c7e(0x16b)](_0x121c7e(0x1f1)),_0x161617=document[_0x121c7e(0x16b)](_0x121c7e(0xda));_0x16031a['textContent']=_0x317a43,_0x3a8330[_0x121c7e(0xe9)]=_0x5f3b51,_0x182a6c[_0x121c7e(0x1f4)]='',_0x769d23[_0x121c7e(0x222)]='password-strength',_0x161617[_0x121c7e(0xe9)]='',_0x769d23[_0x121c7e(0x1ca)][_0x121c7e(0x236)]=_0x2a54f1?_0x121c7e(0x1bb):'none',_0x161617[_0x121c7e(0x1ca)][_0x121c7e(0x236)]=_0x2a54f1?_0x121c7e(0x1bb):_0x121c7e(0xa0),passwordModalResolve=_0x388124,passwordModalReject=_0x30f49f,_0x39c567[_0x121c7e(0x1ca)][_0x121c7e(0x236)]='flex',setTimeout(()=>{const _0xfaa1da=_0x121c7e;_0x182a6c[_0xfaa1da(0x91)]();},0x64);});}function confirmPasswordModal(){const _0x406b21=_0x558412,_0x41d122=document[_0x406b21(0x16b)](_0x406b21(0x201)),_0x322231=_0x41d122[_0x406b21(0x1f4)],_0x4486b6=document[_0x406b21(0x16b)](_0x406b21(0x1f1)),_0x3709f2=document[_0x406b21(0x16b)](_0x406b21(0xda));_0x4486b6[_0x406b21(0x222)]=_0x406b21(0x17d),_0x3709f2['textContent']='',document['getElementById']('passwordModal')['style']['display']='none',passwordModalResolve&&(passwordModalResolve(_0x322231),passwordModalResolve=null,passwordModalReject=null);}function cancelPasswordModal(){const _0x1a4a3b=_0x558412,_0x5b1323=document['getElementById'](_0x1a4a3b(0x201)),_0x2361d6=document[_0x1a4a3b(0x16b)](_0x1a4a3b(0x1f1)),_0x8979f0=document['getElementById']('passwordModalFeedback');_0x5b1323[_0x1a4a3b(0x1f4)]='',_0x2361d6['className']='password-strength',_0x8979f0[_0x1a4a3b(0xe9)]='',document['getElementById']('passwordModal')[_0x1a4a3b(0x1ca)]['display']=_0x1a4a3b(0xa0),passwordModalReject&&(passwordModalReject(new Error('Password\x20entry\x20cancelled')),passwordModalResolve=null,passwordModalReject=null);}function updateModalPasswordStrength(){const _0x354bc8=_0x558412,_0x59ca27=document['getElementById']('passwordModalInput')[_0x354bc8(0x1f4)],_0x2bd868=validator[_0x354bc8(0x216)](_0x59ca27),_0xcd1603=document[_0x354bc8(0x16b)](_0x354bc8(0x1f1)),_0x8a7b13=document[_0x354bc8(0x16b)](_0x354bc8(0xda));_0xcd1603['className']=_0x354bc8(0x17d),_0x59ca27?(_0xcd1603[_0x354bc8(0xea)][_0x354bc8(0x179)](_0x2bd868['strengthCategory']),_0x8a7b13['textContent']=_0x2bd868[_0x354bc8(0xd0)]):_0x8a7b13[_0x354bc8(0xe9)]='';}async function copyToClipboard(_0x770b7d,_0x261c5c){const _0x4e4661=_0x558412,_0x51095e=document[_0x4e4661(0x16b)](_0x770b7d)['value'];if(!_0x51095e){showStatus(_0x261c5c,_0x4e4661(0x260),_0x4e4661(0x182));return;}const _0x6e9c74=await secureClipboardCopy(_0x51095e);if(_0x6e9c74)showStatus(_0x261c5c,_0x4e4661(0xe1),_0x4e4661(0x105)),appSettings[_0x4e4661(0x224)]&&scheduleClipboardClear();else{showStatus(_0x261c5c,_0x4e4661(0x178),'warning');const _0x5539ee=document[_0x4e4661(0x16b)](_0x770b7d);_0x5539ee[_0x4e4661(0x91)](),_0x5539ee['select']();}}function toggleDarkMode(){const _0x2bd0c2=_0x558412,_0x293add=document[_0x2bd0c2(0x16b)](_0x2bd0c2(0xdf))['checked'];_0x293add?document[_0x2bd0c2(0x134)][_0x2bd0c2(0xea)]['add'](_0x2bd0c2(0x95)):document[_0x2bd0c2(0x134)][_0x2bd0c2(0xea)][_0x2bd0c2(0xf2)](_0x2bd0c2(0x95)),localStorage[_0x2bd0c2(0x244)](_0x2bd0c2(0x14c),_0x293add);}function arrayBufferToBase64(_0x1bdd39){const _0x115600=_0x558412,_0x43c4af=new Uint8Array(_0x1bdd39);let _0x59e74d='';for(let _0x22a6c5=0x0;_0x22a6c5<_0x43c4af['byteLength'];_0x22a6c5++){_0x59e74d+=String[_0x115600(0x25e)](_0x43c4af[_0x22a6c5]);}return btoa(_0x59e74d);}function base64ToArrayBuffer(_0x57fd30){const _0x1fa9aa=_0x558412;try{const _0x37f1db=atob(_0x57fd30),_0x3b7263=new Uint8Array(_0x37f1db[_0x1fa9aa(0x18c)]);for(let _0x114313=0x0;_0x114313<_0x37f1db[_0x1fa9aa(0x18c)];_0x114313++){_0x3b7263[_0x114313]=_0x37f1db[_0x1fa9aa(0x1cb)](_0x114313);}return _0x3b7263[_0x1fa9aa(0x168)];}catch(_0x243991){console['error']('Base64\x20decoding\x20error:',_0x243991);throw new Error(_0x1fa9aa(0x251)+_0x243991['message']);}}async function encryptData(_0x42a877,_0x24f246){const _0x5463d6=_0x558412;if(_0x24f246[_0x5463d6(0x142)]===_0x5463d6(0xb8))return await encryptWithAES(_0x42a877,_0x24f246);else{if(_0x24f246[_0x5463d6(0x142)]===_0x5463d6(0x228)||_0x24f246[_0x5463d6(0x142)]===_0x5463d6(0x10d))return await encryptWithRSA(_0x42a877,_0x24f246);else{if(_0x24f246[_0x5463d6(0x142)]==='ecc'||_0x24f246[_0x5463d6(0x142)]===_0x5463d6(0x15d))return await encryptWithECC(_0x42a877,_0x24f246);else throw new Error('Unsupported\x20key\x20type');}}}async function decryptData(_0x14a3b5,_0x4efa8a){const _0x14ae87=_0x558412;if(_0x14a3b5[_0x14ae87(0x203)]===0x2){if(_0x4efa8a[_0x14ae87(0x142)]===_0x14ae87(0xb8))return await decryptWithAES(_0x14a3b5,_0x4efa8a);else{if(_0x4efa8a['type']===_0x14ae87(0x228)||_0x4efa8a[_0x14ae87(0x142)]===_0x14ae87(0x10d))return await decryptWithRSA(_0x14a3b5,_0x4efa8a);else{if(_0x4efa8a[_0x14ae87(0x142)]===_0x14ae87(0x1cc)||_0x4efa8a['type']==='ecc-p384')return await decryptWithECC(_0x14a3b5,_0x4efa8a);}}}if(_0x14a3b5[_0x14ae87(0x1f9)]===AES_CONFIG[_0x14ae87(0x21d)])return await decryptWithAES(_0x14a3b5,_0x4efa8a);else{if(_0x14a3b5[_0x14ae87(0x1f9)]===RSA_CONFIG[_0x14ae87(0x243)]+'+'+AES_CONFIG[_0x14ae87(0x21d)]||_0x14a3b5[_0x14ae87(0x1f9)]===_0x14ae87(0xa4))return await decryptWithRSA(_0x14a3b5,_0x4efa8a);else{if(_0x14a3b5[_0x14ae87(0x1f9)]===_0x14ae87(0x12d)+AES_CONFIG[_0x14ae87(0x21d)]||_0x14a3b5[_0x14ae87(0x1f9)]===_0x14ae87(0x153))return await decryptWithECC(_0x14a3b5,_0x4efa8a);else throw new Error(_0x14ae87(0x111)+_0x14a3b5[_0x14ae87(0x1f9)]);}}}async function deriveKeyFromPassword(_0x47ec22,_0x35bcee){const _0x370c23=_0x558412,_0x197b50=new TextEncoder()[_0x370c23(0x107)](_0x47ec22),_0x59859d=await window[_0x370c23(0x261)][_0x370c23(0x98)][_0x370c23(0xb7)](_0x370c23(0x257),_0x197b50,{'name':'PBKDF2'},![],['deriveKey']);return window[_0x370c23(0x261)]['subtle'][_0x370c23(0x19c)]({'name':_0x370c23(0xbc),'salt':_0x35bcee,'iterations':PBKDF2_CONFIG['ITERATIONS'],'hash':PBKDF2_CONFIG[_0x370c23(0xf3)]},_0x59859d,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG['KEY_LENGTH']},!![],[_0x370c23(0x1ec),'decrypt']);}async function encryptWithDerivedKey(_0x3645de,_0x431817,_0x48382b){const _0x269d54=_0x558412;return window[_0x269d54(0x261)][_0x269d54(0x98)][_0x269d54(0x1ec)]({'name':AES_CONFIG[_0x269d54(0x21d)],'iv':_0x48382b,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x3645de,_0x431817);}async function decryptWithDerivedKey(_0x1dba3c,_0x28e50a,_0x5238da){const _0x593134=_0x558412;return window[_0x593134(0x261)]['subtle'][_0x593134(0x125)]({'name':AES_CONFIG[_0x593134(0x21d)],'iv':_0x5238da,'tagLength':AES_CONFIG[_0x593134(0x102)]},_0x1dba3c,_0x28e50a);}async function importAESKey(_0x2e19b9){const _0x4c4e6f=_0x558412;return window[_0x4c4e6f(0x261)]['subtle'][_0x4c4e6f(0xb7)]('raw',_0x2e19b9,{'name':AES_CONFIG['MODE'],'length':AES_CONFIG[_0x4c4e6f(0xae)]},![],[_0x4c4e6f(0x1ec),'decrypt']);}async function importRSAPublicKey(_0x161cfb,_0x5e2e55){const _0x386118=_0x558412;return window[_0x386118(0x261)][_0x386118(0x98)][_0x386118(0xb7)](_0x386118(0x15f),_0x161cfb,{'name':RSA_CONFIG[_0x386118(0x243)],'hash':RSA_CONFIG[_0x386118(0xf3)]},![],[_0x386118(0x1ec)]);}async function importRSAPrivateKey(_0x1c3659,_0x1cbdb7){const _0x5465bf=_0x558412;return window[_0x5465bf(0x261)][_0x5465bf(0x98)][_0x5465bf(0xb7)](_0x5465bf(0xd5),_0x1c3659,{'name':RSA_CONFIG[_0x5465bf(0x243)],'hash':RSA_CONFIG['HASH']},![],[_0x5465bf(0x125)]);}async function importECCPublicKey(_0x10b33d,_0x22762c){const _0x30de0b=_0x558412;return window['crypto'][_0x30de0b(0x98)]['importKey'](_0x30de0b(0x15f),_0x10b33d,{'name':'ECDH','namedCurve':_0x22762c},![],[]);}async function importECCPrivateKey(_0x54605f,_0x5dc423){const _0x1da674=_0x558412;return window[_0x1da674(0x261)][_0x1da674(0x98)]['importKey'](_0x1da674(0xd5),_0x54605f,{'name':'ECDH','namedCurve':_0x5dc423},![],[_0x1da674(0x19c),_0x1da674(0x94)]);}async function saveToDatabase(_0x1be7c8,_0x19201d){return new Promise((_0x2c46be,_0x5ec223)=>{const _0x3a0f30=_0xb415;if(!db){_0x5ec223(new Error(_0x3a0f30(0x136)));return;}const _0x273787=db[_0x3a0f30(0xd6)](_0x1be7c8,_0x3a0f30(0xd7)),_0x102be0=_0x273787[_0x3a0f30(0x194)](_0x1be7c8),_0x48bee0=_0x102be0[_0x3a0f30(0x1b4)](_0x19201d);_0x48bee0[_0x3a0f30(0x255)]=()=>_0x2c46be(),_0x48bee0[_0x3a0f30(0x217)]=()=>_0x5ec223(_0x48bee0[_0x3a0f30(0x182)]);});}async function getFromDatabase(_0x4b388e,_0x2356a1){return new Promise((_0x27c819,_0x39f16f)=>{const _0x483378=_0xb415;if(!db){_0x39f16f(new Error('Database\x20not\x20initialized'));return;}const _0x3c1970=db[_0x483378(0xd6)](_0x4b388e,_0x483378(0x1af)),_0x34c13d=_0x3c1970[_0x483378(0x194)](_0x4b388e),_0x2cd99a=_0x34c13d[_0x483378(0x1da)](_0x2356a1);_0x2cd99a[_0x483378(0x255)]=()=>_0x27c819(_0x2cd99a[_0x483378(0x157)]),_0x2cd99a[_0x483378(0x217)]=()=>_0x39f16f(_0x2cd99a['error']);});}async function getAllFromDatabase(_0x47f574){return new Promise((_0x5f0c4a,_0x7fa89d)=>{const _0x4555bc=_0xb415;if(!db){_0x7fa89d(new Error(_0x4555bc(0x136)));return;}const _0x40baed=db[_0x4555bc(0xd6)](_0x47f574,_0x4555bc(0x1af)),_0x46de46=_0x40baed[_0x4555bc(0x194)](_0x47f574),_0x2cdafc=_0x46de46['getAll']();_0x2cdafc[_0x4555bc(0x255)]=()=>_0x5f0c4a(_0x2cdafc[_0x4555bc(0x157)]),_0x2cdafc[_0x4555bc(0x217)]=()=>_0x7fa89d(_0x2cdafc[_0x4555bc(0x182)]);});}async function clearDatabase(_0x529d3a){return new Promise((_0x3bc224,_0x1ee117)=>{const _0x2a6ac8=_0xb415;if(!db){_0x1ee117(new Error(_0x2a6ac8(0x136)));return;}const _0x2cb056=db[_0x2a6ac8(0xd6)](_0x529d3a,'readwrite'),_0x4ed2eb=_0x2cb056[_0x2a6ac8(0x194)](_0x529d3a),_0x2743e5=_0x4ed2eb[_0x2a6ac8(0xbd)]();_0x2743e5['onsuccess']=()=>_0x3bc224(),_0x2743e5[_0x2a6ac8(0x217)]=()=>_0x1ee117(_0x2743e5[_0x2a6ac8(0x182)]);});}window['exportKey']=exportKey,window[_0x558412(0x221)]=exportPrivateKey,window[_0x558412(0x1bc)]=deleteKey;let deferredPrompt;const installBtn=document[_0x558412(0x16b)](_0x558412(0x1f3)),installContainer=document[_0x558412(0x16b)](_0x558412(0x13e)),installStatus=document[_0x558412(0x16b)]('installStatus');installBtn&&(installBtn[_0x558412(0x1a2)]=!![]);window[_0x558412(0x214)](_0x558412(0x1bf),_0x228f4c=>{const _0x4c9810=_0x558412;_0x228f4c[_0x4c9810(0x101)](),deferredPrompt=_0x228f4c;if(installBtn){installBtn[_0x4c9810(0x1a2)]=![];const _0x1f23ca=installContainer['querySelector'](_0x4c9810(0x1e7));_0x1f23ca&&(_0x1f23ca[_0x4c9810(0x1ca)][_0x4c9810(0x236)]=_0x4c9810(0xa0)),showStatus('installStatus',_0x4c9810(0x162),_0x4c9810(0x105));}});installBtn&&installBtn[_0x558412(0x214)]('click',async()=>{const _0x2ed7da=_0x558412;if(!deferredPrompt){showStatus(_0x2ed7da(0xe5),_0x2ed7da(0x1b7),'warning');return;}deferredPrompt[_0x2ed7da(0x146)]();const {outcome:_0x57cb7c}=await deferredPrompt[_0x2ed7da(0xf0)];console[_0x2ed7da(0x184)]('User\x20response\x20to\x20install\x20prompt:\x20'+_0x57cb7c),_0x57cb7c===_0x2ed7da(0x239)?showStatus(_0x2ed7da(0xe5),_0x2ed7da(0x1b3),'success'):showStatus(_0x2ed7da(0xe5),_0x2ed7da(0x1cf),_0x2ed7da(0x220)),deferredPrompt=null,installBtn[_0x2ed7da(0x1a2)]=!![];});window['addEventListener'](_0x558412(0x147),()=>{const _0x2ba847=_0x558412;console[_0x2ba847(0x184)](_0x2ba847(0xf9)),deferredPrompt=null,installBtn&&(installBtn[_0x2ba847(0x1a2)]=!![]),showStatus(_0x2ba847(0xe5),_0x2ba847(0x1b3),'success');});_0x558412(0x24f)in navigator&&(window[_0x558412(0x135)]['protocol']===_0x558412(0x167)||window[_0x558412(0x135)][_0x558412(0x117)]==='localhost'||window[_0x558412(0x135)]['hostname']===_0x558412(0x18f))?window[_0x558412(0x214)](_0x558412(0x233),function(){const _0x31cdd=_0x558412;navigator[_0x31cdd(0x24f)]['register'](_0x31cdd(0xa6))[_0x31cdd(0x10a)](function(_0x3c4f10){const _0x535162=_0x31cdd;console[_0x535162(0x184)]('Service\x20Worker\x20registered\x20with\x20scope:',_0x3c4f10[_0x535162(0x124)]);})[_0x31cdd(0x238)](function(_0x3e7893){const _0x351311=_0x31cdd;console[_0x351311(0x182)](_0x351311(0x1a6),_0x3e7893),showStatus(_0x351311(0xe5),_0x351311(0x1c2),_0x351311(0x220));});}):(console[_0x558412(0x184)]('Service\x20Workers\x20not\x20supported\x20or\x20not\x20in\x20secure\x20context'),installStatus&&(window[_0x558412(0x135)][_0x558412(0xb1)]===_0x558412(0xc9)?showStatus(_0x558412(0xe5),_0x558412(0x1c3),'warning'):showStatus(_0x558412(0xe5),'Your\x20browser\x20does\x20not\x20support\x20PWA\x20installation\x20features.',_0x558412(0x220))));window[_0x558412(0x16e)](_0x558412(0x8c))[_0x558412(0x1a0)]&&(console['log']('App\x20is\x20already\x20running\x20in\x20standalone\x20mode\x20(installed)'),installStatus&&showStatus(_0x558412(0xe5),'Lemonade\x20is\x20running\x20as\x20an\x20installed\x20app',_0x558412(0x105)));let encryptFileData=null,encryptFileName='',decryptFileData=null,decryptFileName='';document[_0x558412(0x214)](_0x558412(0xbf),function(){const _0x15a9b4=_0x558412,_0x4a723b=document[_0x15a9b4(0x16b)](_0x15a9b4(0x11a)),_0x30cd25=document['getElementById'](_0x15a9b4(0x10e)),_0x1b398d=document[_0x15a9b4(0x16b)](_0x15a9b4(0xb0)),_0x39189b=document['getElementById'](_0x15a9b4(0x200)),_0x3473de=document[_0x15a9b4(0x16b)](_0x15a9b4(0x23d)),_0x566fdf=document['getElementById'](_0x15a9b4(0x9f)),_0x6a96da=document[_0x15a9b4(0x16b)](_0x15a9b4(0x206)),_0x57e8ad=document['getElementById'](_0x15a9b4(0x118)),_0x44ef47=document['getElementById'](_0x15a9b4(0xb3)),_0x275e09=document[_0x15a9b4(0x16b)](_0x15a9b4(0xcd)),_0x2b5d5d=document[_0x15a9b4(0x16b)](_0x15a9b4(0x9a)),_0x39dad2=document[_0x15a9b4(0x16b)](_0x15a9b4(0x1ed));_0x30cd25['addEventListener'](_0x15a9b4(0x8e),()=>{const _0x20cedc=_0x15a9b4;_0x4a723b[_0x20cedc(0x8e)]();}),_0x4a723b[_0x15a9b4(0x214)]('change',_0x3f5101=>{const _0x168a75=_0x15a9b4;handleEncryptFileSelect(_0x3f5101[_0x168a75(0x1b1)][_0x168a75(0x1d9)]);}),_0x3473de[_0x15a9b4(0x214)](_0x15a9b4(0x8e),()=>{clearEncryptFile();}),_0x6a96da[_0x15a9b4(0x214)](_0x15a9b4(0x8e),()=>{const _0x45b9ab=_0x15a9b4;_0x566fdf[_0x45b9ab(0x8e)]();}),_0x566fdf[_0x15a9b4(0x214)](_0x15a9b4(0x1a1),_0x57e95c=>{const _0x1ef368=_0x15a9b4;handleDecryptFileSelect(_0x57e95c[_0x1ef368(0x1b1)][_0x1ef368(0x1d9)]);}),_0x275e09['addEventListener']('click',()=>{clearDecryptFile();}),createKeyFileInput(),_0x2b5d5d[_0x15a9b4(0x214)](_0x15a9b4(0x8e),downloadEncryptedFile),_0x39dad2['addEventListener'](_0x15a9b4(0x8e),downloadDecryptedFile),document['getElementById'](_0x15a9b4(0x1ae))['addEventListener'](_0x15a9b4(0x8e),function(){window['decryptedBinaryData']=null;}),document[_0x15a9b4(0x16b)](_0x15a9b4(0x22d))[_0x15a9b4(0x214)](_0x15a9b4(0x8e),confirmPasswordModal),document[_0x15a9b4(0x16b)]('passwordModalCancel')['addEventListener']('click',cancelPasswordModal),document['getElementById']('passwordModalInput')[_0x15a9b4(0x214)](_0x15a9b4(0x172),updateModalPasswordStrength),document[_0x15a9b4(0x16b)](_0x15a9b4(0x201))[_0x15a9b4(0x214)](_0x15a9b4(0x129),function(_0x29d97e){const _0x37d874=_0x15a9b4;_0x29d97e[_0x37d874(0x109)]===_0x37d874(0x8a)&&confirmPasswordModal();}),document[_0x15a9b4(0x214)]('keydown',function(_0x474562){const _0x5de34f=_0x15a9b4;_0x474562[_0x5de34f(0x109)]===_0x5de34f(0x121)&&document['getElementById'](_0x5de34f(0x100))[_0x5de34f(0x1ca)]['display']===_0x5de34f(0x1bd)&&cancelPasswordModal();});});function handleEncryptFileSelect(_0x1dd0b2){const _0x534173=_0x558412;if(_0x1dd0b2[_0x534173(0x18c)]===0x0)return;const _0x289301=_0x1dd0b2[0x0];encryptFileName=_0x289301[_0x534173(0xe7)];const _0x2b52ad=new FileReader();_0x2b52ad[_0x534173(0x10b)]=function(_0x277e6c){const _0xb772d8=_0x534173;encryptFileData=_0x277e6c[_0xb772d8(0x1b1)]['result'],document['getElementById']('encryptMessage')[_0xb772d8(0x1f4)]='File:\x20'+encryptFileName+'\x20('+formatFileSize(_0x289301[_0xb772d8(0x14f)])+')',document[_0xb772d8(0x16b)](_0xb772d8(0xb0))['style'][_0xb772d8(0x236)]=_0xb772d8(0x1bd),document[_0xb772d8(0x16b)]('encryptFileName')[_0xb772d8(0xe9)]=encryptFileName;},_0x2b52ad['readAsArrayBuffer'](_0x289301);}function handleDecryptFileSelect(_0x3e67){const _0x176665=_0x558412;if(_0x3e67[_0x176665(0x18c)]===0x0)return;const _0x24c072=_0x3e67[0x0];decryptFileName=_0x24c072[_0x176665(0xe7)];const _0x20e577=new FileReader();_0x20e577[_0x176665(0x10b)]=function(_0x232dcc){const _0x170687=_0x176665,_0x29f99f=_0x232dcc[_0x170687(0x1b1)][_0x170687(0x157)];document[_0x170687(0x16b)](_0x170687(0x17e))[_0x170687(0x1f4)]=_0x29f99f,decryptFileData=null,document[_0x170687(0x16b)](_0x170687(0x118))['style'][_0x170687(0x236)]=_0x170687(0x1bd),document['getElementById'](_0x170687(0xb3))[_0x170687(0xe9)]=decryptFileName,showStatus(_0x170687(0xe4),_0x170687(0xb6),_0x170687(0x105));},_0x20e577[_0x176665(0x217)]=function(){const _0x3a44a9=_0x176665;showStatus(_0x3a44a9(0xe4),_0x3a44a9(0x20a),_0x3a44a9(0x182));},_0x20e577[_0x176665(0x1c9)](_0x24c072);}function clearEncryptFile(){const _0x54f3d6=_0x558412;encryptFileData=null,encryptFileName='',document[_0x54f3d6(0x16b)](_0x54f3d6(0x1d7))[_0x54f3d6(0x1f4)]='',document['getElementById'](_0x54f3d6(0xb0))['style']['display']=_0x54f3d6(0xa0),document[_0x54f3d6(0x16b)]('encryptFileInput')[_0x54f3d6(0x1f4)]='';}function clearDecryptFile(){const _0x56fd2e=_0x558412;decryptFileData=null,decryptFileName='',document['getElementById'](_0x56fd2e(0x17e))[_0x56fd2e(0x1f4)]='',document[_0x56fd2e(0x16b)](_0x56fd2e(0x118))['style']['display']=_0x56fd2e(0xa0),document['getElementById'](_0x56fd2e(0x9f))['value']='';}function formatFileSize(_0xd691b4){const _0x4bd0bc=_0x558412;if(_0xd691b4===0x0)return _0x4bd0bc(0x25c);const _0x583977=0x400,_0x456d7f=['Bytes','KB','MB','GB'],_0x3ef20f=Math[_0x4bd0bc(0x1fa)](Math[_0x4bd0bc(0x184)](_0xd691b4)/Math[_0x4bd0bc(0x184)](_0x583977));return parseFloat((_0xd691b4/Math[_0x4bd0bc(0x234)](_0x583977,_0x3ef20f))[_0x4bd0bc(0x1d3)](0x2))+'\x20'+_0x456d7f[_0x3ef20f];}function generateRandomFileName(_0x521e44=0x6){const _0x43b8bc=_0x558412,_0xa485eb='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let _0x107f7f='';for(let _0x582f9b=0x0;_0x582f9b<_0x521e44;_0x582f9b++){_0x107f7f+=_0xa485eb[_0x43b8bc(0xe8)](Math[_0x43b8bc(0x1fa)](Math['random']()*_0xa485eb['length']));}return _0x107f7f;}
    </script><div id="passwordModal" class="modal"><div class="modal-content"><h3 id="passwordModalTitle">Enter Password</h3><p id="passwordModalMessage">Please enter a password to continue:</p><div class="form-group"><input type="password" id="passwordModalInput" placeholder="Enter password"><div id="passwordModalStrength" class="password-strength"></div><div id="passwordModalFeedback" class="password-feedback"></div></div><div class="btn-group"><button id="passwordModalConfirm" class="btn-primary">Confirm</button><button id="passwordModalCancel" class="btn-secondary">Cancel</button></div></div></div></body></html>
