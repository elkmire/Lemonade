<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Referrer-Policy" content="no-referrer">
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=()">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Lemonade">
    <link rel="icon" href="icon.svg">
    <link rel="apple-touch-icon" href="icon.svg">
    <link rel="manifest" href="manifest.json">
    <title>LC5</title>
    <style>
/* CSS with dark/light mode support */
:root {
    --bg-color: #ffffff;
    --text-color: #000000;
    --title-gradient: linear-gradient(90deg, #000000, #000000);
    --card-bg: #ffffff;
    --accent-color: #000000;
    --border-color: #dddddd;
    --input-bg: #ffffff;
    --button-bg: #000000;
    --button-text: #ffffff;
    --button-hover: #333333;
    --success-color: #00cc66;
    --error-color: #cc3300;
    --warning-color: #f0ad4e;
    --cyber-line: rgba(0, 0, 0, 0.15); /* Kept for light mode, dark mode will override */
    --cyber-glow: rgba(0, 0, 0, 0.4); /* Kept for light mode, dark mode will override */
    --security-high: #00cc66;
    --security-medium: #f0ad4e;
    --security-low: #cc3300;
    --output-bg: #f8f8f8;
    --output-text: #222222;
}

/* Dark mode class */
body.dark-mode {
    --bg-color: #000000; /* Pitch black background */
    --text-color: #E0E0E0; /* Light grey/off-white for general text */
    --title-gradient: linear-gradient(90deg, #39FF14, #FF00FF, #00FFFF); /* Green, Pink, Blue */
    --card-bg: #0A0A0A; /* Very dark grey, almost black, solid */
    --accent-color: #39FF14; /* Terminal Green */
    --border-color: #2A2A2A; /* Darker grey for subtle borders */
    --input-bg: #101010; /* Dark grey for inputs */
    --button-bg: #00FFFF; /* Cyber Blue for buttons */
    --button-text: #000000; /* Black for text on blue buttons */
    --button-hover: #FF00FF; /* Hot Pink for button hover */
    --success-color: #39FF14; /* Terminal Green for success */
    --error-color: #FF3131; /* Neon Red for error */
    --warning-color: #FFFF00; /* Neon Yellow for warning */
    --cyber-line: rgba(57, 255, 20, 0.3); /* Terminal Green, slightly transparent line */
    --cyber-glow: rgba(57, 255, 20, 0.1); /* Terminal Green, very subtle glow or none */
    --security-high: #39FF14;
    --security-medium: #FFFF00;
    --security-low: #FF3131;
    --output-bg: #050505; /* Even darker for output boxes */
    --output-text: #B2F2BB; /* Light terminal green for output text */
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    transition: background-color 0.3s, color 0.3s;
    line-height: 1.6;
    position: relative;
    overflow-x: hidden;
}

body::before {
    display: none; /* Removed psychedelic background for performance */
}

/* Solid Black Background for Dark Mode */
body.dark-mode::before {
    content: "";
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    background-color: #000000; /* Pitch black */
    opacity: 1;
}

/* Static scanlines overlay (kept as it's not resource-intensive) */
body.dark-mode::after {
    content: "";
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1; /* Ensure it's behind content */
    background: repeating-linear-gradient(
        0deg,
        rgba(57, 255, 20, 0.05), /* Very subtle green scanlines */
        rgba(57, 255, 20, 0.05) 1px,
        transparent 1px,
        transparent 3px /* Increased spacing for subtlety */
    );
    pointer-events: none;
}

/* Enhanced App Title - No animation */
body.dark-mode .app-title {
    background: var(--title-gradient);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    text-shadow: none; /* Removed text-shadow */
    /* animation: title-shift 5s ease infinite; REMOVED */
}

/* Enhanced Cards - No animation or heavy shadows */
body.dark-mode .card {
    border: 1px solid var(--accent-color); /* Terminal green border */
    box-shadow: none; /* Removed box-shadow */
    backdrop-filter: none; /* Removed backdrop-filter */
    /* animation: border-pulse 4s infinite; REMOVED */
}

/* Enhanced Buttons - No animation or heavy shadows */
body.dark-mode button {
    border: 1px solid transparent;
    box-shadow: none; /* Removed box-shadow */
    text-shadow: none; /* Removed text-shadow */
    transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease; /* Simplified transition */
    position: relative;
    overflow: hidden;
}

body.dark-mode button:hover {
    background-color: var(--button-hover); /* Uses --button-hover (Hot Pink) */
    color: var(--button-text); /* Ensure text remains readable, or set a specific hover text color */
    box-shadow: none; /* Ensure no shadow on hover */
    transform: translateY(-1px); /* Slight lift effect */
}

/* Removed Psychedelic button effects */
body.dark-mode button::before {
    display: none; /* Removed animated gradient */
}

/* Enhanced Input Fields - No animation or heavy shadows */
body.dark-mode input,
body.dark-mode textarea,
body.dark-mode select {
    border: 1px solid var(--border-color);
    box-shadow: none; /* Removed inset shadow */
    backdrop-filter: none; /* Removed backdrop-filter */
    transition: border-color 0.2s ease; /* Simplified transition */
}

body.dark-mode input:focus,
body.dark-mode textarea:focus,
body.dark-mode select:focus {
    border-color: var(--accent-color); /* Terminal green border on focus */
    box-shadow: none; /* Removed focus shadow and animation */
    /* animation: focus-pulse 2s infinite; REMOVED */
}

/* Enhanced Security Badges - No animation */
body.dark-mode .security-badge {
    /* animation: security-pulse 2s infinite; REMOVED */
    text-shadow: none; /* Removed text-shadow */
}

/* Enhanced Key Items - Simplified */
body.dark-mode .key-item {
    border: 1px solid var(--border-color);
    background-color: var(--card-bg); /* Consistent with card background */
    box-shadow: none; /* Removed box-shadow */
    transition: border-color 0.2s ease; /* Simplified transition */
}

body.dark-mode .key-item:hover {
    transform: none; /* Removed transform */
    border-color: var(--accent-color); /* Green border on hover */
    box-shadow: none;
}

/* Tab Button Enhancement - Simplified */
body.dark-mode .tab-btn.active {
    background-color: var(--accent-color); /* Terminal green background */
    color: var(--button-text); /* Black text for contrast */
    border-bottom-color: var(--accent-color);
    box-shadow: none;
    /* animation: tab-shift 3s infinite; REMOVED */
}
body.dark-mode .tab-btn:hover:not(.active) {
    color: var(--accent-color);
    border-bottom-color: var(--accent-color);
}


/* Switch slider enhancement - Simplified */
body.dark-mode .slider {
    background-color: #333; /* Dark grey for off state */
    box-shadow: none;
}

body.dark-mode input:checked + .slider {
    background-color: var(--accent-color); /* Terminal green for on state */
}

body.dark-mode .slider:before {
    box-shadow: none;
    background-color: #111; /* Darker circle */
}
body.dark-mode input:checked + .slider:before {
    background-color: #000; /* Black circle when active */
}


/* Status enhancement - No animation */
body.dark-mode .status.success,
body.dark-mode .status.warning,
body.dark-mode .status.error {
    /* animation: status-pulse 2s infinite; REMOVED */
    border-width: 1px;
    border-style: solid;
}
body.dark-mode .status.success { background-color: rgba(57, 255, 20, 0.1); border-color: var(--success-color); color: var(--success-color); }
body.dark-mode .status.warning { background-color: rgba(255, 255, 0, 0.1); border-color: var(--warning-color); color: var(--warning-color); }
body.dark-mode .status.error { background-color: rgba(255, 49, 49, 0.1); border-color: var(--error-color); color: var(--error-color); }


/* Loading animation enhancement - Simplified */
body.dark-mode .spinner {
    border: 3px solid rgba(224, 224, 224, 0.2); /* Lighter, subtle border */
    border-top-color: var(--accent-color); /* Terminal Green */
    /* animation: spin 1s ease-in-out infinite, color-shift 3s linear infinite; REMOVED color-shift */
    animation: spin 1s linear infinite; /* Kept spin animation */
}

/* Ensure base styles for .app-title are present if needed */
.app-title {
    font-size: 1.8rem;
    margin: 0;
    background: var(--title-gradient); /* Ensure this is applied for light mode too */
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    /* text-shadow: 0 0 15px var(--cyber-glow); /* Potentially remove for light mode too if desired */
}

/* Updated Dark Mode styles for elements previously animated or heavily styled */
body.dark-mode .app-header::after {
    background: linear-gradient(90deg, transparent, var(--accent-color), transparent); /* Green accent line */
}

body.dark-mode .card::before { /* Top border highlight for card */
    background: var(--accent-color); /* Solid Green */
    height: 2px;
}

body.dark-mode .tab-btn:hover::after {
    background-color: var(--accent-color); /* Green underline on hover */
}

body.dark-mode input:focus, 
body.dark-mode textarea:focus, 
body.dark-mode select:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px var(--cyber-glow); /* Using the new subtle glow */
}

body.dark-mode .btn-secondary {
    border: 1px solid var(--accent-color); /* Green border */
    color: var(--accent-color); /* Green text */
    background-color: transparent;
}

body.dark-mode .btn-secondary:hover {
    background-color: rgba(57, 255, 20, 0.1); /* Slight green tint on hover */
    color: #39FF14; /* Brighter green text on hover */
}

/* Security Badges in Dark Mode - Static, no pulse */
body.dark-mode .security-badge {
    /* animation: securityPulse 2s infinite; REMOVED */
    transition: none;
}
body.dark-mode .security-badge.high { background-color: rgba(57, 255, 20, 0.1); color: var(--security-high); border: 1px solid var(--security-high); box-shadow: none; }
body.dark-mode .security-badge.medium { background-color: rgba(255, 255, 0, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); box-shadow: none; }
body.dark-mode .security-badge.low { background-color: rgba(255, 49, 49, 0.1); color: var(--security-low); border: 1px solid var(--security-low); box-shadow: none; }

/* Key Pair Badges in Dark Mode - Static */
body.dark-mode .key-pair-badge.full { background-color: rgba(57, 255, 20, 0.1); color: var(--security-high); border: 1px solid var(--security-high); box-shadow: none; }
body.dark-mode .key-pair-badge.private { background-color: rgba(255, 49, 49, 0.1); color: var(--security-low); border: 1px solid var(--security-low); box-shadow: none; }
body.dark-mode .key-pair-badge.public { background-color: rgba(255, 255, 0, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); box-shadow: none; }

body.dark-mode .private-key-btn {
    border: 1px solid var(--error-color) !important;
    color: var(--error-color) !important;
}
body.dark-mode .private-key-btn:hover {
    background-color: rgba(255, 49, 49, 0.2) !important;
    color: #FF3131 !important; /* Brighter red on hover */
}

/* Modal Content in Dark Mode */
body.dark-mode .modal-content {
    border: 1px solid var(--accent-color); /* Green border */
    box-shadow: none; /* Removed glow */
    background-color: var(--card-bg); /* Consistent with card backgrounds */
}

/* Primary button in dark mode (often used in modals) */
body.dark-mode .btn-primary {
    background-color: var(--accent-color); /* Green */
    color: #000000; /* Black text for contrast */
}
body.dark-mode .btn-primary:hover {
    background-color: #4CFF3A; /* Lighter green for hover */
}

/* Zero Keys button dark mode override */
body.dark-mode .btn-zero {
    background-color: var(--error-color); /* Neon Red */
    color: #FFFFFF; /* White text for contrast */
    border: 1px solid #FF0000; /* Brighter Red border */
}
body.dark-mode .btn-zero:hover {
    background-color: #FF5555; /* Lighter Neon Red */
}

/* Ensure general body styles and other non-dark-mode specific styles remain below */

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    transition: background-color 0.3s, color 0.3s;
    line-height: 1.6;
    position: relative;
    overflow-x: hidden;
}

/* Base container - Responsive container sizing */
.container {
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
    transition: max-width 0.3s ease-in-out;
}

.app-header {
    text-align: center;
    margin-bottom: 20px;
    position: relative;
}

/* .app-title is already defined above with dark mode considerations */

.app-subtitle {
    font-size: 0.9rem;
    margin: 0;
    padding-top: 2px;
    font-style: italic;
    color: var(--text-color);
    opacity: 0.8;
}

.app-header::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 80%;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
}

.card {
    background-color: var(--card-bg);
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    padding: 20px;
    margin-bottom: 20px;
    border: 1px solid var(--border-color);
    position: relative;
    overflow: hidden;
}

.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, #33aaff, #0066cc); /* Default for light mode */
}
/* Dark mode card::before is handled by body.dark-mode .card::before */


.tabs {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
    border-bottom: 1px solid var(--border-color);
    overflow-x: auto; /* Allow scrolling on small screens */
}

.tab-btn {
    background: none;
    border: none;
    padding: 10px 20px;
    font-size: 1rem;
    cursor: pointer;
    color: var(--text-color);
    border-bottom: 2px solid transparent;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
    white-space: nowrap; /* Prevent text wrapping */
}

.tab-btn.active {
    border-bottom: 2px solid var(--accent-color);
    color: var(--accent-color);
}
/* body.dark-mode .tab-btn.active is already defined */

.tab-btn::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background-color: var(--accent-color);
    transition: width 0.3s;
}

.tab-btn:hover::after {
    width: 100%;
}
/* body.dark-mode .tab-btn:hover::after is already defined */

.tab-content {
    display: none !important;
}

.tab-content.active {
    display: block !important;
    /* animation: fadeIn 0.3s ease-in-out; REMOVED animation for performance */
}

/* @keyframes fadeIn { REMOVED
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
} */

.form-group {
    margin-bottom: 15px;
}

label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
}

input, textarea, select {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background-color: var(--input-bg);
    color: var(--text-color);
    font-size: 1rem;
    box-sizing: border-box;
    transition: border-color 0.3s, box-shadow 0.3s;
}

input:focus, textarea:focus, select:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 2px var(--cyber-glow); /* Default glow, dark mode overrides this */
}
/* body.dark-mode input:focus etc. is already defined */


/* Enhanced output textareas */
#encryptedOutput,
#decryptedOutput {
    min-height: 120px;
    background-color: var(--output-bg);
    color: var(--output-text);
    border-width: 1px;
    border-style: solid;
    border-color: var(--border-color);
    font-family: 'Consolas', 'Courier New', monospace;
    width: 100%;
    resize: vertical;
    padding: 15px;
    overflow-y: auto;
}

/* Make sure parent containers don't restrict width */
.form-group:has(#encryptedOutput),
.form-group:has(#decryptedOutput) {
    width: 100%;
}

/* Non :has() fallback for better browser compatibility */
#encrypt .form-group:nth-of-type(3),
#decrypt .form-group:nth-of-type(3) {
    width: 100%;
}

textarea {
    min-height: 100px;
    resize: vertical;
}

button {
    background-color: var(--button-bg);
    color: var(--button-text);
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.1s;
    position: relative;
    overflow: hidden;
}

button:hover {
    background-color: var(--button-hover);
}
/* body.dark-mode button:hover is already defined */


button:active {
    transform: scale(0.98);
}

/* Removed ripple effect for performance */
button::after {
    display: none;
}
/* @keyframes ripple { REMOVED ... } */

.btn-group {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}

.btn-secondary {
    background-color: transparent;
    border: 1px solid var(--accent-color);
    color: var(--accent-color);
}
/* body.dark-mode .btn-secondary is already defined */

.btn-secondary:hover {
    background-color: rgba(0,0,0, 0.05); /* Subtle hover for light mode */
}
/* body.dark-mode .btn-secondary:hover is already defined */

.status {
    padding: 10px;
    border-radius: 8px;
    margin-top: 15px;
    display: none; /* Hidden by default */
}

.status.success {
    background-color: rgba(0, 204, 102, 0.1);
    color: var(--success-color);
    border: 1px solid var(--success-color);
    display: block;
}

.status.warning {
    background-color: rgba(240, 173, 78, 0.1);
    color: var(--warning-color);
    border: 1px solid var(--warning-color);
    display: block;
}

.status.error {
    background-color: rgba(204, 51, 0, 0.1);
    color: var(--error-color);
    border: 1px solid var(--error-color);
    display: block;
}
/* body.dark-mode .status styles are already defined */

.keys-container {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.keys-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px;
    width: 100%;
}

.key-form {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.key-item {
    background-color: var(--input-bg); /* Light mode uses input background */
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 15px;
    display: flex;
    flex-direction: column;
    height: 100%;
}
/* body.dark-mode .key-item is already defined */


.key-item-content {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.key-item h3 {
    margin-top: 0;
    margin-bottom: 10px;
}

.key-header {
    text-align: center;
    margin-bottom: 15px;
}

.key-actions {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
    margin-top: auto;
    padding-top: 15px;
    border-top: 1px solid var(--border-color);
}

.key-actions button {
    flex: 1 1 auto;
    min-width: 80px;
    padding: 8px 12px;
    font-size: 0.9rem;
}

.key-meta {
    font-size: 0.9rem;
    color: #888; /* Consistent for both modes, or use var(--text-color) with opacity */
    margin-bottom: 5px;
}

.key-management-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 20px;
}

.key-management-buttons button {
    flex: 1 1 auto;
    min-width: 100px;
}

.btn-zero {
    background-color: #cc3300;
    color: white;
    margin-top: 20px;
    width: 100%;
    font-weight: bold;
    border: 1px solid #aa2200;
}
.btn-zero:hover {
    background-color: #ff3300;
}
/* body.dark-mode .btn-zero is already defined */


.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent black */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    display: none; /* Hidden by default */
}

.spinner {
    width: 50px;
    height: 50px;
    border: 5px solid rgba(255, 255, 255, 0.3); /* Default for light mode, or when overlay is on light bg */
    border-radius: 50%;
    border-top-color: var(--accent-color); /* Uses current accent color */
    animation: spin 1s linear infinite; /* Simplified animation */
}
/* body.dark-mode .spinner is already defined */

@keyframes spin {
    to { transform: rotate(360deg); }
}
/* @keyframes color-shift { REMOVED ... } */


.password-strength {
    height: 5px;
    border-radius: 5px;
    margin-top: 5px;
    transition: all 0.3s;
}
.password-strength.weak { background-color: var(--security-low); width: 30%; }
.password-strength.medium { background-color: var(--security-medium); width: 60%; }
.password-strength.strong { background-color: var(--security-high); width: 100%; }

.password-feedback {
    font-size: 0.8rem;
    margin-top: 5px;
    color: var(--text-color); /* Ensure it's readable in dark mode */
    opacity: 0.9;
}

.security-badge {
    display: inline-flex;
    align-items: center;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    margin-left: 8px;
    font-weight: bold;
}
.security-badge.high { background-color: rgba(0, 204, 102, 0.1); color: var(--security-high); border: 1px solid var(--security-high); }
.security-badge.medium { background-color: rgba(240, 173, 78, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); }
.security-badge.low { background-color: rgba(204, 51, 0, 0.1); color: var(--security-low); border: 1px solid var(--security-low); }
/* body.dark-mode .security-badge (static) is already defined */

/* @keyframes securityPulse { REMOVED ... } */


.key-pair-badge {
    display: inline-flex;
    align-items: center;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: bold;
    margin-top: 5px;
}
.key-pair-badge.full { background-color: rgba(0, 204, 102, 0.1); color: var(--security-high); border: 1px solid var(--security-high); }
.key-pair-badge.private { background-color: rgba(204, 51, 0, 0.1); color: var(--security-low); border: 1px solid var(--security-low); }
.key-pair-badge.public { background-color: rgba(240, 173, 78, 0.1); color: var(--security-medium); border: 1px solid var(--security-medium); }
/* body.dark-mode .key-pair-badge (static) is already defined */


.private-key-btn { /* Base style for light mode */
    border: 1px solid var(--error-color) !important;
    color: var(--error-color) !important;
}
.private-key-btn:hover {
    background-color: rgba(204, 51, 0, 0.1) !important;
}
/* body.dark-mode .private-key-btn is already defined */


.config-toggle {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}
.config-toggle label {
    display: inline;
    margin-bottom: 0;
}

.switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 24px;
}
.switch input { opacity: 0; width: 0; height: 0; }

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc; /* Light mode off */
    transition: .4s;
    border-radius: 24px;
}
.slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: white; /* Light mode handle */
    transition: .4s;
    border-radius: 50%;
}
input:checked + .slider { background-color: var(--accent-color); } /* Uses current accent */
input:focus + .slider { box-shadow: 0 0 1px var(--accent-color); }
input:checked + .slider:before { transform: translateX(26px); }
/* body.dark-mode .slider styles are already defined */


.security-info {
    font-size: 0.9rem;
    padding: 10px;
    border-left: 3px solid var(--accent-color);
    background-color: rgba(0,0,0, 0.03); /* Very light grey for light mode */
    margin-bottom: 15px;
}
body.dark-mode .security-info {
    background-color: rgba(57, 255, 20, 0.05); /* Subtle green background */
    border-left-color: var(--accent-color); /* Green left border */
    color: var(--text-color);
}

.key-expiry {
    font-size: 0.8rem;
    color: var(--warning-color); /* Uses warning color */
    margin-top: 5px;
    font-style: italic;
}

#inactivityModal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 1001;
    justify-content: center;
    align-items: center;
}
.modal-content { /* Base styles for modal, dark mode overrides parts of this */
    background-color: var(--card-bg);
    padding: 20px;
    border-radius: 12px;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3); /* Light mode shadow */
    width: 90%; /* Added for responsiveness */
    position: relative; /* Added for positioning context if needed */
}
/* body.dark-mode .modal-content is already defined */

.timer {
    font-size: 2rem;
    margin: 20px 0;
    color: var(--warning-color);
}

#settings { display: none; } /* Base, active state is .tab-content.active */

.settings-section { margin-bottom: 20px; }
.settings-section h3 {
    margin-top: 0;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 5px;
}

.file-info {
    margin-top: 10px;
    font-size: 0.9rem;
    background-color: var(--input-bg);
    padding: 8px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}
.file-info-name { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.file-icon { margin-right: 8px; font-size: 1.2rem; }
.remove-file { cursor: pointer; color: var(--error-color); padding: 2px 6px; border-radius: 4px; margin-left: 8px; }
.remove-file:hover { background-color: rgba(204, 51, 0, 0.1); } /* Light mode hover */
body.dark-mode .remove-file:hover { background-color: rgba(255, 49, 49, 0.2); }


/* Password Modal Styles */
.modal { /* General modal styling, used by passwordModal too */
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 1001;
    justify-content: center;
    align-items: center;
}

.btn-primary { /* Base btn-primary, dark mode overrides */
    background-color: var(--accent-color);
    color: var(--button-text);
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.1s;
}
.btn-primary:hover {
    background-color: var(--button-hover);
}
/* body.dark-mode .btn-primary is already defined */


/* Mobile Optimization */
@media (max-width: 600px) {
    .container { padding: 15px; }
    .card { padding: 15px; }
    .app-title { font-size: 1.5rem; }
    .btn-group { flex-direction: column; }
    /* button { width: 100%; } This was too broad, specific buttons might need this */
    .btn-group button { width: 100%; } /* Apply to buttons within btn-group */
    .key-actions button { width: 100%; margin-bottom: 5px; }


    .tab-btn { padding: 10px 10px; font-size: 0.9rem; }
    .key-actions { flex-direction: column; }
}

@media (max-width: 767px) {
    .keys-container { flex-direction: column; }
    .key-form, .keys-list-container { width: 100%; }
}

/* Medium screens (tablets and small desktops) */
@media (min-width: 768px) {
    .container { max-width: 750px; }
    .app-title { font-size: 2rem; }
    .card { padding: 25px; }
    #encryptedOutput, #decryptedOutput { min-height: 150px; font-size: 1.05rem; }
    .keys-container { flex-direction: row; align-items: flex-start; }
    .key-form { width: 40%; position: sticky; top: 20px; }
    .keys-list-container { width: 60%; }
    .key-item h3 { font-size: 1.1rem; margin-top: 0; margin-bottom: 10px; word-break: break-word; }
}

/* Large screens (desktops and large tablets in landscape) */
@media (min-width: 1024px) {
    .container { max-width: 900px; }
    #encryptedOutput, #decryptedOutput { min-height: 180px; font-size: 1.1rem; padding: 18px; }
    #keys .card { display: flex; flex-wrap: wrap; gap: 20px; }
    #keys .card > h2, #keys .card > .security-info { width: 100%; }
    #keys .card > .form-group, #keys .card > button#generateKeyBtn { width: calc(40% - 10px); }
    #keys .card > div:has(#keysList) { width: calc(60% - 10px); margin-top: 0; }
    #keys .card > div:nth-last-child(3) { /* Fallback */ width: calc(60% - 10px); margin-top: 0; }
    #keys .card > .btn-group, #keys .card > div:has(#zeroKeysBtn) { width: 100%; }
    #encrypt .card, #decrypt .card { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    #encrypt .card > .form-group:first-child,
    #decrypt .card > .form-group:first-child,
    #encrypt .card > .form-group:has(#encryptedOutput),
    #decrypt .card > .form-group:has(#decryptedOutput),
    #encrypt .card > .form-group:nth-child(3), /* Fallback */
    #decrypt .card > .form-group:nth-child(3) /* Fallback */
    { grid-column: 1 / span 2; }
    #encrypt .card > button, #decrypt .card > button { grid-column: 1 / span 2; }
    #encrypt .card > .btn-group, #decrypt .card > .btn-group { grid-column: 1 / span 2; }
    #encrypt .card > #encryptStatus, #decrypt .card > #decryptStatus { grid-column: 1 / span 2; }
}

@media (min-width: 1200px) {
    .container { max-width: 1140px; }
    .keys-grid { grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); }
}

/* Extra large screens */
@media (min-width: 1440px) {
    .container { max-width: 1200px; }
    #encryptedOutput, #decryptedOutput { min-height: 220px; font-size: 1.15rem; padding: 20px; }
    #settings .card { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
    #settings .card > h2 { grid-column: 1 / span 2; }
    #settings .card > .btn-group { grid-column: 1 / span 2; justify-content: center; }
    #settings .card > #settingsStatus { grid-column: 1 / span 2; }
    #keysList { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }

    @media (min-width: 1800px) {
        #encrypt .card, #decrypt .card { grid-template-columns: 1fr 1fr 1fr; }
        #encrypt .card > .form-group:first-child,
        #decrypt .card > .form-group:first-child,
        #encrypt .card > .form-group:has(#encryptedOutput),
        #decrypt .card > .form-group:has(#decryptedOutput),
        #encrypt .card > .form-group:nth-child(3), /* Fallback */
        #decrypt .card > .form-group:nth-child(3), /* Fallback */
        #encrypt .card > button, #decrypt .card > button,
        #encrypt .card > .btn-group, #decrypt .card > .btn-group,
        #encrypt .card > #encryptStatus, #decrypt .card > #decryptStatus
        { grid-column: 1 / span 3; }
    }
}

/* Ensure button groups stack properly on mobile but stay horizontal on larger screens */
/* This is already handled well by the (max-width: 600px) rule for .btn-group */
@media (min-width: 601px) {
    .btn-group { flex-direction: row; }
    .btn-group button { flex: 1; }
}


/* Print styles */
@media print {
    body { background-color: white; color: black; }
    body.dark-mode { /* Override dark mode for print */
        --bg-color: #ffffff;
        --text-color: #000000;
        --card-bg: #ffffff;
        --border-color: #dddddd;
        --input-bg: #ffffff;
        --output-bg: #f8f8f8;
        --output-text: #222222;
    }
    body.dark-mode .app-title { /* Ensure title is visible when printing from dark mode */
        background: none;
        color: #000000;
        text-shadow: none;
    }
    body.dark-mode .tab-btn.active {
        color: #000000; /* Black text for active tab in print */
        background: none;
    }
    body.dark-mode .security-info {
        background-color: #f0f0f0;
        border-left-color: #ccc;
        color: #000;
    }


    .card { box-shadow: none; border: 1px solid #ddd; }
    .btn-group, button, .tabs, .app-subtitle, .key-actions, .key-management-buttons, .config-toggle, #installContainer, .remove-file { display: none !important; }
    .container { max-width: 100%; padding: 0; }
    #encryptedOutput, #decryptedOutput { border: 1px solid #ddd; background-color: white; color: black; min-height: auto; }
    .key-item { page-break-inside: avoid; }
    .keys-grid { grid-template-columns: 1fr !important; } /* Single column for printing keys */
}
    </style>
</head>
<body>
    <div class="container">
        <div class="app-header">
            <h1 class="app-title">LC5</h1>
            <div class="app-subtitle">by elkmire</div>
            <p>Secure MSG/FILE option</p>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" data-tab="encrypt">Encrypt</button>
            <button class="tab-btn" data-tab="decrypt">Decrypt</button>
            <button class="tab-btn" data-tab="keys">Key Management</button>
            <button class="tab-btn" data-tab="settings">Settings</button>
        </div>
        
        <div class="tab-content active" id="encrypt">
            <div class="card">
                <div class="form-group">
                    <label for="encryptMessage">To Encrypt</label>
                    <textarea id="encryptMessage" placeholder="Free-type here or load file for encryption..."></textarea>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <button id="encryptBrowseBtn" class="btn-secondary">Browse Files</button>
                        <button id="clearEncryptMessageBtn" class="btn-secondary">Clear</button>
                        <input type="file" id="encryptFileInput" style="display: none;">
                    </div>
                    <div id="encryptFileInfo" style="display: none;" class="file-info">
                        <span><span class="file-icon">ðŸ“„</span> <span id="encryptFileName" class="file-info-name"></span></span>
                        <span class="remove-file" id="removeEncryptFile">Ã—</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="encryptionKey">Encryption Key</label>
                    <select id="encryptionKey">
                        <option value="">Select a key...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="encryptObfKey">OBF Key</label>
                    <input type="text" id="encryptObfKey" placeholder="Optional*">
                </div>
                <div class="form-group" id="encryptionPasswordGroup" style="display: none;">
                    <label for="encryptionPassword">Key Password</label>
                    <input type="password" id="encryptionPassword" placeholder="Enter key password">
                </div>
                
                <button id="encryptBtn">Encrypt Data</button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="encryptedOutput">Encrypted Data</label>
                    <textarea id="encryptedOutput" readonly></textarea>
                </div>
                
                <div class="btn-group">
                    <button id="downloadEncryptedBtn" class="btn-secondary">Download Encrypted File</button>
                    <button id="copyEncryptedBtn" class="btn-secondary">Copy to Clipboard</button>
                    <button id="clearEncryptBtn" class="btn-secondary">Clear All</button>
                </div>
                
                <div id="encryptStatus" class="status"></div>
            </div>
        </div>
        
        <div class="tab-content" id="decrypt">
            <div class="card">
                <div class="form-group">
                    <label for="encryptedMessage">To Decrypt</label>
                    <textarea id="encryptedMessage" placeholder="Paste the encrypted data here or load encrypted data..."></textarea>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <button id="decryptBrowseBtn" class="btn-secondary">Browse Files</button>
                        <button id="clearEncryptedMessageBtn" class="btn-secondary">Clear</button>
                        <input type="file" id="decryptFileInput" style="display: none;">
                    </div>
                    <div id="decryptFileInfo" style="display: none;" class="file-info">
                        <span><span class="file-icon">ðŸ“„</span> <span id="decryptFileName" class="file-info-name"></span></span>
                        <span class="remove-file" id="removeDecryptFile">Ã—</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="decryptionKey">Decryption Key</label>
                    <select id="decryptionKey">
                        <option value="">Select a key...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="decryptObfKey">OBF Key</label>
                    <input type="text" id="decryptObfKey" placeholder="Optional*">
                </div>
                
                <div class="form-group" id="decryptionPasswordGroup" style="display: none;">
                    <label for="decryptionPassword">Key Password</label>
                    <input type="password" id="decryptionPassword" placeholder="Enter key password">
                </div>
                
                <button id="decryptBtn">Decrypt Data</button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="decryptedOutput">Decrypted Data</label>
                    <textarea id="decryptedOutput" readonly></textarea>
                </div>
                
                <div class="btn-group">
                    <button id="downloadDecryptedBtn" class="btn-secondary">Download Decrypted File</button>
                    <button id="copyDecryptedBtn" class="btn-secondary">Copy to Clipboard</button>
                    <button id="clearDecryptBtn" class="btn-secondary">Clear All</button>
                </div>
                
                <div id="decryptStatus" class="status"></div>
            </div>
        </div>
        
        <div class="tab-content" id="keys">
            <div class="card">
                <h2>Key Management</h2>
                
                <div class="security-info">
                    <strong>Security Note:</strong> All keys are stored locally in your browser's protected storage and never sent to any server.
                </div>
                
                <div class="keys-container">
                    <div class="key-form">
                        <div class="form-group">
                            <label for="keyName">Key Name</label>
                            <input type="text" id="keyName" placeholder="e.g., enter crypto name">
                        </div>
                        
                        <div class="form-group">
                            <label for="keyType">Key Type</label>
                            <select id="keyType">
                                <option value="aes">AES-GCM (Symmetric) - 256 bits</option>
                                <option value="rsa">RSA-OAEP (Asymmetric) - 2048 bits</option>
                                <option value="rsa-4096">RSA-OAEP (Asymmetric) - 4096 bits</option>
                                <option value="ecc">ECC (Asymmetric) - P-256</option>
                                <option value="ecc-p384">ECC (Asymmetric) - P-384</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="keyExpiry">Key Expiration (Optional)</label>
                            <select id="keyExpiry">
                                <option value="">Never (Not Recommended)</option>
                                <option value="30">30 Days</option>
                                <option value="90">90 Days</option>
                                <option value="180">180 Days</option>
                                <option value="365">1 Year</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="keyPasswordGroup">
                            <label for="keyPassword">Key Password (Recommended)</label>
                            <input type="password" id="keyPassword" placeholder="Enter optional password">
                            <div id="passwordStrength" class="password-strength"></div>
                            <div id="passwordFeedback" class="password-feedback"></div>
                        </div>
                        
                        <div class="form-group" id="confirmKeyPasswordGroup">
                            <label for="confirmKeyPassword">Confirm Password</label>
                            <input type="password" id="confirmKeyPassword" placeholder="Confirm your password">
                        </div>
                        
                        <button id="generateKeyBtn">Generate New Key</button>
                        
                        <div class="key-management-buttons">
                            <button id="importKeyBtn" class="btn-secondary">Import Key</button>
                            <button id="exportAllKeysBtn" class="btn-secondary">Export State</button>
                            <button id="importStateBtn" class="btn-secondary">Import State</button>
                        </div>
        
                        <div style="text-align: center; margin-top: 20px;">
                            <button id="zeroKeysBtn" class="btn-zero">ZERO ALL KEYS</button>
                        </div>
                        
                        <div id="keyStatus" class="status"></div>
                    </div>
                    
                    <div class="keys-list-container">
                        <h3>Your Keys</h3>
                        <div id="keysList" class="keys-grid">
                            <!-- Keys will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="settings">
            <div class="card">
                <h2>Security Settings</h2>
<p> (Must SAVE for changes to take effect) <p>
                
                <div class="settings-section">
                    <h3>Storage Options</h3>
                    
                    <div class="config-toggle">
                        <label for="useIndexedDB">Use IndexedDB for key storage (more secure)</label>
                        <label class="switch">
                            <input type="checkbox" id="useIndexedDB" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="config-toggle">
                        <label for="sessionOnly">Session-only mode (keys aren't saved when browser closes)</label>
                        <label class="switch">
                            <input type="checkbox" id="sessionOnly">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>Security Parameters</h3>
                    
                    <div class="config-toggle">
                        <label for="enforcePwdProtection">Enforce password protection for keys</label>
                        <label class="switch">
                            <input type="checkbox" id="enforcePwdProtection">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="config-toggle">
                        <label for="enforceKeyExpiry">Enforce key expiration</label>
                        <label class="switch">
                            <input type="checkbox" id="enforceKeyExpiry">
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label for="pbkdf2Iterations">PBKDF2 Iterations (higher = more secure but slower)</label>
                        <select id="pbkdf2Iterations">
                            <option value="100000">100,000 (Default)</option>
                            <option value="200000">200,000</option>
                            <option value="300000">300,000</option>
                            <option value="500000">500,000</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Appearance</h3>
                    
                    <div class="config-toggle">
                        <label for="darkMode">Dark Mode</label>
                        <label class="switch">
                            <input type="checkbox" id="darkMode">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Install App</h3>
                    <p>Installs PWA (must be Chromium-based browser or Safari for IOS)</p>
                    <div id="installContainer">
                        <button id="installBtn" class="btn-secondary">Install Lemonade App</button>
                        <p class="install-note" style="margin-top: 8px; font-size: 0.85rem; color: #888;">
                            (Button will be enabled when installation is available)
                        </p>
                    </div>
                    <div id="installStatus" class="status"></div>
                </div>

                <div class="btn-group">
                    <button id="saveSettingsBtn">Save Settings</button>
                    <button id="resetSettingsBtn" class="btn-secondary">Reset to Defaults</button>
                </div>
                
                <div id="settingsStatus" class="status"></div>
            </div>
        </div>
    </div>
    
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>
    
    <script>
const _0x5adec6=_0x2c9f;(function(_0x8ad694,_0x47cc0b){const _0x1d2e98=_0x2c9f,_0x242a30=_0x8ad694();while(!![]){try{const _0x43db5c=parseInt(_0x1d2e98(0x281))/0x1+-parseInt(_0x1d2e98(0x252))/0x2+-parseInt(_0x1d2e98(0x229))/0x3*(parseInt(_0x1d2e98(0x154))/0x4)+-parseInt(_0x1d2e98(0xe0))/0x5*(parseInt(_0x1d2e98(0x20c))/0x6)+parseInt(_0x1d2e98(0x237))/0x7+parseInt(_0x1d2e98(0x1f4))/0x8*(parseInt(_0x1d2e98(0xf9))/0x9)+-parseInt(_0x1d2e98(0x20b))/0xa*(-parseInt(_0x1d2e98(0x127))/0xb);if(_0x43db5c===_0x47cc0b)break;else _0x242a30['push'](_0x242a30['shift']());}catch(_0x151886){_0x242a30['push'](_0x242a30['shift']());}}}(_0x5598,0xeff9e));const PBKDF2_CONFIG={'ITERATIONS':0x186a0,'HASH':_0x5adec6(0x213)},AES_CONFIG={'KEY_LENGTH':0x100,'MODE':_0x5adec6(0xeb),'IV_LENGTH':0xc,'TAG_LENGTH':0x80},RSA_CONFIG={'KEY_SIZE':0x800,'KEY_SIZE_4096':0x1000,'ALGORITHM':_0x5adec6(0x162),'HASH':_0x5adec6(0x213)},ECC_CONFIG={'CURVE':_0x5adec6(0x1be),'CURVE_P384':_0x5adec6(0x225),'ALGORITHM':_0x5adec6(0x243),'KEY_DERIVATION':_0x5adec6(0x119),'KDF_HASH':_0x5adec6(0x213),'ENC_ALGORITHM':'AES-GCM'},DB_NAME=_0x5adec6(0x24e),DB_VERSION=0x1,KEYS_STORE=_0x5adec6(0x17e),SETTINGS_STORE=_0x5adec6(0x284),DEFAULT_SETTINGS={'useIndexedDB':!![],'sessionOnly':![],'enforcePwdProtection':![],'enforceKeyExpiry':![],'pbkdf2Iterations':0x186a0};let db=null,keys=[],appSettings={...DEFAULT_SETTINGS};const tabBtns=document[_0x5adec6(0x2a5)](_0x5adec6(0x1ef)),tabContents=document[_0x5adec6(0x2a5)]('.tab-content'),encryptionKeySelect=document[_0x5adec6(0x294)]('encryptionKey'),decryptionKeySelect=document[_0x5adec6(0x294)]('decryptionKey'),keysList=document['getElementById'](_0x5adec6(0x25a)),loadingOverlay=document['getElementById'](_0x5adec6(0x20a)),inactivityModal=document[_0x5adec6(0x294)](_0x5adec6(0x130)),timeoutTimer=document[_0x5adec6(0x294)](_0x5adec6(0x11f)),safeMemory={'sensitiveData':new WeakMap(),'store':function(_0x2d0445){const _0x371097=_0x5adec6,_0x987935={'id':crypto[_0x371097(0x21d)]()};return this[_0x371097(0x2a8)]['set'](_0x987935,_0x2d0445),_0x987935;},'retrieve':function(_0x147444,_0x2fef1c=![]){const _0xe4a83b=_0x5adec6;if(!this['sensitiveData'][_0xe4a83b(0xe2)](_0x147444))return null;const _0xdb9a4b=this[_0xe4a83b(0x2a8)]['get'](_0x147444);return _0x2fef1c&&this[_0xe4a83b(0x2a8)][_0xe4a83b(0x105)](_0x147444),_0xdb9a4b;},'delete':function(_0x20821c){const _0x235a51=_0x5adec6;if(this[_0x235a51(0x2a8)][_0x235a51(0xe2)](_0x20821c))return this['sensitiveData'][_0x235a51(0x105)](_0x20821c),!![];return![];},'clearAll':function(){const _0x3e35f4=_0x5adec6;this['sensitiveData']=new WeakMap();if(typeof window['gc']===_0x3e35f4(0x1e5))try{window['gc']();}catch(_0x5e965f){console[_0x3e35f4(0x11c)](_0x3e35f4(0x11d));}}},validator={'sanitizeHTML':function(_0x2fe690){const _0x145c11=_0x5adec6,_0x29b07e=document[_0x145c11(0xe3)](_0x145c11(0x1d7));return _0x29b07e[_0x145c11(0x235)]=_0x2fe690,_0x29b07e[_0x145c11(0xed)];},'validateInput':function(_0x48d8e8,_0x292728=![]){const _0x68436d=_0x5adec6;if(_0x48d8e8===null||_0x48d8e8===undefined)return'';const _0x27c95e=String(_0x48d8e8);return _0x292728?_0x27c95e:this[_0x68436d(0x1ca)](_0x27c95e);},'isValidKeyName':function(_0x568759){const _0x40696c=_0x5adec6;return/^[A-Za-z0-9 ._-]{1,50}$/[_0x40696c(0x198)](_0x568759);},'isValidEncryptedMessage':function(_0x1d0868){const _0xedae79=_0x5adec6;return/^--LM--\s*[A-Za-z0-9+/=]+\s*--EM--$/s[_0xedae79(0x198)](_0x1d0868);},'measurePasswordStrength':function(_0x9d943b){const _0x4f6f16=_0x5adec6;let _0x17dd41=0x0;if(!_0x9d943b)return{'score':0x0,'feedback':_0x4f6f16(0x11b)};const _0x4e2aa2=_0x9d943b['length'];_0x17dd41+=Math['min'](0x5,Math['floor'](_0x4e2aa2/0x4));if(/[a-z]/[_0x4f6f16(0x198)](_0x9d943b))_0x17dd41+=0x1;if(/[A-Z]/[_0x4f6f16(0x198)](_0x9d943b))_0x17dd41+=0x1;if(/[0-9]/[_0x4f6f16(0x198)](_0x9d943b))_0x17dd41+=0x1;if(/[^A-Za-z0-9]/[_0x4f6f16(0x198)](_0x9d943b))_0x17dd41+=0x2;if(/^[a-zA-Z]+$/[_0x4f6f16(0x198)](_0x9d943b))_0x17dd41-=0x1;if(/^[0-9]+$/[_0x4f6f16(0x198)](_0x9d943b))_0x17dd41-=0x1;if(/(.)\1{2,}/['test'](_0x9d943b))_0x17dd41-=0x1;let _0x3442f4,_0x2aeb98;if(_0x17dd41<0x4)_0x3442f4=_0x4f6f16(0x1b2),_0x2aeb98=_0x4f6f16(0x184);else _0x17dd41<0x8?(_0x3442f4=_0x4f6f16(0x1e9),_0x2aeb98=_0x4f6f16(0x17c)):(_0x3442f4=_0x4f6f16(0x1ea),_0x2aeb98=_0x4f6f16(0x224));return{'score':_0x17dd41,'strengthCategory':_0x3442f4,'feedback':_0x2aeb98};}},escapeRegex=_0x468447=>{const _0x231dd0=_0x5adec6;if(typeof _0x468447!==_0x231dd0(0x1a8))return'';return _0x468447[_0x231dd0(0x158)](/[.*+?^${}()|[\]\\]/g,_0x231dd0(0x1a4));};document[_0x5adec6(0x1a6)](_0x5adec6(0x155),async()=>{const _0x397239=_0x5adec6;document[_0x397239(0x2a5)]('.tab-btn')[_0x397239(0x1b5)](_0x40e1a3=>{const _0xf227a1=_0x397239;_0x40e1a3[_0xf227a1(0x1a6)](_0xf227a1(0x1e4),_0x32415d=>{const _0x44aa7d=_0xf227a1;_0x32415d['preventDefault']();const _0x1ee6f8=_0x40e1a3[_0x44aa7d(0x27f)](_0x44aa7d(0x2ad));console[_0x44aa7d(0x11c)](_0x44aa7d(0x14e),_0x1ee6f8),switchTab(_0x1ee6f8);});}),document['getElementById']('darkMode')[_0x397239(0x1a6)]('change',toggleDarkMode);const _0x32956a=localStorage[_0x397239(0x219)]('LemonadeDarkMode');_0x32956a===_0x397239(0x1b8)&&(document[_0x397239(0x294)](_0x397239(0x24c))['checked']=!![],document[_0x397239(0xfc)][_0x397239(0x10e)][_0x397239(0x13a)](_0x397239(0x1f5))),document[_0x397239(0x294)]('clearEncryptMessageBtn')[_0x397239(0x1a6)](_0x397239(0x1e4),()=>{clearEncryptFile();}),document[_0x397239(0x294)]('clearEncryptedMessageBtn')[_0x397239(0x1a6)](_0x397239(0x1e4),()=>{clearDecryptFile();}),await initDatabase(),await loadSettings(),initSettingsUI(),await loadKeys(),document[_0x397239(0x294)](_0x397239(0x296))['addEventListener'](_0x397239(0x2af),updatePasswordStrength),document[_0x397239(0x294)](_0x397239(0xfe))[_0x397239(0x1a6)]('click',encryptMessage),document[_0x397239(0x294)]('decryptBtn')['addEventListener'](_0x397239(0x1e4),decryptMessage),document[_0x397239(0x294)]('generateKeyBtn')['addEventListener'](_0x397239(0x1e4),generateKey),document['getElementById']('copyEncryptedBtn')[_0x397239(0x1a6)]('click',()=>copyToClipboard(_0x397239(0x1e3),'encryptStatus')),document[_0x397239(0x294)](_0x397239(0x13d))[_0x397239(0x1a6)](_0x397239(0x1e4),()=>copyToClipboard(_0x397239(0x1af),'decryptStatus')),document['getElementById'](_0x397239(0x188))[_0x397239(0x1a6)](_0x397239(0x1e4),()=>{const _0x4526ff=_0x397239;document['getElementById'](_0x4526ff(0x1fb))[_0x4526ff(0x1d6)]='',document[_0x4526ff(0x294)]('encryptedOutput')[_0x4526ff(0x1d6)]='',document[_0x4526ff(0x294)]('encryptStatus')['className']='status',document['getElementById']('encryptStatus')[_0x4526ff(0x235)]='',clearEncryptFile();}),document[_0x397239(0x294)](_0x397239(0x153))['addEventListener']('click',()=>{const _0x52cf21=_0x397239;document[_0x52cf21(0x294)]('encryptedMessage')[_0x52cf21(0x1d6)]='',document['getElementById'](_0x52cf21(0x1af))[_0x52cf21(0x1d6)]='',document['getElementById'](_0x52cf21(0x140))[_0x52cf21(0x220)]=_0x52cf21(0x24b),document[_0x52cf21(0x294)](_0x52cf21(0x140))[_0x52cf21(0x235)]='',clearDecryptFile(),window[_0x52cf21(0x251)]=null;}),document[_0x397239(0x294)](_0x397239(0x29f))[_0x397239(0x1a6)]('click',importKey),document[_0x397239(0x294)]('exportAllKeysBtn')[_0x397239(0x1a6)]('click',exportAllKeys),document[_0x397239(0x294)]('importStateBtn')[_0x397239(0x1a6)](_0x397239(0x1e4),importState),document[_0x397239(0x294)](_0x397239(0x195))[_0x397239(0x1a6)](_0x397239(0x1e4),saveSettings),document['getElementById']('resetSettingsBtn')['addEventListener'](_0x397239(0x1e4),resetSettings),document['getElementById'](_0x397239(0xf8))[_0x397239(0x1a6)](_0x397239(0x1e4),zeroAllKeys),encryptionKeySelect[_0x397239(0x1a6)](_0x397239(0x2b4),handleEncryptionKeyChange),decryptionKeySelect[_0x397239(0x1a6)](_0x397239(0x2b4),handleDecryptionKeyChange);});async function initDatabase(){const _0x1e4e99=_0x5adec6;if(!window[_0x1e4e99(0xdf)]){showStatus(_0x1e4e99(0x1ab),_0x1e4e99(0x20f),_0x1e4e99(0x1f9)),appSettings[_0x1e4e99(0x14b)]=![];return;}return new Promise((_0x468a67,_0x24c7cf)=>{const _0x32a990=_0x1e4e99,_0x38833b=indexedDB[_0x32a990(0x205)](DB_NAME,DB_VERSION);_0x38833b[_0x32a990(0x231)]=function(_0x184847){const _0x5961af=_0x32a990,_0xbea823=_0x184847['target']['result'];!_0xbea823['objectStoreNames'][_0x5961af(0x27d)](KEYS_STORE)&&_0xbea823[_0x5961af(0x21c)](KEYS_STORE,{'keyPath':'id'}),!_0xbea823['objectStoreNames'][_0x5961af(0x27d)](SETTINGS_STORE)&&_0xbea823['createObjectStore'](SETTINGS_STORE,{'keyPath':'id'});},_0x38833b[_0x32a990(0x14d)]=function(_0x2a95ce){const _0x4408ca=_0x32a990;db=_0x2a95ce[_0x4408ca(0x21b)][_0x4408ca(0x20e)],console['log'](_0x4408ca(0x102)),_0x468a67();},_0x38833b[_0x32a990(0x177)]=function(_0x103643){const _0x407835=_0x32a990;console[_0x407835(0x123)]('Database\x20error:',_0x103643[_0x407835(0x21b)][_0x407835(0x123)]),showStatus(_0x407835(0x1ab),'Database\x20initialization\x20failed.\x20Using\x20less\x20secure\x20localStorage\x20instead.','warning'),appSettings[_0x407835(0x14b)]=![],_0x468a67();};});}function switchTab(_0x5879f1){const _0x226665=_0x5adec6;console['log']('Switching\x20to\x20tab:',_0x5879f1),tabBtns[_0x226665(0x1b5)](_0x41f526=>{const _0x38fc91=_0x226665;_0x41f526[_0x38fc91(0x27f)](_0x38fc91(0x2ad))===_0x5879f1?_0x41f526[_0x38fc91(0x10e)][_0x38fc91(0x13a)]('active'):_0x41f526['classList'][_0x38fc91(0x215)](_0x38fc91(0x15f));}),document['getElementById'](_0x226665(0x1fb))[_0x226665(0x1d6)]='',document[_0x226665(0x294)](_0x226665(0x1e3))[_0x226665(0x1d6)]='',document[_0x226665(0x294)]('encryptStatus')[_0x226665(0x220)]=_0x226665(0x24b),document[_0x226665(0x294)](_0x226665(0x1e7))[_0x226665(0x235)]='',document[_0x226665(0x294)]('encryptionKey')[_0x226665(0x1d6)]='',document[_0x226665(0x294)]('encryptionPassword')['value']='',document['getElementById'](_0x226665(0x149))[_0x226665(0x172)][_0x226665(0x13b)]='none',clearEncryptFile(),document[_0x226665(0x294)](_0x226665(0x122))[_0x226665(0x1d6)]='',document[_0x226665(0x294)](_0x226665(0x1af))['value']='',document[_0x226665(0x294)](_0x226665(0x140))[_0x226665(0x220)]=_0x226665(0x24b),document['getElementById'](_0x226665(0x140))[_0x226665(0x235)]='',document[_0x226665(0x294)](_0x226665(0x156))[_0x226665(0x1d6)]='',document['getElementById'](_0x226665(0x145))[_0x226665(0x1d6)]='',document[_0x226665(0x294)](_0x226665(0x268))[_0x226665(0x172)][_0x226665(0x13b)]=_0x226665(0x28a),clearDecryptFile(),window[_0x226665(0x251)]=null,document[_0x226665(0x294)](_0x226665(0x245))[_0x226665(0x10e)][_0x226665(0x215)]('active'),document[_0x226665(0x294)]('decrypt')[_0x226665(0x10e)][_0x226665(0x215)](_0x226665(0x15f)),document[_0x226665(0x294)](_0x226665(0x17e))[_0x226665(0x10e)]['remove'](_0x226665(0x15f)),document['getElementById']('settings')['classList']['remove'](_0x226665(0x15f)),document[_0x226665(0x294)](_0x5879f1)['classList'][_0x226665(0x13a)](_0x226665(0x15f));}function setLoading(_0x236036){const _0x41238c=_0x5adec6;loadingOverlay[_0x41238c(0x172)]['display']=_0x236036?_0x41238c(0x29c):_0x41238c(0x28a);}async function loadSettings(){const _0x38922d=_0x5adec6;if(appSettings[_0x38922d(0x14b)]&&db)try{const _0x2f5451=await getFromDatabase(SETTINGS_STORE,_0x38922d(0xea));_0x2f5451&&(appSettings={...DEFAULT_SETTINGS,..._0x2f5451});}catch(_0x54ec47){console[_0x38922d(0x123)](_0x38922d(0x249),_0x54ec47);try{const _0x4eebc9=localStorage['getItem'](_0x38922d(0x12d));_0x4eebc9&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x38922d(0x1f8)](_0x4eebc9)});}catch(_0x5146b0){console[_0x38922d(0x123)](_0x38922d(0xdc),_0x5146b0);}}else try{const _0x139ad2=localStorage[_0x38922d(0x219)]('LemonadeSettings');_0x139ad2&&(appSettings={...DEFAULT_SETTINGS,...JSON[_0x38922d(0x1f8)](_0x139ad2)});}catch(_0x226bd2){console[_0x38922d(0x123)](_0x38922d(0xdc),_0x226bd2);}return PBKDF2_CONFIG[_0x38922d(0x168)]=appSettings['pbkdf2Iterations'],appSettings;}function initSettingsUI(){const _0x82a5d5=_0x5adec6;document[_0x82a5d5(0x294)](_0x82a5d5(0x14b))[_0x82a5d5(0x1cc)]=appSettings[_0x82a5d5(0x14b)],document[_0x82a5d5(0x294)](_0x82a5d5(0x1a1))[_0x82a5d5(0x1cc)]=appSettings[_0x82a5d5(0x1a1)],document['getElementById'](_0x82a5d5(0x2a9))[_0x82a5d5(0x1cc)]=appSettings['enforcePwdProtection'],document[_0x82a5d5(0x294)](_0x82a5d5(0x14c))[_0x82a5d5(0x1cc)]=appSettings[_0x82a5d5(0x14c)],document[_0x82a5d5(0x294)](_0x82a5d5(0x21a))[_0x82a5d5(0x1d6)]=appSettings[_0x82a5d5(0x21a)];}async function saveSettings(){const _0x5a9334=_0x5adec6;try{appSettings['useIndexedDB']=document[_0x5a9334(0x294)]('useIndexedDB')[_0x5a9334(0x1cc)],appSettings[_0x5a9334(0x1a1)]=document[_0x5a9334(0x294)](_0x5a9334(0x1a1))[_0x5a9334(0x1cc)],appSettings[_0x5a9334(0x2a9)]=document[_0x5a9334(0x294)](_0x5a9334(0x2a9))[_0x5a9334(0x1cc)],appSettings[_0x5a9334(0x14c)]=document[_0x5a9334(0x294)](_0x5a9334(0x14c))[_0x5a9334(0x1cc)],appSettings[_0x5a9334(0x21a)]=parseInt(document[_0x5a9334(0x294)]('pbkdf2Iterations')[_0x5a9334(0x1d6)]),PBKDF2_CONFIG['ITERATIONS']=appSettings['pbkdf2Iterations'],appSettings[_0x5a9334(0x14b)]&&db?await saveToDatabase(SETTINGS_STORE,{'id':_0x5a9334(0xea),...appSettings}):localStorage['setItem'](_0x5a9334(0x12d),JSON['stringify'](appSettings)),showStatus(_0x5a9334(0x10c),_0x5a9334(0x191),'success');}catch(_0x1ef9e7){console[_0x5a9334(0x123)](_0x5a9334(0x118),_0x1ef9e7),showStatus(_0x5a9334(0x10c),'Error\x20saving\x20settings:\x20'+_0x1ef9e7[_0x5a9334(0x25f)],_0x5a9334(0x123));}}function resetSettings(){const _0xb5f8d2=_0x5adec6,_0x49785b=confirm(_0xb5f8d2(0xf7));if(!_0x49785b)return;appSettings={...DEFAULT_SETTINGS},initSettingsUI(),saveSettings();}function updatePasswordStrength(){const _0x5c5d7f=_0x5adec6,_0x5a5227=document[_0x5c5d7f(0x294)]('keyPassword')['value'],_0x22cb90=validator[_0x5c5d7f(0x167)](_0x5a5227),_0x5eb637=document['getElementById'](_0x5c5d7f(0x1df)),_0x532b40=document[_0x5c5d7f(0x294)](_0x5c5d7f(0x181));_0x5eb637[_0x5c5d7f(0x220)]='password-strength',_0x5a5227?(_0x5eb637[_0x5c5d7f(0x10e)][_0x5c5d7f(0x13a)](_0x22cb90[_0x5c5d7f(0x19b)]),_0x532b40[_0x5c5d7f(0x235)]=_0x22cb90[_0x5c5d7f(0x1fa)]):_0x532b40[_0x5c5d7f(0x235)]='';}function _0x5598(){const _0x42c24b=['State\x20import\x20error:\x20','\x20[Full\x20Pair]','sanitizeHTML','passwordModalInput','checked','Complete\x20asymmetric\x20key\x20pair\x20\x22','importKey','Please\x20use\x20a\x20stronger\x20password:\x20','<span\x20class=\x22key-pair-badge\x20full\x22>FULL\x20KEY\x20PAIR</span>','getDate','store','Do\x20you\x20want\x20to\x20continue?','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20key\x20\x22','(display-mode:\x20standalone)','value','div','Key\x20is\x20missing\x20salt\x20or\x20IV\x20data','Import\x20error:\x20','Decryption\x20error:\x20','keyName','exportPrivateKey','\x20days\x20(','data','passwordStrength','Error\x20reading\x20the\x20state\x20file','This\x20file\x20is\x20not\x20in\x20Lemonade\x20encrypted\x20format.\x20Try\x20again.','decryptFileName','encryptedOutput','click','function','data-binary','encryptStatus','<button\x20class=\x22btn-secondary\x22\x20onclick=\x22exportKey(\x27','medium','strong','User\x20response\x20to\x20install\x20prompt:\x20','Key\x20data\x20and\x20password\x20are\x20required','info','No\x20keys\x20to\x20delete','.tab-btn','removeItem','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Decryption\x20failed:\x20','Failed\x20to\x20retrieve\x20decrypted\x20key\x20from\x20memory.','805168zVEBhd','dark-mode','LemonadeProtectedBackup','Failed\x20to\x20decrypt\x20key:\x20','parse','warning','feedback','encryptMessage','No\x20decrypted\x20data\x20to\x20download','passwordModalCancel','Invalid\x20key\x20file\x20format','Error\x20loading\x20keys:','retrieve','Protected\x20Private\x20Key','createObjectURL','toUpperCase','Encryption\x20error:\x20','open','includes','low','Enter','keyFileInput','loadingOverlay','6400lUmgGl','525318DNQGcV','TAG_LENGTH','result','Your\x20browser\x20doesn\x27t\x20support\x20secure\x20storage.\x20Using\x20less\x20secure\x20localStorage\x20instead.','hasPrivate','Error\x20generating\x20key:\x20','readwrite','SHA-256','<button\x20class=\x22btn-secondary\x20private-key-btn\x22\x20onclick=\x22exportPrivateKey(\x27','remove','onload','.install-note','ECDH+AES-GCM','getItem','pbkdf2Iterations','target','createObjectStore','randomUUID','private','Unsupported\x20key\x20type','className','MODE','downloadEncryptedBtn','This\x20key\x20does\x20not\x20have\x20a\x20private\x20key\x20component\x20to\x20export','Strong\x20-\x20Good\x20password!','P-384','register','Please\x20enter\x20an\x20encrypted\x20message\x20or\x20add\x20an\x20encrypted\x20file','appinstalled','2317494nzdALZ','Missing\x20required\x20key\x20properties','application/octet-stream','WARNING:\x20This\x20will\x20permanently\x20delete\x20ALL\x20your\x20encryption\x20keys.\x20This\x20action\x20CANNOT\x20be\x20undone.\x0a\x0aAre\x20you\x20absolutely\x20sure\x20you\x20want\x20to\x20continue?','files','\x22\x20imported\x20as\x20separate\x20key','size','Application\x20state\x20with\x20','onupgradeneeded','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','random','fileName','textContent','This\x20will\x20import\x20','3610761WRTtvj','put','public\x20key','Protected\x20State\x20File','passwordModalTitle','\x22\x20downloaded\x20successfully','serviceWorker','LemonadeDarkMode','https:','<span\x20class=\x22security-badge\x20','passwordModalStrength','Invalid\x20state\x20file\x20format','ECDH','AES\x20Decryption\x20error:','encrypt','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-item-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>','download','encryptFileInfo','Error\x20loading\x20settings\x20from\x20database:','[\x5cs\x5cS]+?','status','darkMode','HASH','LemonadeSecureDB','Private\x20key\x20\x22','Database\x20not\x20initialized','decryptedBinaryData','3442992RlCcyD','isFile','data-filename','high','AES','ALGORITHM','Password\x20protection\x20is\x20required\x20by\x20your\x20security\x20settings','deriveKey','keysList','charCodeAt','\x20[Public]','rsa','\x20expired\x20key(s)\x20removed\x20for\x20security','message','isValidKeyName','127.0.0.1','setDate','No\x20encrypted\x20data\x20to\x20download','protected','removeChild','removeDecryptFile','encode','decryptionPasswordGroup','.lem','select','Unsupported\x20key\x20type:\x20','appendChild','Please\x20enter\x20a\x20message\x20or\x20add\x20a\x20file\x20to\x20encrypt','\x20keys\x20imported\x20successfully','beforeinstallprompt','confirmKeyPassword','</span>','Incorrect\x20password\x20or\x20corrupted\x20private\x20key','Export\x20cancelled:\x20','Please\x20select\x20an\x20encryption\x20key','\x22\x20imported\x20successfully','deleteKey','Key\x20name\x20can\x20only\x20contain\x20letters,\x20numbers,\x20spaces,\x20and\x20basic\x20punctuation\x20(._-)','setAttribute','Invalid\x20encrypted\x20message\x20format\x20or\x20OBF\x20Key\x20mismatch','stateFileInput','hostname','ECC-P256','contains','Application\x20state\x20exported\x20successfully','getAttribute','objectStore','1931862llCLPP','Export\x20error:','file:','settings','Decryption\x20error:','option','<p>No\x20keys\x20available.\x20Generate\x20or\x20import\x20a\x20key\x20to\x20get\x20started.</p>','.state,application/octet-stream','toFixed','none','0\x20Bytes','Escape','Only\x20export\x20private\x20keys\x20if\x20you\x20absolutely\x20need\x20to\x20use\x20them\x20on\x20another\x20device.\x20','set','_cryptoKey','Message\x20encrypted\x20successfully','\x20ðŸ”’','raw','load','getElementById','digest','keyPassword','key-item','decrypt','preventDefault','\x22\x20deleted\x20successfully','keyType','flex','transaction','Please\x20enter\x20a\x20key\x20name','importKeyBtn','CURVE_P384','CURVE','encryptionPassword','RSA-4096','metadata','querySelectorAll','protocol','then','sensitiveData','enforcePwdProtection','passwordModalFeedback','ECDH+','WARNING:\x20Exporting\x20keys\x20without\x20a\x20password\x20is\x20not\x20secure.\x20Anyone\x20with\x20access\x20to\x20this\x20file\x20will\x20be\x20able\x20to\x20use\x20your\x20keys.\x20Continue\x20anyway?','data-tab','\x22\x20updated\x20with\x20','input','clear','Lemonade-state.state','pairedKeyId','Please\x20select\x20a\x20decryption\x20key','change','password-strength','algorithm','byteLength','WARNING:\x20Exporting\x20a\x20private\x20key\x20is\x20a\x20security\x20risk.\x20','This\x20state\x20file\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import:','Error\x20loading\x20settings\x20from\x20localStorage:','generateKey','buffer','indexedDB','35LKUNYS','Key\x20\x22','has','createElement','length','Modern\x20clipboard\x20API\x20failed:','match','Password\x20required\x20for\x20this\x20key','matches','encryptObfKey','app-settings','AES-GCM','scope','innerHTML','Error\x20generating\x20key:','publicKeyHash','accepted','IV_LENGTH','expiry','Missing\x20encrypted\x20key\x20data','.lim','filter','curve','Are\x20you\x20sure\x20you\x20want\x20to\x20reset\x20all\x20settings\x20to\x20defaults?','zeroKeysBtn','63YflVmy','endsWith','Export\x20error:\x20','body','pkcs8','encryptBtn','keypress','text','salt','Database\x20initialized\x20successfully','Your\x20browser\x20does\x20not\x20support\x20PWA\x20installation\x20features.','Missing\x20encrypted\x20private\x20key\x20data','delete','This\x20private\x20key\x20is\x20password-protected.\x20Please\x20enter\x20the\x20password\x20to\x20import\x20it:','toLocaleString','crypto','decode','Error\x20clearing\x20keys\x20from\x20database:','<option\x20value=\x22\x22>Select\x20a\x20key...</option>','settingsStatus','decryptFileInfo','classList','This\x20.lem\x20file\x20does\x20not\x20contain\x20a\x20private\x20key','Encrypted\x20file\x20loaded\x20successfully.','KEY_LENGTH','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','type','Base64\x20decoding\x20error:','decryptObfKey','Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20private\x20key','sw.js','Error\x20saving\x20settings:','HKDF','findIndex','Password\x20is\x20required','log','Manual\x20garbage\x20collection\x20not\x20available','name','timeoutTimer','Enter\x20the\x20current\x20key\x20password\x20to\x20continue:','AES\x20encryption\x20error:','encryptedMessage','error','toLocaleDateString','confirm','readonly','16115RgwBfu','<span\x20class=\x22key-pair-badge\x20private\x22>PRIVATE\x20KEY</span>','encryptedKey','version','passwordModal','PBKDF2','LemonadeSettings','State\x20import\x20error:','LemonadeKeys','inactivityModal','hasPublic','Lemonade\x20is\x20running\x20as\x20an\x20installed\x20app','decryptFileInput','Copied\x20to\x20clipboard','\x20key\x20part\x20of\x20an\x20existing\x20key.\x20','KEY_SIZE_4096','spki','trim','Nothing\x20to\x20copy','add','display','\x22\x20generated\x20successfully','copyDecryptedBtn','Key\x20expiration\x20is\x20required\x20by\x20your\x20security\x20settings','join','decryptStatus','Lemonade\x20was\x20installed','All\x20keys\x20cleared\x20from\x20database','_privateKey','file','decryptionPassword','writeText','PWA\x20installation\x20requires\x20HTTPS.\x20You\x20are\x20viewing\x20this\x20file\x20locally.','installStatus','encryptionPasswordGroup','href','useIndexedDB','enforceKeyExpiry','onsuccess','Tab\x20button\x20clicked:','File\x20downloaded\x20successfully','\x20-\x20','exportKey','Key\x20deletion\x20canceled','clearDecryptBtn','4ZZNSRT','DOMContentLoaded','decryptionKey','All\x20keys\x20(','replace',')</div>','readAsText','getAll','removeEncryptFile','toLowerCase','File:\x20','active','publicKey','Would\x20you\x20like\x20to\x20merge\x20them\x20into\x20a\x20complete\x20key\x20pair?','RSA-OAEP','aes','getRandomValues','Service\x20Worker\x20registration\x20failed.\x20PWA\x20features\x20unavailable.','Passwords\x20do\x20not\x20match','measurePasswordStrength','ITERATIONS','Password\x20entry\x20cancelled','accept','floor','App\x20is\x20already\x20running\x20in\x20standalone\x20mode\x20(installed)','created','focus','Please\x20enter\x20a\x20password\x20to\x20protect\x20this\x20private\x20key:','keyExpiry','Installation\x20is\x20now\x20available!','style','Invalid\x20encrypted\x20message\x20format\x20or\x20OBF\x20Key\x20mismatch.\x20Ensure\x20the\x20OBF\x20key\x20is\x20correct\x20(closer\x20is\x20reverse\x20of\x20opener)\x20and\x20the\x20message\x20structure\x20is\x20intact.','disabled','encryptFileInput','split','onerror','Symmetric\x20key\x20\x22','_importPassword','block','([\x5cs\x5cS]+?)','Medium\x20-\x20Add\x20more\x20variety\x20or\x20length\x20for\x20better\x20security','Installation\x20was\x20canceled','keys','Unable\x20to\x20copy\x20automatically.\x20Please\x20select\x20the\x20text\x20and\x20press\x20Ctrl+C\x20(or\x20âŒ˜+C)\x20to\x20copy\x20manually.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','passwordFeedback','Key\x20not\x20found','keydown','Weak\x20-\x20Use\x20a\x20longer\x20password\x20with\x20numbers\x20and\x20special\x20characters','score','Invalid\x20base64\x20data:\x20','revokeObjectURL','clearEncryptBtn','Encryption\x20failed:\x20','passwordModalMessage','success','location','deriveBits','setItem','localhost','Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message','Settings\x20saved\x20successfully','ecc-p384','.lmn','No\x20keys\x20available\x20to\x20export','saveSettingsBtn','get','Bytes','test','find','false','strengthCategory','.*$','public','downloadDecryptedBtn','stringify','KEY_SIZE','sessionOnly','matchMedia','catch','\x5c$&','\x20key\x20\x22','addEventListener','rsa-4096','string','Lemonade\x20has\x20been\x20installed\x20successfully!','status\x20','keyStatus',')\x20have\x20been\x20permanently\x20deleted','userChoice','decryptBrowseBtn','decryptedOutput','Import\x20error:','This\x20.lim\x20file\x20does\x20not\x20contain\x20a\x20public\x20key','weak','ecc','push','forEach','prompt','readAsArrayBuffer','true','subtle','fileSize','_publicKey','keySize','toISOString','P-256','\x20keys\x20into\x20your\x20application.\x20Continue?','privateKey','slice','encryptFileName','\x20exported\x20as\x20','Message\x20decrypted\x20successfully','<div\x20class=\x22key-expiry\x22>Expires\x20in\x20','Invalid\x20state\x20data\x20format','key'];_0x5598=function(){return _0x42c24b;};return _0x5598();}async function loadKeys(){const _0xfc002b=_0x5adec6;try{keys=[];if(appSettings[_0xfc002b(0x14b)]&&db){const _0x3ca5e4=await getAllFromDatabase(KEYS_STORE);_0x3ca5e4&&_0x3ca5e4[_0xfc002b(0xe4)]>0x0&&(keys=_0x3ca5e4);}else{const _0x1f36ad=localStorage[_0xfc002b(0x219)](_0xfc002b(0x12f));_0x1f36ad&&(keys=JSON[_0xfc002b(0x1f8)](_0x1f36ad));}checkExpiredKeys(),updateKeysList(),updateKeySelects();}catch(_0x337694){console[_0xfc002b(0x123)](_0xfc002b(0x1ff),_0x337694),showStatus(_0xfc002b(0x1ab),'Error\x20loading\x20keys:\x20'+_0x337694[_0xfc002b(0x25f)],'error');}}async function saveKeys(){const _0xd67d5=_0x5adec6;try{if(appSettings[_0xd67d5(0x1a1)])console[_0xd67d5(0x11c)]('Session-only\x20mode:\x20Keys\x20not\x20saved\x20persistently');else{if(appSettings['useIndexedDB']&&db){await clearDatabase(KEYS_STORE);for(const _0x51fd7d of keys){await saveToDatabase(KEYS_STORE,_0x51fd7d);}}else localStorage[_0xd67d5(0x18e)](_0xd67d5(0x12f),JSON[_0xd67d5(0x19f)](keys));}updateKeysList(),updateKeySelects();}catch(_0x49637c){console[_0xd67d5(0x123)]('Error\x20saving\x20keys:',_0x49637c),showStatus('keyStatus','Error\x20saving\x20keys:\x20'+_0x49637c[_0xd67d5(0x25f)],_0xd67d5(0x123));}}function checkExpiredKeys(){const _0x1f29bb=_0x5adec6,_0x11e22a=new Date(),_0x2743ab=[];keys['forEach'](_0x35c777=>{const _0x3c066f=_0x2c9f;if(_0x35c777[_0x3c066f(0xf2)]){const _0x232220=new Date(_0x35c777[_0x3c066f(0xf2)]);_0x232220<_0x11e22a&&_0x2743ab['push'](_0x35c777['id']);}}),_0x2743ab[_0x1f29bb(0xe4)]>0x0&&(keys=keys[_0x1f29bb(0xf5)](_0x557729=>!_0x2743ab['includes'](_0x557729['id'])),saveKeys(),showStatus(_0x1f29bb(0x1ab),_0x2743ab[_0x1f29bb(0xe4)]+_0x1f29bb(0x25e),_0x1f29bb(0x1f9)));}async function generateKey(){const _0x3dd7f5=_0x5adec6;try{setLoading(!![]);const _0x3c180a=document['getElementById']('keyName')[_0x3dd7f5(0x1d6)][_0x3dd7f5(0x138)](),_0x1907de=document[_0x3dd7f5(0x294)](_0x3dd7f5(0x29b))[_0x3dd7f5(0x1d6)],_0x44c63e=document[_0x3dd7f5(0x294)]('keyPassword')[_0x3dd7f5(0x1d6)],_0x14616b=document[_0x3dd7f5(0x294)](_0x3dd7f5(0x270))[_0x3dd7f5(0x1d6)],_0x3bc46e=document[_0x3dd7f5(0x294)](_0x3dd7f5(0x170))['value'];if(!_0x3c180a){showStatus(_0x3dd7f5(0x1ab),_0x3dd7f5(0x29e),_0x3dd7f5(0x123));return;}if(!validator[_0x3dd7f5(0x260)](_0x3c180a)){showStatus('keyStatus',_0x3dd7f5(0x277),_0x3dd7f5(0x123));return;}if(appSettings[_0x3dd7f5(0x2a9)]&&!_0x44c63e){showStatus(_0x3dd7f5(0x1ab),_0x3dd7f5(0x258),_0x3dd7f5(0x123));return;}if(_0x44c63e){const _0x46bfb1=validator[_0x3dd7f5(0x167)](_0x44c63e);if(_0x46bfb1[_0x3dd7f5(0x185)]<0x4){showStatus(_0x3dd7f5(0x1ab),_0x3dd7f5(0x1cf)+_0x46bfb1[_0x3dd7f5(0x1fa)],_0x3dd7f5(0x123));return;}if(_0x44c63e!==_0x14616b){showStatus('keyStatus',_0x3dd7f5(0x166),_0x3dd7f5(0x123));return;}}if(appSettings['enforceKeyExpiry']&&!_0x3bc46e){showStatus(_0x3dd7f5(0x1ab),_0x3dd7f5(0x13e),_0x3dd7f5(0x123));return;}const _0x2c409f={'id':crypto[_0x3dd7f5(0x21d)](),'name':_0x3c180a,'type':_0x1907de,'created':new Date()[_0x3dd7f5(0x1bd)]()};if(_0x3bc46e){const _0x2bde36=parseInt(_0x3bc46e),_0x32e03c=new Date();_0x32e03c[_0x3dd7f5(0x262)](_0x32e03c[_0x3dd7f5(0x1d1)]()+_0x2bde36),_0x2c409f[_0x3dd7f5(0xf2)]=_0x32e03c['toISOString']();}const _0xa3b6b0=_0x1907de===_0x3dd7f5(0x25d)||_0x1907de===_0x3dd7f5(0x1a7)||_0x1907de===_0x3dd7f5(0x1b3)||_0x1907de==='ecc-p384';_0xa3b6b0&&(_0x2c409f[_0x3dd7f5(0x131)]=!![],_0x2c409f[_0x3dd7f5(0x210)]=!![],_0x2c409f[_0x3dd7f5(0x2b2)]=_0x2c409f['id']);if(_0x1907de===_0x3dd7f5(0x163))await generateAESKey(_0x2c409f,_0x44c63e);else{if(_0x1907de==='rsa')await generateRSAKey(_0x2c409f,_0x44c63e,RSA_CONFIG[_0x3dd7f5(0x1a0)]);else{if(_0x1907de===_0x3dd7f5(0x1a7))await generateRSAKey(_0x2c409f,_0x44c63e,RSA_CONFIG[_0x3dd7f5(0x136)]);else{if(_0x1907de==='ecc')await generateECCKey(_0x2c409f,_0x44c63e,ECC_CONFIG[_0x3dd7f5(0x2a1)]);else _0x1907de===_0x3dd7f5(0x192)&&await generateECCKey(_0x2c409f,_0x44c63e,ECC_CONFIG[_0x3dd7f5(0x2a0)]);}}}keys[_0x3dd7f5(0x1b4)](_0x2c409f),await saveKeys(),document[_0x3dd7f5(0x294)](_0x3dd7f5(0x1db))[_0x3dd7f5(0x1d6)]='',document[_0x3dd7f5(0x294)](_0x3dd7f5(0x296))[_0x3dd7f5(0x1d6)]='',document[_0x3dd7f5(0x294)](_0x3dd7f5(0x270))[_0x3dd7f5(0x1d6)]='',document[_0x3dd7f5(0x294)]('passwordStrength')[_0x3dd7f5(0x220)]='password-strength',document['getElementById'](_0x3dd7f5(0x181))['textContent']='';const _0x190603=getKeyTypeDisplay(_0x2c409f);showStatus(_0x3dd7f5(0x1ab),_0x190603+_0x3dd7f5(0x1a5)+_0x3c180a+_0x3dd7f5(0x13c),_0x3dd7f5(0x18b));}catch(_0x57adc7){console[_0x3dd7f5(0x123)](_0x3dd7f5(0xee),_0x57adc7),showStatus('keyStatus',_0x3dd7f5(0x211)+_0x57adc7[_0x3dd7f5(0x25f)],_0x3dd7f5(0x123));}finally{setLoading(![]);}}function getPairedKeyIds(_0x1228cb){const _0x2459f8=_0x5adec6;if(_0x1228cb[_0x2459f8(0x2b2)])return _0x1228cb[_0x2459f8(0x2b2)];if(_0x1228cb[_0x2459f8(0x210)]&&_0x1228cb[_0x2459f8(0x131)])return _0x1228cb['id'];if((_0x1228cb[_0x2459f8(0x113)]===_0x2459f8(0x25d)||_0x1228cb[_0x2459f8(0x113)]===_0x2459f8(0x1a7)||_0x1228cb['type']===_0x2459f8(0x1b3)||_0x1228cb[_0x2459f8(0x113)]===_0x2459f8(0x192))&&(_0x1228cb[_0x2459f8(0x131)]||_0x1228cb[_0x2459f8(0x210)])){const _0x248db5=keys[_0x2459f8(0xf5)](_0x328f2c=>_0x328f2c['id']!==_0x1228cb['id']&&_0x328f2c[_0x2459f8(0x113)]===_0x1228cb[_0x2459f8(0x113)]&&(_0x1228cb[_0x2459f8(0x131)]&&_0x328f2c['hasPrivate']||_0x1228cb[_0x2459f8(0x210)]&&_0x328f2c[_0x2459f8(0x131)])&&(_0x328f2c[_0x2459f8(0xef)]&&_0x1228cb['publicKeyHash']&&_0x328f2c[_0x2459f8(0xef)]===_0x1228cb[_0x2459f8(0xef)]));if(_0x248db5['length']>0x0)return _0x248db5[0x0]['id'];}return null;}function zeroAllKeys(){const _0x5421f2=_0x5adec6;if(keys[_0x5421f2(0xe4)]===0x0){showStatus(_0x5421f2(0x1ab),_0x5421f2(0x1ee),_0x5421f2(0x1f9));return;}const _0x3c8d4c=confirm(_0x5421f2(0x22c));if(_0x3c8d4c){const _0x598d94=keys[_0x5421f2(0xe4)];keys=[],appSettings[_0x5421f2(0x14b)]&&db?clearDatabase(KEYS_STORE)[_0x5421f2(0x2a7)](()=>{const _0xec8aa3=_0x5421f2;console['log'](_0xec8aa3(0x142));})[_0x5421f2(0x1a3)](_0x55b1a3=>{const _0x3880cd=_0x5421f2;console[_0x3880cd(0x123)](_0x3880cd(0x10a),_0x55b1a3);}):localStorage[_0x5421f2(0x1f0)]('LemonadeKeys'),updateKeysList(),updateKeySelects(),showStatus(_0x5421f2(0x1ab),_0x5421f2(0x157)+_0x598d94+_0x5421f2(0x1ac),'success');}else showStatus('keyStatus',_0x5421f2(0x152),_0x5421f2(0x1ed));}async function generateAESKey(_0x41f504,_0x14eb18){const _0x53c373=_0x5adec6,_0xe03c0e=await window[_0x53c373(0x108)]['subtle'][_0x53c373(0xdd)]({'name':AES_CONFIG[_0x53c373(0x221)],'length':AES_CONFIG['KEY_LENGTH']},!![],['encrypt',_0x53c373(0x298)]),_0x8b7b01=await window['crypto'][_0x53c373(0x1b9)][_0x53c373(0x151)](_0x53c373(0x292),_0xe03c0e);_0x41f504[_0x53c373(0x1c7)]=arrayBufferToBase64(_0x8b7b01),_0x41f504[_0x53c373(0x2b6)]=AES_CONFIG[_0x53c373(0x221)],_0x41f504['length']=AES_CONFIG['KEY_LENGTH'],_0x14eb18&&await encryptKeyWithPassword(_0x41f504,_0x14eb18);}async function generateRSAKey(_0x3d43f0,_0x5c22ad,_0x31cd34){const _0x2b7b06=_0x5adec6,_0x4e2cd8=await window[_0x2b7b06(0x108)][_0x2b7b06(0x1b9)][_0x2b7b06(0xdd)]({'name':RSA_CONFIG['ALGORITHM'],'modulusLength':_0x31cd34,'publicExponent':new Uint8Array([0x1,0x0,0x1]),'hash':RSA_CONFIG[_0x2b7b06(0x24d)]},!![],[_0x2b7b06(0x245),_0x2b7b06(0x298)]),_0x2f08a6=await window[_0x2b7b06(0x108)][_0x2b7b06(0x1b9)][_0x2b7b06(0x151)](_0x2b7b06(0x137),_0x4e2cd8['publicKey']),_0x27aff0=await window[_0x2b7b06(0x108)]['subtle'][_0x2b7b06(0x151)](_0x2b7b06(0xfd),_0x4e2cd8[_0x2b7b06(0x1c0)]);_0x3d43f0[_0x2b7b06(0x160)]=arrayBufferToBase64(_0x2f08a6),_0x3d43f0[_0x2b7b06(0x1c0)]=arrayBufferToBase64(_0x27aff0),_0x3d43f0[_0x2b7b06(0x2b6)]=RSA_CONFIG['ALGORITHM'],_0x3d43f0[_0x2b7b06(0xe4)]=_0x31cd34;const _0x24f25f=await computeKeyHash(_0x2f08a6);_0x3d43f0[_0x2b7b06(0xef)]=_0x24f25f,_0x5c22ad&&await encryptKeyWithPassword(_0x3d43f0,_0x5c22ad);}async function generateECCKey(_0x51e1c3,_0x3b13da,_0x585ab2){const _0x7bc306=_0x5adec6,_0x25174a=await window['crypto'][_0x7bc306(0x1b9)]['generateKey']({'name':'ECDH','namedCurve':_0x585ab2},!![],[_0x7bc306(0x259),_0x7bc306(0x18d)]),_0x4c7852=await window[_0x7bc306(0x108)][_0x7bc306(0x1b9)][_0x7bc306(0x151)]('spki',_0x25174a['publicKey']),_0x3f12eb=await window[_0x7bc306(0x108)][_0x7bc306(0x1b9)][_0x7bc306(0x151)](_0x7bc306(0xfd),_0x25174a['privateKey']);_0x51e1c3[_0x7bc306(0x160)]=arrayBufferToBase64(_0x4c7852),_0x51e1c3['privateKey']=arrayBufferToBase64(_0x3f12eb),_0x51e1c3[_0x7bc306(0x2b6)]=_0x7bc306(0x243),_0x51e1c3[_0x7bc306(0xf6)]=_0x585ab2;const _0x51faf8=await computeKeyHash(_0x4c7852);_0x51e1c3[_0x7bc306(0xef)]=_0x51faf8,_0x3b13da&&await encryptKeyWithPassword(_0x51e1c3,_0x3b13da);}async function computeKeyHash(_0x1c8901){const _0x18352a=_0x5adec6,_0x5645b3=await crypto[_0x18352a(0x1b9)][_0x18352a(0x295)](_0x18352a(0x213),_0x1c8901);return arrayBufferToBase64(_0x5645b3);}async function encryptKeyWithPassword(_0xb5e581,_0x45dbbb){const _0x3f2ef8=_0x5adec6,_0x453127=window[_0x3f2ef8(0x108)][_0x3f2ef8(0x164)](new Uint8Array(0x10));_0xb5e581[_0x3f2ef8(0x101)]=arrayBufferToBase64(_0x453127);const _0x218df0=await deriveKeyFromPassword(_0x45dbbb,_0x453127),_0x48c8e9=window[_0x3f2ef8(0x108)]['getRandomValues'](new Uint8Array(AES_CONFIG[_0x3f2ef8(0xf1)]));_0xb5e581['iv']=arrayBufferToBase64(_0x48c8e9);if(_0xb5e581[_0x3f2ef8(0x113)]===_0x3f2ef8(0x163)){const _0x5090fd=await encryptWithDerivedKey(_0x218df0,base64ToArrayBuffer(_0xb5e581[_0x3f2ef8(0x1c7)]),_0x48c8e9);_0xb5e581[_0x3f2ef8(0x1c7)]=arrayBufferToBase64(_0x5090fd),_0xb5e581[_0x3f2ef8(0x264)]=!![];}else{const _0x45457d=await encryptWithDerivedKey(_0x218df0,base64ToArrayBuffer(_0xb5e581['privateKey']),_0x48c8e9);_0xb5e581[_0x3f2ef8(0x1c0)]=arrayBufferToBase64(_0x45457d),_0xb5e581[_0x3f2ef8(0x264)]=!![];}}async function decryptKeyWithPassword(_0x2837cf,_0x25067d){const _0x324816=_0x5adec6;try{if(!_0x2837cf||!_0x25067d)throw new Error(_0x324816(0x1ec));if(!_0x2837cf[_0x324816(0x101)]||!_0x2837cf['iv'])throw new Error(_0x324816(0x1d8));const _0x1917c2=base64ToArrayBuffer(_0x2837cf['salt']),_0x52bd37=await deriveKeyFromPassword(_0x25067d,_0x1917c2),_0x496fc1=base64ToArrayBuffer(_0x2837cf['iv']),_0x3d758f={..._0x2837cf};if(_0x2837cf[_0x324816(0x113)]===_0x324816(0x163)){if(!_0x2837cf['key'])throw new Error(_0x324816(0xf3));const _0x4fff4a=await decryptWithDerivedKey(_0x52bd37,base64ToArrayBuffer(_0x2837cf['key']),_0x496fc1);_0x3d758f[_0x324816(0x1c7)]=arrayBufferToBase64(_0x4fff4a),_0x3d758f[_0x324816(0x28f)]=await importAESKey(_0x4fff4a);}else{if(_0x2837cf[_0x324816(0x113)]===_0x324816(0x25d)||_0x2837cf[_0x324816(0x113)]===_0x324816(0x1a7)){if(!_0x2837cf['privateKey'])throw new Error('Missing\x20encrypted\x20private\x20key\x20data');const _0x19eba2=await decryptWithDerivedKey(_0x52bd37,base64ToArrayBuffer(_0x2837cf[_0x324816(0x1c0)]),_0x496fc1);_0x3d758f[_0x324816(0x1c0)]=arrayBufferToBase64(_0x19eba2),_0x3d758f[_0x324816(0x143)]=await importRSAPrivateKey(_0x19eba2,_0x2837cf[_0x324816(0xe4)]||RSA_CONFIG[_0x324816(0x1a0)]),_0x2837cf[_0x324816(0x160)]&&(_0x3d758f[_0x324816(0x1bb)]=await importRSAPublicKey(base64ToArrayBuffer(_0x2837cf[_0x324816(0x160)]),_0x2837cf[_0x324816(0xe4)]||RSA_CONFIG[_0x324816(0x1a0)]));}else{if(_0x2837cf[_0x324816(0x113)]===_0x324816(0x1b3)||_0x2837cf['type']===_0x324816(0x192)){if(!_0x2837cf[_0x324816(0x1c0)])throw new Error(_0x324816(0x104));const _0x5291ee=await decryptWithDerivedKey(_0x52bd37,base64ToArrayBuffer(_0x2837cf['privateKey']),_0x496fc1);_0x3d758f[_0x324816(0x1c0)]=arrayBufferToBase64(_0x5291ee),_0x3d758f['_privateKey']=await importECCPrivateKey(_0x5291ee,_0x2837cf[_0x324816(0xf6)]||ECC_CONFIG['CURVE']),_0x2837cf[_0x324816(0x160)]&&(_0x3d758f['_publicKey']=await importECCPublicKey(base64ToArrayBuffer(_0x2837cf[_0x324816(0x160)]),_0x2837cf['curve']||ECC_CONFIG['CURVE']));}else throw new Error(_0x324816(0x26b)+_0x2837cf[_0x324816(0x113)]);}}return safeMemory[_0x324816(0x1d2)](_0x3d758f);}catch(_0x54f18d){console[_0x324816(0x123)](_0x324816(0x285),_0x54f18d);throw new Error(_0x324816(0x272));}}function updateKeysList(){const _0x416cb1=_0x5adec6;keysList[_0x416cb1(0xed)]='';if(keys['length']===0x0){keysList[_0x416cb1(0xed)]=_0x416cb1(0x287);return;}keys[_0x416cb1(0x1b5)](_0x2376bf=>{const _0x56c2b1=_0x416cb1,_0x3d8beb=document['createElement'](_0x56c2b1(0x1d7));_0x3d8beb['className']=_0x56c2b1(0x297);const _0x10c379=getKeyTypeDisplay(_0x2376bf),_0x55b718=_0x2376bf[_0x56c2b1(0x264)]?_0x56c2b1(0x291):'';let _0x11c090='';if(_0x2376bf['type']===_0x56c2b1(0x163))_0x11c090='';else{if(_0x2376bf['hasPrivate']&&_0x2376bf[_0x56c2b1(0x131)])_0x11c090=_0x56c2b1(0x1d0);else{if(_0x2376bf[_0x56c2b1(0x210)])_0x11c090=_0x56c2b1(0x128);else _0x2376bf[_0x56c2b1(0x131)]&&(_0x11c090='<span\x20class=\x22key-pair-badge\x20public\x22>PUBLIC\x20KEY</span>');}}let _0x59fc00='',_0x50c0e3=determineKeySecurityLevel(_0x2376bf);_0x59fc00=_0x56c2b1(0x240)+_0x50c0e3+'\x22>'+_0x50c0e3['toUpperCase']()+_0x56c2b1(0x271);let _0x5e8f73='';if(_0x2376bf['expiry']){const _0x345733=new Date(_0x2376bf[_0x56c2b1(0xf2)]),_0x50d4e5=Math['ceil']((_0x345733-new Date())/(0x3e8*0x3c*0x3c*0x18));_0x5e8f73=_0x56c2b1(0x1c5)+_0x50d4e5+_0x56c2b1(0x1dd)+_0x345733[_0x56c2b1(0x124)]()+_0x56c2b1(0x159);}let _0x481147='';if(_0x2376bf['type']===_0x56c2b1(0x163))_0x481147+=_0x56c2b1(0x1e8)+_0x2376bf['id']+'\x27)\x22>Export</button>';else _0x2376bf[_0x56c2b1(0x131)]&&(_0x481147+=_0x56c2b1(0x1e8)+_0x2376bf['id']+'\x27)\x22>Export\x20Public</button>');_0x2376bf[_0x56c2b1(0x113)]!==_0x56c2b1(0x163)&&_0x2376bf[_0x56c2b1(0x210)]&&(_0x481147+=_0x56c2b1(0x214)+_0x2376bf['id']+'\x27)\x22>Private\x20Key</button>'),_0x481147+='<button\x20class=\x22btn-secondary\x22\x20onclick=\x22deleteKey(\x27'+_0x2376bf['id']+'\x27)\x22>Delete</button>',_0x3d8beb['innerHTML']=_0x56c2b1(0x246)+validator[_0x56c2b1(0x1ca)](_0x2376bf[_0x56c2b1(0x11e)])+'\x20('+_0x10c379+_0x55b718+')\x20'+_0x59fc00+_0x56c2b1(0x232)+_0x11c090+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Created:\x20'+new Date(_0x2376bf[_0x56c2b1(0x16d)])[_0x56c2b1(0x107)]()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22key-meta\x22>Algorithm:\x20'+(_0x2376bf[_0x56c2b1(0x2b6)]||'')+'\x20'+(_0x2376bf[_0x56c2b1(0xe4)]?_0x2376bf[_0x56c2b1(0xe4)]+'\x20bits':_0x2376bf[_0x56c2b1(0xf6)]||'')+_0x56c2b1(0x1f1)+_0x5e8f73+_0x56c2b1(0x112)+_0x481147+_0x56c2b1(0x180),keysList['appendChild'](_0x3d8beb);});}function getKeyTypeDisplay(_0x15eee6){const _0x2ddcd7=_0x5adec6;if(_0x15eee6['type']==='aes')return _0x2ddcd7(0x256);else{if(_0x15eee6[_0x2ddcd7(0x113)]==='rsa')return'RSA-2048';else{if(_0x15eee6[_0x2ddcd7(0x113)]==='rsa-4096')return _0x2ddcd7(0x2a3);else{if(_0x15eee6[_0x2ddcd7(0x113)]===_0x2ddcd7(0x1b3))return _0x2ddcd7(0x27c);else{if(_0x15eee6[_0x2ddcd7(0x113)]==='ecc-p384')return'ECC-P384';}}}}return _0x15eee6[_0x2ddcd7(0x113)][_0x2ddcd7(0x203)]();}function updateKeySelects(){const _0xddfa9=_0x5adec6;encryptionKeySelect[_0xddfa9(0xed)]=_0xddfa9(0x10b),decryptionKeySelect[_0xddfa9(0xed)]=_0xddfa9(0x10b),keys['forEach'](_0x4e0951=>{const _0x3947b=_0xddfa9;if(_0x4e0951[_0x3947b(0x113)]===_0x3947b(0x163)||_0x4e0951[_0x3947b(0x131)]){const _0x42b44f=document['createElement'](_0x3947b(0x286));_0x42b44f[_0x3947b(0x1d6)]=_0x4e0951['id'];const _0x17b459=getKeyTypeDisplay(_0x4e0951),_0x34f50f=_0x4e0951[_0x3947b(0x264)]?_0x3947b(0x291):'';let _0x5d4dcb='';_0x4e0951[_0x3947b(0x113)]!=='aes'&&(_0x5d4dcb=_0x4e0951[_0x3947b(0x210)]&&_0x4e0951[_0x3947b(0x131)]?_0x3947b(0x1c9):_0x3947b(0x25c)),_0x42b44f[_0x3947b(0x100)]=_0x4e0951['name']+'\x20('+_0x17b459+_0x5d4dcb+_0x34f50f+')',encryptionKeySelect['appendChild'](_0x42b44f);}}),keys[_0xddfa9(0x1b5)](_0x2e78ca=>{const _0x2f14b1=_0xddfa9;if(_0x2e78ca['type']==='aes'||_0x2e78ca['hasPrivate']){const _0x4cd95c=document[_0x2f14b1(0xe3)](_0x2f14b1(0x286));_0x4cd95c[_0x2f14b1(0x1d6)]=_0x2e78ca['id'];const _0x22d4ad=getKeyTypeDisplay(_0x2e78ca),_0x4e5b2c=_0x2e78ca[_0x2f14b1(0x264)]?_0x2f14b1(0x291):'';let _0xa4f0d8='';_0x2e78ca[_0x2f14b1(0x113)]!==_0x2f14b1(0x163)&&(_0xa4f0d8=_0x2e78ca['hasPrivate']&&_0x2e78ca['hasPublic']?_0x2f14b1(0x1c9):'\x20[Private]'),_0x4cd95c[_0x2f14b1(0x100)]=_0x2e78ca[_0x2f14b1(0x11e)]+'\x20('+_0x22d4ad+_0xa4f0d8+_0x4e5b2c+')',decryptionKeySelect['appendChild'](_0x4cd95c);}});}function handleEncryptionKeyChange(){const _0x4004f3=_0x5adec6,_0x439086=encryptionKeySelect['value'];if(!_0x439086){document[_0x4004f3(0x294)](_0x4004f3(0x149))[_0x4004f3(0x172)][_0x4004f3(0x13b)]=_0x4004f3(0x28a);return;}const _0xbf7b95=keys['find'](_0x1c82cd=>_0x1c82cd['id']===_0x439086);if(!_0xbf7b95)return;document[_0x4004f3(0x294)](_0x4004f3(0x149))['style'][_0x4004f3(0x13b)]=_0xbf7b95[_0x4004f3(0x264)]?_0x4004f3(0x17a):_0x4004f3(0x28a);}function handleDecryptionKeyChange(){const _0x58fb20=_0x5adec6,_0x255f6b=decryptionKeySelect[_0x58fb20(0x1d6)];if(!_0x255f6b){document[_0x58fb20(0x294)](_0x58fb20(0x268))['style'][_0x58fb20(0x13b)]=_0x58fb20(0x28a);return;}const _0x683c83=keys['find'](_0x4db552=>_0x4db552['id']===_0x255f6b);if(!_0x683c83)return;document[_0x58fb20(0x294)](_0x58fb20(0x268))[_0x58fb20(0x172)][_0x58fb20(0x13b)]=_0x683c83[_0x58fb20(0x264)]?_0x58fb20(0x17a):_0x58fb20(0x28a);}async function encryptMessage(){const _0x869b18=_0x5adec6;try{let _0x12af61,_0x512db1='';if(encryptFileData)_0x12af61=encryptFileData,_0x512db1=generateRandomFileName(0x6)+_0x869b18(0x193);else{const _0x3ac485=document[_0x869b18(0x294)](_0x869b18(0x1fb))['value'];if(!_0x3ac485){showStatus('encryptStatus',_0x869b18(0x26d),_0x869b18(0x123));return;}_0x12af61=new TextEncoder()[_0x869b18(0x267)](_0x3ac485);}const _0x1ee256=document[_0x869b18(0x294)]('encryptionKey')[_0x869b18(0x1d6)],_0x506b0d=document[_0x869b18(0x294)](_0x869b18(0x2a2))[_0x869b18(0x1d6)],_0x16d655=document[_0x869b18(0x294)](_0x869b18(0xe9))[_0x869b18(0x1d6)];if(!_0x1ee256){showStatus(_0x869b18(0x1e7),_0x869b18(0x274),_0x869b18(0x123));return;}setLoading(!![]);const _0x278a65=keys[_0x869b18(0x199)](_0x1f7b4c=>_0x1f7b4c['id']===_0x1ee256);if(!_0x278a65){showStatus(_0x869b18(0x1e7),'Key\x20not\x20found',_0x869b18(0x123)),setLoading(![]);return;}let _0x1013cc=null,_0x5cec7a=_0x278a65;if(_0x278a65[_0x869b18(0x264)]){if(!_0x506b0d){showStatus(_0x869b18(0x1e7),_0x869b18(0xe7),_0x869b18(0x123)),setLoading(![]);return;}try{_0x1013cc=await decryptKeyWithPassword(_0x278a65,_0x506b0d),_0x5cec7a=safeMemory['retrieve'](_0x1013cc);if(!_0x5cec7a)throw new Error(_0x869b18(0x1f3));}catch(_0x50e168){showStatus(_0x869b18(0x1e7),_0x869b18(0x1f7)+_0x50e168[_0x869b18(0x25f)],_0x869b18(0x123)),setLoading(![]);return;}}let _0x382837=await encryptData(_0x12af61,_0x5cec7a);_0x1013cc&&safeMemory[_0x869b18(0x105)](_0x1013cc);encryptFileData&&(_0x382837[_0x869b18(0x234)]=encryptFileName,_0x382837[_0x869b18(0x1ba)]=encryptFileData[_0x869b18(0x2b7)],_0x382837[_0x869b18(0x253)]=!![]);const _0xdfa8ca=createEncryptedMessageString(_0x382837,_0x16d655);document[_0x869b18(0x294)](_0x869b18(0x1e3))[_0x869b18(0x1d6)]=_0xdfa8ca,document['getElementById']('downloadEncryptedBtn')['setAttribute'](_0x869b18(0x254),_0x512db1),showStatus(_0x869b18(0x1e7),_0x869b18(0x290),_0x869b18(0x18b));}catch(_0x2f7cc4){console['error']('Encryption\x20error:',_0x2f7cc4),showStatus(_0x869b18(0x1e7),_0x869b18(0x204)+_0x2f7cc4['message'],_0x869b18(0x123));}finally{document[_0x869b18(0x294)](_0x869b18(0x2a2))[_0x869b18(0x1d6)]='',setLoading(![]);}}async function encryptWithAES(_0x514453,_0x54607a){const _0x3a3016=_0x5adec6;try{const _0x49eac6=window[_0x3a3016(0x108)][_0x3a3016(0x164)](new Uint8Array(AES_CONFIG[_0x3a3016(0xf1)]));let _0x2e62c2;if(_0x54607a[_0x3a3016(0x28f)])_0x2e62c2=_0x54607a[_0x3a3016(0x28f)];else{const _0x2b8d0a=base64ToArrayBuffer(_0x54607a[_0x3a3016(0x1c7)]);_0x2e62c2=await window[_0x3a3016(0x108)][_0x3a3016(0x1b9)][_0x3a3016(0x1ce)](_0x3a3016(0x292),_0x2b8d0a,{'name':AES_CONFIG[_0x3a3016(0x221)],'length':AES_CONFIG[_0x3a3016(0x111)]},![],[_0x3a3016(0x245)]);}const _0x845c8c=await window[_0x3a3016(0x108)][_0x3a3016(0x1b9)][_0x3a3016(0x245)]({'name':AES_CONFIG[_0x3a3016(0x221)],'iv':_0x49eac6,'tagLength':AES_CONFIG[_0x3a3016(0x20d)]},_0x2e62c2,_0x514453),_0x590255={'k':_0x54607a['id'],'t':new Date()[_0x3a3016(0x1bd)](),'a':AES_CONFIG[_0x3a3016(0x221)]};encryptFileData&&encryptFileName&&(_0x590255['f']={'n':encryptFileName,'s':encryptFileData[_0x3a3016(0x2b7)]});const _0x41e7e0=new TextEncoder()[_0x3a3016(0x267)](JSON['stringify'](_0x590255)),_0x5b6531=window[_0x3a3016(0x108)][_0x3a3016(0x164)](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0x205564=await window[_0x3a3016(0x108)][_0x3a3016(0x1b9)][_0x3a3016(0xdd)]({'name':AES_CONFIG[_0x3a3016(0x221)],'length':AES_CONFIG[_0x3a3016(0x111)]},!![],['encrypt']),_0x45bb21=await window[_0x3a3016(0x108)][_0x3a3016(0x1b9)][_0x3a3016(0x245)]({'name':AES_CONFIG[_0x3a3016(0x221)],'iv':_0x5b6531,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x205564,_0x41e7e0),_0x3a6091=await window[_0x3a3016(0x108)][_0x3a3016(0x1b9)][_0x3a3016(0x151)](_0x3a3016(0x292),_0x205564),_0xc50dcb=0x3,_0x36b4c1=0x1+_0x5b6531[_0x3a3016(0x2b7)]+0x4+_0x3a6091[_0x3a3016(0x2b7)]+0x4+_0x45bb21[_0x3a3016(0x2b7)]+_0x49eac6[_0x3a3016(0x2b7)]+0x4+_0x845c8c[_0x3a3016(0x2b7)],_0x25e5fd=new Uint8Array(_0x36b4c1);let _0x1a01d4=0x0;_0x25e5fd[_0x1a01d4++]=_0xc50dcb,_0x25e5fd[_0x3a3016(0x28e)](_0x5b6531,_0x1a01d4),_0x1a01d4+=_0x5b6531[_0x3a3016(0x2b7)];const _0x3956bd=_0x3a6091[_0x3a3016(0x2b7)];_0x25e5fd[_0x1a01d4++]=_0x3956bd>>0x18&0xff,_0x25e5fd[_0x1a01d4++]=_0x3956bd>>0x10&0xff,_0x25e5fd[_0x1a01d4++]=_0x3956bd>>0x8&0xff,_0x25e5fd[_0x1a01d4++]=_0x3956bd&0xff,_0x25e5fd['set'](new Uint8Array(_0x3a6091),_0x1a01d4),_0x1a01d4+=_0x3a6091['byteLength'];const _0x22fde5=_0x45bb21[_0x3a3016(0x2b7)];_0x25e5fd[_0x1a01d4++]=_0x22fde5>>0x18&0xff,_0x25e5fd[_0x1a01d4++]=_0x22fde5>>0x10&0xff,_0x25e5fd[_0x1a01d4++]=_0x22fde5>>0x8&0xff,_0x25e5fd[_0x1a01d4++]=_0x22fde5&0xff,_0x25e5fd[_0x3a3016(0x28e)](new Uint8Array(_0x45bb21),_0x1a01d4),_0x1a01d4+=_0x45bb21['byteLength'],_0x25e5fd['set'](_0x49eac6,_0x1a01d4),_0x1a01d4+=_0x49eac6[_0x3a3016(0x2b7)];const _0x4d359c=_0x845c8c[_0x3a3016(0x2b7)];return _0x25e5fd[_0x1a01d4++]=_0x4d359c>>0x18&0xff,_0x25e5fd[_0x1a01d4++]=_0x4d359c>>0x10&0xff,_0x25e5fd[_0x1a01d4++]=_0x4d359c>>0x8&0xff,_0x25e5fd[_0x1a01d4++]=_0x4d359c&0xff,_0x25e5fd['set'](new Uint8Array(_0x845c8c),_0x1a01d4),{'version':0x3,'data':arrayBufferToBase64(_0x25e5fd['buffer'])};}catch(_0x4dc09f){console['error'](_0x3a3016(0x121),_0x4dc09f);throw new Error(_0x3a3016(0x189)+_0x4dc09f[_0x3a3016(0x25f)]);}}async function deriveMetadataKey(_0x527d18,_0x268774){const _0x5f14b0=_0x5adec6,_0x4075b4=await window[_0x5f14b0(0x108)][_0x5f14b0(0x1b9)][_0x5f14b0(0x151)](_0x5f14b0(0x292),_0x527d18),_0x52c7fe=new Uint8Array(_0x4075b4[_0x5f14b0(0x2b7)]+_0x268774[_0x5f14b0(0x2b7)]);_0x52c7fe['set'](new Uint8Array(_0x4075b4),0x0),_0x52c7fe[_0x5f14b0(0x28e)](_0x268774,_0x4075b4[_0x5f14b0(0x2b7)]);const _0x5eb5fc=await window['crypto'][_0x5f14b0(0x1b9)]['importKey'](_0x5f14b0(0x292),_0x52c7fe,{'name':_0x5f14b0(0x119)},![],[_0x5f14b0(0x259)]);return window[_0x5f14b0(0x108)][_0x5f14b0(0x1b9)][_0x5f14b0(0x259)]({'name':_0x5f14b0(0x119),'hash':_0x5f14b0(0x213),'salt':_0x268774,'info':new Uint8Array([0x1,0x2,0x3,0x4])},_0x5eb5fc,{'name':AES_CONFIG[_0x5f14b0(0x221)],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x5f14b0(0x245),_0x5f14b0(0x298)]);}async function encryptWithRSA(_0x4a977c,_0x3f2c59){const _0x1a25d9=_0x5adec6,_0x18278e=await window['crypto'][_0x1a25d9(0x1b9)][_0x1a25d9(0xdd)]({'name':AES_CONFIG[_0x1a25d9(0x221)],'length':AES_CONFIG[_0x1a25d9(0x111)]},!![],['encrypt','decrypt']),_0x3ca9fa=window[_0x1a25d9(0x108)]['getRandomValues'](new Uint8Array(AES_CONFIG[_0x1a25d9(0xf1)])),_0x5bff20=await window[_0x1a25d9(0x108)][_0x1a25d9(0x1b9)][_0x1a25d9(0x245)]({'name':AES_CONFIG[_0x1a25d9(0x221)],'iv':_0x3ca9fa,'tagLength':AES_CONFIG[_0x1a25d9(0x20d)]},_0x18278e,_0x4a977c),_0x4a5a77=await window[_0x1a25d9(0x108)][_0x1a25d9(0x1b9)][_0x1a25d9(0x151)]('raw',_0x18278e);let _0x3363d0;if(_0x3f2c59[_0x1a25d9(0x1bb)])_0x3363d0=_0x3f2c59['_publicKey'];else{const _0xa2ab71=base64ToArrayBuffer(_0x3f2c59[_0x1a25d9(0x160)]);_0x3363d0=await importRSAPublicKey(_0xa2ab71,_0x3f2c59[_0x1a25d9(0xe4)]||RSA_CONFIG['KEY_SIZE']);}const _0x260792=await window['crypto'][_0x1a25d9(0x1b9)][_0x1a25d9(0x245)]({'name':RSA_CONFIG[_0x1a25d9(0x257)]},_0x3363d0,_0x4a5a77),_0x10eb67={'a':RSA_CONFIG[_0x1a25d9(0x257)]+'+'+AES_CONFIG[_0x1a25d9(0x221)],'k':_0x3f2c59['id'],'t':new Date()[_0x1a25d9(0x1bd)](),'s':_0x3f2c59['length']||RSA_CONFIG[_0x1a25d9(0x1a0)]};encryptFileData&&encryptFileName&&(_0x10eb67['f']={'n':encryptFileName,'s':encryptFileData[_0x1a25d9(0x2b7)]});const _0xeee8f1=new TextEncoder()[_0x1a25d9(0x267)](JSON['stringify'](_0x10eb67)),_0x3a8cfe=await window[_0x1a25d9(0x108)][_0x1a25d9(0x1b9)][_0x1a25d9(0xdd)]({'name':AES_CONFIG[_0x1a25d9(0x221)],'length':AES_CONFIG[_0x1a25d9(0x111)]},!![],[_0x1a25d9(0x245),_0x1a25d9(0x298)]),_0xa126f0=window[_0x1a25d9(0x108)][_0x1a25d9(0x164)](new Uint8Array(AES_CONFIG[_0x1a25d9(0xf1)])),_0xaf2e66=await window[_0x1a25d9(0x108)]['subtle'][_0x1a25d9(0x245)]({'name':AES_CONFIG['MODE'],'iv':_0xa126f0,'tagLength':AES_CONFIG[_0x1a25d9(0x20d)]},_0x3a8cfe,_0xeee8f1),_0x19656b=await window[_0x1a25d9(0x108)][_0x1a25d9(0x1b9)]['exportKey']('raw',_0x3a8cfe),_0x4a0ab6=Math[_0x1a25d9(0x16b)](Math[_0x1a25d9(0x233)]()*0x40)+0x1,_0x3ba63a=window[_0x1a25d9(0x108)]['getRandomValues'](new Uint8Array(_0x4a0ab6)),_0x381258=new Uint8Array(0x1+_0xa126f0[_0x1a25d9(0x2b7)]+0x4+_0x19656b[_0x1a25d9(0x2b7)]+0x4+_0xaf2e66[_0x1a25d9(0x2b7)]+0x4+_0x260792[_0x1a25d9(0x2b7)]+_0x3ca9fa[_0x1a25d9(0x2b7)]+0x4+_0x5bff20[_0x1a25d9(0x2b7)]+0x1+_0x3ba63a[_0x1a25d9(0x2b7)]);let _0x164d2e=0x0;_0x381258[_0x164d2e++]=_0xa126f0[_0x1a25d9(0x2b7)],_0x381258[_0x1a25d9(0x28e)](_0xa126f0,_0x164d2e),_0x164d2e+=_0xa126f0[_0x1a25d9(0x2b7)];const _0x39e057=_0x19656b[_0x1a25d9(0x2b7)];_0x381258[_0x164d2e++]=_0x39e057>>0x18&0xff,_0x381258[_0x164d2e++]=_0x39e057>>0x10&0xff,_0x381258[_0x164d2e++]=_0x39e057>>0x8&0xff,_0x381258[_0x164d2e++]=_0x39e057&0xff,_0x381258[_0x1a25d9(0x28e)](new Uint8Array(_0x19656b),_0x164d2e),_0x164d2e+=_0x19656b['byteLength'];const _0x4c4dc7=_0xaf2e66[_0x1a25d9(0x2b7)];_0x381258[_0x164d2e++]=_0x4c4dc7>>0x18&0xff,_0x381258[_0x164d2e++]=_0x4c4dc7>>0x10&0xff,_0x381258[_0x164d2e++]=_0x4c4dc7>>0x8&0xff,_0x381258[_0x164d2e++]=_0x4c4dc7&0xff,_0x381258[_0x1a25d9(0x28e)](new Uint8Array(_0xaf2e66),_0x164d2e),_0x164d2e+=_0xaf2e66[_0x1a25d9(0x2b7)];const _0x5a34c2=_0x260792['byteLength'];_0x381258[_0x164d2e++]=_0x5a34c2>>0x18&0xff,_0x381258[_0x164d2e++]=_0x5a34c2>>0x10&0xff,_0x381258[_0x164d2e++]=_0x5a34c2>>0x8&0xff,_0x381258[_0x164d2e++]=_0x5a34c2&0xff,_0x381258['set'](new Uint8Array(_0x260792),_0x164d2e),_0x164d2e+=_0x260792[_0x1a25d9(0x2b7)],_0x381258[_0x1a25d9(0x28e)](_0x3ca9fa,_0x164d2e),_0x164d2e+=_0x3ca9fa[_0x1a25d9(0x2b7)];const _0x31a8f6=_0x5bff20['byteLength'];return _0x381258[_0x164d2e++]=_0x31a8f6>>0x18&0xff,_0x381258[_0x164d2e++]=_0x31a8f6>>0x10&0xff,_0x381258[_0x164d2e++]=_0x31a8f6>>0x8&0xff,_0x381258[_0x164d2e++]=_0x31a8f6&0xff,_0x381258[_0x1a25d9(0x28e)](new Uint8Array(_0x5bff20),_0x164d2e),_0x164d2e+=_0x5bff20[_0x1a25d9(0x2b7)],_0x381258[_0x164d2e++]=_0x3ba63a[_0x1a25d9(0x2b7)],_0x381258[_0x1a25d9(0x28e)](_0x3ba63a,_0x164d2e),{'version':0x2,'data':arrayBufferToBase64(_0x381258[_0x1a25d9(0xde)])};}async function encryptWithECC(_0x346545,_0x49f1e1){const _0x471de6=_0x5adec6,_0x3f3fcf=await window['crypto'][_0x471de6(0x1b9)][_0x471de6(0xdd)]({'name':'ECDH','namedCurve':_0x49f1e1[_0x471de6(0xf6)]||ECC_CONFIG[_0x471de6(0x2a1)]},!![],[_0x471de6(0x259),'deriveBits']),_0xb61a4b=await window[_0x471de6(0x108)][_0x471de6(0x1b9)][_0x471de6(0x151)](_0x471de6(0x137),_0x3f3fcf[_0x471de6(0x160)]);let _0x3b8e48;if(_0x49f1e1[_0x471de6(0x1bb)])_0x3b8e48=_0x49f1e1[_0x471de6(0x1bb)];else{const _0x376b45=base64ToArrayBuffer(_0x49f1e1[_0x471de6(0x160)]);_0x3b8e48=await importECCPublicKey(_0x376b45,_0x49f1e1[_0x471de6(0xf6)]||ECC_CONFIG['CURVE']);}const _0x518c80=window['crypto'][_0x471de6(0x164)](new Uint8Array(AES_CONFIG[_0x471de6(0xf1)])),_0x1a2044=await window[_0x471de6(0x108)][_0x471de6(0x1b9)][_0x471de6(0x18d)]({'name':_0x471de6(0x243),'public':_0x3b8e48},_0x3f3fcf['privateKey'],0x100),_0x5a4ab6=await window[_0x471de6(0x108)][_0x471de6(0x1b9)][_0x471de6(0x1ce)](_0x471de6(0x292),_0x1a2044,{'name':AES_CONFIG[_0x471de6(0x221)],'length':AES_CONFIG[_0x471de6(0x111)]},![],[_0x471de6(0x245)]),_0x13305d=await window['crypto']['subtle'][_0x471de6(0x245)]({'name':AES_CONFIG[_0x471de6(0x221)],'iv':_0x518c80,'tagLength':AES_CONFIG[_0x471de6(0x20d)]},_0x5a4ab6,_0x346545),_0x35f06f={'a':_0x471de6(0x2ab)+AES_CONFIG[_0x471de6(0x221)],'k':_0x49f1e1['id'],'t':new Date()[_0x471de6(0x1bd)](),'c':_0x49f1e1[_0x471de6(0xf6)]||ECC_CONFIG[_0x471de6(0x2a1)]};encryptFileData&&encryptFileName&&(_0x35f06f['f']={'n':encryptFileName,'s':encryptFileData['byteLength']});const _0xcabab3=new TextEncoder()[_0x471de6(0x267)](JSON[_0x471de6(0x19f)](_0x35f06f)),_0x3051d0=await window[_0x471de6(0x108)][_0x471de6(0x1b9)][_0x471de6(0xdd)]({'name':AES_CONFIG[_0x471de6(0x221)],'length':AES_CONFIG['KEY_LENGTH']},!![],[_0x471de6(0x245),_0x471de6(0x298)]),_0x43c1ce=window[_0x471de6(0x108)][_0x471de6(0x164)](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0x128935=await window['crypto']['subtle']['encrypt']({'name':AES_CONFIG[_0x471de6(0x221)],'iv':_0x43c1ce,'tagLength':AES_CONFIG[_0x471de6(0x20d)]},_0x3051d0,_0xcabab3),_0x448c05=await window[_0x471de6(0x108)]['subtle'][_0x471de6(0x151)](_0x471de6(0x292),_0x3051d0),_0x4a028b=Math[_0x471de6(0x16b)](Math['random']()*0x40)+0x1,_0x55b72f=window['crypto']['getRandomValues'](new Uint8Array(_0x4a028b)),_0x38a114=new Uint8Array(0x1+_0x43c1ce[_0x471de6(0x2b7)]+0x4+_0x448c05[_0x471de6(0x2b7)]+0x4+_0x128935[_0x471de6(0x2b7)]+0x4+_0xb61a4b[_0x471de6(0x2b7)]+_0x518c80[_0x471de6(0x2b7)]+0x4+_0x13305d[_0x471de6(0x2b7)]+0x1+_0x55b72f[_0x471de6(0x2b7)]);let _0x408582=0x0;_0x38a114[_0x408582++]=_0x43c1ce[_0x471de6(0x2b7)],_0x38a114['set'](_0x43c1ce,_0x408582),_0x408582+=_0x43c1ce[_0x471de6(0x2b7)];const _0x452347=_0x448c05[_0x471de6(0x2b7)];_0x38a114[_0x408582++]=_0x452347>>0x18&0xff,_0x38a114[_0x408582++]=_0x452347>>0x10&0xff,_0x38a114[_0x408582++]=_0x452347>>0x8&0xff,_0x38a114[_0x408582++]=_0x452347&0xff,_0x38a114['set'](new Uint8Array(_0x448c05),_0x408582),_0x408582+=_0x448c05[_0x471de6(0x2b7)];const _0x71474b=_0x128935[_0x471de6(0x2b7)];_0x38a114[_0x408582++]=_0x71474b>>0x18&0xff,_0x38a114[_0x408582++]=_0x71474b>>0x10&0xff,_0x38a114[_0x408582++]=_0x71474b>>0x8&0xff,_0x38a114[_0x408582++]=_0x71474b&0xff,_0x38a114['set'](new Uint8Array(_0x128935),_0x408582),_0x408582+=_0x128935[_0x471de6(0x2b7)];const _0x525e37=_0xb61a4b['byteLength'];_0x38a114[_0x408582++]=_0x525e37>>0x18&0xff,_0x38a114[_0x408582++]=_0x525e37>>0x10&0xff,_0x38a114[_0x408582++]=_0x525e37>>0x8&0xff,_0x38a114[_0x408582++]=_0x525e37&0xff,_0x38a114[_0x471de6(0x28e)](new Uint8Array(_0xb61a4b),_0x408582),_0x408582+=_0xb61a4b[_0x471de6(0x2b7)],_0x38a114['set'](_0x518c80,_0x408582),_0x408582+=_0x518c80['byteLength'];const _0x51af76=_0x13305d['byteLength'];return _0x38a114[_0x408582++]=_0x51af76>>0x18&0xff,_0x38a114[_0x408582++]=_0x51af76>>0x10&0xff,_0x38a114[_0x408582++]=_0x51af76>>0x8&0xff,_0x38a114[_0x408582++]=_0x51af76&0xff,_0x38a114[_0x471de6(0x28e)](new Uint8Array(_0x13305d),_0x408582),_0x408582+=_0x13305d[_0x471de6(0x2b7)],_0x38a114[_0x408582++]=_0x55b72f[_0x471de6(0x2b7)],_0x38a114['set'](_0x55b72f,_0x408582),{'version':0x2,'data':arrayBufferToBase64(_0x38a114['buffer'])};}async function decryptMessage(){const _0x581724=_0x5adec6;try{let _0x1d24b0;const _0x296c54=document[_0x581724(0x294)](_0x581724(0x122))[_0x581724(0x1d6)],_0x3977a8=document[_0x581724(0x294)](_0x581724(0x115))['value'];if(!_0x296c54){showStatus(_0x581724(0x140),_0x581724(0x227),'error');return;}if(!isValidEncryptedMessage(_0x296c54,_0x3977a8)){showStatus(_0x581724(0x140),_0x581724(0x279),'error');return;}try{_0x1d24b0=parseEncryptedMessage(_0x296c54,_0x3977a8);}catch(_0x7b2078){showStatus(_0x581724(0x140),'Invalid\x20encrypted\x20message\x20data:\x20'+_0x7b2078['message'],_0x581724(0x123));return;}const _0x5a88aa=document[_0x581724(0x294)](_0x581724(0x156))[_0x581724(0x1d6)],_0x27cb60=document[_0x581724(0x294)]('decryptionPassword')[_0x581724(0x1d6)];if(!_0x5a88aa){showStatus(_0x581724(0x140),_0x581724(0x2b3),'error');return;}setLoading(!![]);const _0x5354d2=keys[_0x581724(0x199)](_0x726200=>_0x726200['id']===_0x5a88aa);if(!_0x5354d2){showStatus(_0x581724(0x140),'Key\x20not\x20found','error'),setLoading(![]);return;}let _0x284f78=null,_0x1e9729=_0x5354d2;if(_0x5354d2[_0x581724(0x264)]){if(!_0x27cb60){showStatus(_0x581724(0x140),_0x581724(0xe7),_0x581724(0x123)),setLoading(![]);return;}try{_0x284f78=await decryptKeyWithPassword(_0x5354d2,_0x27cb60),_0x1e9729=safeMemory[_0x581724(0x200)](_0x284f78);if(!_0x1e9729)throw new Error('Failed\x20to\x20retrieve\x20decrypted\x20key\x20from\x20memory.');}catch(_0x5e72b1){showStatus('decryptStatus','Failed\x20to\x20decrypt\x20key:\x20'+_0x5e72b1[_0x581724(0x25f)],_0x581724(0x123)),setLoading(![]);return;}}let _0x2be532=await decryptData(_0x1d24b0,_0x1e9729),_0xf83897,_0x1e58ca;_0x2be532[_0x581724(0x1de)]?(_0xf83897=_0x2be532[_0x581724(0x1de)],_0x1e58ca=_0x2be532[_0x581724(0x2a4)]):(_0xf83897=_0x2be532,_0x1e58ca=null);_0x284f78&&safeMemory[_0x581724(0x105)](_0x284f78);let _0x2b3005=![],_0x411cd4=null,_0x54050d=null;if(!_0x1d24b0[_0x581724(0x12a)]&&_0x1d24b0[_0x581724(0x253)]&&_0x1d24b0['fileName'])_0x2b3005=!![],_0x411cd4=_0x1d24b0[_0x581724(0x234)],_0x54050d=_0x1d24b0['fileSize']||_0xf83897[_0x581724(0x2b7)];else _0x1e58ca&&_0x1e58ca['f']&&(_0x2b3005=!![],_0x411cd4=_0x1e58ca['f']['n'],_0x54050d=_0x1e58ca['f']['s']||_0xf83897[_0x581724(0x2b7)]);if(_0x2b3005)document[_0x581724(0x294)]('decryptedOutput')['value']=_0x581724(0x15e)+_0x411cd4+'\x20('+formatFileSize(_0x54050d)+')',document[_0x581724(0x294)]('downloadDecryptedBtn')['setAttribute']('data-filename',_0x411cd4),document[_0x581724(0x294)](_0x581724(0x19e))[_0x581724(0x278)](_0x581724(0x1e6),'true'),window[_0x581724(0x251)]=_0xf83897;else{const _0x4d917b=new TextDecoder()[_0x581724(0x109)](_0xf83897);document[_0x581724(0x294)](_0x581724(0x1af))[_0x581724(0x1d6)]=_0x4d917b,document[_0x581724(0x294)]('downloadDecryptedBtn')[_0x581724(0x278)](_0x581724(0x254),'decrypted.txt'),document[_0x581724(0x294)](_0x581724(0x19e))[_0x581724(0x278)](_0x581724(0x1e6),_0x581724(0x19a)),window['decryptedBinaryData']=null;}showStatus(_0x581724(0x140),_0x581724(0x1c4),'success');}catch(_0x510f55){console[_0x581724(0x123)](_0x581724(0x285),_0x510f55),showStatus(_0x581724(0x140),_0x581724(0x1da)+_0x510f55[_0x581724(0x25f)],_0x581724(0x123));}finally{document[_0x581724(0x294)](_0x581724(0x145))['value']='',setLoading(![]);}}async function decryptWithAES(_0x24c4f8,_0x4fb6d4){const _0x149168=_0x5adec6;try{const _0x59d25c=base64ToArrayBuffer(_0x24c4f8[_0x149168(0x1de)]),_0x29a125=new Uint8Array(_0x59d25c);let _0x3c9409=0x0;const _0x54eb44=_0x29a125[_0x3c9409++];if(_0x54eb44!==0x3)throw new Error('Unsupported\x20data\x20format\x20version');const _0x3a4775=_0x29a125[_0x149168(0x1c1)](_0x3c9409,_0x3c9409+AES_CONFIG[_0x149168(0xf1)]);_0x3c9409+=AES_CONFIG[_0x149168(0xf1)];const _0x341fd1=_0x29a125[_0x3c9409]<<0x18|_0x29a125[_0x3c9409+0x1]<<0x10|_0x29a125[_0x3c9409+0x2]<<0x8|_0x29a125[_0x3c9409+0x3];_0x3c9409+=0x4;const _0x3b9eac=_0x29a125[_0x149168(0x1c1)](_0x3c9409,_0x3c9409+_0x341fd1);_0x3c9409+=_0x341fd1;const _0x4481ba=_0x29a125[_0x3c9409]<<0x18|_0x29a125[_0x3c9409+0x1]<<0x10|_0x29a125[_0x3c9409+0x2]<<0x8|_0x29a125[_0x3c9409+0x3];_0x3c9409+=0x4;const _0x11e5f8=_0x29a125['slice'](_0x3c9409,_0x3c9409+_0x4481ba);_0x3c9409+=_0x4481ba;const _0x19eaef=_0x29a125[_0x149168(0x1c1)](_0x3c9409,_0x3c9409+AES_CONFIG[_0x149168(0xf1)]);_0x3c9409+=AES_CONFIG[_0x149168(0xf1)];const _0x267756=_0x29a125[_0x3c9409]<<0x18|_0x29a125[_0x3c9409+0x1]<<0x10|_0x29a125[_0x3c9409+0x2]<<0x8|_0x29a125[_0x3c9409+0x3];_0x3c9409+=0x4;const _0x11699e=_0x29a125[_0x149168(0x1c1)](_0x3c9409,_0x3c9409+_0x267756),_0x561edd=await window[_0x149168(0x108)][_0x149168(0x1b9)][_0x149168(0x1ce)]('raw',_0x3b9eac,{'name':AES_CONFIG[_0x149168(0x221)],'length':AES_CONFIG[_0x149168(0x111)]},![],[_0x149168(0x298)]),_0x4da6aa=await window[_0x149168(0x108)][_0x149168(0x1b9)][_0x149168(0x298)]({'name':AES_CONFIG[_0x149168(0x221)],'iv':_0x3a4775,'tagLength':AES_CONFIG[_0x149168(0x20d)]},_0x561edd,_0x11e5f8),_0xa30573=new TextDecoder()[_0x149168(0x109)](_0x4da6aa),_0xbe7090=JSON[_0x149168(0x1f8)](_0xa30573);if(_0xbe7090['k']!==_0x4fb6d4['id'])throw new Error(_0x149168(0x190));let _0x5984b2;if(_0x4fb6d4[_0x149168(0x28f)])_0x5984b2=_0x4fb6d4[_0x149168(0x28f)];else{const _0x364fbf=base64ToArrayBuffer(_0x4fb6d4['key']);_0x5984b2=await window[_0x149168(0x108)][_0x149168(0x1b9)][_0x149168(0x1ce)](_0x149168(0x292),_0x364fbf,{'name':AES_CONFIG[_0x149168(0x221)],'length':AES_CONFIG[_0x149168(0x111)]},![],[_0x149168(0x298)]);}return{'data':await window[_0x149168(0x108)][_0x149168(0x1b9)][_0x149168(0x298)]({'name':AES_CONFIG['MODE'],'iv':_0x19eaef,'tagLength':AES_CONFIG[_0x149168(0x20d)]},_0x5984b2,_0x11699e),'metadata':_0xbe7090};}catch(_0x32a849){console[_0x149168(0x123)](_0x149168(0x244),_0x32a849);if(_0x32a849 instanceof DOMException)throw new Error(_0x149168(0x1f2)+_0x32a849['name']+_0x149168(0x150)+(_0x32a849['message']||'Unknown\x20WebCrypto\x20error'));else throw new Error(_0x149168(0x1f2)+_0x32a849[_0x149168(0x25f)]);}}function isValidEncryptedMessage(_0x114d7a,_0x301512=''){const _0x3b0abb=_0x5adec6,_0x5e5995=typeof _0x301512===_0x3b0abb(0x1a8)&&_0x301512[_0x3b0abb(0x138)]()!==''?_0x301512['trim']():null;let _0x1981c8,_0x4389d0;_0x5e5995?(_0x1981c8=_0x5e5995,_0x4389d0=reverseString(_0x5e5995)):(_0x1981c8='@!',_0x4389d0='!@');const _0x373fee=escapeRegex(_0x1981c8),_0x5ac556=escapeRegex(_0x4389d0),_0x1dcbc1=_0x373fee+_0x3b0abb(0x24a)+_0x5ac556,_0x555605=new RegExp(_0x1dcbc1);return _0x555605[_0x3b0abb(0x198)](_0x114d7a);}function createEncryptedMessageString(_0x5d56a1,_0xdb6e44=''){const _0x28333d=_0x5adec6,_0x34b074=typeof _0xdb6e44===_0x28333d(0x1a8)&&_0xdb6e44[_0x28333d(0x138)]()!==''?_0xdb6e44[_0x28333d(0x138)]():null;let _0x1848a1,_0x439c4c;_0x34b074?(_0x1848a1=_0x34b074,_0x439c4c=reverseString(_0x34b074)):(_0x1848a1='@!',_0x439c4c='!@');const _0x3c1346=generateRandomString(0x2+Math[_0x28333d(0x16b)](Math[_0x28333d(0x233)]()*0x9)),_0x548cea=generateRandomString(0x2+Math['floor'](Math['random']()*0x9)),_0xf82a8d=typeof _0x5d56a1[_0x28333d(0x1de)]===_0x28333d(0x1a8)?_0x5d56a1['data'][_0x28333d(0x158)](/[\r\n\s]*(.*?)[\r\n\s]*$/s,'$1'):_0x5d56a1['data'];return _0x3c1346+_0x1848a1+_0xf82a8d+_0x439c4c+_0x548cea;}function parseEncryptedMessage(_0x3847bf,_0xca2b22=''){const _0x169c1d=_0x5adec6,_0x2a4c23=typeof _0xca2b22===_0x169c1d(0x1a8)&&_0xca2b22[_0x169c1d(0x138)]()!==''?_0xca2b22[_0x169c1d(0x138)]():null;let _0x432481,_0x5c8ad6;_0x2a4c23?(_0x432481=_0x2a4c23,_0x5c8ad6=reverseString(_0x2a4c23)):(_0x432481='@!',_0x5c8ad6='!@');const _0x1b1bf0=escapeRegex(_0x432481),_0x5581b2=escapeRegex(_0x5c8ad6),_0x469e93='^.*?'+_0x1b1bf0+_0x169c1d(0x17b)+_0x5581b2+_0x169c1d(0x19c),_0x407a93=new RegExp(_0x469e93),_0x315d0e=_0x3847bf[_0x169c1d(0xe6)](_0x407a93);if(!_0x315d0e||!_0x315d0e[0x1])throw new Error(_0x169c1d(0x173));const _0xe01681=_0x315d0e[0x1][_0x169c1d(0x138)]();return{'version':0x2,'data':_0xe01681};}function updateEncryptionOutput(_0x81a299){return createEncryptedMessageString(_0x81a299);}function generateRandomString(_0x32cab6=0x5){const _0x329b54=_0x5adec6,_0x187241='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let _0x4076cd='';for(let _0x5b922e=0x0;_0x5b922e<_0x32cab6;_0x5b922e++){_0x4076cd+=_0x187241['charAt'](Math[_0x329b54(0x16b)](Math[_0x329b54(0x233)]()*_0x187241['length']));}return _0x4076cd;}function determineKeySecurityLevel(_0x3c4cdd){const _0x13f9aa=_0x5adec6;let _0x55c0f4=_0x13f9aa(0x207);if(_0x3c4cdd[_0x13f9aa(0x113)]===_0x13f9aa(0x163)||_0x3c4cdd[_0x13f9aa(0x113)]==='rsa-4096'||_0x3c4cdd[_0x13f9aa(0x113)]==='ecc-p384')_0x55c0f4=_0x13f9aa(0x1e9);else(_0x3c4cdd['type']===_0x13f9aa(0x25d)||_0x3c4cdd['type']===_0x13f9aa(0x1b3))&&(_0x55c0f4=_0x13f9aa(0x207));let _0x11372a=0x0;_0x3c4cdd[_0x13f9aa(0x264)]&&(_0x11372a+=0x2);_0x3c4cdd[_0x13f9aa(0x113)]!=='aes'&&(_0x3c4cdd[_0x13f9aa(0x131)]&&_0x3c4cdd[_0x13f9aa(0x210)]&&(_0x11372a+=0x1));_0x3c4cdd[_0x13f9aa(0xf2)]&&(_0x11372a+=0x1);let _0x253b70;if(_0x55c0f4===_0x13f9aa(0x1e9)){if(_0x11372a>=0x3)_0x253b70='high';else _0x11372a>=0x1?_0x253b70=_0x13f9aa(0x1e9):_0x253b70=_0x13f9aa(0x207);}else{if(_0x11372a>=0x4)_0x253b70=_0x13f9aa(0x255);else _0x11372a>=0x2?_0x253b70=_0x13f9aa(0x1e9):_0x253b70=_0x13f9aa(0x207);}return _0x253b70;}async function decryptWithRSA(_0x5f485a,_0x53f89c){const _0x5df275=_0x5adec6;if(!_0x5f485a[_0x5df275(0x12a)]||_0x5f485a['version']===0x1){const _0x3ba333=base64ToArrayBuffer(_0x5f485a[_0x5df275(0x1de)]),_0x10af07=base64ToArrayBuffer(_0x5f485a[_0x5df275(0x129)]),_0x40fa5d=base64ToArrayBuffer(_0x5f485a['iv']);let _0x37ef8c;if(_0x53f89c[_0x5df275(0x143)])_0x37ef8c=_0x53f89c['_privateKey'];else{const _0x590da7=base64ToArrayBuffer(_0x53f89c[_0x5df275(0x1c0)]);_0x37ef8c=await importRSAPrivateKey(_0x590da7,_0x5f485a[_0x5df275(0x1bc)]||_0x53f89c[_0x5df275(0xe4)]||RSA_CONFIG['KEY_SIZE']);}const _0x4b4267=await window[_0x5df275(0x108)][_0x5df275(0x1b9)][_0x5df275(0x298)]({'name':RSA_CONFIG[_0x5df275(0x257)]},_0x37ef8c,_0x10af07),_0x4a9f6e=await importAESKey(_0x4b4267);return await window[_0x5df275(0x108)]['subtle'][_0x5df275(0x298)]({'name':AES_CONFIG[_0x5df275(0x221)],'iv':_0x40fa5d,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x4a9f6e,_0x3ba333);}else{const _0x759be2=base64ToArrayBuffer(_0x5f485a[_0x5df275(0x1de)]),_0x58ad6c=new Uint8Array(_0x759be2);let _0xa27cc6=0x0;const _0x4d4f62=_0x58ad6c[_0xa27cc6++],_0x4c1565=_0x58ad6c[_0x5df275(0x1c1)](_0xa27cc6,_0xa27cc6+_0x4d4f62);_0xa27cc6+=_0x4d4f62;const _0xe3aba0=_0x58ad6c[_0xa27cc6]<<0x18|_0x58ad6c[_0xa27cc6+0x1]<<0x10|_0x58ad6c[_0xa27cc6+0x2]<<0x8|_0x58ad6c[_0xa27cc6+0x3];_0xa27cc6+=0x4;const _0x2c00ff=_0x58ad6c[_0x5df275(0x1c1)](_0xa27cc6,_0xa27cc6+_0xe3aba0);_0xa27cc6+=_0xe3aba0;const _0xde0448=_0x58ad6c[_0xa27cc6]<<0x18|_0x58ad6c[_0xa27cc6+0x1]<<0x10|_0x58ad6c[_0xa27cc6+0x2]<<0x8|_0x58ad6c[_0xa27cc6+0x3];_0xa27cc6+=0x4;const _0x24776e=_0x58ad6c[_0x5df275(0x1c1)](_0xa27cc6,_0xa27cc6+_0xde0448);_0xa27cc6+=_0xde0448;const _0x385ed1=_0x58ad6c[_0xa27cc6]<<0x18|_0x58ad6c[_0xa27cc6+0x1]<<0x10|_0x58ad6c[_0xa27cc6+0x2]<<0x8|_0x58ad6c[_0xa27cc6+0x3];_0xa27cc6+=0x4;const _0x31a42b=_0x58ad6c[_0x5df275(0x1c1)](_0xa27cc6,_0xa27cc6+_0x385ed1);_0xa27cc6+=_0x385ed1;const _0x3280ac=_0x58ad6c['slice'](_0xa27cc6,_0xa27cc6+AES_CONFIG[_0x5df275(0xf1)]);_0xa27cc6+=AES_CONFIG[_0x5df275(0xf1)];const _0x45aa98=_0x58ad6c[_0xa27cc6]<<0x18|_0x58ad6c[_0xa27cc6+0x1]<<0x10|_0x58ad6c[_0xa27cc6+0x2]<<0x8|_0x58ad6c[_0xa27cc6+0x3];_0xa27cc6+=0x4;const _0x541f9a=_0x58ad6c[_0x5df275(0x1c1)](_0xa27cc6,_0xa27cc6+_0x45aa98);let _0x278ad5;if(_0x53f89c[_0x5df275(0x143)])_0x278ad5=_0x53f89c['_privateKey'];else{const _0x205201=base64ToArrayBuffer(_0x53f89c['privateKey']);_0x278ad5=await importRSAPrivateKey(_0x205201,_0x53f89c[_0x5df275(0xe4)]||RSA_CONFIG[_0x5df275(0x1a0)]);}const _0xb978fb=await window['crypto'][_0x5df275(0x1b9)]['decrypt']({'name':RSA_CONFIG[_0x5df275(0x257)]},_0x278ad5,_0x31a42b),_0xde18b3=await window['crypto'][_0x5df275(0x1b9)]['importKey'](_0x5df275(0x292),_0x2c00ff,{'name':AES_CONFIG[_0x5df275(0x221)],'length':_0xe3aba0*0x8},![],[_0x5df275(0x298)]),_0x3bcf25=await window['crypto'][_0x5df275(0x1b9)][_0x5df275(0x298)]({'name':AES_CONFIG[_0x5df275(0x221)],'iv':_0x4c1565,'tagLength':AES_CONFIG[_0x5df275(0x20d)]},_0xde18b3,_0x24776e),_0x265cf7=new TextDecoder()[_0x5df275(0x109)](_0x3bcf25),_0x3032b4=JSON['parse'](_0x265cf7);if(_0x3032b4['k']!==_0x53f89c['id'])throw new Error(_0x5df275(0x190));const _0x286c67=await importAESKey(_0xb978fb);return{'data':await window[_0x5df275(0x108)][_0x5df275(0x1b9)]['decrypt']({'name':AES_CONFIG[_0x5df275(0x221)],'iv':_0x3280ac,'tagLength':AES_CONFIG[_0x5df275(0x20d)]},_0x286c67,_0x541f9a),'metadata':_0x3032b4};}}async function decryptWithECC(_0x23a1fd,_0x205649){const _0x15f46b=_0x5adec6;if(!_0x23a1fd[_0x15f46b(0x12a)]||_0x23a1fd['version']===0x1){const _0x4063d7=base64ToArrayBuffer(_0x23a1fd[_0x15f46b(0x1de)]),_0x1a0415=base64ToArrayBuffer(_0x23a1fd['ephemeralPublicKey']),_0x15e3b4=base64ToArrayBuffer(_0x23a1fd['iv']),_0x592cfb=await importECCPublicKey(_0x1a0415,_0x23a1fd[_0x15f46b(0xf6)]||ECC_CONFIG[_0x15f46b(0x2a1)]);let _0x1fb3bb;if(_0x205649[_0x15f46b(0x143)])_0x1fb3bb=_0x205649[_0x15f46b(0x143)];else{const _0x13e80a=base64ToArrayBuffer(_0x205649[_0x15f46b(0x1c0)]);_0x1fb3bb=await importECCPrivateKey(_0x13e80a,_0x23a1fd[_0x15f46b(0xf6)]||ECC_CONFIG[_0x15f46b(0x2a1)]);}const _0xaca2ce=await window[_0x15f46b(0x108)]['subtle'][_0x15f46b(0x259)]({'name':_0x15f46b(0x243),'public':_0x592cfb},_0x1fb3bb,{'name':AES_CONFIG[_0x15f46b(0x221)],'length':AES_CONFIG[_0x15f46b(0x111)]},![],[_0x15f46b(0x298)]);return await window[_0x15f46b(0x108)][_0x15f46b(0x1b9)]['decrypt']({'name':AES_CONFIG[_0x15f46b(0x221)],'iv':_0x15e3b4,'tagLength':AES_CONFIG[_0x15f46b(0x20d)]},_0xaca2ce,_0x4063d7);}else{const _0x48c3a2=base64ToArrayBuffer(_0x23a1fd[_0x15f46b(0x1de)]),_0x14ee98=new Uint8Array(_0x48c3a2);let _0x111a59=0x0;const _0x8360bf=_0x14ee98[_0x111a59++],_0x2ed824=_0x14ee98[_0x15f46b(0x1c1)](_0x111a59,_0x111a59+_0x8360bf);_0x111a59+=_0x8360bf;const _0x5ce774=_0x14ee98[_0x111a59]<<0x18|_0x14ee98[_0x111a59+0x1]<<0x10|_0x14ee98[_0x111a59+0x2]<<0x8|_0x14ee98[_0x111a59+0x3];_0x111a59+=0x4;const _0x4c8e40=_0x14ee98[_0x15f46b(0x1c1)](_0x111a59,_0x111a59+_0x5ce774);_0x111a59+=_0x5ce774;const _0x3f421b=_0x14ee98[_0x111a59]<<0x18|_0x14ee98[_0x111a59+0x1]<<0x10|_0x14ee98[_0x111a59+0x2]<<0x8|_0x14ee98[_0x111a59+0x3];_0x111a59+=0x4;const _0x3ec18f=_0x14ee98['slice'](_0x111a59,_0x111a59+_0x3f421b);_0x111a59+=_0x3f421b;const _0x550d94=_0x14ee98[_0x111a59]<<0x18|_0x14ee98[_0x111a59+0x1]<<0x10|_0x14ee98[_0x111a59+0x2]<<0x8|_0x14ee98[_0x111a59+0x3];_0x111a59+=0x4;const _0x5a9aa5=_0x14ee98['slice'](_0x111a59,_0x111a59+_0x550d94);_0x111a59+=_0x550d94;const _0x436ac7=_0x14ee98['slice'](_0x111a59,_0x111a59+AES_CONFIG['IV_LENGTH']);_0x111a59+=AES_CONFIG['IV_LENGTH'];const _0x3fb6e7=_0x14ee98[_0x111a59]<<0x18|_0x14ee98[_0x111a59+0x1]<<0x10|_0x14ee98[_0x111a59+0x2]<<0x8|_0x14ee98[_0x111a59+0x3];_0x111a59+=0x4;const _0x5b080e=_0x14ee98[_0x15f46b(0x1c1)](_0x111a59,_0x111a59+_0x3fb6e7),_0x2d5b62=await importECCPublicKey(_0x5a9aa5,_0x205649[_0x15f46b(0xf6)]||ECC_CONFIG['CURVE']);let _0x3d1d55;if(_0x205649[_0x15f46b(0x143)])_0x3d1d55=_0x205649[_0x15f46b(0x143)];else{const _0x1f7392=base64ToArrayBuffer(_0x205649['privateKey']);_0x3d1d55=await importECCPrivateKey(_0x1f7392,_0x205649['curve']||ECC_CONFIG[_0x15f46b(0x2a1)]);}const _0x393707=await window[_0x15f46b(0x108)][_0x15f46b(0x1b9)][_0x15f46b(0x18d)]({'name':'ECDH','public':_0x2d5b62},_0x3d1d55,0x100),_0x4c086f=await window[_0x15f46b(0x108)][_0x15f46b(0x1b9)][_0x15f46b(0x1ce)](_0x15f46b(0x292),_0x393707,{'name':AES_CONFIG[_0x15f46b(0x221)],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x15f46b(0x298)]),_0x42cb6c=await window[_0x15f46b(0x108)]['subtle'][_0x15f46b(0x1ce)](_0x15f46b(0x292),_0x4c8e40,{'name':AES_CONFIG[_0x15f46b(0x221)],'length':_0x5ce774*0x8},![],[_0x15f46b(0x298)]),_0x4bc018=await window[_0x15f46b(0x108)][_0x15f46b(0x1b9)][_0x15f46b(0x298)]({'name':AES_CONFIG[_0x15f46b(0x221)],'iv':_0x2ed824,'tagLength':AES_CONFIG[_0x15f46b(0x20d)]},_0x42cb6c,_0x3ec18f),_0x195dd6=new TextDecoder()[_0x15f46b(0x109)](_0x4bc018),_0x4c5205=JSON[_0x15f46b(0x1f8)](_0x195dd6);if(_0x4c5205['k']!==_0x205649['id'])throw new Error('Key\x20ID\x20mismatch\x20-\x20wrong\x20key\x20for\x20this\x20message');return{'data':await window['crypto'][_0x15f46b(0x1b9)][_0x15f46b(0x298)]({'name':AES_CONFIG[_0x15f46b(0x221)],'iv':_0x436ac7,'tagLength':AES_CONFIG['TAG_LENGTH']},_0x4c086f,_0x5b080e),'metadata':_0x4c5205};}}function reverseString(_0x489069){const _0x274753=_0x5adec6;if(typeof _0x489069!=='string')return'';return _0x489069[_0x274753(0x176)]('')['reverse']()[_0x274753(0x13f)]('');}function downloadEncryptedFile(){const _0x42aadf=_0x5adec6,_0x12768d=document[_0x42aadf(0x294)](_0x42aadf(0x1e3))['value'];if(!_0x12768d){showStatus(_0x42aadf(0x1e7),_0x42aadf(0x263),_0x42aadf(0x123));return;}const _0x58f144=document[_0x42aadf(0x294)](_0x42aadf(0x222))[_0x42aadf(0x27f)](_0x42aadf(0x254))||generateRandomFileName(0x6)+_0x42aadf(0x193),_0x33e60d=new Blob([_0x12768d],{'type':_0x42aadf(0x22b)});downloadBlob(_0x33e60d,_0x58f144),showStatus(_0x42aadf(0x1e7),'File\x20\x22'+_0x58f144+_0x42aadf(0x23c),_0x42aadf(0x18b));}function downloadDecryptedFile(){const _0x191a5e=_0x5adec6;if(window[_0x191a5e(0x251)]){const _0x174230=document[_0x191a5e(0x294)](_0x191a5e(0x19e))[_0x191a5e(0x27f)](_0x191a5e(0x254))||'decrypted_file',_0x2fb241=new Blob([window[_0x191a5e(0x251)]],{'type':_0x191a5e(0x22b)});downloadBlob(_0x2fb241,_0x174230);}else{const _0x499835=document['getElementById'](_0x191a5e(0x1af))[_0x191a5e(0x1d6)];if(!_0x499835){showStatus(_0x191a5e(0x140),_0x191a5e(0x1fc),'error');return;}const _0x267555=document[_0x191a5e(0x294)](_0x191a5e(0x19e))[_0x191a5e(0x27f)](_0x191a5e(0x254))||'decrypted.txt',_0x40c6c2=new Blob([_0x499835],{'type':_0x191a5e(0x22b)});downloadBlob(_0x40c6c2,_0x267555);}showStatus(_0x191a5e(0x140),_0x191a5e(0x14f),'success');}function downloadBlob(_0x492ae4,_0x3661ac){const _0xc7671f=_0x5adec6,_0xfd9255=URL[_0xc7671f(0x202)](_0x492ae4),_0x2cfab7=document[_0xc7671f(0xe3)]('a');_0x2cfab7['href']=_0xfd9255,_0x2cfab7[_0xc7671f(0x247)]=_0x3661ac,document['body'][_0xc7671f(0x26c)](_0x2cfab7),_0x2cfab7[_0xc7671f(0x1e4)](),document[_0xc7671f(0xfc)][_0xc7671f(0x265)](_0x2cfab7),URL[_0xc7671f(0x187)](_0xfd9255);}function importKey(){const _0x3473bf=_0x5adec6,_0x433d9b=createKeyFileInput();_0x433d9b[_0x3473bf(0x1e4)]();}function _0x2c9f(_0x22a1ba,_0x1e5ed3){const _0x559828=_0x5598();return _0x2c9f=function(_0x2c9f42,_0x1bd76a){_0x2c9f42=_0x2c9f42-0xdb;let _0x56702e=_0x559828[_0x2c9f42];return _0x56702e;},_0x2c9f(_0x22a1ba,_0x1e5ed3);}async function exportKey(_0x3e4253,_0x34e422=![]){const _0xd4b65=_0x5adec6;try{const _0x745c35=keys[_0xd4b65(0x199)](_0x14ac72=>_0x14ac72['id']===_0x3e4253);if(!_0x745c35){alert(_0xd4b65(0x182));return;}const _0x4494ed=_0x745c35[_0xd4b65(0x113)]===_0xd4b65(0x25d)||_0x745c35[_0xd4b65(0x113)]===_0xd4b65(0x1a7)||_0x745c35['type']===_0xd4b65(0x1b3)||_0x745c35[_0xd4b65(0x113)]===_0xd4b65(0x192);let _0x2927b2=_0x745c35,_0x220330=_0xd4b65(0xf4);if(_0x4494ed&&_0x34e422){let _0x4d6b27='';try{_0x4d6b27=await showPasswordModal('Secure\x20Your\x20Private\x20Key',_0xd4b65(0x16f),!![]);}catch(_0x56fdba){return;}if(!_0x4d6b27){if(!confirm('Warning:\x20Exporting\x20a\x20private\x20key\x20without\x20password\x20protection\x20is\x20a\x20security\x20risk.\x20Continue\x20anyway?'))return;}_0x2927b2={'id':_0x745c35['id'],'name':_0x745c35[_0xd4b65(0x11e)],'type':_0x745c35[_0xd4b65(0x113)],'created':_0x745c35['created'],'expiry':_0x745c35[_0xd4b65(0xf2)],'privateKey':_0x745c35[_0xd4b65(0x1c0)],'protected':_0x745c35['protected'],'salt':_0x745c35[_0xd4b65(0x101)],'iv':_0x745c35['iv'],'algorithm':_0x745c35['algorithm'],'hasPrivate':!![],'hasPublic':![],'pairedKeyId':_0x745c35['id'],'publicKeyHash':_0x745c35[_0xd4b65(0xef)]};if(_0x745c35[_0xd4b65(0x113)]===_0xd4b65(0x25d)||_0x745c35['type']===_0xd4b65(0x1a7))_0x2927b2[_0xd4b65(0xe4)]=_0x745c35[_0xd4b65(0xe4)];else(_0x745c35[_0xd4b65(0x113)]===_0xd4b65(0x1b3)||_0x745c35[_0xd4b65(0x113)]===_0xd4b65(0x192))&&(_0x2927b2[_0xd4b65(0xf6)]=_0x745c35['curve']);if(_0x4d6b27){if(_0x745c35[_0xd4b65(0x264)])try{const _0x5ad51f=await showPasswordModal('Enter\x20Current\x20Password',_0xd4b65(0x120),![]),_0x530d2c=await decryptKeyWithPassword(_0x745c35,_0x5ad51f),_0x3128a2=safeMemory[_0xd4b65(0x200)](_0x530d2c,!![]);_0x2927b2[_0xd4b65(0x1c0)]=_0x3128a2[_0xd4b65(0x1c0)],_0x2927b2[_0xd4b65(0x264)]=![];}catch(_0x1bedea){showStatus(_0xd4b65(0x1ab),_0xd4b65(0x273)+_0x1bedea[_0xd4b65(0x25f)],_0xd4b65(0x123));return;}await encryptKeyWithPassword(_0x2927b2,_0x4d6b27);}_0x220330=_0xd4b65(0x269);}else{if(_0x4494ed&&!_0x34e422){_0x2927b2={'id':_0x745c35['id'],'name':_0x745c35['name'],'type':_0x745c35[_0xd4b65(0x113)],'created':_0x745c35[_0xd4b65(0x16d)],'expiry':_0x745c35[_0xd4b65(0xf2)],'publicKey':_0x745c35[_0xd4b65(0x160)],'algorithm':_0x745c35[_0xd4b65(0x2b6)],'hasPublic':!![],'hasPrivate':![],'pairedKeyId':_0x745c35['id'],'publicKeyHash':_0x745c35[_0xd4b65(0xef)]};if(_0x745c35['type']==='rsa'||_0x745c35[_0xd4b65(0x113)]===_0xd4b65(0x1a7))_0x2927b2[_0xd4b65(0xe4)]=_0x745c35[_0xd4b65(0xe4)];else(_0x745c35[_0xd4b65(0x113)]==='ecc'||_0x745c35[_0xd4b65(0x113)]===_0xd4b65(0x192))&&(_0x2927b2[_0xd4b65(0xf6)]=_0x745c35[_0xd4b65(0xf6)]);}}const _0x3c7e22=JSON[_0xd4b65(0x19f)](_0x2927b2),_0x2817b0=btoa(_0x3c7e22),_0x39925f=new Blob([_0x2817b0],{'type':_0xd4b65(0x22b)}),_0x19b488=URL[_0xd4b65(0x202)](_0x39925f),_0x1a5c87=document[_0xd4b65(0xe3)]('a');_0x1a5c87[_0xd4b65(0x14a)]=_0x19b488,_0x1a5c87[_0xd4b65(0x247)]=''+_0x745c35[_0xd4b65(0x11e)]['replace'](/[^a-z0-9]/gi,'_')+_0x220330,document[_0xd4b65(0xfc)][_0xd4b65(0x26c)](_0x1a5c87),_0x1a5c87[_0xd4b65(0x1e4)](),document['body'][_0xd4b65(0x265)](_0x1a5c87),URL[_0xd4b65(0x187)](_0x19b488);const _0x45b85b=_0x34e422?'private\x20key':_0x4494ed?_0xd4b65(0x239):_0xd4b65(0x1c7);showStatus(_0xd4b65(0x1ab),_0xd4b65(0xe1)+_0x745c35[_0xd4b65(0x11e)]+'\x22\x20'+_0x45b85b+_0xd4b65(0x1c3)+_0x220330+'\x20file',_0xd4b65(0x18b));}catch(_0x40bb84){console[_0xd4b65(0x123)](_0xd4b65(0x282),_0x40bb84),showStatus('keyStatus',_0xd4b65(0xfb)+_0x40bb84['message'],_0xd4b65(0x123));}}async function exportPrivateKey(_0x30e1df){const _0x17938e=_0x5adec6,_0x324f5d=keys[_0x17938e(0x199)](_0x5a121c=>_0x5a121c['id']===_0x30e1df);if(!_0x324f5d){alert(_0x17938e(0x182));return;}if(!_0x324f5d[_0x17938e(0x210)]){showStatus(_0x17938e(0x1ab),_0x17938e(0x223),_0x17938e(0x123));return;}const _0x4d2acc=confirm(_0x17938e(0x2b8)+_0x17938e(0x28d)+_0x17938e(0x1d3));_0x4d2acc&&await exportKey(_0x30e1df,!![]);}function createKeyFileInput(){const _0x2b62ce=_0x5adec6;let _0x6f7a3b=document[_0x2b62ce(0x294)]('keyFileInput');return!_0x6f7a3b&&(_0x6f7a3b=document[_0x2b62ce(0xe3)](_0x2b62ce(0x2af)),_0x6f7a3b[_0x2b62ce(0x113)]=_0x2b62ce(0x144),_0x6f7a3b['id']=_0x2b62ce(0x209),_0x6f7a3b[_0x2b62ce(0x16a)]='.lim,.lem',_0x6f7a3b[_0x2b62ce(0x172)]['display']=_0x2b62ce(0x28a),document[_0x2b62ce(0xfc)]['appendChild'](_0x6f7a3b),_0x6f7a3b[_0x2b62ce(0x1a6)]('change',handleKeyFileSelect)),_0x6f7a3b;}async function handleKeyFileSelect(_0x2fe320){const _0x5d96fc=_0x5adec6;try{const _0x3cc04a=_0x2fe320[_0x5d96fc(0x21b)][_0x5d96fc(0x22d)];if(!_0x3cc04a||_0x3cc04a[_0x5d96fc(0xe4)]===0x0)return;setLoading(!![]);const _0x40654a=_0x3cc04a[0x0],_0x579a2c=_0x40654a[_0x5d96fc(0x11e)]['toLowerCase']()[_0x5d96fc(0xfa)](_0x5d96fc(0x269)),_0x281f24=_0x40654a[_0x5d96fc(0x11e)][_0x5d96fc(0x15d)]()[_0x5d96fc(0xfa)]('.lim'),_0x3ff960=new FileReader();_0x3ff960[_0x5d96fc(0x216)]=async function(_0x34f8d8){const _0x16f6b0=_0x5d96fc;try{const _0x5bcfed=_0x34f8d8[_0x16f6b0(0x21b)][_0x16f6b0(0x20e)];let _0x4bc917;try{const _0x483360=atob(_0x5bcfed);_0x4bc917=JSON[_0x16f6b0(0x1f8)](_0x483360);}catch(_0x88030c){throw new Error(_0x16f6b0(0x1fe));}if(!_0x4bc917['id']||!_0x4bc917[_0x16f6b0(0x11e)]||!_0x4bc917[_0x16f6b0(0x113)]||!_0x4bc917[_0x16f6b0(0x16d)])throw new Error(_0x16f6b0(0x22a));if(!validator[_0x16f6b0(0x260)](_0x4bc917[_0x16f6b0(0x11e)]))throw new Error('Invalid\x20key\x20name\x20format');if(_0x4bc917[_0x16f6b0(0x113)]===_0x16f6b0(0x163))_0x4bc917[_0x16f6b0(0x131)]=!![],_0x4bc917['hasPrivate']=!![];else{_0x4bc917[_0x16f6b0(0x131)]=!!_0x4bc917[_0x16f6b0(0x160)],_0x4bc917['hasPrivate']=!!_0x4bc917[_0x16f6b0(0x1c0)];if(_0x579a2c&&!_0x4bc917[_0x16f6b0(0x210)])throw new Error(_0x16f6b0(0x10f));if(_0x281f24&&!_0x4bc917['hasPublic'])throw new Error(_0x16f6b0(0x1b1));}if(_0x4bc917['hasPrivate']&&_0x4bc917[_0x16f6b0(0x264)]){let _0xaf9053='';try{_0xaf9053=await showPasswordModal(_0x16f6b0(0x201),_0x16f6b0(0x106),![]);}catch(_0x1eba4b){throw new Error(_0x16f6b0(0x116));}if(!_0xaf9053)throw new Error(_0x16f6b0(0x116));_0x4bc917[_0x16f6b0(0x179)]=_0xaf9053;}const _0x4c983b=keys[_0x16f6b0(0x11a)](_0x66c5da=>_0x66c5da['id']===_0x4bc917['id']);let _0x12e549=![],_0xd440d4=-0x1;if(_0x4c983b>=0x0){const _0x430c1b=keys[_0x4c983b];if(_0x4bc917['hasPrivate']&&!_0x430c1b['hasPrivate']&&_0x430c1b[_0x16f6b0(0x131)])_0x12e549=!![],_0xd440d4=_0x4c983b;else _0x4bc917[_0x16f6b0(0x131)]&&!_0x430c1b[_0x16f6b0(0x131)]&&_0x430c1b[_0x16f6b0(0x210)]&&(_0x12e549=!![],_0xd440d4=_0x4c983b);}else _0x4bc917[_0x16f6b0(0xef)]&&(_0xd440d4=keys[_0x16f6b0(0x11a)](_0x15dab1=>_0x15dab1[_0x16f6b0(0xef)]===_0x4bc917[_0x16f6b0(0xef)]&&_0x15dab1[_0x16f6b0(0x113)]===_0x4bc917[_0x16f6b0(0x113)]&&(_0x15dab1[_0x16f6b0(0x210)]&&!_0x15dab1[_0x16f6b0(0x131)]&&_0x4bc917[_0x16f6b0(0x131)]||_0x15dab1[_0x16f6b0(0x131)]&&!_0x15dab1[_0x16f6b0(0x210)]&&_0x4bc917[_0x16f6b0(0x210)])),_0xd440d4>=0x0&&(_0x12e549=!![]));if(_0x12e549&&_0xd440d4>=0x0){const _0x5aef49=confirm('This\x20appears\x20to\x20be\x20the\x20'+(_0x4bc917[_0x16f6b0(0x210)]?_0x16f6b0(0x21e):_0x16f6b0(0x19d))+_0x16f6b0(0x135)+_0x16f6b0(0x161));if(_0x5aef49){const _0x25077e=keys[_0xd440d4];_0x4bc917['hasPrivate']&&!_0x25077e[_0x16f6b0(0x210)]&&(_0x25077e[_0x16f6b0(0x1c0)]=_0x4bc917['privateKey'],_0x25077e[_0x16f6b0(0x210)]=!![],_0x4bc917[_0x16f6b0(0x264)]&&(_0x25077e['protected']=!![],_0x25077e['salt']=_0x4bc917[_0x16f6b0(0x101)],_0x25077e['iv']=_0x4bc917['iv'])),_0x4bc917['hasPublic']&&!_0x25077e[_0x16f6b0(0x131)]&&(_0x25077e[_0x16f6b0(0x160)]=_0x4bc917['publicKey'],_0x25077e[_0x16f6b0(0x131)]=!![],_0x4bc917[_0x16f6b0(0xef)]&&(_0x25077e['publicKeyHash']=_0x4bc917[_0x16f6b0(0xef)])),_0x25077e[_0x16f6b0(0x2b2)]=_0x25077e['id'],await saveKeys(),showStatus('keyStatus',_0x16f6b0(0xe1)+_0x25077e['name']+_0x16f6b0(0x2ae)+(_0x4bc917['hasPrivate']?_0x16f6b0(0x21e):_0x16f6b0(0x19d))+'\x20key\x20part.\x20Security\x20level:\x20'+determineKeySecurityLevel(_0x25077e)[_0x16f6b0(0x203)](),'success');}else _0x4bc917['id']=crypto[_0x16f6b0(0x21d)](),keys['push'](_0x4bc917),await saveKeys(),showStatus('keyStatus',_0x16f6b0(0xe1)+_0x4bc917['name']+_0x16f6b0(0x22e),_0x16f6b0(0x18b));}else{if(_0x4c983b>=0x0){const _0x5444a4=confirm('A\x20key\x20with\x20name\x20\x22'+_0x4bc917['name']+'\x22\x20already\x20exists.\x20Overwrite?');_0x5444a4?keys[_0x4c983b]=_0x4bc917:(_0x4bc917['id']=crypto[_0x16f6b0(0x21d)](),keys[_0x16f6b0(0x1b4)](_0x4bc917)),await saveKeys(),showStatus('keyStatus',_0x16f6b0(0xe1)+_0x4bc917[_0x16f6b0(0x11e)]+_0x16f6b0(0x275),_0x16f6b0(0x18b));}else{keys[_0x16f6b0(0x1b4)](_0x4bc917),await saveKeys();if(_0x4bc917[_0x16f6b0(0x113)]===_0x16f6b0(0x163))showStatus(_0x16f6b0(0x1ab),_0x16f6b0(0x178)+_0x4bc917[_0x16f6b0(0x11e)]+_0x16f6b0(0x275),'success');else{if(_0x4bc917[_0x16f6b0(0x210)]&&_0x4bc917[_0x16f6b0(0x131)])showStatus('keyStatus',_0x16f6b0(0x1cd)+_0x4bc917[_0x16f6b0(0x11e)]+_0x16f6b0(0x275),'success');else _0x4bc917['hasPrivate']?showStatus(_0x16f6b0(0x1ab),_0x16f6b0(0x24f)+_0x4bc917['name']+'\x22\x20imported\x20successfully','success'):showStatus(_0x16f6b0(0x1ab),'Public\x20key\x20\x22'+_0x4bc917[_0x16f6b0(0x11e)]+'\x22\x20imported\x20successfully',_0x16f6b0(0x18b));}}}}catch(_0x3d5641){console[_0x16f6b0(0x123)](_0x16f6b0(0x1b0),_0x3d5641),showStatus(_0x16f6b0(0x1ab),_0x16f6b0(0x1d9)+_0x3d5641[_0x16f6b0(0x25f)],_0x16f6b0(0x123));}finally{setLoading(![]),document['getElementById']('keyFileInput')[_0x16f6b0(0x1d6)]='';}},_0x3ff960[_0x5d96fc(0x177)]=function(){const _0x11bdaa=_0x5d96fc;setLoading(![]),showStatus(_0x11bdaa(0x1ab),'Error\x20reading\x20the\x20key\x20file',_0x11bdaa(0x123)),document[_0x11bdaa(0x294)](_0x11bdaa(0x209))[_0x11bdaa(0x1d6)]='';},_0x3ff960['readAsText'](_0x40654a);}catch(_0x203a7b){console[_0x5d96fc(0x123)](_0x5d96fc(0x1b0),_0x203a7b),showStatus(_0x5d96fc(0x1ab),_0x5d96fc(0x1d9)+_0x203a7b[_0x5d96fc(0x25f)],_0x5d96fc(0x123)),setLoading(![]),document['getElementById'](_0x5d96fc(0x209))[_0x5d96fc(0x1d6)]='';}}async function exportAllKeys(){const _0x1a735d=_0x5adec6;try{if(keys['length']===0x0){showStatus(_0x1a735d(0x1ab),_0x1a735d(0x194),_0x1a735d(0x1f9));return;}let _0x48977b='';try{_0x48977b=await showPasswordModal('Secure\x20Your\x20Key\x20Backup','Please\x20enter\x20a\x20password\x20to\x20protect\x20your\x20key\x20backup.\x20This\x20is\x20highly\x20recommended\x20for\x20security.',!![]);}catch(_0x5ac036){return;}let _0x248a03;if(_0x48977b){const _0x13e096=JSON['stringify'](keys),_0x498f85=new TextEncoder()['encode'](_0x13e096),_0x10e2e7=window[_0x1a735d(0x108)][_0x1a735d(0x164)](new Uint8Array(0x10)),_0x17c135=await deriveKeyFromPassword(_0x48977b,_0x10e2e7),_0x38b3a2=window[_0x1a735d(0x108)][_0x1a735d(0x164)](new Uint8Array(AES_CONFIG['IV_LENGTH'])),_0x190cd7=await encryptWithDerivedKey(_0x17c135,_0x498f85,_0x38b3a2);_0x248a03=JSON[_0x1a735d(0x19f)]({'format':'LemonadeProtectedBackup','salt':arrayBufferToBase64(_0x10e2e7),'iv':arrayBufferToBase64(_0x38b3a2),'data':arrayBufferToBase64(_0x190cd7)});}else{const _0x241bfd=confirm(_0x1a735d(0x2ac));if(!_0x241bfd)return;_0x248a03=JSON['stringify'](keys);}const _0x419ff7=new Blob([_0x248a03],{'type':_0x1a735d(0x22b)}),_0x311982=URL[_0x1a735d(0x202)](_0x419ff7),_0x5baf3d=document['createElement']('a');_0x5baf3d['href']=_0x311982,_0x5baf3d[_0x1a735d(0x247)]=_0x1a735d(0x2b1),document[_0x1a735d(0xfc)]['appendChild'](_0x5baf3d),_0x5baf3d[_0x1a735d(0x1e4)](),document[_0x1a735d(0xfc)]['removeChild'](_0x5baf3d),URL[_0x1a735d(0x187)](_0x311982),showStatus(_0x1a735d(0x1ab),_0x1a735d(0x27e),'success');}catch(_0x48620c){console[_0x1a735d(0x123)](_0x1a735d(0x282),_0x48620c),showStatus(_0x1a735d(0x1ab),'Export\x20error:\x20'+_0x48620c[_0x1a735d(0x25f)],_0x1a735d(0x123));}}function createStateFileInput(){const _0x7ac437=_0x5adec6;let _0x57eac2=document[_0x7ac437(0x294)](_0x7ac437(0x27a));return!_0x57eac2&&(_0x57eac2=document['createElement'](_0x7ac437(0x2af)),_0x57eac2[_0x7ac437(0x113)]='file',_0x57eac2['id']=_0x7ac437(0x27a),_0x57eac2[_0x7ac437(0x16a)]=_0x7ac437(0x288),_0x57eac2[_0x7ac437(0x172)][_0x7ac437(0x13b)]='none',document[_0x7ac437(0xfc)]['appendChild'](_0x57eac2),_0x57eac2[_0x7ac437(0x1a6)](_0x7ac437(0x2b4),handleStateFileSelect)),_0x57eac2;}async function handleStateFileSelect(_0x5e5bd8){const _0x4a6e3e=_0x5adec6;try{const _0x55adf8=_0x5e5bd8[_0x4a6e3e(0x21b)]['files'];if(!_0x55adf8||_0x55adf8['length']===0x0)return;setLoading(!![]);const _0x266994=_0x55adf8[0x0],_0x3dbf4d=new FileReader();_0x3dbf4d[_0x4a6e3e(0x216)]=async function(_0x289bc1){const _0x19c2cf=_0x4a6e3e;try{const _0xaba155=_0x289bc1['target'][_0x19c2cf(0x20e)];let _0xbfdfdc;try{_0xbfdfdc=JSON[_0x19c2cf(0x1f8)](_0xaba155);}catch(_0x5a0eed){throw new Error(_0x19c2cf(0x242));}if(_0xbfdfdc['format']===_0x19c2cf(0x1f6)){let _0x17fea4='';try{_0x17fea4=await showPasswordModal(_0x19c2cf(0x23a),_0x19c2cf(0xdb),![]);}catch(_0x306b57){throw new Error('Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20state\x20file');}if(!_0x17fea4)throw new Error('Password\x20is\x20required\x20to\x20import\x20this\x20protected\x20state\x20file');const _0x2d8c60=base64ToArrayBuffer(_0xbfdfdc[_0x19c2cf(0x101)]),_0xef4079=base64ToArrayBuffer(_0xbfdfdc['iv']),_0x4e9833=base64ToArrayBuffer(_0xbfdfdc[_0x19c2cf(0x1de)]),_0x37598c=await deriveKeyFromPassword(_0x17fea4,_0x2d8c60),_0xd9ad82=await decryptWithDerivedKey(_0x37598c,_0x4e9833,_0xef4079),_0x3cb83d=new TextDecoder()['decode'](_0xd9ad82);_0xbfdfdc=JSON[_0x19c2cf(0x1f8)](_0x3cb83d);}if(!Array['isArray'](_0xbfdfdc))throw new Error(_0x19c2cf(0x1c6));const _0x7bee04=confirm(_0x19c2cf(0x236)+_0xbfdfdc[_0x19c2cf(0xe4)]+_0x19c2cf(0x1bf));if(!_0x7bee04)return;keys=_0xbfdfdc,await saveKeys(),showStatus(_0x19c2cf(0x1ab),_0x19c2cf(0x230)+_0xbfdfdc[_0x19c2cf(0xe4)]+_0x19c2cf(0x26e),_0x19c2cf(0x18b));}catch(_0x3ceb68){console['error']('State\x20import\x20error:',_0x3ceb68),showStatus('keyStatus',_0x19c2cf(0x1c8)+_0x3ceb68['message'],'error');}finally{setLoading(![]),document[_0x19c2cf(0x294)](_0x19c2cf(0x27a))['value']='';}},_0x3dbf4d[_0x4a6e3e(0x177)]=function(){const _0x10e70e=_0x4a6e3e;setLoading(![]),showStatus(_0x10e70e(0x1ab),_0x10e70e(0x1e0),_0x10e70e(0x123)),document['getElementById']('stateFileInput')[_0x10e70e(0x1d6)]='';},_0x3dbf4d[_0x4a6e3e(0x15a)](_0x266994);}catch(_0x15cf52){console[_0x4a6e3e(0x123)](_0x4a6e3e(0x12e),_0x15cf52),showStatus(_0x4a6e3e(0x1ab),_0x4a6e3e(0x1c8)+_0x15cf52[_0x4a6e3e(0x25f)],_0x4a6e3e(0x123)),setLoading(![]),document[_0x4a6e3e(0x294)]('stateFileInput')['value']='';}}function importState(){const _0x1f921b=createStateFileInput();_0x1f921b['click']();}async function secureClipboardCopy(_0x274ad3){const _0x3dcfbe=_0x5adec6;try{return await navigator['clipboard'][_0x3dcfbe(0x146)](_0x274ad3),!![];}catch(_0xfd982e){return console[_0x3dcfbe(0x11c)](_0x3dcfbe(0xe5),_0xfd982e),![];}}function deleteKey(_0x1c3879){const _0x5eceb7=_0x5adec6,_0x3320ea=keys[_0x5eceb7(0x199)](_0x34e5bf=>_0x34e5bf['id']===_0x1c3879);if(!_0x3320ea){alert(_0x5eceb7(0x182));return;}const _0x20a2dc=window[_0x5eceb7(0x125)](_0x5eceb7(0x1d4)+_0x3320ea[_0x5eceb7(0x11e)]+'\x22?\x20This\x20action\x20cannot\x20be\x20undone.');_0x20a2dc&&(keys=keys[_0x5eceb7(0xf5)](_0x5becb2=>_0x5becb2['id']!==_0x1c3879),saveKeys(),showStatus(_0x5eceb7(0x1ab),_0x5eceb7(0xe1)+_0x3320ea[_0x5eceb7(0x11e)]+_0x5eceb7(0x29a),_0x5eceb7(0x18b)));}function showStatus(_0x5ac188,_0x1e8ad9,_0x5b9f1f){const _0x39b857=_0x5adec6,_0x44c4c7=document['getElementById'](_0x5ac188);_0x44c4c7[_0x39b857(0x235)]=validator[_0x39b857(0x1ca)](_0x1e8ad9),_0x44c4c7[_0x39b857(0x220)]=_0x39b857(0x1aa)+_0x5b9f1f,setTimeout(()=>{const _0x5c4431=_0x39b857;_0x44c4c7[_0x5c4431(0x235)]===validator['sanitizeHTML'](_0x1e8ad9)&&(_0x44c4c7[_0x5c4431(0x220)]='status');},0x2710);}let passwordModalCallback=null,passwordModalResolve=null,passwordModalReject=null;function showPasswordModal(_0x312162,_0x5ef94f,_0x4dc2ec=![]){return new Promise((_0x1354a0,_0x274373)=>{const _0x5eaa6=_0x2c9f,_0xc8f5eb=document['getElementById']('passwordModal'),_0x505379=document[_0x5eaa6(0x294)](_0x5eaa6(0x23b)),_0x452087=document[_0x5eaa6(0x294)](_0x5eaa6(0x18a)),_0x2ffc0b=document['getElementById'](_0x5eaa6(0x1cb)),_0x280124=document[_0x5eaa6(0x294)]('passwordModalStrength'),_0x2b3cf5=document[_0x5eaa6(0x294)]('passwordModalFeedback');_0x505379[_0x5eaa6(0x235)]=_0x312162,_0x452087['textContent']=_0x5ef94f,_0x2ffc0b[_0x5eaa6(0x1d6)]='',_0x280124['className']=_0x5eaa6(0x2b5),_0x2b3cf5[_0x5eaa6(0x235)]='',_0x280124[_0x5eaa6(0x172)][_0x5eaa6(0x13b)]=_0x4dc2ec?'block':_0x5eaa6(0x28a),_0x2b3cf5[_0x5eaa6(0x172)][_0x5eaa6(0x13b)]=_0x4dc2ec?_0x5eaa6(0x17a):_0x5eaa6(0x28a),passwordModalResolve=_0x1354a0,passwordModalReject=_0x274373,_0xc8f5eb[_0x5eaa6(0x172)][_0x5eaa6(0x13b)]=_0x5eaa6(0x29c),setTimeout(()=>{const _0x40a50f=_0x5eaa6;_0x2ffc0b[_0x40a50f(0x16e)]();},0x64);});}function confirmPasswordModal(){const _0xe53b2b=_0x5adec6,_0x84c310=document[_0xe53b2b(0x294)](_0xe53b2b(0x1cb)),_0x2095cc=_0x84c310[_0xe53b2b(0x1d6)],_0x806cb4=document[_0xe53b2b(0x294)]('passwordModalStrength'),_0x4f019e=document[_0xe53b2b(0x294)]('passwordModalFeedback');_0x806cb4[_0xe53b2b(0x220)]=_0xe53b2b(0x2b5),_0x4f019e[_0xe53b2b(0x235)]='',document[_0xe53b2b(0x294)](_0xe53b2b(0x12b))[_0xe53b2b(0x172)][_0xe53b2b(0x13b)]=_0xe53b2b(0x28a),passwordModalResolve&&(passwordModalResolve(_0x2095cc),passwordModalResolve=null,passwordModalReject=null);}function cancelPasswordModal(){const _0x7953cd=_0x5adec6,_0x21ce08=document['getElementById'](_0x7953cd(0x1cb)),_0x2a6590=document[_0x7953cd(0x294)](_0x7953cd(0x241)),_0x47d966=document[_0x7953cd(0x294)](_0x7953cd(0x2aa));_0x21ce08[_0x7953cd(0x1d6)]='',_0x2a6590[_0x7953cd(0x220)]=_0x7953cd(0x2b5),_0x47d966[_0x7953cd(0x235)]='',document[_0x7953cd(0x294)](_0x7953cd(0x12b))[_0x7953cd(0x172)][_0x7953cd(0x13b)]='none',passwordModalReject&&(passwordModalReject(new Error(_0x7953cd(0x169))),passwordModalResolve=null,passwordModalReject=null);}function updateModalPasswordStrength(){const _0x5426b2=_0x5adec6,_0x5c3a1e=document[_0x5426b2(0x294)]('passwordModalInput')[_0x5426b2(0x1d6)],_0x467b90=validator['measurePasswordStrength'](_0x5c3a1e),_0x43ba3c=document[_0x5426b2(0x294)]('passwordModalStrength'),_0x2d2247=document['getElementById'](_0x5426b2(0x2aa));_0x43ba3c[_0x5426b2(0x220)]=_0x5426b2(0x2b5),_0x5c3a1e?(_0x43ba3c['classList'][_0x5426b2(0x13a)](_0x467b90[_0x5426b2(0x19b)]),_0x2d2247['textContent']=_0x467b90[_0x5426b2(0x1fa)]):_0x2d2247[_0x5426b2(0x235)]='';}async function copyToClipboard(_0x25b93d,_0x4c1473){const _0x7a8888=_0x5adec6,_0x44b36a=document[_0x7a8888(0x294)](_0x25b93d)[_0x7a8888(0x1d6)];if(!_0x44b36a){showStatus(_0x4c1473,_0x7a8888(0x139),_0x7a8888(0x123));return;}const _0x15634c=await secureClipboardCopy(_0x44b36a);if(_0x15634c)showStatus(_0x4c1473,_0x7a8888(0x134),'success'),appSettings['clearClipboard']&&scheduleClipboardClear();else{showStatus(_0x4c1473,_0x7a8888(0x17f),'warning');const _0x8bb29a=document[_0x7a8888(0x294)](_0x25b93d);_0x8bb29a['focus'](),_0x8bb29a[_0x7a8888(0x26a)]();}}function toggleDarkMode(){const _0x133220=_0x5adec6,_0x200089=document['getElementById'](_0x133220(0x24c))['checked'];_0x200089?document[_0x133220(0xfc)]['classList']['add']('dark-mode'):document[_0x133220(0xfc)][_0x133220(0x10e)][_0x133220(0x215)]('dark-mode'),localStorage[_0x133220(0x18e)](_0x133220(0x23e),_0x200089);}function arrayBufferToBase64(_0x1ed1b0){const _0x57fef4=_0x5adec6,_0x1edd7a=new Uint8Array(_0x1ed1b0);let _0x15f2fd='';for(let _0xd0f614=0x0;_0xd0f614<_0x1edd7a[_0x57fef4(0x2b7)];_0xd0f614++){_0x15f2fd+=String['fromCharCode'](_0x1edd7a[_0xd0f614]);}return btoa(_0x15f2fd);}function base64ToArrayBuffer(_0x5d8d64){const _0x27fd6c=_0x5adec6;try{const _0x27c5ed=atob(_0x5d8d64),_0x4dc389=new Uint8Array(_0x27c5ed[_0x27fd6c(0xe4)]);for(let _0x54658c=0x0;_0x54658c<_0x27c5ed[_0x27fd6c(0xe4)];_0x54658c++){_0x4dc389[_0x54658c]=_0x27c5ed[_0x27fd6c(0x25b)](_0x54658c);}return _0x4dc389[_0x27fd6c(0xde)];}catch(_0x488dd9){console['error'](_0x27fd6c(0x114),_0x488dd9);throw new Error(_0x27fd6c(0x186)+_0x488dd9[_0x27fd6c(0x25f)]);}}async function encryptData(_0x217bcf,_0x25ffaf){const _0x2c593d=_0x5adec6;if(_0x25ffaf[_0x2c593d(0x113)]===_0x2c593d(0x163))return await encryptWithAES(_0x217bcf,_0x25ffaf);else{if(_0x25ffaf[_0x2c593d(0x113)]===_0x2c593d(0x25d)||_0x25ffaf[_0x2c593d(0x113)]===_0x2c593d(0x1a7))return await encryptWithRSA(_0x217bcf,_0x25ffaf);else{if(_0x25ffaf[_0x2c593d(0x113)]===_0x2c593d(0x1b3)||_0x25ffaf[_0x2c593d(0x113)]==='ecc-p384')return await encryptWithECC(_0x217bcf,_0x25ffaf);else throw new Error(_0x2c593d(0x21f));}}}async function decryptData(_0xf8769a,_0x2a9a77){const _0x1140e8=_0x5adec6;if(_0xf8769a[_0x1140e8(0x12a)]===0x2){if(_0x2a9a77[_0x1140e8(0x113)]===_0x1140e8(0x163))return await decryptWithAES(_0xf8769a,_0x2a9a77);else{if(_0x2a9a77[_0x1140e8(0x113)]===_0x1140e8(0x25d)||_0x2a9a77[_0x1140e8(0x113)]===_0x1140e8(0x1a7))return await decryptWithRSA(_0xf8769a,_0x2a9a77);else{if(_0x2a9a77[_0x1140e8(0x113)]===_0x1140e8(0x1b3)||_0x2a9a77[_0x1140e8(0x113)]===_0x1140e8(0x192))return await decryptWithECC(_0xf8769a,_0x2a9a77);}}}if(_0xf8769a[_0x1140e8(0x2b6)]===AES_CONFIG[_0x1140e8(0x221)])return await decryptWithAES(_0xf8769a,_0x2a9a77);else{if(_0xf8769a['algorithm']===RSA_CONFIG[_0x1140e8(0x257)]+'+'+AES_CONFIG['MODE']||_0xf8769a[_0x1140e8(0x2b6)]==='RSA-OAEP+AES-GCM')return await decryptWithRSA(_0xf8769a,_0x2a9a77);else{if(_0xf8769a['algorithm']===_0x1140e8(0x2ab)+AES_CONFIG[_0x1140e8(0x221)]||_0xf8769a[_0x1140e8(0x2b6)]===_0x1140e8(0x218))return await decryptWithECC(_0xf8769a,_0x2a9a77);else throw new Error('Unsupported\x20encryption\x20algorithm:\x20'+_0xf8769a[_0x1140e8(0x2b6)]);}}}async function deriveKeyFromPassword(_0x363959,_0x33a137){const _0x3e56a2=_0x5adec6,_0x3e2d90=new TextEncoder()[_0x3e56a2(0x267)](_0x363959),_0x5774ee=await window[_0x3e56a2(0x108)]['subtle']['importKey'](_0x3e56a2(0x292),_0x3e2d90,{'name':_0x3e56a2(0x12c)},![],[_0x3e56a2(0x259)]);return window[_0x3e56a2(0x108)]['subtle'][_0x3e56a2(0x259)]({'name':'PBKDF2','salt':_0x33a137,'iterations':PBKDF2_CONFIG[_0x3e56a2(0x168)],'hash':PBKDF2_CONFIG[_0x3e56a2(0x24d)]},_0x5774ee,{'name':AES_CONFIG[_0x3e56a2(0x221)],'length':AES_CONFIG['KEY_LENGTH']},!![],[_0x3e56a2(0x245),_0x3e56a2(0x298)]);}async function encryptWithDerivedKey(_0x5bb4d0,_0x9f62bb,_0x2aa529){const _0xdc130a=_0x5adec6;return window['crypto']['subtle'][_0xdc130a(0x245)]({'name':AES_CONFIG[_0xdc130a(0x221)],'iv':_0x2aa529,'tagLength':AES_CONFIG[_0xdc130a(0x20d)]},_0x5bb4d0,_0x9f62bb);}async function decryptWithDerivedKey(_0x521177,_0x1daa89,_0xdc0dbc){const _0x4288ab=_0x5adec6;return window[_0x4288ab(0x108)][_0x4288ab(0x1b9)]['decrypt']({'name':AES_CONFIG[_0x4288ab(0x221)],'iv':_0xdc0dbc,'tagLength':AES_CONFIG[_0x4288ab(0x20d)]},_0x521177,_0x1daa89);}async function importAESKey(_0x4977e6){const _0x5ddec4=_0x5adec6;return window['crypto'][_0x5ddec4(0x1b9)][_0x5ddec4(0x1ce)](_0x5ddec4(0x292),_0x4977e6,{'name':AES_CONFIG[_0x5ddec4(0x221)],'length':AES_CONFIG['KEY_LENGTH']},![],[_0x5ddec4(0x245),'decrypt']);}async function importRSAPublicKey(_0x270a04,_0x55d38e){const _0x25b189=_0x5adec6;return window[_0x25b189(0x108)]['subtle']['importKey'](_0x25b189(0x137),_0x270a04,{'name':RSA_CONFIG[_0x25b189(0x257)],'hash':RSA_CONFIG[_0x25b189(0x24d)]},![],[_0x25b189(0x245)]);}async function importRSAPrivateKey(_0xbd50c,_0xcc081){const _0x941863=_0x5adec6;return window[_0x941863(0x108)][_0x941863(0x1b9)][_0x941863(0x1ce)](_0x941863(0xfd),_0xbd50c,{'name':RSA_CONFIG[_0x941863(0x257)],'hash':RSA_CONFIG[_0x941863(0x24d)]},![],[_0x941863(0x298)]);}async function importECCPublicKey(_0x4c0da2,_0x2b6540){const _0x554939=_0x5adec6;return window['crypto']['subtle'][_0x554939(0x1ce)]('spki',_0x4c0da2,{'name':'ECDH','namedCurve':_0x2b6540},![],[]);}async function importECCPrivateKey(_0x2c492f,_0x4e8537){const _0x45e4eb=_0x5adec6;return window[_0x45e4eb(0x108)][_0x45e4eb(0x1b9)]['importKey']('pkcs8',_0x2c492f,{'name':'ECDH','namedCurve':_0x4e8537},![],[_0x45e4eb(0x259),_0x45e4eb(0x18d)]);}async function saveToDatabase(_0x13cc96,_0x5553df){return new Promise((_0x441771,_0x112049)=>{const _0x2782f0=_0x2c9f;if(!db){_0x112049(new Error(_0x2782f0(0x250)));return;}const _0x2cbb41=db['transaction'](_0x13cc96,_0x2782f0(0x212)),_0x556fde=_0x2cbb41[_0x2782f0(0x280)](_0x13cc96),_0x108381=_0x556fde[_0x2782f0(0x238)](_0x5553df);_0x108381[_0x2782f0(0x14d)]=()=>_0x441771(),_0x108381[_0x2782f0(0x177)]=()=>_0x112049(_0x108381[_0x2782f0(0x123)]);});}async function getFromDatabase(_0x3ae991,_0xd63c60){return new Promise((_0x332c11,_0x575d5d)=>{const _0x3d26e9=_0x2c9f;if(!db){_0x575d5d(new Error(_0x3d26e9(0x250)));return;}const _0x18acbc=db[_0x3d26e9(0x29d)](_0x3ae991,_0x3d26e9(0x126)),_0x29de11=_0x18acbc['objectStore'](_0x3ae991),_0x4328bf=_0x29de11[_0x3d26e9(0x196)](_0xd63c60);_0x4328bf[_0x3d26e9(0x14d)]=()=>_0x332c11(_0x4328bf[_0x3d26e9(0x20e)]),_0x4328bf['onerror']=()=>_0x575d5d(_0x4328bf[_0x3d26e9(0x123)]);});}async function getAllFromDatabase(_0x49606a){return new Promise((_0x1680c3,_0x285903)=>{const _0x335952=_0x2c9f;if(!db){_0x285903(new Error(_0x335952(0x250)));return;}const _0x3050e4=db[_0x335952(0x29d)](_0x49606a,'readonly'),_0x5c760e=_0x3050e4[_0x335952(0x280)](_0x49606a),_0x50e5fa=_0x5c760e[_0x335952(0x15b)]();_0x50e5fa[_0x335952(0x14d)]=()=>_0x1680c3(_0x50e5fa[_0x335952(0x20e)]),_0x50e5fa[_0x335952(0x177)]=()=>_0x285903(_0x50e5fa[_0x335952(0x123)]);});}async function clearDatabase(_0x4b04de){return new Promise((_0x2a1884,_0x4606bf)=>{const _0x3a3a5f=_0x2c9f;if(!db){_0x4606bf(new Error(_0x3a3a5f(0x250)));return;}const _0x713c15=db[_0x3a3a5f(0x29d)](_0x4b04de,_0x3a3a5f(0x212)),_0x178e3d=_0x713c15[_0x3a3a5f(0x280)](_0x4b04de),_0x5b3c11=_0x178e3d[_0x3a3a5f(0x2b0)]();_0x5b3c11['onsuccess']=()=>_0x2a1884(),_0x5b3c11[_0x3a3a5f(0x177)]=()=>_0x4606bf(_0x5b3c11['error']);});}window['exportKey']=exportKey,window[_0x5adec6(0x1dc)]=exportPrivateKey,window[_0x5adec6(0x276)]=deleteKey;let deferredPrompt;const installBtn=document[_0x5adec6(0x294)]('installBtn'),installContainer=document[_0x5adec6(0x294)]('installContainer'),installStatus=document[_0x5adec6(0x294)](_0x5adec6(0x148));installBtn&&(installBtn['disabled']=!![]);window['addEventListener'](_0x5adec6(0x26f),_0x348220=>{const _0x2be6df=_0x5adec6;_0x348220[_0x2be6df(0x299)](),deferredPrompt=_0x348220;if(installBtn){installBtn[_0x2be6df(0x174)]=![];const _0x96d7cf=installContainer['querySelector'](_0x2be6df(0x217));_0x96d7cf&&(_0x96d7cf['style'][_0x2be6df(0x13b)]=_0x2be6df(0x28a)),showStatus(_0x2be6df(0x148),_0x2be6df(0x171),_0x2be6df(0x18b));}});installBtn&&installBtn[_0x5adec6(0x1a6)]('click',async()=>{const _0x475cf6=_0x5adec6;if(!deferredPrompt){showStatus(_0x475cf6(0x148),'Installation\x20not\x20available\x20in\x20this\x20browser\x20or\x20app\x20is\x20already\x20installed',_0x475cf6(0x1f9));return;}deferredPrompt[_0x475cf6(0x1b6)]();const {outcome:_0x56b740}=await deferredPrompt[_0x475cf6(0x1ad)];console[_0x475cf6(0x11c)](_0x475cf6(0x1eb)+_0x56b740),_0x56b740===_0x475cf6(0xf0)?showStatus('installStatus',_0x475cf6(0x1a9),_0x475cf6(0x18b)):showStatus(_0x475cf6(0x148),_0x475cf6(0x17d),_0x475cf6(0x1f9)),deferredPrompt=null,installBtn['disabled']=!![];});window[_0x5adec6(0x1a6)](_0x5adec6(0x228),()=>{const _0x1a1d26=_0x5adec6;console['log'](_0x1a1d26(0x141)),deferredPrompt=null,installBtn&&(installBtn[_0x1a1d26(0x174)]=!![]),showStatus(_0x1a1d26(0x148),_0x1a1d26(0x1a9),_0x1a1d26(0x18b));});_0x5adec6(0x23d)in navigator&&(window[_0x5adec6(0x18c)]['protocol']===_0x5adec6(0x23f)||window['location'][_0x5adec6(0x27b)]===_0x5adec6(0x18f)||window[_0x5adec6(0x18c)][_0x5adec6(0x27b)]===_0x5adec6(0x261))?window['addEventListener'](_0x5adec6(0x293),function(){const _0x3c268b=_0x5adec6;navigator[_0x3c268b(0x23d)][_0x3c268b(0x226)](_0x3c268b(0x117))[_0x3c268b(0x2a7)](function(_0x37dfd8){const _0x26d70=_0x3c268b;console[_0x26d70(0x11c)]('Service\x20Worker\x20registered\x20with\x20scope:',_0x37dfd8[_0x26d70(0xec)]);})['catch'](function(_0x3fd4fe){const _0x2fb04f=_0x3c268b;console['error']('Service\x20Worker\x20registration\x20failed:',_0x3fd4fe),showStatus(_0x2fb04f(0x148),_0x2fb04f(0x165),_0x2fb04f(0x1f9));});}):(console[_0x5adec6(0x11c)]('Service\x20Workers\x20not\x20supported\x20or\x20not\x20in\x20secure\x20context'),installStatus&&(window[_0x5adec6(0x18c)][_0x5adec6(0x2a6)]===_0x5adec6(0x283)?showStatus('installStatus',_0x5adec6(0x147),_0x5adec6(0x1f9)):showStatus(_0x5adec6(0x148),_0x5adec6(0x103),_0x5adec6(0x1f9))));window[_0x5adec6(0x1a2)](_0x5adec6(0x1d5))[_0x5adec6(0xe8)]&&(console[_0x5adec6(0x11c)](_0x5adec6(0x16c)),installStatus&&showStatus(_0x5adec6(0x148),_0x5adec6(0x132),'success'));let encryptFileData=null,encryptFileName='',decryptFileData=null,decryptFileName='';document[_0x5adec6(0x1a6)](_0x5adec6(0x155),function(){const _0x2d6499=_0x5adec6,_0x35881b=document[_0x2d6499(0x294)](_0x2d6499(0x175)),_0x1d17b4=document[_0x2d6499(0x294)]('encryptBrowseBtn'),_0x4891ec=document[_0x2d6499(0x294)](_0x2d6499(0x248)),_0x8215c4=document[_0x2d6499(0x294)](_0x2d6499(0x1c2)),_0x36eb1f=document[_0x2d6499(0x294)](_0x2d6499(0x15c)),_0xa3cb23=document[_0x2d6499(0x294)](_0x2d6499(0x133)),_0x517b3a=document['getElementById'](_0x2d6499(0x1ae)),_0xb5464=document[_0x2d6499(0x294)]('decryptFileInfo'),_0x1ba8df=document['getElementById'](_0x2d6499(0x1e2)),_0x57c141=document[_0x2d6499(0x294)](_0x2d6499(0x266)),_0x21b0c9=document[_0x2d6499(0x294)](_0x2d6499(0x222)),_0x29e611=document[_0x2d6499(0x294)](_0x2d6499(0x19e));_0x1d17b4[_0x2d6499(0x1a6)](_0x2d6499(0x1e4),()=>{_0x35881b['click']();}),_0x35881b['addEventListener'](_0x2d6499(0x2b4),_0x441902=>{const _0x2c63d1=_0x2d6499;handleEncryptFileSelect(_0x441902[_0x2c63d1(0x21b)][_0x2c63d1(0x22d)]);}),_0x36eb1f[_0x2d6499(0x1a6)](_0x2d6499(0x1e4),()=>{clearEncryptFile();}),_0x517b3a[_0x2d6499(0x1a6)]('click',()=>{const _0x564f84=_0x2d6499;_0xa3cb23[_0x564f84(0x1e4)]();}),_0xa3cb23['addEventListener'](_0x2d6499(0x2b4),_0x2e99a5=>{const _0x42ff19=_0x2d6499;handleDecryptFileSelect(_0x2e99a5['target'][_0x42ff19(0x22d)]);}),_0x57c141[_0x2d6499(0x1a6)](_0x2d6499(0x1e4),()=>{clearDecryptFile();}),createKeyFileInput(),_0x21b0c9[_0x2d6499(0x1a6)](_0x2d6499(0x1e4),downloadEncryptedFile),_0x29e611[_0x2d6499(0x1a6)](_0x2d6499(0x1e4),downloadDecryptedFile),document['getElementById'](_0x2d6499(0xfe))[_0x2d6499(0x1a6)](_0x2d6499(0x1e4),function(){window['decryptedBinaryData']=null;}),document[_0x2d6499(0x294)]('passwordModalConfirm')[_0x2d6499(0x1a6)](_0x2d6499(0x1e4),confirmPasswordModal),document[_0x2d6499(0x294)](_0x2d6499(0x1fd))[_0x2d6499(0x1a6)]('click',cancelPasswordModal),document[_0x2d6499(0x294)]('passwordModalInput')[_0x2d6499(0x1a6)](_0x2d6499(0x2af),updateModalPasswordStrength),document[_0x2d6499(0x294)](_0x2d6499(0x1cb))[_0x2d6499(0x1a6)](_0x2d6499(0xff),function(_0x4dfdaf){const _0x1d6b6b=_0x2d6499;_0x4dfdaf['key']===_0x1d6b6b(0x208)&&confirmPasswordModal();}),document[_0x2d6499(0x1a6)](_0x2d6499(0x183),function(_0x451727){const _0x3424cb=_0x2d6499;_0x451727['key']===_0x3424cb(0x28c)&&document[_0x3424cb(0x294)](_0x3424cb(0x12b))[_0x3424cb(0x172)][_0x3424cb(0x13b)]==='flex'&&cancelPasswordModal();});});function handleEncryptFileSelect(_0x520de5){const _0x2ab601=_0x5adec6;if(_0x520de5[_0x2ab601(0xe4)]===0x0)return;const _0x3d956c=_0x520de5[0x0];encryptFileName=_0x3d956c['name'];const _0x228173=new FileReader();_0x228173[_0x2ab601(0x216)]=function(_0x1b2e40){const _0x28428b=_0x2ab601;encryptFileData=_0x1b2e40['target'][_0x28428b(0x20e)],document[_0x28428b(0x294)]('encryptMessage')[_0x28428b(0x1d6)]=_0x28428b(0x15e)+encryptFileName+'\x20('+formatFileSize(_0x3d956c[_0x28428b(0x22f)])+')',document[_0x28428b(0x294)](_0x28428b(0x248))['style']['display']=_0x28428b(0x29c),document[_0x28428b(0x294)](_0x28428b(0x1c2))[_0x28428b(0x235)]=encryptFileName;},_0x228173[_0x2ab601(0x1b7)](_0x3d956c);}function handleDecryptFileSelect(_0x93b642){const _0x43786d=_0x5adec6;if(_0x93b642['length']===0x0)return;const _0x314f0d=_0x93b642[0x0];decryptFileName=_0x314f0d[_0x43786d(0x11e)];const _0xdf2625=new FileReader();_0xdf2625[_0x43786d(0x216)]=function(_0x1add81){const _0x2fa11e=_0x43786d,_0x10a5f5=_0x1add81[_0x2fa11e(0x21b)][_0x2fa11e(0x20e)];_0x10a5f5[_0x2fa11e(0x206)]('@!')&&_0x10a5f5[_0x2fa11e(0x206)]('!@')?(document['getElementById'](_0x2fa11e(0x122))[_0x2fa11e(0x1d6)]=_0x10a5f5,decryptFileData=null,document['getElementById'](_0x2fa11e(0x10d))[_0x2fa11e(0x172)][_0x2fa11e(0x13b)]=_0x2fa11e(0x29c),document[_0x2fa11e(0x294)](_0x2fa11e(0x1e2))[_0x2fa11e(0x235)]=decryptFileName,showStatus(_0x2fa11e(0x140),_0x2fa11e(0x110),_0x2fa11e(0x18b))):(showStatus(_0x2fa11e(0x140),_0x2fa11e(0x1e1),'error'),document[_0x2fa11e(0x294)](_0x2fa11e(0x10d))['style'][_0x2fa11e(0x13b)]='none');},_0xdf2625[_0x43786d(0x177)]=function(){const _0x598a27=_0x43786d;showStatus(_0x598a27(0x140),'Unable\x20to\x20read\x20the\x20file\x20as\x20a\x20Lemonade\x20encrypted\x20format.','error');},_0xdf2625[_0x43786d(0x15a)](_0x314f0d);}function clearEncryptFile(){const _0x35589c=_0x5adec6;encryptFileData=null,encryptFileName='',document[_0x35589c(0x294)]('encryptMessage')[_0x35589c(0x1d6)]='',document[_0x35589c(0x294)]('encryptFileInfo')[_0x35589c(0x172)][_0x35589c(0x13b)]='none',document[_0x35589c(0x294)](_0x35589c(0x175))['value']='';}function clearDecryptFile(){const _0x415e05=_0x5adec6;decryptFileData=null,decryptFileName='',document[_0x415e05(0x294)](_0x415e05(0x122))[_0x415e05(0x1d6)]='',document[_0x415e05(0x294)]('decryptFileInfo')[_0x415e05(0x172)]['display']=_0x415e05(0x28a),document[_0x415e05(0x294)](_0x415e05(0x133))[_0x415e05(0x1d6)]='';}function formatFileSize(_0x5d620a){const _0x4a5bfb=_0x5adec6;if(_0x5d620a===0x0)return _0x4a5bfb(0x28b);const _0x4f7750=0x400,_0x53c719=[_0x4a5bfb(0x197),'KB','MB','GB'],_0x439efe=Math[_0x4a5bfb(0x16b)](Math[_0x4a5bfb(0x11c)](_0x5d620a)/Math[_0x4a5bfb(0x11c)](_0x4f7750));return parseFloat((_0x5d620a/Math['pow'](_0x4f7750,_0x439efe))[_0x4a5bfb(0x289)](0x2))+'\x20'+_0x53c719[_0x439efe];}function generateRandomFileName(_0x56ccf4=0x6){const _0x524f58=_0x5adec6,_0x47e82e='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let _0x318c1b='';for(let _0x345f70=0x0;_0x345f70<_0x56ccf4;_0x345f70++){_0x318c1b+=_0x47e82e['charAt'](Math['floor'](Math[_0x524f58(0x233)]()*_0x47e82e['length']));}return _0x318c1b;}

    </script>
<div id="passwordModal" class="modal">
    <div class="modal-content">
        <h3 id="passwordModalTitle">Enter Password</h3>
        <p id="passwordModalMessage">Please enter a password to continue:</p>
        <div class="form-group">
            <input type="password" id="passwordModalInput" placeholder="Enter password">
            <div id="passwordModalStrength" class="password-strength"></div>
            <div id="passwordModalFeedback" class="password-feedback"></div>
        </div>
        <div class="btn-group">
            <button id="passwordModalConfirm" class="btn-primary">Confirm</button>
            <button id="passwordModalCancel" class="btn-secondary">Cancel</button>
        </div>
    </div>
</div>
</body>
</html>
